const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-ponyfill-DIMAIuBD.js","assets/vendor-BLl87vHU.js"])))=>i.map(i=>d[i]);
import{r as B,a as Dc,B as Oc,u as Ic,b as Pc,R as Lc,c as Ie,N as $e,d as Bc}from"./vendor-BLl87vHU.js";import{A as At,S as Mc,F as Vs,a as Xs,T as eo,P as to,B as ua,U as Ks,L as xa,b as zc,c as ma,C as qs,D as yr,d as ro,X as so,e as pa,f as Sr,g as ir,h as Uc,i as $c,j as mn,R as Ur,k as Hc,l as ga,K as Wc,m as Qn,n as no,E as ao,M as Gc,o as Vc,p as Xc,Q as ti,q as ri,r as va,s as si,t as Kc}from"./icons-Jip1ijMp.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))s(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(n){if(n.ep)return;n.ep=!0;const i=e(n);fetch(n.href,i)}})();var io={exports:{}},pn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qc=B,Yc=Symbol.for("react.element"),Jc=Symbol.for("react.fragment"),Qc=Object.prototype.hasOwnProperty,Zc=qc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,e0={key:!0,ref:!0,__self:!0,__source:!0};function oo(t,r,e){var s,n={},i=null,o=null;e!==void 0&&(i=""+e),r.key!==void 0&&(i=""+r.key),r.ref!==void 0&&(o=r.ref);for(s in r)Qc.call(r,s)&&!e0.hasOwnProperty(s)&&(n[s]=r[s]);if(t&&t.defaultProps)for(s in r=t.defaultProps,r)n[s]===void 0&&(n[s]=r[s]);return{$$typeof:Yc,type:t,key:i,ref:o,props:n,_owner:Zc.current}}pn.Fragment=Jc;pn.jsx=oo;pn.jsxs=oo;io.exports=pn;var a=io.exports,Zn={},ni=Dc;Zn.createRoot=ni.createRoot,Zn.hydrateRoot=ni.hydrateRoot;const t0="1.35.7",lo={"X-Client-Info":`supabase-js/${t0}`},r0="supabase.auth.token";function s0(t){return t.replace(/\/$/,"")}const n0=()=>typeof window<"u",a0="1.24.0",i0="http://localhost:9999",o0={"X-Client-Info":`gotrue-js/${a0}`},Ds=10,ur={ERROR_MESSAGE:"Request Failed",MAX_RETRIES:10,RETRY_INTERVAL:2},ts="supabase.auth.token",l0={name:"sb",lifetime:60*60*8,domain:"",path:"/",sameSite:"lax"};var _s=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};const c0=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),d0=(t,r)=>{if(!t?.status)return r({message:ur.ERROR_MESSAGE});if(typeof t.json!="function")return r(t);t.json().then(e=>r({message:c0(e),status:t?.status||500}))},f0=(t,r,e)=>{const s={method:t,headers:r?.headers||{}};return t==="GET"||(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),s.body=JSON.stringify(e)),s};function gn(t,r,e,s,n){return _s(this,void 0,void 0,function*(){return new Promise((i,o)=>{t(e,f0(r,s,n)).then(l=>{if(!l.ok)throw l;return s?.noResolveJson?i:l.json()}).then(l=>i(l)).catch(l=>d0(l,o))})})}function In(t,r,e){return _s(this,void 0,void 0,function*(){return gn(t,"GET",r,e)})}function dt(t,r,e,s){return _s(this,void 0,void 0,function*(){return gn(t,"POST",r,s,e)})}function ai(t,r,e,s){return _s(this,void 0,void 0,function*(){return gn(t,"PUT",r,s,e)})}function h0(t,r,e,s){return _s(this,void 0,void 0,function*(){return gn(t,"DELETE",r,s,e)})}function u0(t,r,e){const s=e||{},n=encodeURIComponent,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if(typeof n!="function")throw new TypeError("option encode is invalid");if(!i.test(t))throw new TypeError("argument name is invalid");const o=n(r);if(o&&!i.test(o))throw new TypeError("argument val is invalid");let l=t+"="+o;if(s.maxAge!=null){const c=s.maxAge-0;if(isNaN(c)||!isFinite(c))throw new TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(c)}if(s.domain){if(!i.test(s.domain))throw new TypeError("option domain is invalid");l+="; Domain="+s.domain}if(s.path){if(!i.test(s.path))throw new TypeError("option path is invalid");l+="; Path="+s.path}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");l+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(l+="; HttpOnly"),s.secure&&(l+="; Secure"),s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case"lax":l+="; SameSite=Lax";break;case"strict":l+="; SameSite=Strict";break;case"none":l+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return l}function x0(t){if(!t||!t.headers||!t.headers.host)throw new Error('The "host" request header is not available');const r=t.headers.host.indexOf(":")>-1&&t.headers.host.split(":")[0]||t.headers.host;return!(["localhost","127.0.0.1"].indexOf(r)>-1||r.endsWith(".local"))}function m0(t,r){var e,s,n;return u0(t.name,t.value,{maxAge:t.maxAge,expires:new Date(Date.now()+t.maxAge*1e3),httpOnly:!0,secure:r,path:(e=t.path)!==null&&e!==void 0?e:"/",domain:(s=t.domain)!==null&&s!==void 0?s:"",sameSite:(n=t.sameSite)!==null&&n!==void 0?n:"lax"})}function ea(t,r,e){const s=e.map(i=>m0(i,x0(t))),n=r.getHeader("Set-Cookie");return n&&(n instanceof Array?Array.prototype.push.apply(s,n):typeof n=="string"&&s.push(n)),s}function Os(t,r,e){r.setHeader("Set-Cookie",ea(t,r,e))}const p0="modulepreload",g0=function(t){return"/"+t},ii={},vn=function(r,e,s){let n=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");n=Promise.allSettled(e.map(c=>{if(c=g0(c),c in ii)return;ii[c]=!0;const f=c.endsWith(".css"),d=f?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=f?"stylesheet":p0,f||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),f)return new Promise((u,m)=>{h.addEventListener("load",u),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return n.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return r().catch(i)})};var yn=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};function tr(t){return Math.round(Date.now()/1e3)+t}function v0(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const r=Math.random()*16|0;return(t=="x"?r:r&3|8).toString(16)})}const Vt=()=>typeof window<"u";function Gt(t,r){var e;r||(r=((e=window?.location)===null||e===void 0?void 0:e.href)||""),t=t.replace(/[\[\]]/g,"\\$&");const s=new RegExp("[?&#]"+t+"(=([^&#]*)|&|#|$)"),n=s.exec(r);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null}const y0=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>yn(void 0,void 0,void 0,function*(){return yield(yield vn(()=>import("./browser-ponyfill-DIMAIuBD.js").then(s=>s.b),__vite__mapDeps([0,1]))).fetch(...e)}):r=fetch,(...e)=>r(...e)},b0=(t,r,e)=>yn(void 0,void 0,void 0,function*(){Vt()&&(yield t?.setItem(r,JSON.stringify(e)))}),w0=(t,r)=>yn(void 0,void 0,void 0,function*(){const e=Vt()&&(yield t?.getItem(r));if(!e)return null;try{return JSON.parse(e)}catch{return e}}),_0=(t,r)=>{const e=Vt()&&t?.getItem(r);if(!e||typeof e!="string")return null;try{return JSON.parse(e)}catch{return e}},S0=(t,r)=>yn(void 0,void 0,void 0,function*(){Vt()&&(yield t?.removeItem(r))});var He=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};class N0{constructor({url:r="",headers:e={},cookieOptions:s,fetch:n}){this.url=r,this.headers=e,this.cookieOptions=Object.assign(Object.assign({},l0),s),this.fetch=y0(n)}_createRequestHeaders(r){const e=Object.assign({},this.headers);return e.Authorization=`Bearer ${r}`,e}cookieName(){var r;return(r=this.cookieOptions.name)!==null&&r!==void 0?r:""}getUrlForProvider(r,e){const s=[`provider=${encodeURIComponent(r)}`];if(e?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(e.redirectTo)}`),e?.scopes&&s.push(`scopes=${encodeURIComponent(e.scopes)}`),e?.queryParams){const n=new URLSearchParams(e.queryParams);s.push(`${n}`)}return`${this.url}/authorize?${s.join("&")}`}signUpWithEmail(r,e,s={}){return He(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers);let i="";s.redirectTo&&(i="?redirect_to="+encodeURIComponent(s.redirectTo));const o=yield dt(this.fetch,`${this.url}/signup${i}`,{email:r,password:e,data:s.data,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:n}),l=Object.assign({},o);return l.expires_in&&(l.expires_at=tr(o.expires_in)),{data:l,error:null}}catch(n){return{data:null,error:n}}})}signInWithEmail(r,e,s={}){return He(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers);let i="?grant_type=password";s.redirectTo&&(i+="&redirect_to="+encodeURIComponent(s.redirectTo));const o=yield dt(this.fetch,`${this.url}/token${i}`,{email:r,password:e,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:n}),l=Object.assign({},o);return l.expires_in&&(l.expires_at=tr(o.expires_in)),{data:l,error:null}}catch(n){return{data:null,error:n}}})}signUpWithPhone(r,e,s={}){return He(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers),i=yield dt(this.fetch,`${this.url}/signup`,{phone:r,password:e,data:s.data,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:n}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=tr(i.expires_in)),{data:o,error:null}}catch(n){return{data:null,error:n}}})}signInWithPhone(r,e,s={}){return He(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers),o=yield dt(this.fetch,`${this.url}/token?grant_type=password`,{phone:r,password:e,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:n}),l=Object.assign({},o);return l.expires_in&&(l.expires_at=tr(o.expires_in)),{data:l,error:null}}catch(n){return{data:null,error:n}}})}signInWithOpenIDConnect({id_token:r,nonce:e,client_id:s,issuer:n,provider:i}){return He(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),c=yield dt(this.fetch,`${this.url}/token?grant_type=id_token`,{id_token:r,nonce:e,client_id:s,issuer:n,provider:i},{headers:o}),f=Object.assign({},c);return f.expires_in&&(f.expires_at=tr(c.expires_in)),{data:f,error:null}}catch(o){return{data:null,error:o}}})}sendMagicLinkEmail(r,e={}){var s;return He(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers);let i="";e.redirectTo&&(i+="?redirect_to="+encodeURIComponent(e.redirectTo));const o=(s=e.shouldCreateUser)!==null&&s!==void 0?s:!0;return{data:yield dt(this.fetch,`${this.url}/otp${i}`,{email:r,create_user:o,gotrue_meta_security:{captcha_token:e.captchaToken}},{headers:n}),error:null}}catch(n){return{data:null,error:n}}})}sendMobileOTP(r,e={}){var s;return He(this,void 0,void 0,function*(){try{const n=(s=e.shouldCreateUser)!==null&&s!==void 0?s:!0,i=Object.assign({},this.headers);return{data:yield dt(this.fetch,`${this.url}/otp`,{phone:r,create_user:n,gotrue_meta_security:{captcha_token:e.captchaToken}},{headers:i}),error:null}}catch(n){return{data:null,error:n}}})}signOut(r){return He(this,void 0,void 0,function*(){try{return yield dt(this.fetch,`${this.url}/logout`,{},{headers:this._createRequestHeaders(r),noResolveJson:!0}),{error:null}}catch(e){return{error:e}}})}verifyMobileOTP(r,e,s={}){return He(this,void 0,void 0,function*(){try{const n=Object.assign({},this.headers),i=yield dt(this.fetch,`${this.url}/verify`,{phone:r,token:e,type:"sms",redirect_to:s.redirectTo},{headers:n}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=tr(i.expires_in)),{data:o,error:null}}catch(n){return{data:null,error:n}}})}verifyOTP({email:r,phone:e,token:s,type:n="sms"},i={}){return He(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),l=yield dt(this.fetch,`${this.url}/verify`,{email:r,phone:e,token:s,type:n,redirect_to:i.redirectTo},{headers:o}),c=Object.assign({},l);return c.expires_in&&(c.expires_at=tr(l.expires_in)),{data:c,error:null}}catch(o){return{data:null,error:o}}})}inviteUserByEmail(r,e={}){return He(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let n="";return e.redirectTo&&(n+="?redirect_to="+encodeURIComponent(e.redirectTo)),{data:yield dt(this.fetch,`${this.url}/invite${n}`,{email:r,data:e.data},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}resetPasswordForEmail(r,e={}){return He(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let n="";return e.redirectTo&&(n+="?redirect_to="+encodeURIComponent(e.redirectTo)),{data:yield dt(this.fetch,`${this.url}/recover${n}`,{email:r,gotrue_meta_security:{captcha_token:e.captchaToken}},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}refreshAccessToken(r){return He(this,void 0,void 0,function*(){try{const e=yield dt(this.fetch,`${this.url}/token?grant_type=refresh_token`,{refresh_token:r},{headers:this.headers}),s=Object.assign({},e);return s.expires_in&&(s.expires_at=tr(e.expires_in)),{data:s,error:null}}catch(e){return{data:null,error:e}}})}setAuthCookie(r,e){r.method!=="POST"&&(e.setHeader("Allow","POST"),e.status(405).end("Method Not Allowed"));const{event:s,session:n}=r.body;if(!s)throw new Error("Auth event missing!");if(s==="SIGNED_IN"){if(!n)throw new Error("Auth session missing!");Os(r,e,[{key:"access-token",value:n.access_token},{key:"refresh-token",value:n.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}s==="SIGNED_OUT"&&Os(r,e,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))),e.status(200).json({})}deleteAuthCookie(r,e,{redirectTo:s="/"}){return Os(r,e,["access-token","refresh-token"].map(n=>({name:`${this.cookieName()}-${n}`,value:"",maxAge:-1}))),e.redirect(307,s)}getAuthCookieString(r,e){r.method!=="POST"&&(e.setHeader("Allow","POST"),e.status(405).end("Method Not Allowed"));const{event:s,session:n}=r.body;if(!s)throw new Error("Auth event missing!");if(s==="SIGNED_IN"){if(!n)throw new Error("Auth session missing!");return ea(r,e,[{key:"access-token",value:n.access_token},{key:"refresh-token",value:n.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}return s==="SIGNED_OUT"?ea(r,e,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))):e.getHeader("Set-Cookie")}generateLink(r,e,s={}){return He(this,void 0,void 0,function*(){try{return{data:yield dt(this.fetch,`${this.url}/admin/generate_link`,{type:r,email:e,password:s.password,data:s.data,redirect_to:s.redirectTo},{headers:this.headers}),error:null}}catch(n){return{data:null,error:n}}})}createUser(r){return He(this,void 0,void 0,function*(){try{const e=yield dt(this.fetch,`${this.url}/admin/users`,r,{headers:this.headers});return{user:e,data:e,error:null}}catch(e){return{user:null,data:null,error:e}}})}listUsers(){return He(this,void 0,void 0,function*(){try{return{data:(yield In(this.fetch,`${this.url}/admin/users`,{headers:this.headers})).users,error:null}}catch(r){return{data:null,error:r}}})}getUserById(r){return He(this,void 0,void 0,function*(){try{return{data:yield In(this.fetch,`${this.url}/admin/users/${r}`,{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}getUserByCookie(r,e){return He(this,void 0,void 0,function*(){try{if(!r.cookies)throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");const s=r.cookies[`${this.cookieName()}-access-token`],n=r.cookies[`${this.cookieName()}-refresh-token`];if(!s)throw new Error("No cookie found!");const{user:i,error:o}=yield this.getUser(s);if(o){if(!n)throw new Error("No refresh_token cookie found!");if(!e)throw new Error("You need to pass the res object to automatically refresh the session!");const{data:l,error:c}=yield this.refreshAccessToken(n);if(c)throw c;if(l)return Os(r,e,[{key:"access-token",value:l.access_token},{key:"refresh-token",value:l.refresh_token}].map(f=>{var d;return{name:`${this.cookieName()}-${f.key}`,value:f.value,domain:this.cookieOptions.domain,maxAge:(d=this.cookieOptions.lifetime)!==null&&d!==void 0?d:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}})),{token:l.access_token,user:l.user,data:l.user,error:null}}return{token:s,user:i,data:i,error:null}}catch(s){return{token:null,user:null,data:null,error:s}}})}updateUserById(r,e){return He(this,void 0,void 0,function*(){try{const s=yield ai(this.fetch,`${this.url}/admin/users/${r}`,e,{headers:this.headers});return{user:s,data:s,error:null}}catch(s){return{user:null,data:null,error:s}}})}deleteUser(r){return He(this,void 0,void 0,function*(){try{const e=yield h0(this.fetch,`${this.url}/admin/users/${r}`,{},{headers:this.headers});return{user:e,data:e,error:null}}catch(e){return{user:null,data:null,error:e}}})}getUser(r){return He(this,void 0,void 0,function*(){try{const e=yield In(this.fetch,`${this.url}/user`,{headers:this._createRequestHeaders(r)});return{user:e,data:e,error:null}}catch(e){return{user:null,data:null,error:e}}})}updateUser(r,e){return He(this,void 0,void 0,function*(){try{const s=yield ai(this.fetch,`${this.url}/user`,e,{headers:this._createRequestHeaders(r)});return{user:s,data:s,error:null}}catch(s){return{user:null,data:null,error:s}}})}}function j0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var ft=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};j0();const E0={url:i0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:o0},T0=t=>{try{return atob(t.replace(/[-]/g,"+").replace(/[_]/g,"/"))}catch(r){if(r instanceof ReferenceError)return Buffer.from(t,"base64").toString("utf-8");throw r}};class C0{constructor(r){this.stateChangeEmitters=new Map,this.networkRetries=0;const e=Object.assign(Object.assign({},E0),r);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=e.autoRefreshToken,this.persistSession=e.persistSession,this.multiTab=e.multiTab,this.localStorage=e.localStorage||globalThis.localStorage,this.api=new N0({url:e.url,headers:e.headers,cookieOptions:e.cookieOptions,fetch:e.fetch}),this._recoverSession(),this._recoverAndRefresh(),this._listenForMultiTabEvents(),this._handleVisibilityChange(),e.detectSessionInUrl&&Vt()&&Gt("access_token")&&this.getSessionFromUrl({storeSession:!0}).then(({error:s})=>{if(s)throw new Error("Error getting session from URL.")})}signUp({email:r,password:e,phone:s},n={}){return ft(this,void 0,void 0,function*(){try{this._removeSession();const{data:i,error:o}=s&&e?yield this.api.signUpWithPhone(s,e,{data:n.data,captchaToken:n.captchaToken}):yield this.api.signUpWithEmail(r,e,{redirectTo:n.redirectTo,data:n.data,captchaToken:n.captchaToken});if(o)throw o;if(!i)throw"An error occurred on sign up.";let l=null,c=null;return i.access_token&&(l=i,c=l.user,this._saveSession(l),this._notifyAllSubscribers("SIGNED_IN")),i.id&&(c=i),{user:c,session:l,error:null}}catch(i){return{user:null,session:null,error:i}}})}signIn({email:r,phone:e,password:s,refreshToken:n,provider:i,oidc:o},l={}){return ft(this,void 0,void 0,function*(){try{if(this._removeSession(),r&&!s){const{error:c}=yield this.api.sendMagicLinkEmail(r,{redirectTo:l.redirectTo,shouldCreateUser:l.shouldCreateUser,captchaToken:l.captchaToken});return{user:null,session:null,error:c}}if(r&&s)return this._handleEmailSignIn(r,s,{redirectTo:l.redirectTo,captchaToken:l.captchaToken});if(e&&!s){const{error:c}=yield this.api.sendMobileOTP(e,{shouldCreateUser:l.shouldCreateUser,captchaToken:l.captchaToken});return{user:null,session:null,error:c}}if(e&&s)return this._handlePhoneSignIn(e,s);if(n){const{error:c}=yield this._callRefreshToken(n);if(c)throw c;return{user:this.currentUser,session:this.currentSession,error:null}}if(i)return this._handleProviderSignIn(i,{redirectTo:l.redirectTo,scopes:l.scopes,queryParams:l.queryParams});if(o)return this._handleOpenIDConnectSignIn(o);throw new Error("You must provide either an email, phone number, a third-party provider or OpenID Connect.")}catch(c){return{user:null,session:null,error:c}}})}verifyOTP(r,e={}){return ft(this,void 0,void 0,function*(){try{this._removeSession();const{data:s,error:n}=yield this.api.verifyOTP(r,e);if(n)throw n;if(!s)throw"An error occurred on token verification.";let i=null,o=null;return s.access_token&&(i=s,o=i.user,this._saveSession(i),this._notifyAllSubscribers("SIGNED_IN")),s.id&&(o=s),{user:o,session:i,error:null}}catch(s){return{user:null,session:null,error:s}}})}user(){return this.currentUser}session(){return this.currentSession}refreshSession(){var r;return ft(this,void 0,void 0,function*(){try{if(!(!((r=this.currentSession)===null||r===void 0)&&r.access_token))throw new Error("Not logged in.");const{error:e}=yield this._callRefreshToken();if(e)throw e;return{data:this.currentSession,user:this.currentUser,error:null}}catch(e){return{data:null,user:null,error:e}}})}update(r){var e;return ft(this,void 0,void 0,function*(){try{if(!(!((e=this.currentSession)===null||e===void 0)&&e.access_token))throw new Error("Not logged in.");const{user:s,error:n}=yield this.api.updateUser(this.currentSession.access_token,r);if(n)throw n;if(!s)throw Error("Invalid user data.");const i=Object.assign(Object.assign({},this.currentSession),{user:s});return this._saveSession(i),this._notifyAllSubscribers("USER_UPDATED"),{data:s,user:s,error:null}}catch(s){return{data:null,user:null,error:s}}})}setSession(r){return ft(this,void 0,void 0,function*(){let e;if(typeof r=="string"){const s=r,{data:n,error:i}=yield this.api.refreshAccessToken(s);if(i)return{session:null,error:i};e=n}else{const s=Math.round(Date.now()/1e3);let{refresh_token:n,access_token:i}=r,o=0,l=0;const c=i.split(".");if(c.length!==3)throw new Error("access_token is not a proper JWT");const f=T0(c[1]);let d;try{d=JSON.parse(f)}catch{throw new Error("access_token is not a proper JWT, invalid JSON in body")}if(typeof d=="object"&&d&&typeof d.exp=="number")o=d.exp,l=s-d.exp;else throw new Error("access_token is not a proper JWT, missing exp claim");if(s>o){const{data:h,error:u}=yield this.api.refreshAccessToken(n);if(u)return{session:null,error:u};e=h}else{const{user:h,error:u}=yield this.api.getUser(i);if(u)throw u;e={access_token:i,expires_in:l,expires_at:o,refresh_token:n,token_type:"bearer",user:h}}}try{return this._saveSession(e),this._notifyAllSubscribers("SIGNED_IN"),{session:e,error:null}}catch(s){return{error:s,session:null}}})}setAuth(r){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:r,token_type:"bearer",user:this.user()}),this._notifyAllSubscribers("TOKEN_REFRESHED"),this.currentSession}getSessionFromUrl(r){return ft(this,void 0,void 0,function*(){try{if(!Vt())throw new Error("No browser detected.");const e=Gt("error_description");if(e)throw new Error(e);const s=Gt("provider_token"),n=Gt("provider_refresh_token"),i=Gt("access_token");if(!i)throw new Error("No access_token detected.");const o=Gt("expires_in");if(!o)throw new Error("No expires_in detected.");const l=Gt("refresh_token");if(!l)throw new Error("No refresh_token detected.");const c=Gt("token_type");if(!c)throw new Error("No token_type detected.");const d=Math.round(Date.now()/1e3)+parseInt(o),{user:h,error:u}=yield this.api.getUser(i);if(u)throw u;const m={provider_token:s,provider_refresh_token:n,access_token:i,expires_in:parseInt(o),expires_at:d,refresh_token:l,token_type:c,user:h};if(r?.storeSession){this._saveSession(m);const p=Gt("type");this._notifyAllSubscribers("SIGNED_IN"),p==="recovery"&&this._notifyAllSubscribers("PASSWORD_RECOVERY")}return window.location.hash="",{data:m,error:null}}catch(e){return{data:null,error:e}}})}signOut(){var r;return ft(this,void 0,void 0,function*(){const e=(r=this.currentSession)===null||r===void 0?void 0:r.access_token;if(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),e){const{error:s}=yield this.api.signOut(e);if(s)return{error:s}}return{error:null}})}onAuthStateChange(r){try{const e=v0(),s={id:e,callback:r,unsubscribe:()=>{this.stateChangeEmitters.delete(e)}};return this.stateChangeEmitters.set(e,s),{data:s,error:null}}catch(e){return{data:null,error:e}}}_handleEmailSignIn(r,e,s={}){var n,i;return ft(this,void 0,void 0,function*(){try{const{data:o,error:l}=yield this.api.signInWithEmail(r,e,{redirectTo:s.redirectTo,captchaToken:s.captchaToken});return l||!o?{data:null,user:null,session:null,error:l}:((!((n=o?.user)===null||n===void 0)&&n.confirmed_at||!((i=o?.user)===null||i===void 0)&&i.email_confirmed_at)&&(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN")),{data:o,user:o.user,session:o,error:null})}catch(o){return{data:null,user:null,session:null,error:o}}})}_handlePhoneSignIn(r,e,s={}){var n;return ft(this,void 0,void 0,function*(){try{const{data:i,error:o}=yield this.api.signInWithPhone(r,e,s);return o||!i?{data:null,user:null,session:null,error:o}:(!((n=i?.user)===null||n===void 0)&&n.phone_confirmed_at&&(this._saveSession(i),this._notifyAllSubscribers("SIGNED_IN")),{data:i,user:i.user,session:i,error:null})}catch(i){return{data:null,user:null,session:null,error:i}}})}_handleProviderSignIn(r,e={}){const s=this.api.getUrlForProvider(r,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});try{return Vt()&&(window.location.href=s),{provider:r,url:s,data:null,session:null,user:null,error:null}}catch(n){return s?{provider:r,url:s,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:n}}}_handleOpenIDConnectSignIn({id_token:r,nonce:e,client_id:s,issuer:n,provider:i}){return ft(this,void 0,void 0,function*(){if(r&&e&&(s&&n||i))try{const{data:o,error:l}=yield this.api.signInWithOpenIDConnect({id_token:r,nonce:e,client_id:s,issuer:n,provider:i});return l||!o?{user:null,session:null,error:l}:(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN"),{user:o.user,session:o,error:null})}catch(o){return{user:null,session:null,error:o}}throw new Error("You must provide a OpenID Connect provider with your id token and nonce.")})}_recoverSession(){try{const r=_0(this.localStorage,ts);if(!r)return null;const{currentSession:e,expiresAt:s}=r,n=Math.round(Date.now()/1e3);s>=n+Ds&&e?.user&&(this._saveSession(e),this._notifyAllSubscribers("SIGNED_IN"))}catch(r){console.log("error",r)}}_recoverAndRefresh(){return ft(this,void 0,void 0,function*(){try{const r=yield w0(this.localStorage,ts);if(!r)return null;const{currentSession:e,expiresAt:s}=r,n=Math.round(Date.now()/1e3);if(s<n+Ds)if(this.autoRefreshToken&&e.refresh_token){this.networkRetries++;const{error:i}=yield this._callRefreshToken(e.refresh_token);if(i){if(console.log(i.message),i.message===ur.ERROR_MESSAGE&&this.networkRetries<ur.MAX_RETRIES){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),this.refreshTokenTimer=setTimeout(()=>this._recoverAndRefresh(),Math.pow(ur.RETRY_INTERVAL,this.networkRetries)*100);return}yield this._removeSession()}this.networkRetries=0}else this._removeSession();else e?(this._saveSession(e),this._notifyAllSubscribers("SIGNED_IN")):(console.log("Current session is missing data."),this._removeSession())}catch(r){return console.error(r),null}})}_callRefreshToken(r){var e;return r===void 0&&(r=(e=this.currentSession)===null||e===void 0?void 0:e.refresh_token),ft(this,void 0,void 0,function*(){try{if(!r)throw new Error("No current session.");const{data:s,error:n}=yield this.api.refreshAccessToken(r);if(n)throw n;if(!s)throw Error("Invalid session data.");return this._saveSession(s),this._notifyAllSubscribers("TOKEN_REFRESHED"),this._notifyAllSubscribers("SIGNED_IN"),{data:s,error:null}}catch(s){return{data:null,error:s}}})}_notifyAllSubscribers(r){this.stateChangeEmitters.forEach(e=>e.callback(r,this.currentSession))}_saveSession(r){this.currentSession=r,this.currentUser=r.user;const e=r.expires_at;if(e){const s=Math.round(Date.now()/1e3),n=e-s,i=n>Ds?Ds:.5;this._startAutoRefreshToken((n-i)*1e3)}this.persistSession&&r.expires_at&&this._persistSession(this.currentSession)}_persistSession(r){const e={currentSession:r,expiresAt:r.expires_at};b0(this.localStorage,ts,e)}_removeSession(){return ft(this,void 0,void 0,function*(){this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),S0(this.localStorage,ts)})}_startAutoRefreshToken(r){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),!(r<=0||!this.autoRefreshToken)&&(this.refreshTokenTimer=setTimeout(()=>ft(this,void 0,void 0,function*(){this.networkRetries++;const{error:e}=yield this._callRefreshToken();e||(this.networkRetries=0),e?.message===ur.ERROR_MESSAGE&&this.networkRetries<ur.MAX_RETRIES&&this._startAutoRefreshToken(Math.pow(ur.RETRY_INTERVAL,this.networkRetries)*100)}),r),typeof this.refreshTokenTimer.unref=="function"&&this.refreshTokenTimer.unref())}_listenForMultiTabEvents(){if(!this.multiTab||!Vt()||!window?.addEventListener)return!1;try{window?.addEventListener("storage",r=>{var e;if(r.key===ts){const s=JSON.parse(String(r.newValue));!((e=s?.currentSession)===null||e===void 0)&&e.access_token?(this._saveSession(s.currentSession),this._notifyAllSubscribers("SIGNED_IN")):(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"))}})}catch(r){console.error("_listenForMultiTabEvents",r)}}_handleVisibilityChange(){if(!this.multiTab||!Vt()||!window?.addEventListener)return!1;try{window?.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this._recoverAndRefresh()})}catch(r){console.error("_handleVisibilityChange",r)}}}class A0 extends C0{constructor(r){super(r)}}var oi=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};class ya{constructor(r){Object.assign(this,r);let e;r.fetch?e=r.fetch:typeof fetch>"u"?e=(...s)=>oi(this,void 0,void 0,function*(){return yield(yield vn(()=>import("./browser-ponyfill-DIMAIuBD.js").then(n=>n.b),__vite__mapDeps([0,1]))).fetch(...s)}):e=fetch,this.fetch=(...s)=>e(...s),this.shouldThrowOnError=r.shouldThrowOnError||!1,this.allowEmpty=r.allowEmpty||!1}throwOnError(r){return r==null&&(r=!0),this.shouldThrowOnError=r,this}then(r,e){typeof this.schema>"u"||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let s=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(n=>oi(this,void 0,void 0,function*(){var i,o,l,c;let f=null,d=null,h=null,u=n.status,m=n.statusText;if(n.ok){const x=(i=this.headers.Prefer)===null||i===void 0?void 0:i.split(",").includes("return=minimal");if(this.method!=="HEAD"&&!x){const _=yield n.text();_&&(this.headers.Accept==="text/csv"?d=_:d=JSON.parse(_))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),T=(l=n.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");g&&T&&T.length>1&&(h=parseInt(T[1]))}else{const x=yield n.text();try{f=JSON.parse(x)}catch{f={message:x}}if(f&&this.allowEmpty&&(!((c=f?.details)===null||c===void 0)&&c.includes("Results contain 0 rows"))&&(f=null,u=200,m="OK"),f&&this.shouldThrowOnError)throw f}return{error:f,data:d,count:h,status:u,statusText:m,body:d}}));return this.shouldThrowOnError||(s=s.catch(n=>({error:{message:`FetchError: ${n.message}`,details:"",hint:"",code:n.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}))),s.then(r,e)}}class k0 extends ya{select(r="*"){let e=!1;const s=r.split("").map(n=>/\s/.test(n)&&!e?"":(n==='"'&&(e=!e),n)).join("");return this.url.searchParams.set("select",s),this}order(r,{ascending:e=!0,nullsFirst:s=!1,foreignTable:n}={}){const i=typeof n>"u"?"order":`${n}.order`,o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${r}.${e?"asc":"desc"}.${s?"nullsfirst":"nullslast"}`),this}limit(r,{foreignTable:e}={}){const s=typeof e>"u"?"limit":`${e}.limit`;return this.url.searchParams.set(s,`${r}`),this}range(r,e,{foreignTable:s}={}){const n=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(n,`${r}`),this.url.searchParams.set(i,`${e-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers.Accept="application/vnd.pgrst.object+json",this.allowEmpty=!0,this}csv(){return this.headers.Accept="text/csv",this}}class Dr extends k0{constructor(){super(...arguments),this.cs=this.contains,this.cd=this.containedBy,this.sl=this.rangeLt,this.sr=this.rangeGt,this.nxl=this.rangeGte,this.nxr=this.rangeLte,this.adj=this.rangeAdjacent,this.ov=this.overlaps}not(r,e,s){return this.url.searchParams.append(`${r}`,`not.${e}.${s}`),this}or(r,{foreignTable:e}={}){const s=typeof e>"u"?"or":`${e}.or`;return this.url.searchParams.append(s,`(${r})`),this}eq(r,e){return this.url.searchParams.append(`${r}`,`eq.${e}`),this}neq(r,e){return this.url.searchParams.append(`${r}`,`neq.${e}`),this}gt(r,e){return this.url.searchParams.append(`${r}`,`gt.${e}`),this}gte(r,e){return this.url.searchParams.append(`${r}`,`gte.${e}`),this}lt(r,e){return this.url.searchParams.append(`${r}`,`lt.${e}`),this}lte(r,e){return this.url.searchParams.append(`${r}`,`lte.${e}`),this}like(r,e){return this.url.searchParams.append(`${r}`,`like.${e}`),this}ilike(r,e){return this.url.searchParams.append(`${r}`,`ilike.${e}`),this}is(r,e){return this.url.searchParams.append(`${r}`,`is.${e}`),this}in(r,e){const s=e.map(n=>typeof n=="string"&&new RegExp("[,()]").test(n)?`"${n}"`:`${n}`).join(",");return this.url.searchParams.append(`${r}`,`in.(${s})`),this}contains(r,e){return typeof e=="string"?this.url.searchParams.append(`${r}`,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(`${r}`,`cs.{${e.join(",")}}`):this.url.searchParams.append(`${r}`,`cs.${JSON.stringify(e)}`),this}containedBy(r,e){return typeof e=="string"?this.url.searchParams.append(`${r}`,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(`${r}`,`cd.{${e.join(",")}}`):this.url.searchParams.append(`${r}`,`cd.${JSON.stringify(e)}`),this}rangeLt(r,e){return this.url.searchParams.append(`${r}`,`sl.${e}`),this}rangeGt(r,e){return this.url.searchParams.append(`${r}`,`sr.${e}`),this}rangeGte(r,e){return this.url.searchParams.append(`${r}`,`nxl.${e}`),this}rangeLte(r,e){return this.url.searchParams.append(`${r}`,`nxr.${e}`),this}rangeAdjacent(r,e){return this.url.searchParams.append(`${r}`,`adj.${e}`),this}overlaps(r,e){return typeof e=="string"?this.url.searchParams.append(`${r}`,`ov.${e}`):this.url.searchParams.append(`${r}`,`ov.{${e.join(",")}}`),this}textSearch(r,e,{config:s,type:n=null}={}){let i="";n==="plain"?i="pl":n==="phrase"?i="ph":n==="websearch"&&(i="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(`${r}`,`${i}fts${o}.${e}`),this}fts(r,e,{config:s}={}){const n=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`fts${n}.${e}`),this}plfts(r,e,{config:s}={}){const n=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`plfts${n}.${e}`),this}phfts(r,e,{config:s}={}){const n=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`phfts${n}.${e}`),this}wfts(r,e,{config:s}={}){const n=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`wfts${n}.${e}`),this}filter(r,e,s){return this.url.searchParams.append(`${r}`,`${e}.${s}`),this}match(r){return Object.keys(r).forEach(e=>{this.url.searchParams.append(`${e}`,`eq.${r[e]}`)}),this}}class co extends ya{constructor(r,{headers:e={},schema:s,fetch:n,shouldThrowOnError:i}={}){super({fetch:n,shouldThrowOnError:i}),this.url=new URL(r),this.headers=Object.assign({},e),this.schema=s}select(r="*",{head:e=!1,count:s=null}={}){this.method="GET";let n=!1;const i=r.split("").map(o=>/\s/.test(o)&&!n?"":(o==='"'&&(n=!n),o)).join("");return this.url.searchParams.set("select",i),s&&(this.headers.Prefer=`count=${s}`),e&&(this.method="HEAD"),new Dr(this)}insert(r,{upsert:e=!1,onConflict:s,returning:n="representation",count:i=null}={}){this.method="POST";const o=[`return=${n}`];if(e&&o.push("resolution=merge-duplicates"),e&&s!==void 0&&this.url.searchParams.set("on_conflict",s),this.body=r,i&&o.push(`count=${i}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),Array.isArray(r)){const l=r.reduce((c,f)=>c.concat(Object.keys(f)),[]);if(l.length>0){const c=[...new Set(l)].map(f=>`"${f}"`);this.url.searchParams.set("columns",c.join(","))}}return new Dr(this)}upsert(r,{onConflict:e,returning:s="representation",count:n=null,ignoreDuplicates:i=!1}={}){this.method="POST";const o=[`resolution=${i?"ignore":"merge"}-duplicates`,`return=${s}`];return e!==void 0&&this.url.searchParams.set("on_conflict",e),this.body=r,n&&o.push(`count=${n}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new Dr(this)}update(r,{returning:e="representation",count:s=null}={}){this.method="PATCH";const n=[`return=${e}`];return this.body=r,s&&n.push(`count=${s}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new Dr(this)}delete({returning:r="representation",count:e=null}={}){this.method="DELETE";const s=[`return=${r}`];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Dr(this)}}class R0 extends ya{constructor(r,{headers:e={},schema:s,fetch:n,shouldThrowOnError:i}={}){super({fetch:n,shouldThrowOnError:i}),this.url=new URL(r),this.headers=Object.assign({},e),this.schema=s}rpc(r,{head:e=!1,count:s=null}={}){return e?(this.method="HEAD",r&&Object.entries(r).forEach(([n,i])=>{this.url.searchParams.append(n,i)})):(this.method="POST",this.body=r),s&&(this.headers.Prefer!==void 0?this.headers.Prefer+=`,count=${s}`:this.headers.Prefer=`count=${s}`),new Dr(this)}}const F0="0.37.4",D0={"X-Client-Info":`postgrest-js/${F0}`};class O0{constructor(r,{headers:e={},schema:s,fetch:n,throwOnError:i}={}){this.url=r,this.headers=Object.assign(Object.assign({},D0),e),this.schema=s,this.fetch=n,this.shouldThrowOnError=i}auth(r){return this.headers.Authorization=`Bearer ${r}`,this}from(r){const e=`${this.url}/${r}`;return new co(e,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(r,e,{head:s=!1,count:n=null}={}){const i=`${this.url}/rpc/${r}`;return new R0(i,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError}).rpc(e,{head:s,count:n})}}var Pe;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Pe||(Pe={}));const li=(t,r,e={})=>{var s;const n=(s=e.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(r).reduce((i,o)=>(i[o]=I0(o,t,r,n),i),{})},I0=(t,r,e,s)=>{const n=r.find(l=>l.name===t),i=n?.type,o=e[t];return i&&!s.includes(i)?fo(i,o):ta(o)},fo=(t,r)=>{if(t.charAt(0)==="_"){const e=t.slice(1,t.length);return M0(r,e)}switch(t){case Pe.bool:return P0(r);case Pe.float4:case Pe.float8:case Pe.int2:case Pe.int4:case Pe.int8:case Pe.numeric:case Pe.oid:return L0(r);case Pe.json:case Pe.jsonb:return B0(r);case Pe.timestamp:return z0(r);case Pe.abstime:case Pe.date:case Pe.daterange:case Pe.int4range:case Pe.int8range:case Pe.money:case Pe.reltime:case Pe.text:case Pe.time:case Pe.timestamptz:case Pe.timetz:case Pe.tsrange:case Pe.tstzrange:return ta(r);default:return ta(r)}},ta=t=>t,P0=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},L0=t=>{if(typeof t=="string"){const r=parseFloat(t);if(!Number.isNaN(r))return r}return t},B0=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(r){return console.log(`JSON parse error: ${r}`),t}return t},M0=(t,r)=>{if(typeof t!="string")return t;const e=t.length-1,s=t[e];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,e);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>fo(r,l))}return t},z0=t=>typeof t=="string"?t.replace(" ","T"):t;var Pn,ci;function U0(){if(ci)return Pn;ci=1;var t=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return Pn=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}(),Pn}const $0="1.0.35",H0={version:$0};var W0=H0.version,xr;if(typeof globalThis=="object")xr=globalThis;else try{xr=U0()}catch{}finally{if(!xr&&typeof window<"u"&&(xr=window),!xr)throw new Error("Could not determine global this")}var us=xr.WebSocket||xr.MozWebSocket,G0=W0;function ho(t,r){var e;return r?e=new us(t,r):e=new us(t),e}us&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(t){Object.defineProperty(ho,t,{get:function(){return us[t]}})});var V0={w3cwebsocket:us?ho:null,version:G0};const X0="1.7.5",K0={"X-Client-Info":`realtime-js/${X0}`},q0="1.0.0",uo=1e4,Y0=1e3;var as;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(as||(as={}));var gt;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(gt||(gt={}));var Ot;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Ot||(Ot={}));var ra;(function(t){t.websocket="websocket"})(ra||(ra={}));var mr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(mr||(mr={}));class xo{constructor(r,e){this.callback=r,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class J0{constructor(){this.HEADER_LENGTH=1}decode(r,e){return r.constructor===ArrayBuffer?e(this._binaryDecode(r)):e(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const e=new DataView(r),s=new TextDecoder;return this._decodeBroadcast(r,e,s)}_decodeBroadcast(r,e,s){const n=e.getUint8(1),i=e.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(r.slice(o,o+n));o=o+n;const c=s.decode(r.slice(o,o+i));o=o+i;const f=JSON.parse(s.decode(r.slice(o,r.byteLength)));return{ref:null,topic:l,event:c,payload:f}}}class Ln{constructor(r,e,s={},n=uo){this.channel=r,this.event=e,this.payload=s,this.timeout=n,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel.joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,e){var s;return this._hasReceived(r)&&e((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:r,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref);const r=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel.on(this.refEvent,r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,e){this.refEvent&&this.channel.trigger(this.refEvent,{status:r,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:e}){this.recHooks.filter(s=>s.status===r).forEach(s=>s.callback(e))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}class Q0{constructor(r,e={},s){this.topic=r,this.params=e,this.socket=s,this.bindings=[],this.state=gt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new Ln(this,Ot.join,this.params,this.timeout),this.rejoinTimer=new xo(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=gt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(n=>n.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=gt.closed,this.socket.remove(this)}),this.onError(n=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,n),this.state=gt.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this.isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=gt.errored,this.rejoinTimer.scheduleTimeout())}),this.on(Ot.reply,(n,i)=>{this.trigger(this.replyEventName(i),n)})}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(r=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(r),this.joinPush}onClose(r){this.on(Ot.close,r)}onError(r){this.on(Ot.error,e=>r(e))}on(r,e){this.bindings.push({event:r,callback:e})}off(r){this.bindings=this.bindings.filter(e=>e.event!==r)}canPush(){return this.socket.isConnected()&&this.isJoined()}push(r,e,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let n=new Ln(this,r,e,s);return this.canPush()?n.send():(n.startTimeout(),this.pushBuffer.push(n)),n}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=gt.leaving;let e=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(Ot.close,"leave",this.joinRef())};this.joinPush.destroy();let s=new Ln(this,Ot.leave,{},r);return s.receive("ok",()=>e()).receive("timeout",()=>e()),s.send(),this.canPush()||s.trigger("ok",{}),s}onMessage(r,e,s){return e}isMember(r){return this.topic===r}joinRef(){return this.joinPush.ref}rejoin(r=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=gt.joining,this.joinPush.resend(r))}trigger(r,e,s){let{close:n,error:i,leave:o,join:l}=Ot;if(s&&[n,i,o,l].indexOf(r)>=0&&s!==this.joinRef())return;let f=this.onMessage(r,e,s);if(e&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(d=>d.event==="*"?r===e?.type:d.event===r).map(d=>d.callback(f,s))}replyEventName(r){return`chan_reply_${r}`}isClosed(){return this.state===gt.closed}isErrored(){return this.state===gt.errored}isJoined(){return this.state===gt.joined}isJoining(){return this.state===gt.joining}isLeaving(){return this.state===gt.leaving}}var Z0=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};const ed=()=>{};class td{constructor(r,e){this.accessToken=null,this.channels=[],this.endPoint="",this.headers=K0,this.params={},this.timeout=uo,this.transport=V0.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=ed,this.conn=null,this.sendBuffer=[],this.serializer=new J0,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.endPoint=`${r}/${ra.websocket}`,e?.params&&(this.params=e.params),e?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e?.timeout&&(this.timeout=e.timeout),e?.logger&&(this.logger=e.logger),e?.transport&&(this.transport=e.transport),e?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs),e?.longpollerTimeout&&(this.longpollerTimeout=e.longpollerTimeout),this.reconnectAfterMs=e?.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e?.encode?e.encode:(s,n)=>n(JSON.stringify(s)),this.decode=e?.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new xo(()=>Z0(this,void 0,void 0,function*(){yield this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this.onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r)))}disconnect(r,e){return new Promise((s,n)=>{try{this.conn&&(this.conn.onclose=function(){},r?this.conn.close(r,e||""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset()),s({error:null,data:!0})}catch(i){s({error:i,data:!1})}})}log(r,e,s){this.logger(r,e,s)}onOpen(r){this.stateChangeCallbacks.open.push(r)}onClose(r){this.stateChangeCallbacks.close.push(r)}onError(r){this.stateChangeCallbacks.error.push(r)}onMessage(r){this.stateChangeCallbacks.message.push(r)}connectionState(){switch(this.conn&&this.conn.readyState){case as.connecting:return mr.Connecting;case as.open:return mr.Open;case as.closing:return mr.Closing;default:return mr.Closed}}isConnected(){return this.connectionState()===mr.Open}remove(r){this.channels=this.channels.filter(e=>e.joinRef()!==r.joinRef())}channel(r,e={}){const s=new Q0(r,e,this);return this.channels.push(s),s}push(r){const{topic:e,event:s,payload:n,ref:i}=r;let o=()=>{this.encode(r,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${e} ${s} (${i})`,n),this.isConnected()?o():this.sendBuffer.push(o)}onConnMessage(r){this.decode(r.data,e=>{let{topic:s,event:n,payload:i,ref:o}=e;(o&&o===this.pendingHeartbeatRef||n===i?.type)&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${n} ${o&&"("+o+")"||""}`,i),this.channels.filter(l=>l.isMember(s)).forEach(l=>l.trigger(n,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(e))})}endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:q0}))}makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}setAuth(r){this.accessToken=r,this.channels.forEach(e=>{r&&e.updateJoinPayload({user_token:r}),e.joinedOnce&&e.isJoined()&&e.push(Ot.access_token,{access_token:r})})}leaveOpenTopic(r){let e=this.channels.find(s=>s.topic===r&&(s.isJoined()||s.isJoining()));e&&(this.log("transport",`leaving duplicate topic "${r}"`),e.unsubscribe())}_onConnOpen(){this.log("transport",`connected to ${this.endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(r=>r())}_onConnClose(r){this.log("transport","close",r),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(r))}_onConnError(r){this.log("transport",r.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(r))}_triggerChanError(){this.channels.forEach(r=>r.trigger(Ot.error))}_appendParams(r,e){if(Object.keys(e).length===0)return r;const s=r.match(/\?/)?"&":"?",n=new URLSearchParams(e);return`${r}${s}${n}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_sendHeartbeat(){var r;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(r=this.conn)===null||r===void 0||r.close(Y0,"hearbeat timeout");return}this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class rd{constructor(r,e,s,n){const i={},o=n==="*"?`realtime:${s}`:`realtime:${s}:${n}`,l=e.Authorization.split(" ")[1];l&&(i.user_token=l),this.subscription=r.channel(o,i)}getPayloadRecords(r){const e={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(e.new=li(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(e.old=li(r.columns,r.old_record)),e}on(r,e){return this.subscription.on(r,s=>{let n={schema:s.schema,table:s.table,commit_timestamp:s.commit_timestamp,eventType:s.type,new:{},old:{},errors:s.errors};n=Object.assign(Object.assign({},n),this.getPayloadRecords(s)),e(n)}),this}subscribe(r=()=>{}){return this.subscription.onError(e=>r("SUBSCRIPTION_ERROR",e)),this.subscription.onClose(()=>r("CLOSED")),this.subscription.subscribe().receive("ok",()=>r("SUBSCRIBED")).receive("error",e=>r("SUBSCRIPTION_ERROR",e)).receive("timeout",()=>r("RETRYING_AFTER_TIMEOUT")),this.subscription}}class sd extends co{constructor(r,{headers:e={},schema:s,realtime:n,table:i,fetch:o,shouldThrowOnError:l}){super(r,{headers:e,schema:s,fetch:o,shouldThrowOnError:l}),this._subscription=null,this._realtime=n,this._headers=e,this._schema=s,this._table=i}on(r,e){return this._realtime.isConnected()||this._realtime.connect(),this._subscription||(this._subscription=new rd(this._realtime,this._headers,this._schema,this._table)),this._subscription.on(r,e)}}const nd="1.7.3",ad={"X-Client-Info":`storage-js/${nd}`};var Ss=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};const id=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),od=(t,r)=>{if(typeof t.json!="function")return r(t);t.json().then(e=>r({message:id(e),status:t?.status||500}))},ld=(t,r,e,s)=>{const n={method:t,headers:r?.headers||{}};return t==="GET"?n:(n.headers=Object.assign({"Content-Type":"application/json"},r?.headers),n.body=JSON.stringify(s),Object.assign(Object.assign({},n),e))};function bn(t,r,e,s,n,i){return Ss(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(e,ld(r,s,n,i)).then(c=>{if(!c.ok)throw c;return s?.noResolveJson?o(c):c.json()}).then(c=>o(c)).catch(c=>od(c,l))})})}function sa(t,r,e,s){return Ss(this,void 0,void 0,function*(){return bn(t,"GET",r,e,s)})}function pr(t,r,e,s,n){return Ss(this,void 0,void 0,function*(){return bn(t,"POST",r,s,n,e)})}function cd(t,r,e,s,n){return Ss(this,void 0,void 0,function*(){return bn(t,"PUT",r,s,n,e)})}function mo(t,r,e,s,n){return Ss(this,void 0,void 0,function*(){return bn(t,"DELETE",r,s,n,e)})}var dd=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};const po=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>dd(void 0,void 0,void 0,function*(){return yield(yield vn(()=>import("./browser-ponyfill-DIMAIuBD.js").then(s=>s.b),__vite__mapDeps([0,1]))).fetch(...e)}):r=fetch,(...e)=>r(...e)};var Ar=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};class fd{constructor(r,e={},s){this.url=r,this.headers=Object.assign(Object.assign({},ad),e),this.fetch=po(s)}listBuckets(){return Ar(this,void 0,void 0,function*(){try{return{data:yield sa(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}getBucket(r){return Ar(this,void 0,void 0,function*(){try{return{data:yield sa(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}createBucket(r,e={public:!1}){return Ar(this,void 0,void 0,function*(){try{return{data:(yield pr(this.fetch,`${this.url}/bucket`,{id:r,name:r,public:e.public},{headers:this.headers})).name,error:null}}catch(s){return{data:null,error:s}}})}updateBucket(r,e){return Ar(this,void 0,void 0,function*(){try{return{data:yield cd(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:e.public},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}emptyBucket(r){return Ar(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}deleteBucket(r){return Ar(this,void 0,void 0,function*(){try{return{data:yield mo(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}}var Mt=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};const hd={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ud={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class xd{constructor(r,e={},s,n){this.url=r,this.headers=e,this.bucketId=s,this.fetch=po(n)}uploadOrUpdate(r,e,s,n){return Mt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},ud),n),l=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl)):(i=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType);const c=this._removeEmptyFolders(e),f=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${f}`,{method:r,body:i,headers:l});return d.ok?{data:{Key:f},error:null}:{data:null,error:yield d.json()}}catch(i){return{data:null,error:i}}})}upload(r,e,s){return Mt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,e,s)})}update(r,e,s){return Mt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,e,s)})}move(r,e){return Mt(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}copy(r,e){return Mt(this,void 0,void 0,function*(){try{return{data:yield pr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}createSignedUrl(r,e){return Mt(this,void 0,void 0,function*(){try{const s=this._getFinalPath(r);let n=yield pr(this.fetch,`${this.url}/object/sign/${s}`,{expiresIn:e},{headers:this.headers});const i=`${this.url}${n.signedURL}`;return n={signedURL:i},{data:n,error:null,signedURL:i}}catch(s){return{data:null,error:s,signedURL:null}}})}createSignedUrls(r,e){return Mt(this,void 0,void 0,function*(){try{return{data:(yield pr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:r},{headers:this.headers})).map(n=>Object.assign(Object.assign({},n),{signedURL:n.signedURL?`${this.url}${n.signedURL}`:null})),error:null}}catch(s){return{data:null,error:s}}})}download(r){return Mt(this,void 0,void 0,function*(){try{const e=this._getFinalPath(r);return{data:yield(yield sa(this.fetch,`${this.url}/object/${e}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(e){return{data:null,error:e}}})}getPublicUrl(r){try{const e=this._getFinalPath(r),s=`${this.url}/object/public/${e}`;return{data:{publicURL:s},error:null,publicURL:s}}catch(e){return{data:null,error:e,publicURL:null}}}remove(r){return Mt(this,void 0,void 0,function*(){try{return{data:yield mo(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}list(r,e,s){return Mt(this,void 0,void 0,function*(){try{const n=Object.assign(Object.assign(Object.assign({},hd),e),{prefix:r||""});return{data:yield pr(this.fetch,`${this.url}/object/list/${this.bucketId}`,n,{headers:this.headers},s),error:null}}catch(n){return{data:null,error:n}}})}_getFinalPath(r){return`${this.bucketId}/${r}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}}class md extends fd{constructor(r,e={},s){super(r,e,s)}from(r){return new xd(this.url,this.headers,r,this.fetch)}}var pd=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};const gd=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>pd(void 0,void 0,void 0,function*(){return yield(yield vn(()=>import("./browser-ponyfill-DIMAIuBD.js").then(s=>s.b),__vite__mapDeps([0,1]))).fetch(...e)}):r=fetch,(...e)=>r(...e)};var vd=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};class yd{constructor(r,{headers:e={},customFetch:s}={}){this.url=r,this.headers=e,this.fetch=gd(s)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,e){return vd(this,void 0,void 0,function*(){try{const{headers:s,body:n}=e??{},i=yield this.fetch(`${this.url}/${r}`,{method:"POST",headers:Object.assign({},this.headers,s),body:n}),o=i.headers.get("x-relay-error");if(o&&o==="true")return{data:null,error:new Error(yield i.text())};let l;const{responseType:c}=e??{};return!c||c==="json"?l=yield i.json():c==="arrayBuffer"?l=yield i.arrayBuffer():c==="blob"?l=yield i.blob():l=yield i.text(),{data:l,error:null}}catch(s){return{data:null,error:s}}})}}var Bn=function(t,r,e,s){function n(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{f(s.next(d))}catch(h){o(h)}}function c(d){try{f(s.throw(d))}catch(h){o(h)}}function f(d){d.done?i(d.value):n(d.value).then(l,c)}f((s=s.apply(t,r||[])).next())})};const bd={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:lo};class wd{constructor(r,e,s){if(this.supabaseUrl=r,this.supabaseKey=e,!r)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const n=s0(r),i=Object.assign(Object.assign({},bd),s);if(this.restUrl=`${n}/rest/v1`,this.realtimeUrl=`${n}/realtime/v1`.replace("http","ws"),this.authUrl=`${n}/auth/v1`,this.storageUrl=`${n}/storage/v1`,n.match(/(supabase\.co)|(supabase\.in)/)){const l=n.split(".");this.functionsUrl=`${l[0]}.functions.${l[1]}.${l[2]}`}else this.functionsUrl=`${n}/functions/v1`;this.schema=i.schema,this.multiTab=i.multiTab,this.fetch=i.fetch,this.headers=Object.assign(Object.assign({},lo),s?.headers),this.shouldThrowOnError=i.shouldThrowOnError||!1,this.auth=this._initSupabaseAuthClient(i),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},i.realtime)),this._listenForAuthEvents(),this._listenForMultiTabEvents()}get functions(){return new yd(this.functionsUrl,{headers:this._getAuthHeaders(),customFetch:this.fetch})}get storage(){return new md(this.storageUrl,this._getAuthHeaders(),this.fetch)}from(r){const e=`${this.restUrl}/${r}`;return new sd(e,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:r,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(r,e,{head:s=!1,count:n=null}={}){return this._initPostgRESTClient().rpc(r,e,{head:s,count:n})}removeAllSubscriptions(){return Bn(this,void 0,void 0,function*(){const r=this.getSubscriptions().slice(),e=r.map(n=>this.removeSubscription(n));return(yield Promise.all(e)).map(({error:n},i)=>({data:{subscription:r[i]},error:n}))})}removeSubscription(r){return Bn(this,void 0,void 0,function*(){const{error:e}=yield this._closeSubscription(r),s=this.getSubscriptions(),n=s.filter(i=>i.isJoined()).length;return s.length===0&&(yield this.realtime.disconnect()),{data:{openSubscriptions:n},error:e}})}_closeSubscription(r){return Bn(this,void 0,void 0,function*(){let e=null;if(!r.isClosed()){const{error:s}=yield this._unsubscribeSubscription(r);e=s}return this.realtime.remove(r),{error:e}})}_unsubscribeSubscription(r){return new Promise(e=>{r.unsubscribe().receive("ok",()=>e({error:null})).receive("error",s=>e({error:s})).receive("timeout",()=>e({error:new Error("timed out")}))})}getSubscriptions(){return this.realtime.channels}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:e,detectSessionInUrl:s,localStorage:n,headers:i,fetch:o,cookieOptions:l,multiTab:c}){const f={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new A0({url:this.authUrl,headers:Object.assign(Object.assign({},i),f),autoRefreshToken:r,persistSession:e,detectSessionInUrl:s,localStorage:n,fetch:o,cookieOptions:l,multiTab:c})}_initRealtimeClient(r){return new td(this.realtimeUrl,Object.assign(Object.assign({},r),{params:Object.assign(Object.assign({},r?.params),{apikey:this.supabaseKey})}))}_initPostgRESTClient(){return new O0(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch,throwOnError:this.shouldThrowOnError})}_getAuthHeaders(){var r,e;const s=Object.assign({},this.headers),n=(e=(r=this.auth.session())===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:this.supabaseKey;return s.apikey=this.supabaseKey,s.Authorization=s.Authorization||`Bearer ${n}`,s}_listenForMultiTabEvents(){if(!this.multiTab||!n0()||!window?.addEventListener)return null;try{return window?.addEventListener("storage",r=>{var e,s,n;if(r.key===r0){const i=JSON.parse(String(r.newValue)),o=(s=(e=i?.currentSession)===null||e===void 0?void 0:e.access_token)!==null&&s!==void 0?s:void 0,l=(n=this.auth.session())===null||n===void 0?void 0:n.access_token;o?!l&&o?this._handleTokenChanged("SIGNED_IN",o,"STORAGE"):l!==o&&this._handleTokenChanged("TOKEN_REFRESHED",o,"STORAGE"):this._handleTokenChanged("SIGNED_OUT",o,"STORAGE")}})}catch(r){return console.error("_listenForMultiTabEvents",r),null}}_listenForAuthEvents(){let{data:r}=this.auth.onAuthStateChange((e,s)=>{this._handleTokenChanged(e,s?.access_token,"CLIENT")});return r}_handleTokenChanged(r,e,s){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==e?(this.realtime.setAuth(e),s=="STORAGE"&&this.auth.setAuth(e),this.changedAccessToken=e):(r==="SIGNED_OUT"||r==="USER_DELETED")&&(this.realtime.setAuth(this.supabaseKey),s=="STORAGE"&&this.auth.signOut())}}const _d=(t,r,e)=>new wd(t,r,e),Sd="https://sgxnxbhbyvrmgrzhosyh.supabase.co",Nd="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNneG54YmhieXZybWdyemhvc3loIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5MDAzMzMsImV4cCI6MjA3MzQ3NjMzM30.1qS_3Qr-zv7woSyPbkdiLkhuXp2pVHJHGiF3iKWEBkc",he=_d(Sd,Nd),na={getUsers:()=>JSON.parse(localStorage.getItem("las_users")||"[]"),setUsers:t=>localStorage.setItem("las_users",JSON.stringify(t)),getWorkDiaries:()=>JSON.parse(localStorage.getItem("las_work_diaries")||"[]"),setWorkDiaries:t=>localStorage.setItem("las_work_diaries",JSON.stringify(t)),getSales:()=>JSON.parse(localStorage.getItem("las_sales")||"[]"),setSales:t=>localStorage.setItem("las_sales",JSON.stringify(t)),getCurrentUser:()=>JSON.parse(localStorage.getItem("las_current_user")||"null"),setCurrentUser:t=>localStorage.setItem("las_current_user",JSON.stringify(t)),clearCurrentUser:()=>localStorage.removeItem("las_current_user"),initAdmin:()=>{if(na.getUsers().length===0){const r={id:"1",email:"admin@las.com",password:"admin123",name:"시스템관리자",branch:"본사",phone:"010-0000-0000",userType:"관리자",status:"approved",createdAt:new Date().toISOString(),approvedAt:new Date().toISOString()};na.setUsers([r]),console.log("✅ 초기 관리자 계정 생성됨: admin@las.com / admin123")}}};na.initAdmin();const Ys={EMPLOYEE:"employee",MANAGER:"manager"},Xt={MONITORING_AGENT:"모니터링요원",CONTRACT_WORKER:"계약근무",STORE_MANAGER:"점장",BRANCH_MANAGER:"지점관리자",SYSTEM_ADMIN:"시스템관리자"},jd=t=>t?t.user_type===Xt.MONITORING_AGENT:!1,Ed=t=>t?t.user_type===Xt.CONTRACT_WORKER:!1,rs=t=>t?t.user_type===Xt.STORE_MANAGER||t.user_type===Xt.BRANCH_MANAGER||t.user_type===Xt.SYSTEM_ADMIN:!1,$r=t=>t?t.user_type===Xt.SYSTEM_ADMIN:!1,Td=t=>t?t.user_type===Xt.STORE_MANAGER||t.user_type===Xt.BRANCH_MANAGER||t.user_type===Xt.SYSTEM_ADMIN:!1,Cd=t=>{if(!t||typeof t!="string")return{isValid:!1,error:"고유번호를 입력해주세요"};const r=t.trim().toUpperCase();if(!/^LAS\d{4}$/.test(r))return{isValid:!1,error:"올바른 고유번호 형식이 아닙니다 (예: LAS1000)"};const s=parseInt(r.replace("LAS",""));return s>=1e3&&s<=2999||s>=3e3&&s<=4999||s>=5e3&&s<=6999?{isValid:!0,error:""}:{isValid:!1,error:"허용되지 않은 고유번호 범위입니다"}};function Ad({onNavigate:t,onAutoLogin:r}){const[e,s]=B.useState(!0);B.useEffect(()=>{n()},[]);const n=async()=>{try{const{data:{session:i},error:o}=await he.auth.getSession();if(o){console.error("세션 확인 오류:",o),s(!1);return}if(i&&i.user){const{data:l,error:c}=await he.from("users").select("*").eq("id",i.user.id).single();if(c){console.error("사용자 정보 조회 오류:",c),s(!1);return}l&&l.status==="approved"?(console.log("자동 로그인:",l.name,"/",l.user_type),r&&r(l)):(console.log("승인 대기 중인 사용자:",l?.name),s(!1))}else s(!1)}catch(i){console.error("자동 로그인 체크 오류:",i),s(!1)}};return e?a.jsx("div",{className:"min-h-screen bg-gray-100 flex justify-center items-center",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:"#249689"}}),a.jsx("p",{className:"text-gray-600",children:"로그인 확인 중..."})]})}):a.jsx("div",{className:"min-h-screen bg-gray-100 flex justify-center items-start pt-8 pb-8",children:a.jsxs("div",{className:"bg-white flex flex-col w-full max-w-md rounded-lg shadow-lg overflow-hidden",children:[a.jsx("div",{className:"flex items-center justify-between p-2 border-b",children:a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:i=>i.target.style.display="none"}),a.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:"LAS 근무관리시스템"})]})}),a.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6",children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("img",{src:"/images/hero-cell.jpg",alt:"The Rise of Life Forms with a Nucleus",className:"w-full max-w-xs rounded-lg shadow-lg",onError:i=>{i.target.style.display="none",i.target.nextElementSibling.style.display="block"}}),a.jsx("div",{className:"hidden w-full max-w-xs h-64 bg-gradient-to-br from-teal-400 to-blue-500 rounded-lg shadow-lg flex items-center justify-center",children:a.jsx("p",{className:"text-white text-xl font-bold",children:"The Rise of Life Forms with a Nucleus"})})]}),a.jsxs("div",{className:"flex flex-col gap-2 w-full px-10",children:[a.jsx("button",{onClick:()=>t("login"),className:"px-8 py-3.5 text-white font-bold rounded-lg shadow-md hover:opacity-90 transition-opacity w-full",style:{backgroundColor:"#249689",fontSize:"15px"},children:"로그인"}),a.jsx("button",{onClick:()=>t("signup"),className:"px-8 py-3.5 font-bold rounded-lg shadow-md hover:bg-gray-50 transition-colors w-full",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",fontSize:"15px"},children:"직원등록"})]})]})]})})}function kd({onNavigate:t,onLogin:r}){const[e,s]=B.useState(""),[n,i]=B.useState(""),[o,l]=B.useState(!1),c=async f=>{f.preventDefault(),l(!0);try{const{data:d,error:h}=await he.from("users").select("*").eq("email",e).eq("password",n).single();if(h||!d){alert("이메일 또는 비밀번호가 올바르지 않습니다.");return}if(d.status!=="approved"){alert("관리자 승인 대기 중입니다. 승인 후 로그인이 가능합니다.");return}r(d)}catch(d){console.error("로그인 오류:",d),alert("로그인에 실패했습니다: "+d.message)}finally{l(!1)}};return a.jsx("div",{className:"min-h-screen flex items-start justify-center p-4 pt-4",style:{backgroundColor:"#f5f5f5"},children:a.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8",children:[a.jsxs("div",{className:"text-center mb-6",children:[a.jsx("p",{className:"text-sm mb-4",style:{color:"#249689"},children:"LAS 매장관리 시스템에 오신것을 환영합니다."}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Book Logo",className:"h-16"}),a.jsx("h1",{className:"text-3xl font-bold",style:{color:"#249689"},children:"로그인"})]})]}),a.jsxs("form",{onSubmit:c,className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[a.jsx("span",{children:"📧"}),a.jsx("span",{children:"이메일"})]}),a.jsx("input",{type:"email",value:e,onChange:f=>s(f.target.value),placeholder:"이메일을 입력하세요",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[a.jsx("span",{children:"🔒"}),a.jsx("span",{children:"비밀번호"})]}),a.jsx("input",{type:"password",value:n,onChange:f=>i(f.target.value),placeholder:"비밀번호를 입력하세요",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsx("button",{type:"submit",disabled:o,className:"w-full py-3 rounded-lg font-bold text-white hover:opacity-90 mt-6",style:{backgroundColor:"#249689",fontSize:"16px"},children:o?"로그인 중...":"로그인"}),a.jsx("button",{type:"button",onClick:()=>t("hero"),className:"w-full py-3 rounded-lg font-bold border-2 hover:bg-gray-50",style:{borderColor:"#cccccc",fontSize:"16px"},children:"취소"})]}),a.jsx("div",{className:"mt-4 text-center",children:a.jsxs("p",{style:{color:"#666666",fontSize:"13px"},children:["아직 직원등록 전 이신가요?"," ",a.jsx("button",{onClick:()=>t("signup"),className:"font-bold hover:underline",style:{color:"#249689"},children:"직원등록 가기"})]})})]})})}function Rd({onNavigate:t}){const[r,e]=B.useState(""),[s,n]=B.useState(""),[i,o]=B.useState(""),[l,c]=B.useState(""),[f,d]=B.useState(""),[h,u]=B.useState(""),[m,p]=B.useState("점주"),[x,g]=B.useState(!1),[T,_]=B.useState([]),[S,A]=B.useState(!1),[D,z]=B.useState(""),[C,I]=B.useState(""),[O,P]=B.useState(""),[H,W]=B.useState("");B.useEffect(()=>{te()},[]);const te=async()=>{try{const{data:ce,error:xe}=await he.from("branches").select("name").order("name",{ascending:!0});if(xe)throw xe;_(ce||[])}catch(ce){console.error("지점 목록 로드 오류:",ce)}},pe=ce=>{const xe=ce.replace(/[^\d]/g,"");return xe.length<=3?xe:xe.length<=7?`${xe.slice(0,3)}-${xe.slice(3)}`:`${xe.slice(0,3)}-${xe.slice(3,7)}-${xe.slice(7,11)}`},me=ce=>{const xe=pe(ce.target.value);u(xe)},Ne=ce=>{const xe=ce.replace(/[^\d]/g,"");return xe.length<=6?xe:`${xe.slice(0,6)}-${xe.slice(6,13)}`},ve=ce=>{const xe=Ne(ce.target.value);z(xe),xe.replace(/-/g,"").length===13||xe.replace(/-/g,"").length>0},je=async ce=>{if(ce.preventDefault(),s!==i){alert("비밀번호가 일치하지 않습니다.");return}if(s.length<6){alert("비밀번호는 최소 6자 이상이어야 합니다.");return}if(D&&D.replace(/-/g,"").length!==13){alert("주민등록번호는 13자리여야 합니다.");return}g(!0);try{const{data:xe}=await he.from("users").select("referral_code").not("referral_code","is",null).order("referral_code",{ascending:!1});let _e="LAS001";if(xe&&xe.length>0){const U=xe[0].referral_code,Y=parseInt(U.replace("LAS",""))+1;_e=`LAS${String(Y).padStart(3,"0")}`}const b=crypto.randomUUID(),w=h.replace(/-/g,""),j=D?D.replace(/-/g,""):null,{error:y}=await he.from("users").insert([{id:b,email:r,password:s,name:l,branch:f,phone:w,user_type:m,status:"pending",referral_code:_e,ssn:j,bank_name:C||null,account_holder:O||null,account_number:H||null}]);if(y)throw y;alert("직원등록이 완료되었습니다. 관리자 승인 후 로그인할 수 있습니다."),t("login")}catch(xe){console.error("직원등록 오류:",xe),alert("직원등록 중 오류가 발생했습니다: "+xe.message)}finally{g(!1)}};return a.jsx("div",{className:"min-h-screen flex items-start justify-center p-4 pt-4",style:{backgroundColor:"#f5f5f5"},children:a.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-6",children:[a.jsxs("div",{className:"text-center mb-4",children:[a.jsx("p",{className:"text-sm mb-3",style:{color:"#249689"},children:"LAS 매장관리 시스템에 오신것을 환영합니다."}),a.jsxs("div",{className:"flex items-center justify-center gap-3",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Book Logo",className:"h-12"}),a.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:"직원등록"})]})]}),a.jsxs("form",{onSubmit:je,className:"space-y-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[a.jsx("span",{children:"📧"}),a.jsx("span",{children:"이메일"})]}),a.jsx("input",{type:"email",value:r,onChange:ce=>e(ce.target.value),placeholder:"이메일을 입력하세요",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[a.jsx("span",{children:"🔒"}),a.jsx("span",{children:"비밀번호"})]}),a.jsx("input",{type:"password",value:s,onChange:ce=>n(ce.target.value),placeholder:"비밀번호",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[a.jsx("span",{children:"🔒"}),a.jsx("span",{children:"비밀번호 확인"})]}),a.jsx("input",{type:"password",value:i,onChange:ce=>o(ce.target.value),placeholder:"비밀번호 확인",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[a.jsx("span",{children:"👤"}),a.jsx("span",{children:"이름"})]}),a.jsx("input",{type:"text",value:l,onChange:ce=>c(ce.target.value),placeholder:"이름",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[a.jsx("span",{children:"📱"}),a.jsx("span",{children:"핸드폰 번호"})]}),a.jsx("input",{type:"tel",value:h,onChange:me,placeholder:"000-0000-0000",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[a.jsx("span",{children:"🏢"}),a.jsx("span",{children:"지정명"})]}),a.jsxs("select",{value:f,onChange:ce=>d(ce.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[a.jsx("option",{value:"",children:"지정명을 선택하세요"}),T.map(ce=>a.jsx("option",{value:ce.name,children:ce.name},ce.name))]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[a.jsx("span",{children:"🏷️"}),a.jsx("span",{children:"구분"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"radio",value:"모니터링요원",checked:m==="모니터링요원",onChange:ce=>p(ce.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),a.jsx("span",{style:{fontSize:"15px"},children:"모니터링요원"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"radio",value:"계약근무",checked:m==="계약근무",onChange:ce=>p(ce.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),a.jsx("span",{style:{fontSize:"15px"},children:"계약근무"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"radio",value:"점주",checked:m==="점주",onChange:ce=>p(ce.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),a.jsx("span",{style:{fontSize:"15px"},children:"점주"})]}),a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"radio",value:"점장",checked:m==="점장",onChange:ce=>p(ce.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),a.jsx("span",{style:{fontSize:"15px"},children:"점장"})]})]})]}),a.jsxs("div",{className:"border-t pt-3 mt-4",children:[a.jsxs("button",{type:"button",onClick:()=>A(!S),className:"w-full flex items-center justify-between p-3 rounded-lg border-2 hover:bg-gray-50",style:{borderColor:"#249689",fontSize:"15px"},children:[a.jsx("span",{className:"font-bold",style:{color:"#249689"},children:"💰 급여 정보 (선택)"}),a.jsx("span",{style:{color:"#249689"},children:S?"▲":"▼"})]}),S&&a.jsxs("div",{className:"mt-3 space-y-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[a.jsx("span",{children:"🆔"}),a.jsx("span",{children:"주민등록번호 (선택)"})]}),a.jsx("input",{type:"text",value:D,onChange:ve,placeholder:"000000-0000000",maxLength:"14",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}}),D&&D.replace(/-/g,"").length>0&&D.replace(/-/g,"").length!==13&&a.jsx("p",{className:"text-sm mt-1",style:{color:"#e74c3c"},children:"⚠️ 주민등록번호는 13자리여야 합니다."})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[a.jsx("span",{children:"👤"}),a.jsx("span",{children:"예금주 (선택)"})]}),a.jsx("input",{type:"text",value:O,onChange:ce=>P(ce.target.value),placeholder:"예금주",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[a.jsx("span",{children:"🏦"}),a.jsx("span",{children:"기관명 (선택)"})]}),a.jsx("input",{type:"text",value:C,onChange:ce=>I(ce.target.value),placeholder:"기관명",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[a.jsx("span",{children:"💳"}),a.jsx("span",{children:"계좌번호 (선택)"})]}),a.jsx("input",{type:"text",value:H,onChange:ce=>W(ce.target.value),placeholder:"계좌번호",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[a.jsxs("button",{type:"button",onClick:()=>t("login"),className:"py-3 rounded-lg font-bold border-2 hover:bg-gray-50 flex items-center justify-center gap-2",style:{borderColor:"#cccccc",fontSize:"16px"},children:[a.jsx(At,{size:18}),"나가기"]}),a.jsx("button",{type:"submit",disabled:x,className:"py-3 rounded-lg font-bold text-white hover:opacity-90",style:{backgroundColor:"#249689",fontSize:"16px"},children:x?"등록 중...":"직원등록"})]})]}),a.jsx("div",{className:"mt-4 text-center",children:a.jsxs("p",{style:{color:"#666666",fontSize:"13px"},children:["직원등록을 하셨나요?"," ",a.jsx("button",{onClick:()=>t("login"),className:"font-bold hover:underline",style:{color:"#249689"},children:"로그인하기"})]})})]})})}function Fd({user:t,onNavigate:r,onLogout:e}){const s=jd(t),n=Ed(t),i=s,o=n;return a.jsx("div",{className:"min-h-screen bg-white",children:a.jsx("div",{className:"max-w-md mx-auto p-6",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:l=>l.target.style.display="none"}),a.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"일반업무"})]}),!i&&!o&&a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"#f0f9ff",borderColor:"#0284c7"},children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-left gap-2 flex-1",children:[a.jsx(Mc,{size:20,style:{color:"#0284c7"}}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",style:{color:"#075985",fontSize:"14px"},children:"🛡️ 매장관리로 이동"}),a.jsx("p",{className:"text-xs",style:{color:"#075985"},children:"직원 관리, 근무일지 관리, 고객 관리 등을 수행하세요"})]})]}),a.jsx("button",{onClick:()=>r("AdminDashboard"),className:"px-4 py-2 bg-white border-2 rounded-lg hover:bg-gray-50 font-bold transition-colors text-sm whitespace-nowrap",style:{borderColor:"#0284c7",color:"#075985",borderRadius:"10px"},children:"🛡️ 매장관리"})]})})}),a.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"🏢 지점명"}),a.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"👤 이름"}),a.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),a.jsxs("div",{className:"space-y-4",children:[o&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>r("WorkDiary"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(Vs,{size:20}),"근무일지"]}),a.jsxs("button",{onClick:()=>r("CustomerManagement"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(Xs,{size:20}),"판매관리"]})]}),!i&&!o&&a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>r("WorkDiary"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(Vs,{size:20}),"근무일지"]}),a.jsxs("button",{onClick:()=>r("CustomerManagement"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(Xs,{size:20}),"판매관리"]}),a.jsxs("button",{onClick:()=>r("ShippingList"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(eo,{size:20}),"주문목록관리"]}),a.jsxs("button",{onClick:()=>r("PurchaseHistory"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(to,{size:20}),"구매이력조회"]})]}),a.jsxs("button",{onClick:()=>r("AdminEventDashboard"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#dc2626",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(ua,{size:20}),"내 이벤트관리"]}),a.jsxs("button",{onClick:()=>r("MyInfo"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#7f95eb",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(Ks,{size:20}),"내정보관리"]}),a.jsxs("button",{onClick:e,className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(xa,{size:20}),"LogOut"]})]})]})})})}function Dd({user:t,onNavigate:r,onLogout:e,onSwitchMode:s}){console.log("🎨 AdminDashboard 렌더링"),console.log("👤 user:",t),console.log("📦 onSwitchMode:",s);const n=()=>{if(console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),console.log("👤 일반업무 버튼 클릭됨"),console.log("📦 onSwitchMode 존재:",!!s),console.log("📦 LOGIN_MODES.EMPLOYEE:",Ys.EMPLOYEE),!s){console.error("❌ onSwitchMode가 undefined입니다!"),alert("모드 전환 기능이 연결되지 않았습니다.");return}if(typeof s!="function"){console.error("❌ onSwitchMode가 함수가 아닙니다!"),alert("모드 전환 기능에 문제가 있습니다.");return}try{console.log("✅ onSwitchMode 호출 시작 (EMPLOYEE 모드)"),s(Ys.EMPLOYEE),console.log("✅ onSwitchMode 호출 완료"),console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")}catch(o){console.error("❌ onSwitchMode 호출 중 에러:",o),alert("모드 전환 중 오류가 발생했습니다: "+o.message)}},i=Td(t);return a.jsx("div",{className:"min-h-screen bg-white",children:a.jsx("div",{className:"max-w-md mx-auto p-6",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:o=>o.target.style.display="none"}),a.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"매장관리"})]}),a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"#f0f9ff",borderColor:"#0284c7"},children:a.jsxs("div",{className:"flex items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex items-left gap-2 flex-1",children:[a.jsx(zc,{size:20,style:{color:"#0284c7"}}),a.jsxs("div",{children:[a.jsx("p",{className:"font-bold",style:{color:"#075985",fontSize:"14px"},children:"💼 일반업무로 돌아가기"}),a.jsx("p",{className:"text-xs",style:{color:"#075985"},children:"근무일지, 판매관리 등 일상 업무를 수행하세요"})]})]}),a.jsx("button",{onClick:n,className:"px-4 py-2 bg-white border-2 rounded-lg hover:bg-gray-50 font-bold transition-colors text-sm whitespace-nowrap",style:{borderColor:"#0284c7",color:"#075985",borderRadius:"10px"},children:"👤 일반업무"})]})})}),a.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"🏢 지점명"}),a.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"👤 이름"}),a.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminWorkDiary"),r("AdminWorkDiary")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(Vs,{size:20}),"근무일지관리"]}),a.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminUsers"),r("AdminUsers")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(ma,{size:20}),"직원정보관리"]}),a.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminCustomers"),r("AdminCustomers")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(Xs,{size:20}),"구매고객조회"]}),i&&a.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminEventDashboard"),r("AdminEventDashboard")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#dc2626",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(qs,{size:20}),"매장 이벤트관리"]}),a.jsxs("button",{onClick:e,className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(xa,{size:20}),"LogOut"]})]})]})})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Js={};Js.version="0.18.5";var go=1252,Od=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],vo=function(t){Od.indexOf(t)!=-1&&(go=t)};function Id(){vo(1252)}var xs=function(t){vo(t)};function Pd(){xs(1200),Id()}var Is=function(r){return String.fromCharCode(r)},di=function(r){return String.fromCharCode(r)},Qs,sr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ms(t){for(var r="",e=0,s=0,n=0,i=0,o=0,l=0,c=0,f=0;f<t.length;)e=t.charCodeAt(f++),i=e>>2,s=t.charCodeAt(f++),o=(e&3)<<4|s>>4,n=t.charCodeAt(f++),l=(s&15)<<2|n>>6,c=n&63,isNaN(s)?l=c=64:isNaN(n)&&(c=64),r+=sr.charAt(i)+sr.charAt(o)+sr.charAt(l)+sr.charAt(c);return r}function Jt(t){var r="",e=0,s=0,n=0,i=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var f=0;f<t.length;)i=sr.indexOf(t.charAt(f++)),o=sr.indexOf(t.charAt(f++)),e=i<<2|o>>4,r+=String.fromCharCode(e),l=sr.indexOf(t.charAt(f++)),s=(o&15)<<4|l>>2,l!==64&&(r+=String.fromCharCode(s)),c=sr.indexOf(t.charAt(f++)),n=(l&3)<<6|c,c!==64&&(r+=String.fromCharCode(n));return r}var Ae=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),Zt=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function br(t){return Ae?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function fi(t){return Ae?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var It=function(r){return Ae?Zt(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function wn(t){if(typeof ArrayBuffer>"u")return It(t);for(var r=new ArrayBuffer(t.length),e=new Uint8Array(r),s=0;s!=t.length;++s)e[s]=t.charCodeAt(s)&255;return r}function Ns(t){if(Array.isArray(t))return t.map(function(s){return String.fromCharCode(s)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function Ld(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var rt=Ae?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:Zt(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var s=new Uint8Array(e),n=0;for(r=0,e=0;r<t.length;e+=n,++r)if(n=t[r].length,t[r]instanceof Uint8Array)s.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";s.set(new Uint8Array(t[r]),e)}return s}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Bd(t){for(var r=[],e=0,s=t.length+250,n=br(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)n[e++]=o;else if(o<2048)n[e++]=192|o>>6&31,n[e++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++i)&1023;n[e++]=240|o>>8&7,n[e++]=128|o>>2&63,n[e++]=128|l>>6&15|(o&3)<<4,n[e++]=128|l&63}else n[e++]=224|o>>12&15,n[e++]=128|o>>6&63,n[e++]=128|o&63;e>s&&(r.push(n.slice(0,e)),e=0,n=br(65535),s=65530)}return r.push(n.slice(0,e)),rt(r)}var is=/\u0000/g,Ps=/[\u0001-\u0006]/g;function Pr(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function Pt(t,r){var e=""+t;return e.length>=r?e:We("0",r-e.length)+e}function ba(t,r){var e=""+t;return e.length>=r?e:We(" ",r-e.length)+e}function Zs(t,r){var e=""+t;return e.length>=r?e:e+We(" ",r-e.length)}function Md(t,r){var e=""+Math.round(t);return e.length>=r?e:We("0",r-e.length)+e}function zd(t,r){var e=""+t;return e.length>=r?e:We("0",r-e.length)+e}var hi=Math.pow(2,32);function kr(t,r){if(t>hi||t<-hi)return Md(t,r);var e=Math.round(t);return zd(e,r)}function en(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var ui=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Mn=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Ud(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var Ge={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},xi={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},$d={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function tn(t,r,e){for(var s=t<0?-1:1,n=t*s,i=0,o=1,l=0,c=1,f=0,d=0,h=Math.floor(n);f<r&&(h=Math.floor(n),l=h*o+i,d=h*f+c,!(n-h<5e-8));)n=1/(n-h),i=o,o=l,c=f,f=d;if(d>r&&(f>r?(d=c,l=i):(d=f,l=o)),!e)return[0,s*l,d];var u=Math.floor(s*l/d);return[u,s*l-u*d,d]}function Ls(t,r,e){if(t>2958465||t<0)return null;var s=t|0,n=Math.floor(86400*(t-s)),i=0,o=[],l={D:s,T:n,u:86400*(t-s)-n,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++n==86400&&(l.T=n=0,++s,++l.D)),s===60)o=e?[1317,10,29]:[1900,2,29],i=3;else if(s===0)o=e?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),s<60&&(i=(i+6)%7),e&&(i=qd(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=n%60,n=Math.floor(n/60),l.M=n%60,n=Math.floor(n/60),l.H=n,l.q=i,l}var yo=new Date(1899,11,31,0,0,0),Hd=yo.getTime(),Wd=new Date(1900,2,1,0,0,0);function bo(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=Wd&&(e+=24*60*60*1e3),(e-(Hd+(t.getTimezoneOffset()-yo.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function wa(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Gd(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Vd(t){var r=t<0?12:11,e=wa(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function Xd(t){var r=wa(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function Kd(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=Vd(t):r===10?e=t.toFixed(10).substr(0,12):e=Xd(t),wa(Gd(e.toUpperCase()))}function aa(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Kd(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return or(14,bo(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function qd(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function Yd(t,r,e,s){var n="",i=0,o=0,l=e.y,c,f=0;switch(t){case 98:l=e.y+543;case 121:switch(r.length){case 1:case 2:c=l%100,f=2;break;default:c=l%1e4,f=4;break}break;case 109:switch(r.length){case 1:case 2:c=e.m,f=r.length;break;case 3:return Mn[e.m-1][1];case 5:return Mn[e.m-1][0];default:return Mn[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=e.d,f=r.length;break;case 3:return ui[e.q][0];default:return ui[e.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(e.H+11)%12,f=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=e.H,f=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=e.M,f=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?Pt(e.S,r.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,i=Math.round(o*(e.S+e.u)),i>=60*o&&(i=0),r==="s"?i===0?"0":""+i/o:(n=Pt(i,2+s),r==="ss"?n.substr(0,2):"."+n.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}f=r.length===3?1:2;break;case 101:c=l,f=1;break}var d=f>0?Pt(c,f):"";return d}function nr(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,s=t.substr(0,e);e!=t.length;e+=r)s+=(s.length>0?",":"")+t.substr(e,r);return s}var wo=/%/g;function Jd(t,r,e){var s=r.replace(wo,""),n=r.length-s.length;return Kt(t,s,e*Math.pow(10,2*n))+We("%",n)}function Qd(t,r,e){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return Kt(t,r.substr(0,s),e/Math.pow(10,3*(r.length-s)))}function _o(t,r){var e,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+_o(t,-r);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),e=(r/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),e.indexOf("e")===-1){var o=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+i):e+="E+"+(o-i);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,n)+"."+e.substr(2+n),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,f,d){return c+f+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else e=r.toExponential(s);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var So=/# (\?+)( ?)\/( ?)(\d+)/;function Zd(t,r,e){var s=parseInt(t[4],10),n=Math.round(r*s),i=Math.floor(n/s),o=n-i*s,l=s;return e+(i===0?"":""+i)+" "+(o===0?We(" ",t[1].length+1+t[4].length):ba(o,t[1].length)+t[2]+"/"+t[3]+Pt(l,t[4].length))}function ef(t,r,e){return e+(r===0?"":""+r)+We(" ",t[1].length+2+t[4].length)}var No=/^#*0*\.([0#]+)/,jo=/\).*[0#]/,Eo=/\(###\) ###\\?-####/;function ht(t){for(var r="",e,s=0;s!=t.length;++s)switch(e=t.charCodeAt(s)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function mi(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function pi(t,r){var e=t-Math.floor(t),s=Math.pow(10,r);return r<(""+Math.round(e*s)).length?0:Math.round(e*s)}function tf(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function rf(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Tt(t,r,e){if(t.charCodeAt(0)===40&&!r.match(jo)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Tt("n",s,e):"("+Tt("n",s,-e)+")"}if(r.charCodeAt(r.length-1)===44)return Qd(t,r,e);if(r.indexOf("%")!==-1)return Jd(t,r,e);if(r.indexOf("E")!==-1)return _o(r,e);if(r.charCodeAt(0)===36)return"$"+Tt(t,r.substr(r.charAt(1)==" "?2:1),e);var n,i,o,l,c=Math.abs(e),f=e<0?"-":"";if(r.match(/^00+$/))return f+kr(c,r.length);if(r.match(/^[#?]+$/))return n=kr(e,0),n==="0"&&(n=""),n.length>r.length?n:ht(r.substr(0,r.length-n.length))+n;if(i=r.match(So))return Zd(i,c,f);if(r.match(/^#+0+$/))return f+kr(c,r.length-r.indexOf("0"));if(i=r.match(No))return n=mi(e,i[1].length).replace(/^([^\.]+)$/,"$1."+ht(i[1])).replace(/\.$/,"."+ht(i[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+We("0",ht(i[1]).length-x.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return f+mi(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return f+nr(kr(c,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Tt(t,r,-e):nr(""+(Math.floor(e)+tf(e,i[1].length)))+"."+Pt(pi(e,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return Tt(t,r.replace(/^#,#*,/,""),e);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Pr(Tt(t,r.replace(/[\\-]/g,""),e)),o=0,Pr(Pr(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<n.length?n.charAt(o++):p==="0"?"0":""}));if(r.match(Eo))return n=Tt(t,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=tn(c,Math.pow(10,o)-1,!1),n=""+f,d=Kt("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Zs(l[2],o),d.length<i[4].length&&(d=ht(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=tn(c,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?ba(l[1],o)+i[2]+"/"+i[3]+Zs(l[2],o):We(" ",2*o+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=kr(e,0),r.length<=n.length?n:ht(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var h=r.indexOf(".")-o,u=r.length-n.length-h;return ht(r.substr(0,h)+n+r.substr(r.length-u))}if(i=r.match(/^00,000\.([#0]*0)$/))return o=pi(e,i[1].length),e<0?"-"+Tt(t,r,-e):nr(rf(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Pt(0,3-p.length):"")+p})+"."+Pt(o,i[1].length);switch(r){case"###,##0.00":return Tt(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var m=nr(kr(c,0));return m!=="0"?f+m:"";case"###,###.00":return Tt(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Tt(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function sf(t,r,e){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return Kt(t,r.substr(0,s),e/Math.pow(10,3*(r.length-s)))}function nf(t,r,e){var s=r.replace(wo,""),n=r.length-s.length;return Kt(t,s,e*Math.pow(10,2*n))+We("%",n)}function To(t,r){var e,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+To(t,-r);var n=t.indexOf(".");n===-1&&(n=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%n;if(i<0&&(i+=n),e=(r/Math.pow(10,i)).toPrecision(s+1+(n+i)%n),!e.match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+i):e+="E+"+(o-i),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,f,d){return c+f+d.substr(0,(n+i)%n)+"."+d.substr(i)+"E"})}else e=r.toExponential(s);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function zt(t,r,e){if(t.charCodeAt(0)===40&&!r.match(jo)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?zt("n",s,e):"("+zt("n",s,-e)+")"}if(r.charCodeAt(r.length-1)===44)return sf(t,r,e);if(r.indexOf("%")!==-1)return nf(t,r,e);if(r.indexOf("E")!==-1)return To(r,e);if(r.charCodeAt(0)===36)return"$"+zt(t,r.substr(r.charAt(1)==" "?2:1),e);var n,i,o,l,c=Math.abs(e),f=e<0?"-":"";if(r.match(/^00+$/))return f+Pt(c,r.length);if(r.match(/^[#?]+$/))return n=""+e,e===0&&(n=""),n.length>r.length?n:ht(r.substr(0,r.length-n.length))+n;if(i=r.match(So))return ef(i,c,f);if(r.match(/^#+0+$/))return f+Pt(c,r.length-r.indexOf("0"));if(i=r.match(No))return n=(""+e).replace(/^([^\.]+)$/,"$1."+ht(i[1])).replace(/\.$/,"."+ht(i[1])),n=n.replace(/\.(\d*)$/,function(p,x){return"."+x+We("0",ht(i[1]).length-x.length)}),r.indexOf("0.")!==-1?n:n.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return f+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return f+nr(""+c);if(i=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+zt(t,r,-e):nr(""+e)+"."+We("0",i[1].length);if(i=r.match(/^#,#*,#0/))return zt(t,r.replace(/^#,#*,/,""),e);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return n=Pr(zt(t,r.replace(/[\\-]/g,""),e)),o=0,Pr(Pr(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<n.length?n.charAt(o++):p==="0"?"0":""}));if(r.match(Eo))return n=zt(t,"##########",e),"("+n.substr(0,3)+") "+n.substr(3,3)+"-"+n.substr(6);var d="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=tn(c,Math.pow(10,o)-1,!1),n=""+f,d=Kt("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),n+=d+i[2]+"/"+i[3],d=Zs(l[2],o),d.length<i[4].length&&(d=ht(i[4].substr(i[4].length-d.length))+d),n+=d,n;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=tn(c,Math.pow(10,o)-1,!0),f+(l[0]||(l[1]?"":"0"))+" "+(l[1]?ba(l[1],o)+i[2]+"/"+i[3]+Zs(l[2],o):We(" ",2*o+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return n=""+e,r.length<=n.length?n:ht(r.substr(0,r.length-n.length))+n;if(i=r.match(/^([#0]+)\.([#0]+)$/)){n=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=n.indexOf(".");var h=r.indexOf(".")-o,u=r.length-n.length-h;return ht(r.substr(0,h)+n+r.substr(r.length-u))}if(i=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+zt(t,r,-e):nr(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Pt(0,3-p.length):"")+p})+"."+Pt(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var m=nr(""+c);return m!=="0"?f+m:"";default:if(r.match(/\.[0#?]*$/))return zt(t,r.slice(0,r.lastIndexOf(".")),e)+ht(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function Kt(t,r,e){return(e|0)===e?zt(t,r,e):Tt(t,r,e)}function af(t){for(var r=[],e=!1,s=0,n=0;s<t.length;++s)switch(t.charCodeAt(s)){case 34:e=!e;break;case 95:case 42:case 92:++s;break;case 59:r[r.length]=t.substr(n,s-n),n=s+1}if(r[r.length]=t.substr(n),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var Co=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Ao(t){for(var r=0,e="",s="";r<t.length;)switch(e=t.charAt(r)){case"G":en(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(s=e;t.charAt(r++)!=="]"&&r<t.length;)s+=t.charAt(r);if(s.match(Co))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function of(t,r,e,s){for(var n=[],i="",o=0,l="",c="t",f,d,h,u="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!en(t,o))throw new Error("unrecognized character "+l+" in "+t);n[n.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(h=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(h);n[n.length]={t:"t",v:i},++o;break;case"\\":var m=t.charAt(++o),p=m==="("||m===")"?m:"t";n[n.length]={t:p,v:m},++o;break;case"_":n[n.length]={t:"t",v:" "},o+=2;break;case"@":n[n.length]={t:"T",v:r},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(f==null&&(f=Ls(r,e,t.charAt(o+1)==="2"),f==null))return"";n[n.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||f==null&&(f=Ls(r,e),f==null))return"";for(i=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=u),n[n.length]={t:l,v:i},c=l;break;case"A":case"a":case"上":var x={t:l,v:l};if(f==null&&(f=Ls(r,e)),t.substr(o,3).toUpperCase()==="A/P"?(f!=null&&(x.v=f.H>=12?"P":"A"),x.t="T",u="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(f!=null&&(x.v=f.H>=12?"PM":"AM"),x.t="T",o+=5,u="h"):t.substr(o,5).toUpperCase()==="上午/下午"?(f!=null&&(x.v=f.H>=12?"下午":"上午"),x.t="T",o+=5,u="h"):(x.t="t",++o),f==null&&x.t==="T")return"";n[n.length]=x,c=l;break;case"[":for(i=l;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Co)){if(f==null&&(f=Ls(r,e),f==null))return"";n[n.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Ao(t)||(n[n.length]={t:"t",v:i}));break;case".":if(f!=null){for(i=l;++o<t.length&&(l=t.charAt(o))==="0";)i+=l;n[n.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)i+=l;n[n.length]={t:"n",v:i};break;case"?":for(i=l;t.charAt(++o)===l;)i+=l;n[n.length]={t:l,v:i},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":n[n.length]={t:s===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);n[n.length]={t:"D",v:i};break;case" ":n[n.length]={t:l,v:l},++o;break;case"$":n[n.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);n[n.length]={t:"t",v:l},++o;break}var g=0,T=0,_;for(o=n.length-1,c="t";o>=0;--o)switch(n[o].t){case"h":case"H":n[o].t=u,c="h",g<1&&(g=1);break;case"s":(_=n[o].v.match(/\.0+$/))&&(T=Math.max(T,_[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=n[o].t;break;case"m":c==="s"&&(n[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&n[o].v.match(/[Hh]/)&&(g=1),g<2&&n[o].v.match(/[Mm]/)&&(g=2),g<3&&n[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M),f.M>=60&&(f.M=0,++f.H);break;case 2:f.u>=.5&&(f.u=0,++f.S),f.S>=60&&(f.S=0,++f.M);break}var S="",A;for(o=0;o<n.length;++o)switch(n[o].t){case"t":case"T":case" ":case"D":break;case"X":n[o].v="",n[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":n[o].v=Yd(n[o].t.charCodeAt(0),n[o].v,f,T),n[o].t="t";break;case"n":case"?":for(A=o+1;n[A]!=null&&((l=n[A].t)==="?"||l==="D"||(l===" "||l==="t")&&n[A+1]!=null&&(n[A+1].t==="?"||n[A+1].t==="t"&&n[A+1].v==="/")||n[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(n[A].v==="/"||n[A].v===" "&&n[A+1]!=null&&n[A+1].t=="?"));)n[o].v+=n[A].v,n[A]={v:"",t:";"},++A;S+=n[o].v,o=A-1;break;case"G":n[o].t="t",n[o].v=aa(r,e);break}var D="",z,C;if(S.length>0){S.charCodeAt(0)==40?(z=r<0&&S.charCodeAt(0)===45?-r:r,C=Kt("n",S,z)):(z=r<0&&s>1?-r:r,C=Kt("n",S,z),z<0&&n[0]&&n[0].t=="t"&&(C=C.substr(1),n[0].v="-"+n[0].v)),A=C.length-1;var I=n.length;for(o=0;o<n.length;++o)if(n[o]!=null&&n[o].t!="t"&&n[o].v.indexOf(".")>-1){I=o;break}var O=n.length;if(I===n.length&&C.indexOf("E")===-1){for(o=n.length-1;o>=0;--o)n[o]==null||"n?".indexOf(n[o].t)===-1||(A>=n[o].v.length-1?(A-=n[o].v.length,n[o].v=C.substr(A+1,n[o].v.length)):A<0?n[o].v="":(n[o].v=C.substr(0,A+1),A=-1),n[o].t="t",O=o);A>=0&&O<n.length&&(n[O].v=C.substr(0,A+1)+n[O].v)}else if(I!==n.length&&C.indexOf("E")===-1){for(A=C.indexOf(".")-1,o=I;o>=0;--o)if(!(n[o]==null||"n?".indexOf(n[o].t)===-1)){for(d=n[o].v.indexOf(".")>-1&&o===I?n[o].v.indexOf(".")-1:n[o].v.length-1,D=n[o].v.substr(d+1);d>=0;--d)A>=0&&(n[o].v.charAt(d)==="0"||n[o].v.charAt(d)==="#")&&(D=C.charAt(A--)+D);n[o].v=D,n[o].t="t",O=o}for(A>=0&&O<n.length&&(n[O].v=C.substr(0,A+1)+n[O].v),A=C.indexOf(".")+1,o=I;o<n.length;++o)if(!(n[o]==null||"n?(".indexOf(n[o].t)===-1&&o!==I)){for(d=n[o].v.indexOf(".")>-1&&o===I?n[o].v.indexOf(".")+1:0,D=n[o].v.substr(0,d);d<n[o].v.length;++d)A<C.length&&(D+=C.charAt(A++));n[o].v=D,n[o].t="t",O=o}}}for(o=0;o<n.length;++o)n[o]!=null&&"n?".indexOf(n[o].t)>-1&&(z=s>1&&r<0&&o>0&&n[o-1].v==="-"?-r:r,n[o].v=Kt(n[o].t,n[o].v,z),n[o].t="t");var P="";for(o=0;o!==n.length;++o)n[o]!=null&&(P+=n[o].v);return P}var gi=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function vi(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function lf(t,r){var e=af(t),s=e.length,n=e[s-1].indexOf("@");if(s<4&&n>-1&&--s,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||n>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=n>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=n>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=n>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var i=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[s,i];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var o=e[0].match(gi),l=e[1].match(gi);return vi(r,o)?[s,e[0]]:vi(r,l)?[s,e[1]]:[s,e[o!=null&&l!=null?2:1]]}return[s,i]}function or(t,r,e){e==null&&(e={});var s="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?s=e.dateNF:s=t;break;case"number":t==14&&e.dateNF?s=e.dateNF:s=(e.table!=null?e.table:Ge)[t],s==null&&(s=e.table&&e.table[xi[t]]||Ge[xi[t]]),s==null&&(s=$d[t]||"General");break}if(en(s,0))return aa(r,e);r instanceof Date&&(r=bo(r,e.date1904));var n=lf(s,r);if(en(n[1]))return aa(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return of(n[1],r,e,n[0])}function ko(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(Ge[e]==null){r<0&&(r=e);continue}if(Ge[e]==t){r=e;break}}r<0&&(r=391)}return Ge[r]=t,r}function _n(t){for(var r=0;r!=392;++r)t[r]!==void 0&&ko(t[r],r)}function Sn(){Ge=Ud()}var Ro=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function cf(t){var r=typeof t=="number"?Ge[t]:t;return r=r.replace(Ro,"(\\d+)"),new RegExp("^"+r+"$")}function df(t,r,e){var s=-1,n=-1,i=-1,o=-1,l=-1,c=-1;(r.match(Ro)||[]).forEach(function(h,u){var m=parseInt(e[u+1],10);switch(h.toLowerCase().charAt(0)){case"y":s=m;break;case"d":i=m;break;case"h":o=m;break;case"s":c=m;break;case"m":o>=0?l=m:n=m;break}}),c>=0&&l==-1&&n>=0&&(l=n,n=-1);var f=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(n>=1?n:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);f.length==7&&(f="0"+f),f.length==8&&(f="20"+f);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?f:s==-1&&n==-1&&i==-1?d:f+"T"+d}var ff=function(){var t={};t.version="1.2.0";function r(){for(var C=0,I=new Array(256),O=0;O!=256;++O)C=O,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,I[O]=C;return typeof Int32Array<"u"?new Int32Array(I):I}var e=r();function s(C){var I=0,O=0,P=0,H=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)H[P]=C[P];for(P=0;P!=256;++P)for(O=C[P],I=256+P;I<4096;I+=256)O=H[I]=O>>>8^C[O&255];var W=[];for(P=1;P!=16;++P)W[P-1]=typeof Int32Array<"u"?H.subarray(P*256,P*256+256):H.slice(P*256,P*256+256);return W}var n=s(e),i=n[0],o=n[1],l=n[2],c=n[3],f=n[4],d=n[5],h=n[6],u=n[7],m=n[8],p=n[9],x=n[10],g=n[11],T=n[12],_=n[13],S=n[14];function A(C,I){for(var O=I^-1,P=0,H=C.length;P<H;)O=O>>>8^e[(O^C.charCodeAt(P++))&255];return~O}function D(C,I){for(var O=I^-1,P=C.length-15,H=0;H<P;)O=S[C[H++]^O&255]^_[C[H++]^O>>8&255]^T[C[H++]^O>>16&255]^g[C[H++]^O>>>24]^x[C[H++]]^p[C[H++]]^m[C[H++]]^u[C[H++]]^h[C[H++]]^d[C[H++]]^f[C[H++]]^c[C[H++]]^l[C[H++]]^o[C[H++]]^i[C[H++]]^e[C[H++]];for(P+=15;H<P;)O=O>>>8^e[(O^C[H++])&255];return~O}function z(C,I){for(var O=I^-1,P=0,H=C.length,W=0,te=0;P<H;)W=C.charCodeAt(P++),W<128?O=O>>>8^e[(O^W)&255]:W<2048?(O=O>>>8^e[(O^(192|W>>6&31))&255],O=O>>>8^e[(O^(128|W&63))&255]):W>=55296&&W<57344?(W=(W&1023)+64,te=C.charCodeAt(P++)&1023,O=O>>>8^e[(O^(240|W>>8&7))&255],O=O>>>8^e[(O^(128|W>>2&63))&255],O=O>>>8^e[(O^(128|te>>6&15|(W&3)<<4))&255],O=O>>>8^e[(O^(128|te&63))&255]):(O=O>>>8^e[(O^(224|W>>12&15))&255],O=O>>>8^e[(O^(128|W>>6&63))&255],O=O>>>8^e[(O^(128|W&63))&255]);return~O}return t.table=e,t.bstr=A,t.buf=D,t.str=z,t}(),Oe=function(){var r={};r.version="1.2.1";function e(v,k){for(var N=v.split("/"),E=k.split("/"),R=0,F=0,V=Math.min(N.length,E.length);R<V;++R){if(F=N[R].length-E[R].length)return F;if(N[R]!=E[R])return N[R]<E[R]?-1:1}return N.length-E.length}function s(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:s(v.slice(0,-1));var k=v.lastIndexOf("/");return k===-1?v:v.slice(0,k+1)}function n(v){if(v.charAt(v.length-1)=="/")return n(v.slice(0,-1));var k=v.lastIndexOf("/");return k===-1?v:v.slice(k+1)}function i(v,k){typeof k=="string"&&(k=new Date(k));var N=k.getHours();N=N<<6|k.getMinutes(),N=N<<5|k.getSeconds()>>>1,v.write_shift(2,N);var E=k.getFullYear()-1980;E=E<<4|k.getMonth()+1,E=E<<5|k.getDate(),v.write_shift(2,E)}function o(v){var k=v.read_shift(2)&65535,N=v.read_shift(2)&65535,E=new Date,R=N&31;N>>>=5;var F=N&15;N>>>=4,E.setMilliseconds(0),E.setFullYear(N+1980),E.setMonth(F-1),E.setDate(R);var V=k&31;k>>>=5;var J=k&63;return k>>>=6,E.setHours(k),E.setMinutes(J),E.setSeconds(V<<1),E}function l(v){_t(v,0);for(var k={},N=0;v.l<=v.length-4;){var E=v.read_shift(2),R=v.read_shift(2),F=v.l+R,V={};switch(E){case 21589:N=v.read_shift(1),N&1&&(V.mtime=v.read_shift(4)),R>5&&(N&2&&(V.atime=v.read_shift(4)),N&4&&(V.ctime=v.read_shift(4))),V.mtime&&(V.mt=new Date(V.mtime*1e3));break}v.l=F,k[E]=V}return k}var c;function f(){return c||(c={})}function d(v,k){if(v[0]==80&&v[1]==75)return ei(v,k);if((v[0]|32)==109&&(v[1]|32)==105)return Tc(v,k);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var N=3,E=512,R=0,F=0,V=0,J=0,G=0,X=[],K=v.slice(0,512);_t(K,0);var re=h(K);switch(N=re[0],N){case 3:E=512;break;case 4:E=4096;break;case 0:if(re[1]==0)return ei(v,k);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}E!==512&&(K=v.slice(0,E),_t(K,28));var le=v.slice(0,E);u(K,N);var ue=K.read_shift(4,"i");if(N===3&&ue!==0)throw new Error("# Directory Sectors: Expected 0 saw "+ue);K.l+=4,V=K.read_shift(4,"i"),K.l+=4,K.chk("00100000","Mini Stream Cutoff Size: "),J=K.read_shift(4,"i"),R=K.read_shift(4,"i"),G=K.read_shift(4,"i"),F=K.read_shift(4,"i");for(var se=-1,fe=0;fe<109&&(se=K.read_shift(4,"i"),!(se<0));++fe)X[fe]=se;var be=m(v,E);g(G,F,be,E,X);var ze=_(be,V,X,E);ze[V].name="!Directory",R>0&&J!==te&&(ze[J].name="!MiniFAT"),ze[X[0]].name="!FAT",ze.fat_addrs=X,ze.ssz=E;var Ue={},it=[],Qr=[],Zr=[];S(V,ze,be,it,R,Ue,Qr,J),p(Qr,Zr,it),it.shift();var es={FileIndex:Qr,FullPaths:Zr};return k&&k.raw&&(es.raw={header:le,sectors:be}),es}function h(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(pe,"Header Signature: "),v.l+=16;var k=v.read_shift(2,"u");return[v.read_shift(2,"u"),k]}function u(v,k){var N=9;switch(v.l+=2,N=v.read_shift(2)){case 9:if(k!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(k!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function m(v,k){for(var N=Math.ceil(v.length/k)-1,E=[],R=1;R<N;++R)E[R-1]=v.slice(R*k,(R+1)*k);return E[N-1]=v.slice(N*k),E}function p(v,k,N){for(var E=0,R=0,F=0,V=0,J=0,G=N.length,X=[],K=[];E<G;++E)X[E]=K[E]=E,k[E]=N[E];for(;J<K.length;++J)E=K[J],R=v[E].L,F=v[E].R,V=v[E].C,X[E]===E&&(R!==-1&&X[R]!==R&&(X[E]=X[R]),F!==-1&&X[F]!==F&&(X[E]=X[F])),V!==-1&&(X[V]=E),R!==-1&&E!=X[E]&&(X[R]=X[E],K.lastIndexOf(R)<J&&K.push(R)),F!==-1&&E!=X[E]&&(X[F]=X[E],K.lastIndexOf(F)<J&&K.push(F));for(E=1;E<G;++E)X[E]===E&&(F!==-1&&X[F]!==F?X[E]=X[F]:R!==-1&&X[R]!==R&&(X[E]=X[R]));for(E=1;E<G;++E)if(v[E].type!==0){if(J=E,J!=X[J])do J=X[J],k[E]=k[J]+"/"+k[E];while(J!==0&&X[J]!==-1&&J!=X[J]);X[E]=-1}for(k[0]+="/",E=1;E<G;++E)v[E].type!==2&&(k[E]+="/")}function x(v,k,N){for(var E=v.start,R=v.size,F=[],V=E;N&&R>0&&V>=0;)F.push(k.slice(V*W,V*W+W)),R-=W,V=gr(N,V*4);return F.length===0?q(0):rt(F).slice(0,v.size)}function g(v,k,N,E,R){var F=te;if(v===te){if(k!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var V=N[v],J=(E>>>2)-1;if(!V)return;for(var G=0;G<J&&(F=gr(V,G*4))!==te;++G)R.push(F);g(gr(V,E-4),k-1,N,E,R)}}function T(v,k,N,E,R){var F=[],V=[];R||(R=[]);var J=E-1,G=0,X=0;for(G=k;G>=0;){R[G]=!0,F[F.length]=G,V.push(v[G]);var K=N[Math.floor(G*4/E)];if(X=G*4&J,E<4+X)throw new Error("FAT boundary crossed: "+G+" 4 "+E);if(!v[K])break;G=gr(v[K],X)}return{nodes:F,data:Ei([V])}}function _(v,k,N,E){var R=v.length,F=[],V=[],J=[],G=[],X=E-1,K=0,re=0,le=0,ue=0;for(K=0;K<R;++K)if(J=[],le=K+k,le>=R&&(le-=R),!V[le]){G=[];var se=[];for(re=le;re>=0;){se[re]=!0,V[re]=!0,J[J.length]=re,G.push(v[re]);var fe=N[Math.floor(re*4/E)];if(ue=re*4&X,E<4+ue)throw new Error("FAT boundary crossed: "+re+" 4 "+E);if(!v[fe]||(re=gr(v[fe],ue),se[re]))break}F[le]={nodes:J,data:Ei([G])}}return F}function S(v,k,N,E,R,F,V,J){for(var G=0,X=E.length?2:0,K=k[v].data,re=0,le=0,ue;re<K.length;re+=128){var se=K.slice(re,re+128);_t(se,64),le=se.read_shift(2),ue=Ea(se,0,le-X),E.push(ue);var fe={name:ue,type:se.read_shift(1),color:se.read_shift(1),L:se.read_shift(4,"i"),R:se.read_shift(4,"i"),C:se.read_shift(4,"i"),clsid:se.read_shift(16),state:se.read_shift(4,"i"),start:0,size:0},be=se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2);be!==0&&(fe.ct=A(se,se.l-8));var ze=se.read_shift(2)+se.read_shift(2)+se.read_shift(2)+se.read_shift(2);ze!==0&&(fe.mt=A(se,se.l-8)),fe.start=se.read_shift(4,"i"),fe.size=se.read_shift(4,"i"),fe.size<0&&fe.start<0&&(fe.size=fe.type=0,fe.start=te,fe.name=""),fe.type===5?(G=fe.start,R>0&&G!==te&&(k[G].name="!StreamData")):fe.size>=4096?(fe.storage="fat",k[fe.start]===void 0&&(k[fe.start]=T(N,fe.start,k.fat_addrs,k.ssz)),k[fe.start].name=fe.name,fe.content=k[fe.start].data.slice(0,fe.size)):(fe.storage="minifat",fe.size<0?fe.size=0:G!==te&&fe.start!==te&&k[G]&&(fe.content=x(fe,k[G].data,(k[J]||{}).data))),fe.content&&_t(fe.content,0),F[ue]=fe,V.push(fe)}}function A(v,k){return new Date((Nt(v,k+4)/1e7*Math.pow(2,32)+Nt(v,k)/1e7-11644473600)*1e3)}function D(v,k){return f(),d(c.readFileSync(v),k)}function z(v,k){var N=k&&k.type;switch(N||Ae&&Buffer.isBuffer(v)&&(N="buffer"),N||"base64"){case"file":return D(v,k);case"base64":return d(It(Jt(v)),k);case"binary":return d(It(v),k)}return d(v,k)}function C(v,k){var N=k||{},E=N.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=E+"/",v.FileIndex[0]={name:E,type:5}),N.CLSID&&(v.FileIndex[0].clsid=N.CLSID),I(v)}function I(v){var k="Sh33tJ5";if(!Oe.find(v,"/"+k)){var N=q(4);N[0]=55,N[1]=N[3]=50,N[2]=54,v.FileIndex.push({name:k,type:2,content:N,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+k),O(v)}}function O(v,k){C(v);for(var N=!1,E=!1,R=v.FullPaths.length-1;R>=0;--R){var F=v.FileIndex[R];switch(F.type){case 0:E?N=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:E=!0,isNaN(F.R*F.L*F.C)&&(N=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!k)){var V=new Date(1987,1,19),J=0,G=Object.create?Object.create(null):{},X=[];for(R=0;R<v.FullPaths.length;++R)G[v.FullPaths[R]]=!0,v.FileIndex[R].type!==0&&X.push([v.FullPaths[R],v.FileIndex[R]]);for(R=0;R<X.length;++R){var K=s(X[R][0]);E=G[K],E||(X.push([K,{name:n(K).replace("/",""),type:1,clsid:Ne,ct:V,mt:V,content:null}]),G[K]=!0)}for(X.sort(function(ue,se){return e(ue[0],se[0])}),v.FullPaths=[],v.FileIndex=[],R=0;R<X.length;++R)v.FullPaths[R]=X[R][0],v.FileIndex[R]=X[R][1];for(R=0;R<X.length;++R){var re=v.FileIndex[R],le=v.FullPaths[R];if(re.name=n(le).replace("/",""),re.L=re.R=re.C=-(re.color=1),re.size=re.content?re.content.length:0,re.start=0,re.clsid=re.clsid||Ne,R===0)re.C=X.length>1?1:-1,re.size=0,re.type=5;else if(le.slice(-1)=="/"){for(J=R+1;J<X.length&&s(v.FullPaths[J])!=le;++J);for(re.C=J>=X.length?-1:J,J=R+1;J<X.length&&s(v.FullPaths[J])!=s(le);++J);re.R=J>=X.length?-1:J,re.type=1}else s(v.FullPaths[R+1]||"")==s(le)&&(re.R=R+1),re.type=2}}}function P(v,k){var N=k||{};if(N.fileType=="mad")return Cc(v,N);switch(O(v),N.fileType){case"zip":return wc(v,N)}var E=function(ue){for(var se=0,fe=0,be=0;be<ue.FileIndex.length;++be){var ze=ue.FileIndex[be];if(ze.content){var Ue=ze.content.length;Ue>0&&(Ue<4096?se+=Ue+63>>6:fe+=Ue+511>>9)}}for(var it=ue.FullPaths.length+3>>2,Qr=se+7>>3,Zr=se+127>>7,es=Qr+fe+it+Zr,hr=es+127>>7,On=hr<=109?0:Math.ceil((hr-109)/127);es+hr+On+127>>7>hr;)On=++hr<=109?0:Math.ceil((hr-109)/127);var Wt=[1,On,hr,Zr,it,fe,se,0];return ue.FileIndex[0].size=se<<6,Wt[7]=(ue.FileIndex[0].start=Wt[0]+Wt[1]+Wt[2]+Wt[3]+Wt[4]+Wt[5])+(Wt[6]+7>>3),Wt}(v),R=q(E[7]<<9),F=0,V=0;{for(F=0;F<8;++F)R.write_shift(1,me[F]);for(F=0;F<8;++F)R.write_shift(2,0);for(R.write_shift(2,62),R.write_shift(2,3),R.write_shift(2,65534),R.write_shift(2,9),R.write_shift(2,6),F=0;F<3;++F)R.write_shift(2,0);for(R.write_shift(4,0),R.write_shift(4,E[2]),R.write_shift(4,E[0]+E[1]+E[2]+E[3]-1),R.write_shift(4,0),R.write_shift(4,4096),R.write_shift(4,E[3]?E[0]+E[1]+E[2]-1:te),R.write_shift(4,E[3]),R.write_shift(-4,E[1]?E[0]-1:te),R.write_shift(4,E[1]),F=0;F<109;++F)R.write_shift(-4,F<E[2]?E[1]+F:-1)}if(E[1])for(V=0;V<E[1];++V){for(;F<236+V*127;++F)R.write_shift(-4,F<E[2]?E[1]+F:-1);R.write_shift(-4,V===E[1]-1?te:V+1)}var J=function(ue){for(V+=ue;F<V-1;++F)R.write_shift(-4,F+1);ue&&(++F,R.write_shift(-4,te))};for(V=F=0,V+=E[1];F<V;++F)R.write_shift(-4,ve.DIFSECT);for(V+=E[2];F<V;++F)R.write_shift(-4,ve.FATSECT);J(E[3]),J(E[4]);for(var G=0,X=0,K=v.FileIndex[0];G<v.FileIndex.length;++G)K=v.FileIndex[G],K.content&&(X=K.content.length,!(X<4096)&&(K.start=V,J(X+511>>9)));for(J(E[6]+7>>3);R.l&511;)R.write_shift(-4,ve.ENDOFCHAIN);for(V=F=0,G=0;G<v.FileIndex.length;++G)K=v.FileIndex[G],K.content&&(X=K.content.length,!(!X||X>=4096)&&(K.start=V,J(X+63>>6)));for(;R.l&511;)R.write_shift(-4,ve.ENDOFCHAIN);for(F=0;F<E[4]<<2;++F){var re=v.FullPaths[F];if(!re||re.length===0){for(G=0;G<17;++G)R.write_shift(4,0);for(G=0;G<3;++G)R.write_shift(4,-1);for(G=0;G<12;++G)R.write_shift(4,0);continue}K=v.FileIndex[F],F===0&&(K.start=K.size?K.start-1:te);var le=F===0&&N.root||K.name;if(X=2*(le.length+1),R.write_shift(64,le,"utf16le"),R.write_shift(2,X),R.write_shift(1,K.type),R.write_shift(1,K.color),R.write_shift(-4,K.L),R.write_shift(-4,K.R),R.write_shift(-4,K.C),K.clsid)R.write_shift(16,K.clsid,"hex");else for(G=0;G<4;++G)R.write_shift(4,0);R.write_shift(4,K.state||0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,0),R.write_shift(4,K.start),R.write_shift(4,K.size),R.write_shift(4,0)}for(F=1;F<v.FileIndex.length;++F)if(K=v.FileIndex[F],K.size>=4096)if(R.l=K.start+1<<9,Ae&&Buffer.isBuffer(K.content))K.content.copy(R,R.l,0,K.size),R.l+=K.size+511&-512;else{for(G=0;G<K.size;++G)R.write_shift(1,K.content[G]);for(;G&511;++G)R.write_shift(1,0)}for(F=1;F<v.FileIndex.length;++F)if(K=v.FileIndex[F],K.size>0&&K.size<4096)if(Ae&&Buffer.isBuffer(K.content))K.content.copy(R,R.l,0,K.size),R.l+=K.size+63&-64;else{for(G=0;G<K.size;++G)R.write_shift(1,K.content[G]);for(;G&63;++G)R.write_shift(1,0)}if(Ae)R.l=R.length;else for(;R.l<R.length;)R.write_shift(1,0);return R}function H(v,k){var N=v.FullPaths.map(function(G){return G.toUpperCase()}),E=N.map(function(G){var X=G.split("/");return X[X.length-(G.slice(-1)=="/"?2:1)]}),R=!1;k.charCodeAt(0)===47?(R=!0,k=N[0].slice(0,-1)+k):R=k.indexOf("/")!==-1;var F=k.toUpperCase(),V=R===!0?N.indexOf(F):E.indexOf(F);if(V!==-1)return v.FileIndex[V];var J=!F.match(Ps);for(F=F.replace(is,""),J&&(F=F.replace(Ps,"!")),V=0;V<N.length;++V)if((J?N[V].replace(Ps,"!"):N[V]).replace(is,"")==F||(J?E[V].replace(Ps,"!"):E[V]).replace(is,"")==F)return v.FileIndex[V];return null}var W=64,te=-2,pe="d0cf11e0a1b11ae1",me=[208,207,17,224,161,177,26,225],Ne="00000000000000000000000000000000",ve={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:te,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ne,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function je(v,k,N){f();var E=P(v,N);c.writeFileSync(k,E)}function ce(v){for(var k=new Array(v.length),N=0;N<v.length;++N)k[N]=String.fromCharCode(v[N]);return k.join("")}function xe(v,k){var N=P(v,k);switch(k&&k.type||"buffer"){case"file":return f(),c.writeFileSync(k.filename,N),N;case"binary":return typeof N=="string"?N:ce(N);case"base64":return ms(typeof N=="string"?N:ce(N));case"buffer":if(Ae)return Buffer.isBuffer(N)?N:Zt(N);case"array":return typeof N=="string"?It(N):N}return N}var _e;function b(v){try{var k=v.InflateRaw,N=new k;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)_e=v;else throw new Error("zlib does not expose bytesRead")}catch(E){console.error("cannot use native zlib: "+(E.message||E))}}function w(v,k){if(!_e)return Qa(v,k);var N=_e.InflateRaw,E=new N,R=E._processChunk(v.slice(v.l),E._finishFlushFlag);return v.l+=E.bytesRead,R}function j(v){return _e?_e.deflateRawSync(v):Va(v)}var y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],U=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],L=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Y(v){var k=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(k>>16|k>>8|k)&255}for(var Z=typeof Uint8Array<"u",Q=Z?new Uint8Array(256):[],ge=0;ge<256;++ge)Q[ge]=Y(ge);function M(v,k){var N=Q[v&255];return k<=8?N>>>8-k:(N=N<<8|Q[v>>8&255],k<=16?N>>>16-k:(N=N<<8|Q[v>>16&255],N>>>24-k))}function oe(v,k){var N=k&7,E=k>>>3;return(v[E]|(N<=6?0:v[E+1]<<8))>>>N&3}function ie(v,k){var N=k&7,E=k>>>3;return(v[E]|(N<=5?0:v[E+1]<<8))>>>N&7}function Be(v,k){var N=k&7,E=k>>>3;return(v[E]|(N<=4?0:v[E+1]<<8))>>>N&15}function ye(v,k){var N=k&7,E=k>>>3;return(v[E]|(N<=3?0:v[E+1]<<8))>>>N&31}function de(v,k){var N=k&7,E=k>>>3;return(v[E]|(N<=1?0:v[E+1]<<8))>>>N&127}function Ee(v,k,N){var E=k&7,R=k>>>3,F=(1<<N)-1,V=v[R]>>>E;return N<8-E||(V|=v[R+1]<<8-E,N<16-E)||(V|=v[R+2]<<16-E,N<24-E)||(V|=v[R+3]<<24-E),V&F}function Se(v,k,N){var E=k&7,R=k>>>3;return E<=5?v[R]|=(N&7)<<E:(v[R]|=N<<E&255,v[R+1]=(N&7)>>8-E),k+3}function Ce(v,k,N){var E=k&7,R=k>>>3;return N=(N&1)<<E,v[R]|=N,k+1}function Me(v,k,N){var E=k&7,R=k>>>3;return N<<=E,v[R]|=N&255,N>>>=8,v[R+1]=N,k+8}function er(v,k,N){var E=k&7,R=k>>>3;return N<<=E,v[R]|=N&255,N>>>=8,v[R+1]=N&255,v[R+2]=N>>>8,k+16}function Bt(v,k){var N=v.length,E=2*N>k?2*N:k+5,R=0;if(N>=k)return v;if(Ae){var F=fi(E);if(v.copy)v.copy(F);else for(;R<v.length;++R)F[R]=v[R];return F}else if(Z){var V=new Uint8Array(E);if(V.set)V.set(v);else for(;R<N;++R)V[R]=v[R];return V}return v.length=E,v}function ct(v){for(var k=new Array(v),N=0;N<v;++N)k[N]=0;return k}function Ve(v,k,N){var E=1,R=0,F=0,V=0,J=0,G=v.length,X=Z?new Uint16Array(32):ct(32);for(F=0;F<32;++F)X[F]=0;for(F=G;F<N;++F)v[F]=0;G=v.length;var K=Z?new Uint16Array(G):ct(G);for(F=0;F<G;++F)X[R=v[F]]++,E<R&&(E=R),K[F]=0;for(X[0]=0,F=1;F<=E;++F)X[F+16]=J=J+X[F-1]<<1;for(F=0;F<G;++F)J=v[F],J!=0&&(K[F]=X[J+16]++);var re=0;for(F=0;F<G;++F)if(re=v[F],re!=0)for(J=M(K[F],E)>>E-re,V=(1<<E+4-re)-1;V>=0;--V)k[J|V<<re]=re&15|F<<4;return E}var mt=Z?new Uint16Array(512):ct(512),pt=Z?new Uint16Array(32):ct(32);if(!Z){for(var Rt=0;Rt<512;++Rt)mt[Rt]=0;for(Rt=0;Rt<32;++Rt)pt[Rt]=0}(function(){for(var v=[],k=0;k<32;k++)v.push(5);Ve(v,pt,32);var N=[];for(k=0;k<=143;k++)N.push(8);for(;k<=255;k++)N.push(9);for(;k<=279;k++)N.push(7);for(;k<=287;k++)N.push(8);Ve(N,mt,288)})();var gc=function(){for(var k=Z?new Uint8Array(32768):[],N=0,E=0;N<L.length-1;++N)for(;E<L[N+1];++E)k[E]=N;for(;E<32768;++E)k[E]=29;var R=Z?new Uint8Array(259):[];for(N=0,E=0;N<U.length-1;++N)for(;E<U[N+1];++E)R[E]=N;function F(J,G){for(var X=0;X<J.length;){var K=Math.min(65535,J.length-X),re=X+K==J.length;for(G.write_shift(1,+re),G.write_shift(2,K),G.write_shift(2,~K&65535);K-- >0;)G[G.l++]=J[X++]}return G.l}function V(J,G){for(var X=0,K=0,re=Z?new Uint16Array(32768):[];K<J.length;){var le=Math.min(65535,J.length-K);if(le<10){for(X=Se(G,X,+(K+le==J.length)),X&7&&(X+=8-(X&7)),G.l=X/8|0,G.write_shift(2,le),G.write_shift(2,~le&65535);le-- >0;)G[G.l++]=J[K++];X=G.l*8;continue}X=Se(G,X,+(K+le==J.length)+2);for(var ue=0;le-- >0;){var se=J[K];ue=(ue<<5^se)&32767;var fe=-1,be=0;if((fe=re[ue])&&(fe|=K&-32768,fe>K&&(fe-=32768),fe<K))for(;J[fe+be]==J[K+be]&&be<250;)++be;if(be>2){se=R[be],se<=22?X=Me(G,X,Q[se+1]>>1)-1:(Me(G,X,3),X+=5,Me(G,X,Q[se-23]>>5),X+=3);var ze=se<8?0:se-4>>2;ze>0&&(er(G,X,be-U[se]),X+=ze),se=k[K-fe],X=Me(G,X,Q[se]>>3),X-=3;var Ue=se<4?0:se-2>>1;Ue>0&&(er(G,X,K-fe-L[se]),X+=Ue);for(var it=0;it<be;++it)re[ue]=K&32767,ue=(ue<<5^J[K])&32767,++K;le-=be-1}else se<=143?se=se+48:X=Ce(G,X,1),X=Me(G,X,Q[se]),re[ue]=K&32767,++K}X=Me(G,X,0)-1}return G.l=(X+7)/8|0,G.l}return function(G,X){return G.length<8?F(G,X):V(G,X)}}();function Va(v){var k=q(50+Math.floor(v.length*1.1)),N=gc(v,k);return k.slice(0,N)}var Xa=Z?new Uint16Array(32768):ct(32768),Ka=Z?new Uint16Array(32768):ct(32768),qa=Z?new Uint16Array(128):ct(128),Ya=1,Ja=1;function vc(v,k){var N=ye(v,k)+257;k+=5;var E=ye(v,k)+1;k+=5;var R=Be(v,k)+4;k+=4;for(var F=0,V=Z?new Uint8Array(19):ct(19),J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],G=1,X=Z?new Uint8Array(8):ct(8),K=Z?new Uint8Array(8):ct(8),re=V.length,le=0;le<R;++le)V[y[le]]=F=ie(v,k),G<F&&(G=F),X[F]++,k+=3;var ue=0;for(X[0]=0,le=1;le<=G;++le)K[le]=ue=ue+X[le-1]<<1;for(le=0;le<re;++le)(ue=V[le])!=0&&(J[le]=K[ue]++);var se=0;for(le=0;le<re;++le)if(se=V[le],se!=0){ue=Q[J[le]]>>8-se;for(var fe=(1<<7-se)-1;fe>=0;--fe)qa[ue|fe<<se]=se&7|le<<3}var be=[];for(G=1;be.length<N+E;)switch(ue=qa[de(v,k)],k+=ue&7,ue>>>=3){case 16:for(F=3+oe(v,k),k+=2,ue=be[be.length-1];F-- >0;)be.push(ue);break;case 17:for(F=3+ie(v,k),k+=3;F-- >0;)be.push(0);break;case 18:for(F=11+de(v,k),k+=7;F-- >0;)be.push(0);break;default:be.push(ue),G<ue&&(G=ue);break}var ze=be.slice(0,N),Ue=be.slice(N);for(le=N;le<286;++le)ze[le]=0;for(le=E;le<30;++le)Ue[le]=0;return Ya=Ve(ze,Xa,286),Ja=Ve(Ue,Ka,30),k}function yc(v,k){if(v[0]==3&&!(v[1]&3))return[br(k),2];for(var N=0,E=0,R=fi(k||1<<18),F=0,V=R.length>>>0,J=0,G=0;!(E&1);){if(E=ie(v,N),N+=3,E>>>1)E>>1==1?(J=9,G=5):(N=vc(v,N),J=Ya,G=Ja);else{N&7&&(N+=8-(N&7));var X=v[N>>>3]|v[(N>>>3)+1]<<8;if(N+=32,X>0)for(!k&&V<F+X&&(R=Bt(R,F+X),V=R.length);X-- >0;)R[F++]=v[N>>>3],N+=8;continue}for(;;){!k&&V<F+32767&&(R=Bt(R,F+32767),V=R.length);var K=Ee(v,N,J),re=E>>>1==1?mt[K]:Xa[K];if(N+=re&15,re>>>=4,!(re>>>8&255))R[F++]=re;else{if(re==256)break;re-=257;var le=re<8?0:re-4>>2;le>5&&(le=0);var ue=F+U[re];le>0&&(ue+=Ee(v,N,le),N+=le),K=Ee(v,N,G),re=E>>>1==1?pt[K]:Ka[K],N+=re&15,re>>>=4;var se=re<4?0:re-2>>1,fe=L[re];for(se>0&&(fe+=Ee(v,N,se),N+=se),!k&&V<ue&&(R=Bt(R,ue+100),V=R.length);F<ue;)R[F]=R[F-fe],++F}}}return k?[R,N+7>>>3]:[R.slice(0,F),N+7>>>3]}function Qa(v,k){var N=v.slice(v.l||0),E=yc(N,k);return v.l+=E[1],E[0]}function Za(v,k){if(v)typeof console<"u"&&console.error(k);else throw new Error(k)}function ei(v,k){var N=v;_t(N,0);var E=[],R=[],F={FileIndex:E,FullPaths:R};C(F,{root:k.root});for(var V=N.length-4;(N[V]!=80||N[V+1]!=75||N[V+2]!=5||N[V+3]!=6)&&V>=0;)--V;N.l=V+4,N.l+=4;var J=N.read_shift(2);N.l+=6;var G=N.read_shift(4);for(N.l=G,V=0;V<J;++V){N.l+=20;var X=N.read_shift(4),K=N.read_shift(4),re=N.read_shift(2),le=N.read_shift(2),ue=N.read_shift(2);N.l+=8;var se=N.read_shift(4),fe=l(N.slice(N.l+re,N.l+re+le));N.l+=re+le+ue;var be=N.l;N.l=se+4,bc(N,X,K,F,fe),N.l=be}return F}function bc(v,k,N,E,R){v.l+=2;var F=v.read_shift(2),V=v.read_shift(2),J=o(v);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var G=v.read_shift(4),X=v.read_shift(4),K=v.read_shift(4),re=v.read_shift(2),le=v.read_shift(2),ue="",se=0;se<re;++se)ue+=String.fromCharCode(v[v.l++]);if(le){var fe=l(v.slice(v.l,v.l+le));(fe[21589]||{}).mt&&(J=fe[21589].mt),((R||{})[21589]||{}).mt&&(J=R[21589].mt)}v.l+=le;var be=v.slice(v.l,v.l+X);switch(V){case 8:be=w(v,K);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+V)}var ze=!1;F&8&&(G=v.read_shift(4),G==134695760&&(G=v.read_shift(4),ze=!0),X=v.read_shift(4),K=v.read_shift(4)),X!=k&&Za(ze,"Bad compressed size: "+k+" != "+X),K!=N&&Za(ze,"Bad uncompressed size: "+N+" != "+K),Dn(E,ue,be,{unsafe:!0,mt:J})}function wc(v,k){var N=k||{},E=[],R=[],F=q(1),V=N.compression?8:0,J=0,G=0,X=0,K=0,re=0,le=v.FullPaths[0],ue=le,se=v.FileIndex[0],fe=[],be=0;for(G=1;G<v.FullPaths.length;++G)if(ue=v.FullPaths[G].slice(le.length),se=v.FileIndex[G],!(!se.size||!se.content||ue=="Sh33tJ5")){var ze=K,Ue=q(ue.length);for(X=0;X<ue.length;++X)Ue.write_shift(1,ue.charCodeAt(X)&127);Ue=Ue.slice(0,Ue.l),fe[re]=ff.buf(se.content,0);var it=se.content;V==8&&(it=j(it)),F=q(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,J),F.write_shift(2,V),se.mt?i(F,se.mt):F.write_shift(4,0),F.write_shift(-4,fe[re]),F.write_shift(4,it.length),F.write_shift(4,se.content.length),F.write_shift(2,Ue.length),F.write_shift(2,0),K+=F.length,E.push(F),K+=Ue.length,E.push(Ue),K+=it.length,E.push(it),F=q(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,J),F.write_shift(2,V),F.write_shift(4,0),F.write_shift(-4,fe[re]),F.write_shift(4,it.length),F.write_shift(4,se.content.length),F.write_shift(2,Ue.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,ze),be+=F.l,R.push(F),be+=Ue.length,R.push(Ue),++re}return F=q(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,re),F.write_shift(2,re),F.write_shift(4,be),F.write_shift(4,K),F.write_shift(2,0),rt([rt(E),rt(R),F])}var Fs={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function _c(v,k){if(v.ctype)return v.ctype;var N=v.name||"",E=N.match(/\.([^\.]+)$/);return E&&Fs[E[1]]||k&&(E=(N=k).match(/[\.\\]([^\.\\])+$/),E&&Fs[E[1]])?Fs[E[1]]:"application/octet-stream"}function Sc(v){for(var k=ms(v),N=[],E=0;E<k.length;E+=76)N.push(k.slice(E,E+76));return N.join(`\r
`)+`\r
`}function Nc(v){var k=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var K=X.charCodeAt(0).toString(16).toUpperCase();return"="+(K.length==1?"0"+K:K)});k=k.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),k.charAt(0)==`
`&&(k="=0D"+k.slice(1)),k=k.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],E=k.split(`\r
`),R=0;R<E.length;++R){var F=E[R];if(F.length==0){N.push("");continue}for(var V=0;V<F.length;){var J=76,G=F.slice(V,V+J);G.charAt(J-1)=="="?J--:G.charAt(J-2)=="="?J-=2:G.charAt(J-3)=="="&&(J-=3),G=F.slice(V,V+J),V+=J,V<F.length&&(G+="="),N.push(G)}}return N.join(`\r
`)}function jc(v){for(var k=[],N=0;N<v.length;++N){for(var E=v[N];N<=v.length&&E.charAt(E.length-1)=="=";)E=E.slice(0,E.length-1)+v[++N];k.push(E)}for(var R=0;R<k.length;++R)k[R]=k[R].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return It(k.join(`\r
`))}function Ec(v,k,N){for(var E="",R="",F="",V,J=0;J<10;++J){var G=k[J];if(!G||G.match(/^\s*$/))break;var X=G.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":E=X[2].trim();break;case"content-type":F=X[2].trim();break;case"content-transfer-encoding":R=X[2].trim();break}}switch(++J,R.toLowerCase()){case"base64":V=It(Jt(k.slice(J).join("")));break;case"quoted-printable":V=jc(k.slice(J));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+R)}var K=Dn(v,E.slice(N.length),V,{unsafe:!0});F&&(K.ctype=F)}function Tc(v,k){if(ce(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=k&&k.root||"",E=(Ae&&Buffer.isBuffer(v)?v.toString("binary"):ce(v)).split(`\r
`),R=0,F="";for(R=0;R<E.length;++R)if(F=E[R],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),N||(N=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),F.slice(0,N.length)!=N););var V=(E[1]||"").match(/boundary="(.*?)"/);if(!V)throw new Error("MAD cannot find boundary");var J="--"+(V[1]||""),G=[],X=[],K={FileIndex:G,FullPaths:X};C(K);var re,le=0;for(R=0;R<E.length;++R){var ue=E[R];ue!==J&&ue!==J+"--"||(le++&&Ec(K,E.slice(re,R),N),re=R)}return K}function Cc(v,k){var N=k||{},E=N.boundary||"SheetJS";E="------="+E;for(var R=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+E.slice(2)+'"',"","",""],F=v.FullPaths[0],V=F,J=v.FileIndex[0],G=1;G<v.FullPaths.length;++G)if(V=v.FullPaths[G].slice(F.length),J=v.FileIndex[G],!(!J.size||!J.content||V=="Sh33tJ5")){V=V.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(be){return"_x"+be.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(be){return"_u"+be.charCodeAt(0).toString(16)+"_"});for(var X=J.content,K=Ae&&Buffer.isBuffer(X)?X.toString("binary"):ce(X),re=0,le=Math.min(1024,K.length),ue=0,se=0;se<=le;++se)(ue=K.charCodeAt(se))>=32&&ue<128&&++re;var fe=re>=le*4/5;R.push(E),R.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+V),R.push("Content-Transfer-Encoding: "+(fe?"quoted-printable":"base64")),R.push("Content-Type: "+_c(J,V)),R.push(""),R.push(fe?Nc(K):Sc(K))}return R.push(E+`--\r
`),R.join(`\r
`)}function Ac(v){var k={};return C(k,v),k}function Dn(v,k,N,E){var R=E&&E.unsafe;R||C(v);var F=!R&&Oe.find(v,k);if(!F){var V=v.FullPaths[0];k.slice(0,V.length)==V?V=k:(V.slice(-1)!="/"&&(V+="/"),V=(V+k).replace("//","/")),F={name:n(k),type:2},v.FileIndex.push(F),v.FullPaths.push(V),R||Oe.utils.cfb_gc(v)}return F.content=N,F.size=N?N.length:0,E&&(E.CLSID&&(F.clsid=E.CLSID),E.mt&&(F.mt=E.mt),E.ct&&(F.ct=E.ct)),F}function kc(v,k){C(v);var N=Oe.find(v,k);if(N){for(var E=0;E<v.FileIndex.length;++E)if(v.FileIndex[E]==N)return v.FileIndex.splice(E,1),v.FullPaths.splice(E,1),!0}return!1}function Rc(v,k,N){C(v);var E=Oe.find(v,k);if(E){for(var R=0;R<v.FileIndex.length;++R)if(v.FileIndex[R]==E)return v.FileIndex[R].name=n(N),v.FullPaths[R]=N,!0}return!1}function Fc(v){O(v,!0)}return r.find=H,r.read=z,r.parse=d,r.write=xe,r.writeFile=je,r.utils={cfb_new:Ac,cfb_add:Dn,cfb_del:kc,cfb_mov:Rc,cfb_gc:Fc,ReadShift:ls,CheckField:qo,prep_blob:_t,bconcat:rt,use_zlib:b,_deflateRaw:Va,_inflateRaw:Qa,consts:ve},r}();function hf(t){return typeof t=="string"?wn(t):Array.isArray(t)?Ld(t):t}function js(t,r,e){if(typeof Deno<"u"){if(e&&typeof r=="string")switch(e){case"utf8":r=new TextEncoder(e).encode(r);break;case"binary":r=wn(r);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(t,r)}var s=e=="utf8"?gs(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,t);if(typeof Blob<"u"){var n=new Blob([hf(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(n,t);if(typeof saveAs<"u")return saveAs(n,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(n);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(r)&&(r=Ns(r)),l.write(r),l.close(),r}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function at(t){for(var r=Object.keys(t),e=[],s=0;s<r.length;++s)Object.prototype.hasOwnProperty.call(t,r[s])&&e.push(r[s]);return e}function yi(t,r){for(var e=[],s=at(t),n=0;n!==s.length;++n)e[t[s[n]][r]]==null&&(e[t[s[n]][r]]=s[n]);return e}function _a(t){for(var r=[],e=at(t),s=0;s!==e.length;++s)r[t[e[s]]]=e[s];return r}function Nn(t){for(var r=[],e=at(t),s=0;s!==e.length;++s)r[t[e[s]]]=parseInt(e[s],10);return r}function uf(t){for(var r=[],e=at(t),s=0;s!==e.length;++s)r[t[e[s]]]==null&&(r[t[e[s]]]=[]),r[t[e[s]]].push(e[s]);return r}var rn=new Date(1899,11,30,0,0,0);function yt(t,r){var e=t.getTime(),s=rn.getTime()+(t.getTimezoneOffset()-rn.getTimezoneOffset())*6e4;return(e-s)/(24*60*60*1e3)}var Fo=new Date,xf=rn.getTime()+(Fo.getTimezoneOffset()-rn.getTimezoneOffset())*6e4,bi=Fo.getTimezoneOffset();function Do(t){var r=new Date;return r.setTime(t*24*60*60*1e3+xf),r.getTimezoneOffset()!==bi&&r.setTime(r.getTime()+(r.getTimezoneOffset()-bi)*6e4),r}var wi=new Date("2017-02-19T19:06:09.000Z"),Oo=isNaN(wi.getFullYear())?new Date("2/19/17"):wi,mf=Oo.getFullYear()==2017;function xt(t,r){var e=new Date(t);if(mf)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(Oo.getFullYear()==1917&&!isNaN(e.getFullYear())){var s=e.getFullYear();return t.indexOf(""+s)>-1||e.setFullYear(e.getFullYear()+100),e}var n=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function jn(t,r){if(Ae&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var e={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return e[i]||i})}catch{}for(var s=[],n=0;n!=t.length;++n)s.push(String.fromCharCode(t[n]));return s.join("")}function bt(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=bt(t[e]));return r}function We(t,r){for(var e="";e.length<r;)e+=t;return e}function qt(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,s=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(s))||(s=s.replace(/[(](.*)[)]/,function(n,i){return e=-e,i}),!isNaN(r=Number(s)))?r/e:r}var pf=["january","february","march","april","may","june","july","august","september","october","november","december"];function ps(t){var r=new Date(t),e=new Date(NaN),s=r.getYear(),n=r.getMonth(),i=r.getDate();if(isNaN(i))return e;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&pf.indexOf(o)==-1)return e}else if(o.match(/[a-z]/))return e;return s<0||s>8099?e:(n>0||i>1)&&s!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}function we(t,r,e){if(t.FullPaths){if(typeof e=="string"){var s;return Ae?s=Zt(e):s=Bd(e),Oe.utils.cfb_add(t,r,s)}Oe.utils.cfb_add(t,r,e)}else t.file(r,e)}function Sa(){return Oe.utils.cfb_new()}var qe=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,gf={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Na=_a(gf),ja=/[&<>'"]/g,vf=/[\u0000-\u0008\u000b-\u001f]/g;function Fe(t){var r=t+"";return r.replace(ja,function(e){return Na[e]}).replace(vf,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function _i(t){return Fe(t).replace(/ /g,"_x0020_")}var Io=/[\u0000-\u001f]/g;function yf(t){var r=t+"";return r.replace(ja,function(e){return Na[e]}).replace(/\n/g,"<br/>").replace(Io,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function bf(t){var r=t+"";return r.replace(ja,function(e){return Na[e]}).replace(Io,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function wf(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function _f(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function zn(t){for(var r="",e=0,s=0,n=0,i=0,o=0,l=0;e<t.length;){if(s=t.charCodeAt(e++),s<128){r+=String.fromCharCode(s);continue}if(n=t.charCodeAt(e++),s>191&&s<224){o=(s&31)<<6,o|=n&63,r+=String.fromCharCode(o);continue}if(i=t.charCodeAt(e++),s<240){r+=String.fromCharCode((s&15)<<12|(n&63)<<6|i&63);continue}o=t.charCodeAt(e++),l=((s&7)<<18|(n&63)<<12|(i&63)<<6|o&63)-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(l&1023))}return r}function Si(t){var r=br(2*t.length),e,s,n=1,i=0,o=0,l;for(s=0;s<t.length;s+=n)n=1,(l=t.charCodeAt(s))<128?e=l:l<224?(e=(l&31)*64+(t.charCodeAt(s+1)&63),n=2):l<240?(e=(l&15)*4096+(t.charCodeAt(s+1)&63)*64+(t.charCodeAt(s+2)&63),n=3):(n=4,e=(l&7)*262144+(t.charCodeAt(s+1)&63)*4096+(t.charCodeAt(s+2)&63)*64+(t.charCodeAt(s+3)&63),e-=65536,o=55296+(e>>>10&1023),e=56320+(e&1023)),o!==0&&(r[i++]=o&255,r[i++]=o>>>8,o=0),r[i++]=e%256,r[i++]=e>>>8;return r.slice(0,i).toString("ucs2")}function Ni(t){return Zt(t,"binary").toString("utf8")}var Bs="foo bar bazâð£",os=Ae&&(Ni(Bs)==zn(Bs)&&Ni||Si(Bs)==zn(Bs)&&Si)||zn,gs=Ae?function(t){return Zt(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,s=0,n=0;e<t.length;)switch(s=t.charCodeAt(e++),!0){case s<128:r.push(String.fromCharCode(s));break;case s<2048:r.push(String.fromCharCode(192+(s>>6))),r.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,n=t.charCodeAt(e++)-56320+(s<<10),r.push(String.fromCharCode(240+(n>>18&7))),r.push(String.fromCharCode(144+(n>>12&63))),r.push(String.fromCharCode(128+(n>>6&63))),r.push(String.fromCharCode(128+(n&63)));break;default:r.push(String.fromCharCode(224+(s>>12))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)))}return r.join("")},Sf=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var s=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),n=0;n<t.length;++n)s=s.replace(t[n][0],t[n][1]);return s}}(),Po=/(^\s|\s$|\n)/;function st(t,r){return"<"+t+(r.match(Po)?' xml:space="preserve"':"")+">"+r+"</"+t+">"}function vs(t){return at(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function ne(t,r,e){return"<"+t+(e!=null?vs(e):"")+(r!=null?(r.match(Po)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function ia(t,r){try{return t.toISOString().replace(/\.\d*/,"")}catch(e){if(r)throw e}return""}function Nf(t,r){switch(typeof t){case"string":var e=ne("vt:lpwstr",Fe(t));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return ne((t|0)==t?"vt:i4":"vt:r8",Fe(String(t)));case"boolean":return ne("vt:bool",t?"true":"false")}if(t instanceof Date)return ne("vt:filetime",ia(t));throw new Error("Unable to serialize "+t)}var Je={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Kr=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],St={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function jf(t,r){for(var e=1-2*(t[r+7]>>>7),s=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),n=t[r+6]&15,i=5;i>=0;--i)n=n*256+t[r+i];return s==2047?n==0?e*(1/0):NaN:(s==0?s=-1022:(s-=1023,n+=Math.pow(2,52)),e*Math.pow(2,s-52)*n)}function Ef(t,r,e){var s=(r<0||1/r==-1/0?1:0)<<7,n=0,i=0,o=s?-r:r;isFinite(o)?o==0?n=i=0:(n=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-n),n<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?n=-1022:(i-=Math.pow(2,52),n+=1023)):(n=2047,i=isNaN(r)?26985:0);for(var l=0;l<=5;++l,i/=256)t[e+l]=i&255;t[e+6]=(n&15)<<4|i&15,t[e+7]=n>>4|s}var ji=function(t){for(var r=[],e=10240,s=0;s<t[0].length;++s)if(t[0][s])for(var n=0,i=t[0][s].length;n<i;n+=e)r.push.apply(r,t[0][s].slice(n,n+e));return r},Ei=Ae?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:Zt(r)})):ji(t)}:ji,Ti=function(t,r,e){for(var s=[],n=r;n<e;n+=2)s.push(String.fromCharCode(ns(t,n)));return s.join("").replace(is,"")},Ea=Ae?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(is,""):Ti(t,r,e)}:Ti,Ci=function(t,r,e){for(var s=[],n=r;n<r+e;++n)s.push(("0"+t[n].toString(16)).slice(-2));return s.join("")},Lo=Ae?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):Ci(t,r,e)}:Ci,Ai=function(t,r,e){for(var s=[],n=r;n<e;n++)s.push(String.fromCharCode(Or(t,n)));return s.join("")},Es=Ae?function(r,e,s){return Buffer.isBuffer(r)?r.toString("utf8",e,s):Ai(r,e,s)}:Ai,Bo=function(t,r){var e=Nt(t,r);return e>0?Es(t,r+4,r+4+e-1):""},Mo=Bo,zo=function(t,r){var e=Nt(t,r);return e>0?Es(t,r+4,r+4+e-1):""},Uo=zo,$o=function(t,r){var e=2*Nt(t,r);return e>0?Es(t,r+4,r+4+e-1):""},Ho=$o,Wo=function(r,e){var s=Nt(r,e);return s>0?Ea(r,e+4,e+4+s):""},Go=Wo,Vo=function(t,r){var e=Nt(t,r);return e>0?Es(t,r+4,r+4+e):""},Xo=Vo,Ko=function(t,r){return jf(t,r)},sn=Ko,Ta=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Ae&&(Mo=function(r,e){if(!Buffer.isBuffer(r))return Bo(r,e);var s=r.readUInt32LE(e);return s>0?r.toString("utf8",e+4,e+4+s-1):""},Uo=function(r,e){if(!Buffer.isBuffer(r))return zo(r,e);var s=r.readUInt32LE(e);return s>0?r.toString("utf8",e+4,e+4+s-1):""},Ho=function(r,e){if(!Buffer.isBuffer(r))return $o(r,e);var s=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+s-1)},Go=function(r,e){if(!Buffer.isBuffer(r))return Wo(r,e);var s=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+s)},Xo=function(r,e){if(!Buffer.isBuffer(r))return Vo(r,e);var s=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+s)},sn=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):Ko(r,e)},Ta=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Or=function(t,r){return t[r]},ns=function(t,r){return t[r+1]*256+t[r]},Tf=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},Nt=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},gr=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},Cf=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function ls(t,r){var e="",s,n,i=[],o,l,c,f;switch(r){case"dbcs":if(f=this.l,Ae&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)e+=String.fromCharCode(ns(this,f)),f+=2;t*=2;break;case"utf8":e=Es(this,this.l,this.l+t);break;case"utf16le":t*=2,e=Ea(this,this.l,this.l+t);break;case"wstr":return ls.call(this,t,"dbcs");case"lpstr-ansi":e=Mo(this,this.l),t=4+Nt(this,this.l);break;case"lpstr-cp":e=Uo(this,this.l),t=4+Nt(this,this.l);break;case"lpwstr":e=Ho(this,this.l),t=4+2*Nt(this,this.l);break;case"lpp4":t=4+Nt(this,this.l),e=Go(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+Nt(this,this.l),e=Xo(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(o=Or(this,this.l+t++))!==0;)i.push(Is(o));e=i.join("");break;case"_wstr":for(t=0,e="";(o=ns(this,this.l+t))!==0;)i.push(Is(o)),t+=2;t+=2,e=i.join("");break;case"dbcs-cont":for(e="",f=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Or(this,f),this.l=f+1,l=ls.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Is(ns(this,f))),f+=2}e=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(e="",f=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(f)!==-1)return o=Or(this,f),this.l=f+1,l=ls.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Is(Or(this,f))),f+=1}e=i.join("");break;default:switch(t){case 1:return s=Or(this,this.l),this.l++,s;case 2:return s=(r==="i"?Tf:ns)(this,this.l),this.l+=2,s;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(s=(t>0?gr:Cf)(this,this.l),this.l+=4,s):(n=Nt(this,this.l),this.l+=4,n);case 8:case-8:if(r==="f")return t==8?n=sn(this,this.l):n=sn([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,n;t=8;case 16:e=Lo(this,this.l,t);break}}return this.l+=t,e}var Af=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},kf=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},Rf=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function Ff(t,r,e){var s=0,n=0;if(e==="dbcs"){for(n=0;n!=r.length;++n)Rf(this,r.charCodeAt(n),this.l+2*n);s=2*r.length}else if(e==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),n=0;n!=r.length;++n)this[this.l+n]=r.charCodeAt(n)&255;s=r.length}else if(e==="hex"){for(;n<t;++n)this[this.l++]=parseInt(r.slice(2*n,2*n+2),16)||0;return this}else if(e==="utf16le"){var i=Math.min(this.l+t,this.length);for(n=0;n<Math.min(r.length,t);++n){var o=r.charCodeAt(n);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:s=1,this[this.l]=r&255;break;case 2:s=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:s=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:s=4,Af(this,r,this.l);break;case 8:if(s=8,e==="f"){Ef(this,r,this.l);break}case 16:break;case-4:s=4,kf(this,r,this.l);break}return this.l+=s,this}function qo(t,r){var e=Lo(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function _t(t,r){t.l=r,t.read_shift=ls,t.chk=qo,t.write_shift=Ff}function $t(t,r){t.l+=r}function q(t){var r=br(t);return _t(r,0),r}function vt(){var t=[],r=Ae?256:2048,e=function(f){var d=q(f);return _t(d,0),d},s=e(r),n=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&t.push(s),s=null)},i=function(f){return s&&f<s.length-s.l?s:(n(),s=e(Math.max(f+1,r)))},o=function(){return n(),rt(t)},l=function(f){n(),s=f,s.l==null&&(s.l=s.length),i(r)};return{next:i,push:l,end:o,_bufs:t}}function ee(t,r,e,s){var n=+r,i;if(!isNaN(n)){s||(s=j1[n].p||(e||[]).length||0),i=1+(n>=128?1:0)+1,s>=128&&++i,s>=16384&&++i,s>=2097152&&++i;var o=t.next(i);n<=127?o.write_shift(1,n):(o.write_shift(1,(n&127)+128),o.write_shift(1,n>>7));for(var l=0;l!=4;++l)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&Ta(e)&&t.push(e)}}function cs(t,r,e){var s=bt(t);if(r.s?(s.cRel&&(s.c+=r.s.c),s.rRel&&(s.r+=r.s.r)):(s.cRel&&(s.c+=r.c),s.rRel&&(s.r+=r.r)),!e||e.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function ki(t,r,e){var s=bt(t);return s.s=cs(s.s,r.s,e),s.e=cs(s.e,r.s,e),s}function ds(t,r){if(t.cRel&&t.c<0)for(t=bt(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=bt(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=De(t);return!t.cRel&&t.cRel!=null&&(e=If(e)),!t.rRel&&t.rRel!=null&&(e=Df(e)),e}function Un(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ot(t.s.c)+":"+(t.e.cRel?"":"$")+ot(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+nt(t.s.r)+":"+(t.e.rRel?"":"$")+nt(t.e.r):ds(t.s,r.biff)+":"+ds(t.e,r.biff)}function Ca(t){return parseInt(Of(t),10)-1}function nt(t){return""+(t+1)}function Df(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Of(t){return t.replace(/\$(\d+)$/,"$1")}function Aa(t){for(var r=Pf(t),e=0,s=0;s!==r.length;++s)e=26*e+r.charCodeAt(s)-64;return e-1}function ot(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function If(t){return t.replace(/^([A-Z])/,"$$$1")}function Pf(t){return t.replace(/^\$([A-Z])/,"$1")}function Lf(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Qe(t){for(var r=0,e=0,s=0;s<t.length;++s){var n=t.charCodeAt(s);n>=48&&n<=57?r=10*r+(n-48):n>=65&&n<=90&&(e=26*e+(n-64))}return{c:e-1,r:r-1}}function De(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function jt(t){var r=t.indexOf(":");return r==-1?{s:Qe(t),e:Qe(t)}:{s:Qe(t.slice(0,r)),e:Qe(t.slice(r+1))}}function Ke(t,r){return typeof r>"u"||typeof r=="number"?Ke(t.s,t.e):(typeof t!="string"&&(t=De(t)),typeof r!="string"&&(r=De(r)),t==r?t:t+":"+r)}function Le(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,s=0,n=0,i=t.length;for(e=0;s<i&&!((n=t.charCodeAt(s)-64)<1||n>26);++s)e=26*e+n;for(r.s.c=--e,e=0;s<i&&!((n=t.charCodeAt(s)-48)<0||n>9);++s)e=10*e+n;if(r.s.r=--e,s===i||n!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++s,e=0;s!=i&&!((n=t.charCodeAt(s)-64)<1||n>26);++s)e=26*e+n;for(r.e.c=--e,e=0;s!=i&&!((n=t.charCodeAt(s)-48)<0||n>9);++s)e=10*e+n;return r.e.r=--e,r}function Ri(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=or(t.z,e?yt(r):r)}catch{}try{return t.w=or((t.XF||{}).numFmtId||(e?14:0),e?yt(r):r)}catch{return""+r}}function Qt(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?Ts[t.v]||t.v:r==null?Ri(t,t.v):Ri(t,r))}function Nr(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",s={};return s[e]=t,{SheetNames:[e],Sheets:s}}function Yo(t,r,e){var s=e||{},n=t?Array.isArray(t):s.dense,i=t||(n?[]:{}),o=0,l=0;if(i&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?Qe(s.origin):s.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var f={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Le(i["!ref"]);f.s.c=d.s.c,f.s.r=d.s.r,f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),o==-1&&(f.e.r=o=d.e.r+1)}for(var h=0;h!=r.length;++h)if(r[h]){if(!Array.isArray(r[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=r[h].length;++u)if(!(typeof r[h][u]>"u")){var m={v:r[h][u]},p=o+h,x=l+u;if(f.s.r>p&&(f.s.r=p),f.s.c>x&&(f.s.c=x),f.e.r<p&&(f.e.r=p),f.e.c<x&&(f.e.c=x),r[h][u]&&typeof r[h][u]=="object"&&!Array.isArray(r[h][u])&&!(r[h][u]instanceof Date))m=r[h][u];else if(Array.isArray(m.v)&&(m.f=r[h][u][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(s.nullError)m.t="e",m.v=0;else if(s.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=s.dateNF||Ge[14],s.cellDates?(m.t="d",m.w=or(m.z,yt(m.v))):(m.t="n",m.v=yt(m.v),m.w=or(m.z,m.v))):m.t="s";if(n)i[p]||(i[p]=[]),i[p][x]&&i[p][x].z&&(m.z=i[p][x].z),i[p][x]=m;else{var g=De({c:x,r:p});i[g]&&i[g].z&&(m.z=i[g].z),i[g]=m}}}return f.s.c<1e7&&(i["!ref"]=Ke(f)),i}function qr(t,r){return Yo(null,t,r)}function Bf(t){return t.read_shift(4,"i")}function Lt(t,r){return r||(r=q(4)),r.write_shift(4,t),r}function lt(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function Ze(t,r){var e=!1;return r==null&&(e=!0,r=q(4+2*t.length)),r.write_shift(4,t.length),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}function Mf(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function zf(t,r){return r||(r=q(4)),r.write_shift(2,0),r.write_shift(2,0),r}function ka(t,r){var e=t.l,s=t.read_shift(1),n=lt(t),i=[],o={t:n,h:n};if(s&1){for(var l=t.read_shift(4),c=0;c!=l;++c)i.push(Mf(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=e+r,o}function Uf(t,r){var e=!1;return r==null&&(e=!0,r=q(15+4*t.t.length)),r.write_shift(1,0),Ze(t.t,r),e?r.slice(0,r.l):r}var $f=ka;function Hf(t,r){var e=!1;return r==null&&(e=!0,r=q(23+4*t.t.length)),r.write_shift(1,1),Ze(t.t,r),r.write_shift(4,1),zf({},r),e?r.slice(0,r.l):r}function kt(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function jr(t,r){return r==null&&(r=q(8)),r.write_shift(-4,t.c),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}function Er(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}function Tr(t,r){return r==null&&(r=q(4)),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}var Wf=lt,Jo=Ze;function Ra(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}function nn(t,r){var e=!1;return r==null&&(e=!0,r=q(127)),r.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}var Gf=lt,oa=Ra,Fa=nn;function Qo(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,s=r[0]&2;t.l+=4;var n=s===0?sn([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):gr(r,0)>>2;return e?n/100:n}function Zo(t,r){r==null&&(r=q(4));var e=0,s=0,n=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?s=1:n==(n|0)&&n>=-536870912&&n<1<<29&&(s=1,e=1),s)r.write_shift(-4,((e?n:t)<<2)+(e+2));else throw new Error("unsupported RkNumber "+t)}function el(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}function Vf(t,r){return r||(r=q(16)),r.write_shift(4,t.s.r),r.write_shift(4,t.e.r),r.write_shift(4,t.s.c),r.write_shift(4,t.e.c),r}var Cr=el,Yr=Vf;function Jr(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function wr(t,r){return(r||q(8)).write_shift(8,t,"f")}function Xf(t){var r={},e=t.read_shift(1),s=e>>>1,n=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,s){case 0:r.auto=1;break;case 1:r.index=n;var f=rh[n];f&&(r.rgb=$i(f));break;case 2:r.rgb=$i([o,l,c]);break;case 3:r.theme=n;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function an(t,r){if(r||(r=q(8)),!t||t.auto)return r.write_shift(4,0),r.write_shift(4,0),r;t.index!=null?(r.write_shift(1,2),r.write_shift(1,t.index)):t.theme!=null?(r.write_shift(1,6),r.write_shift(1,t.theme)):(r.write_shift(1,5),r.write_shift(1,0));var e=t.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),r.write_shift(2,e),!t.rgb||t.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var s=t.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),r.write_shift(1,parseInt(s.slice(0,2),16)),r.write_shift(1,parseInt(s.slice(2,4),16)),r.write_shift(1,parseInt(s.slice(4,6),16)),r.write_shift(1,255)}return r}function Kf(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function qf(t,r){r||(r=q(2));var e=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return r.write_shift(1,e),r.write_shift(1,0),r}var tl=2,wt=3,Ms=11,on=19,zs=64,Yf=65,Jf=71,Qf=4108,Zf=4126,tt=80,Fi={1:{n:"CodePage",t:tl},2:{n:"Category",t:tt},3:{n:"PresentationFormat",t:tt},4:{n:"ByteCount",t:wt},5:{n:"LineCount",t:wt},6:{n:"ParagraphCount",t:wt},7:{n:"SlideCount",t:wt},8:{n:"NoteCount",t:wt},9:{n:"HiddenCount",t:wt},10:{n:"MultimediaClipCount",t:wt},11:{n:"ScaleCrop",t:Ms},12:{n:"HeadingPairs",t:Qf},13:{n:"TitlesOfParts",t:Zf},14:{n:"Manager",t:tt},15:{n:"Company",t:tt},16:{n:"LinksUpToDate",t:Ms},17:{n:"CharacterCount",t:wt},19:{n:"SharedDoc",t:Ms},22:{n:"HyperlinksChanged",t:Ms},23:{n:"AppVersion",t:wt,p:"version"},24:{n:"DigSig",t:Yf},26:{n:"ContentType",t:tt},27:{n:"ContentStatus",t:tt},28:{n:"Language",t:tt},29:{n:"Version",t:tt},255:{},2147483648:{n:"Locale",t:on},2147483651:{n:"Behavior",t:on},1919054434:{}},Di={1:{n:"CodePage",t:tl},2:{n:"Title",t:tt},3:{n:"Subject",t:tt},4:{n:"Author",t:tt},5:{n:"Keywords",t:tt},6:{n:"Comments",t:tt},7:{n:"Template",t:tt},8:{n:"LastAuthor",t:tt},9:{n:"RevNumber",t:tt},10:{n:"EditTime",t:zs},11:{n:"LastPrinted",t:zs},12:{n:"CreatedDate",t:zs},13:{n:"ModifiedDate",t:zs},14:{n:"PageCount",t:wt},15:{n:"WordCount",t:wt},16:{n:"CharCount",t:wt},17:{n:"Thumbnail",t:Jf},18:{n:"Application",t:tt},19:{n:"DocSecurity",t:wt},255:{},2147483648:{n:"Locale",t:on},2147483651:{n:"Behavior",t:on},1919054434:{}};function eh(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var th=eh([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),rh=bt(th),Ts={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},sh={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Us={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function rl(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function sl(t,r){var e=uf(sh),s=[],n;s[s.length]=qe,s[s.length]=ne("Types",null,{xmlns:Je.CT,"xmlns:xsd":Je.xsd,"xmlns:xsi":Je.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ne("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){t[c]&&t[c].length>0&&(n=t[c][0],s[s.length]=ne("Override",null,{PartName:(n[0]=="/"?"":"/")+n,ContentType:Us[c][r.bookType]||Us[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(f){s[s.length]=ne("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:Us[c][r.bookType]||Us[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(f){s[s.length]=ne("Override",null,{PartName:(f[0]=="/"?"":"/")+f,ContentType:e[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var Te={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function nl(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function Lr(t){var r=[qe,ne("Relationships",null,{xmlns:Je.RELS})];return at(t["!id"]).forEach(function(e){r[r.length]=ne("Relationship",null,t["!id"][e])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Re(t,r,e,s,n,i){if(n||(n={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),r<0)for(r=t["!idx"];t["!id"]["rId"+r];++r);if(t["!idx"]=r+1,n.Id="rId"+r,n.Type=s,n.Target=e,[Te.HLINK,Te.XPATH,Te.XMISS].indexOf(n.Type)>-1&&(n.TargetMode="External"),t["!id"][n.Id])throw new Error("Cannot rewrite rId "+r);return t["!id"][n.Id]=n,t[("/"+n.Target).replace("//","/")]=n,r}function nh(t){var r=[qe];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<t.length;++e)r.push('  <manifest:file-entry manifest:full-path="'+t[e][0]+'" manifest:media-type="'+t[e][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Oi(t,r,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function ah(t,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function ih(t){var r=[qe];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=t.length;++e)r.push(Oi(t[e][0],t[e][1])),r.push(ah("",t[e][0]));return r.push(Oi("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function al(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Js.version+"</meta:generator></office:meta></office:document-meta>"}var vr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function $n(t,r,e,s,n){n[t]!=null||r==null||r===""||(n[t]=r,r=Fe(r),s[s.length]=e?ne(t,r,e):st(t,r))}function il(t,r){var e=r||{},s=[qe,ne("cp:coreProperties",null,{"xmlns:cp":Je.CORE_PROPS,"xmlns:dc":Je.dc,"xmlns:dcterms":Je.dcterms,"xmlns:dcmitype":Je.dcmitype,"xmlns:xsi":Je.xsi})],n={};if(!t&&!e.Props)return s.join("");t&&(t.CreatedDate!=null&&$n("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:ia(t.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n),t.ModifiedDate!=null&&$n("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:ia(t.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},s,n));for(var i=0;i!=vr.length;++i){var o=vr[i],l=e.Props&&e.Props[o[1]]!=null?e.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&$n(o[0],l,null,s,n)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Br=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ol=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function ll(t){var r=[],e=ne;return t||(t={}),t.Application="SheetJS",r[r.length]=qe,r[r.length]=ne("Properties",null,{xmlns:Je.EXT_PROPS,"xmlns:vt":Je.vt}),Br.forEach(function(s){if(t[s[1]]!==void 0){var n;switch(s[2]){case"string":n=Fe(String(t[s[1]]));break;case"bool":n=t[s[1]]?"true":"false";break}n!==void 0&&(r[r.length]=e(s[0],n))}}),r[r.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=e("TitlesOfParts",e("vt:vector",t.SheetNames.map(function(s){return"<vt:lpstr>"+Fe(s)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function cl(t){var r=[qe,ne("Properties",null,{xmlns:Je.CUST_PROPS,"xmlns:vt":Je.vt})];if(!t)return r.join("");var e=1;return at(t).forEach(function(n){++e,r[r.length]=ne("property",Nf(t[n]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Fe(n)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Ii={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function oh(t,r){var e=[];return at(Ii).map(function(s){for(var n=0;n<vr.length;++n)if(vr[n][1]==s)return vr[n];for(n=0;n<Br.length;++n)if(Br[n][1]==s)return Br[n];throw s}).forEach(function(s){if(t[s[1]]!=null){var n=r&&r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:t[s[1]];switch(s[2]){case"date":n=new Date(n).toISOString().replace(/\.\d*Z/,"Z");break}typeof n=="number"?n=String(n):n===!0||n===!1?n=n?"1":"0":n instanceof Date&&(n=new Date(n).toISOString().replace(/\.\d*Z/,"")),e.push(st(Ii[s[1]]||s[1],n))}}),ne("DocumentProperties",e.join(""),{xmlns:St.o})}function lh(t,r){var e=["Worksheets","SheetNames"],s="CustomDocumentProperties",n=[];return t&&at(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<vr.length;++o)if(i==vr[o][1])return;for(o=0;o<Br.length;++o)if(i==Br[o][1])return;for(o=0;o<e.length;++o)if(i==e[o])return;var l=t[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),n.push(ne(_i(i),l,{"dt:dt":c}))}}),r&&at(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=r[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),n.push(ne(_i(i),o,{"dt:dt":l}))}}),"<"+s+' xmlns="'+St.o+'">'+n.join("")+"</"+s+">"}function ch(t){var r=typeof t=="string"?new Date(Date.parse(t)):t,e=r.getTime()/1e3+11644473600,s=e%Math.pow(2,32),n=(e-s)/Math.pow(2,32);s*=1e7,n*=1e7;var i=s/Math.pow(2,32)|0;i>0&&(s=s%Math.pow(2,32),n+=i);var o=q(8);return o.write_shift(4,s),o.write_shift(4,n),o}function Pi(t,r){var e=q(4),s=q(4);switch(e.write_shift(4,t==80?31:t),t){case 3:s.write_shift(-4,r);break;case 5:s=q(8),s.write_shift(8,r,"f");break;case 11:s.write_shift(4,r?1:0);break;case 64:s=ch(r);break;case 31:case 80:for(s=q(4+2*(r.length+1)+(r.length%2?0:2)),s.write_shift(4,r.length+1),s.write_shift(0,r,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}return rt([e,s])}var dl=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function dh(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Li(t,r,e){var s=q(8),n=[],i=[],o=8,l=0,c=q(8),f=q(8);if(c.write_shift(4,2),c.write_shift(4,1200),f.write_shift(4,1),i.push(c),n.push(f),o+=8+c.length,!r){f=q(8),f.write_shift(4,0),n.unshift(f);var d=[q(4)];for(d[0].write_shift(4,t.length),l=0;l<t.length;++l){var h=t[l][0];for(c=q(8+2*(h.length+1)+(h.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,h.length+1),c.write_shift(0,h,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=rt(d),i.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(r&&!r[t[l][0]])&&!(dl.indexOf(t[l][0])>-1||ol.indexOf(t[l][0])>-1)&&t[l][1]!=null){var u=t[l][1],m=0;if(r){m=+r[t[l][0]];var p=e[m];if(p.p=="version"&&typeof u=="string"){var x=u.split(".");u=(+x[0]<<16)+(+x[1]||0)}c=Pi(p.t,u)}else{var g=dh(u);g==-1&&(g=31,u=String(u)),c=Pi(g,u)}i.push(c),f=q(8),f.write_shift(4,r?m:2+l),n.push(f),o+=8+c.length}var T=8*(i.length+1);for(l=0;l<i.length;++l)n[l].write_shift(4,T),T+=i[l].length;return s.write_shift(4,o),s.write_shift(4,i.length),rt([s].concat(n).concat(i))}function Bi(t,r,e,s,n,i){var o=q(n?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Oe.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,n?2:1),o.write_shift(16,r,"hex"),o.write_shift(4,n?68:48);var c=Li(t,e,s);if(l.push(c),n){var f=Li(n,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(f)}return rt(l)}function fh(t,r){r||(r=q(t));for(var e=0;e<t;++e)r.write_shift(1,0);return r}function hh(t,r){return t.read_shift(r)===1}function ut(t,r){return r||(r=q(2)),r.write_shift(2,+!!t),r}function fl(t){return t.read_shift(2,"u")}function Ct(t,r){return r||(r=q(2)),r.write_shift(2,t),r}function hl(t,r,e){return e||(e=q(2)),e.write_shift(1,r=="e"?+t:+!!t),e.write_shift(1,r=="e"?1:0),e}function ul(t,r,e){var s=t.read_shift(e&&e.biff>=12?2:1),n="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var i=t.read_shift(1);i&&(n="dbcs-cont")}else e.biff==12&&(n="wstr");e.biff>=2&&e.biff<=5&&(n="cpstr");var o=s?t.read_shift(s,n):"";return o}function uh(t){var r=t.t||"",e=q(3);e.write_shift(2,r.length),e.write_shift(1,1);var s=q(2*r.length);s.write_shift(2*r.length,r,"utf16le");var n=[e,s];return rt(n)}function xh(t,r,e){var s;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var n=t.read_shift(1);return n===0?s=t.read_shift(r,"sbcs-cont"):s=t.read_shift(r,"dbcs-cont"),s}function mh(t,r,e){var s=t.read_shift(e&&e.biff==2?1:2);return s===0?(t.l++,""):xh(t,s,e)}function ph(t,r,e){if(e.biff>5)return mh(t,r,e);var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function xl(t,r,e){return e||(e=q(3+2*t.length)),e.write_shift(2,t.length),e.write_shift(1,1),e.write_shift(31,t,"utf16le"),e}function Mi(t,r){r||(r=q(6+t.length*2)),r.write_shift(4,1+t.length);for(var e=0;e<t.length;++e)r.write_shift(2,t.charCodeAt(e));return r.write_shift(2,0),r}function gh(t){var r=q(512),e=0,s=t.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var n=s.indexOf("#"),i=n>-1?31:23;switch(s.charAt(0)){case"#":i=28;break;case".":i&=-3;break}r.write_shift(4,2),r.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(e=0;e<o.length;++e)r.write_shift(4,o[e]);if(i==28)s=s.slice(1),Mi(s,r);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<o.length;++e)r.write_shift(1,parseInt(o[e],16));var l=n>-1?s.slice(0,n):s;for(r.write_shift(4,2*(l.length+1)),e=0;e<l.length;++e)r.write_shift(2,l.charCodeAt(e));r.write_shift(2,0),i&8&&Mi(n>-1?s.slice(n+1):"",r)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<o.length;++e)r.write_shift(1,parseInt(o[e],16));for(var c=0;s.slice(c*3,c*3+3)=="../"||s.slice(c*3,c*3+3)=="..\\";)++c;for(r.write_shift(2,c),r.write_shift(4,s.length-3*c+1),e=0;e<s.length-3*c;++e)r.write_shift(1,s.charCodeAt(e+3*c)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),e=0;e<6;++e)r.write_shift(4,0)}return r.slice(0,r.l)}function _r(t,r,e,s){return s||(s=q(6)),s.write_shift(2,t),s.write_shift(2,r),s.write_shift(2,e||0),s}function vh(t,r,e){var s=e.biff>8?4:2,n=t.read_shift(s),i=t.read_shift(s,"i"),o=t.read_shift(s,"i");return[n,i,o]}function yh(t){var r=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(2),n=t.read_shift(2);return{s:{c:s,r},e:{c:n,r:e}}}function ml(t,r){return r||(r=q(8)),r.write_shift(2,t.s.r),r.write_shift(2,t.e.r),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c),r}function Da(t,r,e){var s=1536,n=16;switch(e.bookType){case"biff8":break;case"biff5":s=1280,n=8;break;case"biff4":s=4,n=6;break;case"biff3":s=3,n=6;break;case"biff2":s=2,n=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=q(n);return i.write_shift(2,s),i.write_shift(2,r),n>4&&i.write_shift(2,29282),n>6&&i.write_shift(2,1997),n>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function bh(t,r){var e=!r||r.biff==8,s=q(e?112:54);for(s.write_shift(r.biff==8?2:1,7),e&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(e?0:536870912));s.l<s.length;)s.write_shift(1,e?0:32);return s}function wh(t,r){var e=!r||r.biff>=8?2:1,s=q(8+e*t.name.length);s.write_shift(4,t.pos),s.write_shift(1,t.hs||0),s.write_shift(1,t.dt),s.write_shift(1,t.name.length),r.biff>=8&&s.write_shift(1,1),s.write_shift(e*t.name.length,t.name,r.biff<8?"sbcs":"utf16le");var n=s.slice(0,s.l);return n.l=s.l,n}function _h(t,r){var e=q(8);e.write_shift(4,t.Count),e.write_shift(4,t.Unique);for(var s=[],n=0;n<t.length;++n)s[n]=uh(t[n]);var i=rt([e].concat(s));return i.parts=[e.length].concat(s.map(function(o){return o.length})),i}function Sh(){var t=q(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Nh(t){var r=q(18),e=1718;return t&&t.RTL&&(e|=64),r.write_shift(2,e),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function jh(t,r){var e=t.name||"Arial",s=r&&r.biff==5,n=s?15+e.length:16+2*e.length,i=q(n);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,e.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le"),i}function Eh(t,r,e,s){var n=q(10);return _r(t,r,s,n),n.write_shift(4,e),n}function Th(t,r,e,s,n){var i=!n||n.biff==8,o=q(8+ +i+(1+i)*e.length);return _r(t,r,s,o),o.write_shift(2,e.length),i&&o.write_shift(1,1),o.write_shift((1+i)*e.length,e,i?"utf16le":"sbcs"),o}function Ch(t,r,e,s){var n=e&&e.biff==5;s||(s=q(n?3+r.length:5+2*r.length)),s.write_shift(2,t),s.write_shift(n?1:2,r.length),n||s.write_shift(1,1),s.write_shift((n?1:2)*r.length,r,n?"sbcs":"utf16le");var i=s.length>s.l?s.slice(0,s.l):s;return i.l==null&&(i.l=i.length),i}function Ah(t,r){var e=r.biff==8||!r.biff?4:2,s=q(2*e+6);return s.write_shift(e,t.s.r),s.write_shift(e,t.e.r+1),s.write_shift(2,t.s.c),s.write_shift(2,t.e.c+1),s.write_shift(2,0),s}function zi(t,r,e,s){var n=e&&e.biff==5;s||(s=q(n?16:20)),s.write_shift(2,0),t.style?(s.write_shift(2,t.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,t.numFmtId||0),s.write_shift(2,r<<4));var i=0;return t.numFmtId>0&&n&&(i|=1024),s.write_shift(4,i),s.write_shift(4,0),n||s.write_shift(4,0),s.write_shift(2,0),s}function kh(t){var r=q(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function Rh(t,r,e,s,n,i){var o=q(8);return _r(t,r,s,o),hl(e,i,o),o}function Fh(t,r,e,s){var n=q(14);return _r(t,r,s,n),wr(e,n),n}function Dh(t,r,e){if(e.biff<8)return Oh(t,r,e);for(var s=[],n=t.l+r,i=t.read_shift(e.biff>8?4:2);i--!==0;)s.push(vh(t,e.biff>8?12:6,e));if(t.l!=n)throw new Error("Bad ExternSheet: "+t.l+" != "+n);return s}function Oh(t,r,e){t[t.l+1]==3&&t[t.l]++;var s=ul(t,r,e);return s.charCodeAt(0)==3?s.slice(1):s}function Ih(t){var r=q(2+t.length*8);r.write_shift(2,t.length);for(var e=0;e<t.length;++e)ml(t[e],r);return r}function Ph(t){var r=q(24),e=Qe(t[0]);r.write_shift(2,e.r),r.write_shift(2,e.r),r.write_shift(2,e.c),r.write_shift(2,e.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<16;++n)r.write_shift(1,parseInt(s[n],16));return rt([r,gh(t[1])])}function Lh(t){var r=t[1].Tooltip,e=q(10+2*(r.length+1));e.write_shift(2,2048);var s=Qe(t[0]);e.write_shift(2,s.r),e.write_shift(2,s.r),e.write_shift(2,s.c),e.write_shift(2,s.c);for(var n=0;n<r.length;++n)e.write_shift(2,r.charCodeAt(n));return e.write_shift(2,0),e}function Bh(t){return t||(t=q(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Mh(t,r,e){if(!e.cellStyles)return $t(t,r);var s=e&&e.biff>=12?4:2,n=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(s),l=t.read_shift(s),c=t.read_shift(2);s==2&&(t.l+=2);var f={s:n,e:i,w:o,ixfe:l,flags:c};return(e.biff>=5||!e.biff)&&(f.level=c>>8&7),f}function zh(t,r){var e=q(12);e.write_shift(2,r),e.write_shift(2,r),e.write_shift(2,t.width*256),e.write_shift(2,0);var s=0;return t.hidden&&(s|=1),e.write_shift(1,s),s=t.level||0,e.write_shift(1,s),e.write_shift(2,0),e}function Uh(t){for(var r=q(2*t),e=0;e<t;++e)r.write_shift(2,e+1);return r}function $h(t,r,e){var s=q(15);return As(s,t,r),s.write_shift(8,e,"f"),s}function Hh(t,r,e){var s=q(9);return As(s,t,r),s.write_shift(2,e),s}var Wh=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=_a({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,c){var f=[],d=br(1);switch(c.type){case"base64":d=It(Jt(l));break;case"binary":d=It(l);break;case"buffer":case"array":d=l;break}_t(d,0);var h=d.read_shift(1),u=!!(h&136),m=!1,p=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,u=!0;break;case 49:m=!0,u=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var x=0,g=521;h==2&&(x=d.read_shift(2)),d.l+=3,h!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),h!=2&&(g=d.read_shift(2));var T=d.read_shift(2),_=c.codepage||1252;h!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(_=t[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var S=[],A={},D=Math.min(d.length,h==2?521:g-10-(m?264:0)),z=p?32:11;d.l<D&&d[d.l]!=13;)switch(A={},A.name=Qs.utils.decode(_,d.slice(d.l,d.l+z)).replace(/[\u0000\r\n].*$/g,""),d.l+=z,A.type=String.fromCharCode(d.read_shift(1)),h!=2&&!p&&(A.offset=d.read_shift(4)),A.len=d.read_shift(1),h==2&&(A.offset=d.read_shift(2)),A.dec=d.read_shift(1),A.name.length&&S.push(A),h!=2&&(d.l+=p?13:14),A.type){case"B":(!m||A.len!=8)&&c.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var C=0,I=0;for(f[0]=[],I=0;I!=S.length;++I)f[0][I]=S[I].name;for(;x-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,f[++C]=[],I=0,I=0;I!=S.length;++I){var O=d.slice(d.l,d.l+S[I].len);d.l+=S[I].len,_t(O,0);var P=Qs.utils.decode(_,O);switch(S[I].type){case"C":P.trim().length&&(f[C][I]=P.replace(/\s+$/,""));break;case"D":P.length===8?f[C][I]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):f[C][I]=P;break;case"F":f[C][I]=parseFloat(P.trim());break;case"+":case"I":f[C][I]=p?O.read_shift(-4,"i")^2147483648:O.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":f[C][I]=!0;break;case"N":case"F":f[C][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));f[C][I]="##MEMO##"+(p?parseInt(P.trim(),10):O.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(f[C][I]=+P||0);break;case"@":f[C][I]=new Date(O.read_shift(-8,"f")-621356832e5);break;case"T":f[C][I]=new Date((O.read_shift(4)-2440588)*864e5+O.read_shift(4));break;case"Y":f[C][I]=O.read_shift(4,"i")/1e4+O.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":f[C][I]=-O.read_shift(-8,"f");break;case"B":if(m&&S[I].len==8){f[C][I]=O.read_shift(8,"f");break}case"G":case"P":O.l+=S[I].len;break;case"0":if(S[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+S[I].type)}}}if(h!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(f=f.slice(0,c.sheetRows)),c.DBF=S,f}function s(l,c){var f=c||{};f.dateNF||(f.dateNF="yyyymmdd");var d=qr(e(l,f),f);return d["!cols"]=f.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete f.DBF,d}function n(l,c){try{return Nr(s(l,c),c)}catch(f){if(c&&c.WTF)throw f}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var f=c||{};if(+f.codepage>=0&&xs(+f.codepage),f.type=="string")throw new Error("Cannot write DBF to JS string");var d=vt(),h=hn(l,{header:1,raw:!0,cellDates:!0}),u=h[0],m=h.slice(1),p=l["!cols"]||[],x=0,g=0,T=0,_=1;for(x=0;x<u.length;++x){if(((p[x]||{}).DBF||{}).name){u[x]=p[x].DBF.name,++T;continue}if(u[x]!=null){if(++T,typeof u[x]=="number"&&(u[x]=u[x].toString(10)),typeof u[x]!="string")throw new Error("DBF Invalid column name "+u[x]+" |"+typeof u[x]+"|");if(u.indexOf(u[x])!==x){for(g=0;g<1024;++g)if(u.indexOf(u[x]+"_"+g)==-1){u[x]+="_"+g;break}}}}var S=Le(l["!ref"]),A=[],D=[],z=[];for(x=0;x<=S.e.c-S.s.c;++x){var C="",I="",O=0,P=[];for(g=0;g<m.length;++g)m[g][x]!=null&&P.push(m[g][x]);if(P.length==0||u[x]==null){A[x]="?";continue}for(g=0;g<P.length;++g){switch(typeof P[g]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=P[g]instanceof Date?"D":"C";break;default:I="C"}O=Math.max(O,String(P[g]).length),C=C&&C!=I?"C":I}O>250&&(O=250),I=((p[x]||{}).DBF||{}).type,I=="C"&&p[x].DBF.len>O&&(O=p[x].DBF.len),C=="B"&&I=="N"&&(C="N",z[x]=p[x].DBF.dec,O=p[x].DBF.len),D[x]=C=="C"||I=="N"?O:i[C]||0,_+=D[x],A[x]=C}var H=d.next(32);for(H.write_shift(4,318902576),H.write_shift(4,m.length),H.write_shift(2,296+32*T),H.write_shift(2,_),x=0;x<4;++x)H.write_shift(4,0);for(H.write_shift(4,0|(+r[go]||3)<<8),x=0,g=0;x<u.length;++x)if(u[x]!=null){var W=d.next(32),te=(u[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);W.write_shift(1,te,"sbcs"),W.write_shift(1,A[x]=="?"?"C":A[x],"sbcs"),W.write_shift(4,g),W.write_shift(1,D[x]||i[A[x]]||0),W.write_shift(1,z[x]||0),W.write_shift(1,2),W.write_shift(4,0),W.write_shift(1,0),W.write_shift(4,0),W.write_shift(4,0),g+=D[x]||i[A[x]]||0}var pe=d.next(264);for(pe.write_shift(4,13),x=0;x<65;++x)pe.write_shift(4,0);for(x=0;x<m.length;++x){var me=d.next(_);for(me.write_shift(1,0),g=0;g<u.length;++g)if(u[g]!=null)switch(A[g]){case"L":me.write_shift(1,m[x][g]==null?63:m[x][g]?84:70);break;case"B":me.write_shift(8,m[x][g]||0,"f");break;case"N":var Ne="0";for(typeof m[x][g]=="number"&&(Ne=m[x][g].toFixed(z[g]||0)),T=0;T<D[g]-Ne.length;++T)me.write_shift(1,32);me.write_shift(1,Ne,"sbcs");break;case"D":m[x][g]?(me.write_shift(4,("0000"+m[x][g].getFullYear()).slice(-4),"sbcs"),me.write_shift(2,("00"+(m[x][g].getMonth()+1)).slice(-2),"sbcs"),me.write_shift(2,("00"+m[x][g].getDate()).slice(-2),"sbcs")):me.write_shift(8,"00000000","sbcs");break;case"C":var ve=String(m[x][g]!=null?m[x][g]:"").slice(0,D[g]);for(me.write_shift(1,ve,"sbcs"),T=0;T<D[g]-ve.length;++T)me.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:n,to_sheet:s,from_sheet:o}}(),Gh=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+at(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(u,m){var p=t[m];return typeof p=="number"?di(p):p},s=function(u,m,p){var x=m.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?u:di(x)};t["|"]=254;function n(u,m){switch(m.type){case"base64":return i(Jt(u),m);case"binary":return i(u,m);case"buffer":return i(Ae&&Buffer.isBuffer(u)?u.toString("binary"):Ns(u),m);case"array":return i(jn(u),m)}throw new Error("Unrecognized type "+m.type)}function i(u,m){var p=u.split(/[\n\r]+/),x=-1,g=-1,T=0,_=0,S=[],A=[],D=null,z={},C=[],I=[],O=[],P=0,H;for(+m.codepage>=0&&xs(+m.codepage);T!==p.length;++T){P=0;var W=p[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(r,e),te=W.replace(/;;/g,"\0").split(";").map(function(y){return y.replace(/\u0000/g,";")}),pe=te[0],me;if(W.length>0)switch(pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":te[1].charAt(0)=="P"&&A.push(W.slice(3).replace(/;;/g,";"));break;case"C":var Ne=!1,ve=!1,je=!1,ce=!1,xe=-1,_e=-1;for(_=1;_<te.length;++_)switch(te[_].charAt(0)){case"A":break;case"X":g=parseInt(te[_].slice(1))-1,ve=!0;break;case"Y":for(x=parseInt(te[_].slice(1))-1,ve||(g=0),H=S.length;H<=x;++H)S[H]=[];break;case"K":me=te[_].slice(1),me.charAt(0)==='"'?me=me.slice(1,me.length-1):me==="TRUE"?me=!0:me==="FALSE"?me=!1:isNaN(qt(me))?isNaN(ps(me).getDate())||(me=xt(me)):(me=qt(me),D!==null&&Ao(D)&&(me=Do(me))),Ne=!0;break;case"E":ce=!0;var b=Hu(te[_].slice(1),{r:x,c:g});S[x][g]=[S[x][g],b];break;case"S":je=!0,S[x][g]=[S[x][g],"S5S"];break;case"G":break;case"R":xe=parseInt(te[_].slice(1))-1;break;case"C":_e=parseInt(te[_].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+W)}if(Ne&&(S[x][g]&&S[x][g].length==2?S[x][g][0]=me:S[x][g]=me,D=null),je){if(ce)throw new Error("SYLK shared formula cannot have own formula");var w=xe>-1&&S[xe][_e];if(!w||!w[1])throw new Error("SYLK shared formula cannot find base");S[x][g][1]=Wu(w[1],{r:x-xe,c:g-_e})}break;case"F":var j=0;for(_=1;_<te.length;++_)switch(te[_].charAt(0)){case"X":g=parseInt(te[_].slice(1))-1,++j;break;case"Y":for(x=parseInt(te[_].slice(1))-1,H=S.length;H<=x;++H)S[H]=[];break;case"M":P=parseInt(te[_].slice(1))/20;break;case"F":break;case"G":break;case"P":D=A[parseInt(te[_].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(O=te[_].slice(1).split(" "),H=parseInt(O[0],10);H<=parseInt(O[1],10);++H)P=parseInt(O[2],10),I[H-1]=P===0?{hidden:!0}:{wch:P},Oa(I[H-1]);break;case"C":g=parseInt(te[_].slice(1))-1,I[g]||(I[g]={});break;case"R":x=parseInt(te[_].slice(1))-1,C[x]||(C[x]={}),P>0?(C[x].hpt=P,C[x].hpx=bl(P)):P===0&&(C[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+W)}j<1&&(D=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+W)}}return C.length>0&&(z["!rows"]=C),I.length>0&&(z["!cols"]=I),m&&m.sheetRows&&(S=S.slice(0,m.sheetRows)),[S,z]}function o(u,m){var p=n(u,m),x=p[0],g=p[1],T=qr(x,m);return at(g).forEach(function(_){T[_]=g[_]}),T}function l(u,m){return Nr(o(u,m),m)}function c(u,m,p,x){var g="C;Y"+(p+1)+";X"+(x+1)+";K";switch(u.t){case"n":g+=u.v||0,u.f&&!u.F&&(g+=";E"+Pa(u.f,{r:p,c:x}));break;case"b":g+=u.v?"TRUE":"FALSE";break;case"e":g+=u.w||u.v;break;case"d":g+='"'+(u.w||u.v)+'"';break;case"s":g+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function f(u,m){m.forEach(function(p,x){var g="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=ln(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=cn(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&u.push(g)})}function d(u,m){m.forEach(function(p,x){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*dn(p.hpx)+";"),g.length>2&&u.push(g+"R"+(x+1))})}function h(u,m){var p=["ID;PWXL;N;E"],x=[],g=Le(u["!ref"]),T,_=Array.isArray(u),S=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),u["!cols"]&&f(p,u["!cols"]),u["!rows"]&&d(p,u["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var A=g.s.r;A<=g.e.r;++A)for(var D=g.s.c;D<=g.e.c;++D){var z=De({r:A,c:D});T=_?(u[A]||[])[D]:u[z],!(!T||T.v==null&&(!T.f||T.F))&&x.push(c(T,u,A,D))}return p.join(S)+S+x.join(S)+S+"E"+S}return{to_workbook:l,to_sheet:o,from_sheet:h}}(),Vh=function(){function t(i,o){switch(o.type){case"base64":return r(Jt(i),o);case"binary":return r(i,o);case"buffer":return r(Ae&&Buffer.isBuffer(i)?i.toString("binary"):Ns(i),o);case"array":return r(jn(i),o)}throw new Error("Unrecognized type "+o.type)}function r(i,o){for(var l=i.split(`
`),c=-1,f=-1,d=0,h=[];d!==l.length;++d){if(l[d].trim()==="BOT"){h[++c]=[],f=0;continue}if(!(c<0)){var u=l[d].trim().split(","),m=u[0],p=u[1];++d;for(var x=l[d]||"";(x.match(/["]/g)||[]).length&1&&d<l.length-1;)x+=`
`+l[++d];switch(x=x.trim(),+m){case-1:if(x==="BOT"){h[++c]=[],f=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?h[c][f]=!0:x==="FALSE"?h[c][f]=!1:isNaN(qt(p))?isNaN(ps(p).getDate())?h[c][f]=p:h[c][f]=xt(p):h[c][f]=qt(p),++f;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),h[c][f++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(h=h.slice(0,o.sheetRows)),h}function e(i,o){return qr(t(i,o),o)}function s(i,o){return Nr(e(i,o),o)}var n=function(){var i=function(c,f,d,h,u){c.push(f),c.push(d+","+h),c.push('"'+u.replace(/"/g,'""')+'"')},o=function(c,f,d,h){c.push(f+","+d),c.push(f==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(c){var f=[],d=Le(c["!ref"]),h,u=Array.isArray(c);i(f,"TABLE",0,1,"sheetjs"),i(f,"VECTORS",0,d.e.r-d.s.r+1,""),i(f,"TUPLES",0,d.e.c-d.s.c+1,""),i(f,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){o(f,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var x=De({r:m,c:p});if(h=u?(c[m]||[])[p]:c[x],!h){o(f,1,0,"");continue}switch(h.t){case"n":var g=h.w;!g&&h.v!=null&&(g=h.v),g==null?h.f&&!h.F?o(f,1,0,"="+h.f):o(f,1,0,""):o(f,0,g,"V");break;case"b":o(f,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":o(f,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=or(h.z||Ge[14],yt(xt(h.v)))),o(f,0,h.w,"V");break;default:o(f,1,0,"")}}}o(f,-1,0,"EOD");var T=`\r
`,_=f.join(T);return _}}();return{to_workbook:s,to_sheet:e,from_sheet:n}}(),pl=function(){function t(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(h,u){for(var m=h.split(`
`),p=-1,x=-1,g=0,T=[];g!==m.length;++g){var _=m[g].trim().split(":");if(_[0]==="cell"){var S=Qe(_[1]);if(T.length<=S.r)for(p=T.length;p<=S.r;++p)T[p]||(T[p]=[]);switch(p=S.r,x=S.c,_[2]){case"t":T[p][x]=t(_[3]);break;case"v":T[p][x]=+_[3];break;case"vtf":var A=_[_.length-1];case"vtc":switch(_[3]){case"nl":T[p][x]=!!+_[4];break;default:T[p][x]=+_[4];break}_[2]=="vtf"&&(T[p][x]=[T[p][x],A])}}}return u&&u.sheetRows&&(T=T.slice(0,u.sheetRows)),T}function s(h,u){return qr(e(h,u),u)}function n(h,u){return Nr(s(h,u),u)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function f(h){if(!h||!h["!ref"])return"";for(var u=[],m=[],p,x="",g=jt(h["!ref"]),T=Array.isArray(h),_=g.s.r;_<=g.e.r;++_)for(var S=g.s.c;S<=g.e.c;++S)if(x=De({r:_,c:S}),p=T?(h[_]||[])[S]:h[x],!(!p||p.v==null||p.t==="z")){switch(m=["cell",x,"t"],p.t){case"s":case"str":m.push(r(p.v));break;case"n":p.f?(m[2]="vtf",m[3]="n",m[4]=p.v,m[5]=r(p.f)):(m[2]="v",m[3]=p.v);break;case"b":m[2]="vt"+(p.f?"f":"c"),m[3]="nl",m[4]=p.v?"1":"0",m[5]=r(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var A=yt(xt(p.v));m[2]="vtc",m[3]="nd",m[4]=""+A,m[5]=p.w||or(p.z||Ge[14],A);break;case"e":continue}u.push(m.join(":"))}return u.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function d(h){return[i,o,l,o,f(h),c].join(`
`)}return{to_workbook:n,to_sheet:s,from_sheet:d}}(),Xh=function(){function t(d,h,u,m,p){p.raw?h[u][m]=d:d===""||(d==="TRUE"?h[u][m]=!0:d==="FALSE"?h[u][m]=!1:isNaN(qt(d))?isNaN(ps(d).getDate())?h[u][m]=d:h[u][m]=xt(d):h[u][m]=qt(d))}function r(d,h){var u=h||{},m=[];if(!d||d.length===0)return m;for(var p=d.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var g=10,T=0,_=0;_<=x;++_)T=p[_].indexOf(" "),T==-1?T=p[_].length:T++,g=Math.max(g,T);for(_=0;_<=x;++_){m[_]=[];var S=0;for(t(p[_].slice(0,g).trim(),m,_,S,u),S=1;S<=(p[_].length-g)/10+1;++S)t(p[_].slice(g+(S-1)*10,g+S*10).trim(),m,_,S,u)}return u.sheetRows&&(m=m.slice(0,u.sheetRows)),m}var e={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function n(d){for(var h={},u=!1,m=0,p=0;m<d.length;++m)(p=d.charCodeAt(m))==34?u=!u:!u&&p in e&&(h[p]=(h[p]||0)+1);p=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&p.push([h[m],m]);if(!p.length){h=s;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&p.push([h[m],m])}return p.sort(function(x,g){return x[0]-g[0]||s[x[1]]-s[g[1]]}),e[p.pop()[1]]||44}function i(d,h){var u=h||{},m="",p=u.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=n(d.slice(0,1024)):u&&u.FS?m=u.FS:m=n(d.slice(0,1024));var g=0,T=0,_=0,S=0,A=0,D=m.charCodeAt(0),z=!1,C=0,I=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var O=u.dateNF!=null?cf(u.dateNF):null;function P(){var H=d.slice(S,A),W={};if(H.charAt(0)=='"'&&H.charAt(H.length-1)=='"'&&(H=H.slice(1,-1).replace(/""/g,'"')),H.length===0)W.t="z";else if(u.raw)W.t="s",W.v=H;else if(H.trim().length===0)W.t="s",W.v=H;else if(H.charCodeAt(0)==61)H.charCodeAt(1)==34&&H.charCodeAt(H.length-1)==34?(W.t="s",W.v=H.slice(2,-1).replace(/""/g,'"')):Gu(H)?(W.t="n",W.f=H.slice(1)):(W.t="s",W.v=H);else if(H=="TRUE")W.t="b",W.v=!0;else if(H=="FALSE")W.t="b",W.v=!1;else if(!isNaN(_=qt(H)))W.t="n",u.cellText!==!1&&(W.w=H),W.v=_;else if(!isNaN(ps(H).getDate())||O&&H.match(O)){W.z=u.dateNF||Ge[14];var te=0;O&&H.match(O)&&(H=df(H,u.dateNF,H.match(O)||[]),te=1),u.cellDates?(W.t="d",W.v=xt(H,te)):(W.t="n",W.v=yt(xt(H,te))),u.cellText!==!1&&(W.w=or(W.z,W.v instanceof Date?yt(W.v):W.v)),u.cellNF||delete W.z}else W.t="s",W.v=H;if(W.t=="z"||(u.dense?(p[g]||(p[g]=[]),p[g][T]=W):p[De({c:T,r:g})]=W),S=A+1,I=d.charCodeAt(S),x.e.c<T&&(x.e.c=T),x.e.r<g&&(x.e.r=g),C==D)++T;else if(T=0,++g,u.sheetRows&&u.sheetRows<=g)return!0}e:for(;A<d.length;++A)switch(C=d.charCodeAt(A)){case 34:I===34&&(z=!z);break;case D:case 10:case 13:if(!z&&P())break e;break}return A-S>0&&P(),p["!ref"]=Ke(x),p}function o(d,h){return!(h&&h.PRN)||h.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,h):qr(r(d,h),h)}function l(d,h){var u="",m=h.type=="string"?[0,0,0,0]:ag(d,h);switch(h.type){case"base64":u=Jt(d);break;case"binary":u=d;break;case"buffer":h.codepage==65001?u=d.toString("utf8"):h.codepage&&typeof Qs<"u"||(u=Ae&&Buffer.isBuffer(d)?d.toString("binary"):Ns(d));break;case"array":u=jn(d);break;case"string":u=d;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?u=os(u.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?u=os(u):h.type=="binary"&&typeof Qs<"u",u.slice(0,19)=="socialcalc:version:"?pl.to_sheet(h.type=="string"?u:os(u),h):o(u,h)}function c(d,h){return Nr(l(d,h),h)}function f(d){for(var h=[],u=Le(d["!ref"]),m,p=Array.isArray(d),x=u.s.r;x<=u.e.r;++x){for(var g=[],T=u.s.c;T<=u.e.c;++T){var _=De({r:x,c:T});if(m=p?(d[x]||[])[T]:d[_],!m||m.v==null){g.push("          ");continue}for(var S=(m.w||(Qt(m),m.w)||"").slice(0,10);S.length<10;)S+=" ";g.push(S+(T===0?" ":""))}h.push(g.join(""))}return h.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:f}}(),Ui=function(){function t(b,w,j){if(b){_t(b,b.l||0);for(var y=j.Enum||xe;b.l<b.length;){var U=b.read_shift(2),L=y[U]||y[65535],Y=b.read_shift(2),Z=b.l+Y,Q=L.f&&L.f(b,Y,j);if(b.l=Z,w(Q,L,U))return}}}function r(b,w){switch(w.type){case"base64":return e(It(Jt(b)),w);case"binary":return e(It(b),w);case"buffer":case"array":return e(b,w)}throw"Unsupported type "+w.type}function e(b,w){if(!b)return b;var j=w||{},y=j.dense?[]:{},U="Sheet1",L="",Y=0,Z={},Q=[],ge=[],M={s:{r:0,c:0},e:{r:0,c:0}},oe=j.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)j.Enum=xe,t(b,function(de,Ee,Se){switch(Se){case 0:j.vers=de,de>=4096&&(j.qpro=!0);break;case 6:M=de;break;case 204:de&&(L=de);break;case 222:L=de;break;case 15:case 51:j.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:Se==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=j.dateNF||Ge[14],j.cellDates&&(de[1].t="d",de[1].v=Do(de[1].v))),j.qpro&&de[3]>Y&&(y["!ref"]=Ke(M),Z[U]=y,Q.push(U),y=j.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},Y=de[3],U=L||"Sheet"+(Y+1),L="");var Ce=j.dense?(y[de[0].r]||[])[de[0].c]:y[De(de[0])];if(Ce){Ce.t=de[1].t,Ce.v=de[1].v,de[1].z!=null&&(Ce.z=de[1].z),de[1].f!=null&&(Ce.f=de[1].f);break}j.dense?(y[de[0].r]||(y[de[0].r]=[]),y[de[0].r][de[0].c]=de[1]):y[De(de[0])]=de[1];break}},j);else if(b[2]==26||b[2]==14)j.Enum=_e,b[2]==14&&(j.qpro=!0,b.l=0),t(b,function(de,Ee,Se){switch(Se){case 204:U=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>Y&&(y["!ref"]=Ke(M),Z[U]=y,Q.push(U),y=j.dense?[]:{},M={s:{r:0,c:0},e:{r:0,c:0}},Y=de[3],U="Sheet"+(Y+1)),oe>0&&de[0].r>=oe)break;j.dense?(y[de[0].r]||(y[de[0].r]=[]),y[de[0].r][de[0].c]=de[1]):y[De(de[0])]=de[1],M.e.c<de[0].c&&(M.e.c=de[0].c),M.e.r<de[0].r&&(M.e.r=de[0].r);break;case 27:de[14e3]&&(ge[de[14e3][0]]=de[14e3][1]);break;case 1537:ge[de[0]]=de[1],de[0]==Y&&(U=de[1]);break}},j);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(y["!ref"]=Ke(M),Z[L||U]=y,Q.push(L||U),!ge.length)return{SheetNames:Q,Sheets:Z};for(var ie={},Be=[],ye=0;ye<ge.length;++ye)Z[Q[ye]]?(Be.push(ge[ye]||Q[ye]),ie[ge[ye]]=Z[ge[ye]]||Z[Q[ye]]):(Be.push(ge[ye]),ie[ge[ye]]={"!ref":"A1"});return{SheetNames:Be,Sheets:ie}}function s(b,w){var j=w||{};if(+j.codepage>=0&&xs(+j.codepage),j.type=="string")throw new Error("Cannot write WK1 to JS string");var y=vt(),U=Le(b["!ref"]),L=Array.isArray(b),Y=[];ae(y,0,i(1030)),ae(y,6,c(U));for(var Z=Math.min(U.e.r,8191),Q=U.s.r;Q<=Z;++Q)for(var ge=nt(Q),M=U.s.c;M<=U.e.c;++M){Q===U.s.r&&(Y[M]=ot(M));var oe=Y[M]+ge,ie=L?(b[Q]||[])[M]:b[oe];if(!(!ie||ie.t=="z"))if(ie.t=="n")(ie.v|0)==ie.v&&ie.v>=-32768&&ie.v<=32767?ae(y,13,m(Q,M,ie.v)):ae(y,14,x(Q,M,ie.v));else{var Be=Qt(ie);ae(y,15,h(Q,M,Be.slice(0,239)))}}return ae(y,1),y.end()}function n(b,w){var j=w||{};if(+j.codepage>=0&&xs(+j.codepage),j.type=="string")throw new Error("Cannot write WK3 to JS string");var y=vt();ae(y,0,o(b));for(var U=0,L=0;U<b.SheetNames.length;++U)(b.Sheets[b.SheetNames[U]]||{})["!ref"]&&ae(y,27,ce(b.SheetNames[U],L++));var Y=0;for(U=0;U<b.SheetNames.length;++U){var Z=b.Sheets[b.SheetNames[U]];if(!(!Z||!Z["!ref"])){for(var Q=Le(Z["!ref"]),ge=Array.isArray(Z),M=[],oe=Math.min(Q.e.r,8191),ie=Q.s.r;ie<=oe;++ie)for(var Be=nt(ie),ye=Q.s.c;ye<=Q.e.c;++ye){ie===Q.s.r&&(M[ye]=ot(ye));var de=M[ye]+Be,Ee=ge?(Z[ie]||[])[ye]:Z[de];if(!(!Ee||Ee.t=="z"))if(Ee.t=="n")ae(y,23,P(ie,ye,Y,Ee.v));else{var Se=Qt(Ee);ae(y,22,C(ie,ye,Y,Se.slice(0,239)))}}++Y}}return ae(y,1),y.end()}function i(b){var w=q(2);return w.write_shift(2,b),w}function o(b){var w=q(26);w.write_shift(2,4096),w.write_shift(2,4),w.write_shift(4,0);for(var j=0,y=0,U=0,L=0;L<b.SheetNames.length;++L){var Y=b.SheetNames[L],Z=b.Sheets[Y];if(!(!Z||!Z["!ref"])){++U;var Q=jt(Z["!ref"]);j<Q.e.r&&(j=Q.e.r),y<Q.e.c&&(y=Q.e.c)}}return j>8191&&(j=8191),w.write_shift(2,j),w.write_shift(1,U),w.write_shift(1,y),w.write_shift(2,0),w.write_shift(2,0),w.write_shift(1,1),w.write_shift(1,2),w.write_shift(4,0),w.write_shift(4,0),w}function l(b,w,j){var y={s:{c:0,r:0},e:{c:0,r:0}};return w==8&&j.qpro?(y.s.c=b.read_shift(1),b.l++,y.s.r=b.read_shift(2),y.e.c=b.read_shift(1),b.l++,y.e.r=b.read_shift(2),y):(y.s.c=b.read_shift(2),y.s.r=b.read_shift(2),w==12&&j.qpro&&(b.l+=2),y.e.c=b.read_shift(2),y.e.r=b.read_shift(2),w==12&&j.qpro&&(b.l+=2),y.s.c==65535&&(y.s.c=y.e.c=y.s.r=y.e.r=0),y)}function c(b){var w=q(8);return w.write_shift(2,b.s.c),w.write_shift(2,b.s.r),w.write_shift(2,b.e.c),w.write_shift(2,b.e.r),w}function f(b,w,j){var y=[{c:0,r:0},{t:"n",v:0},0,0];return j.qpro&&j.vers!=20768?(y[0].c=b.read_shift(1),y[3]=b.read_shift(1),y[0].r=b.read_shift(2),b.l+=2):(y[2]=b.read_shift(1),y[0].c=b.read_shift(2),y[0].r=b.read_shift(2)),y}function d(b,w,j){var y=b.l+w,U=f(b,w,j);if(U[1].t="s",j.vers==20768){b.l++;var L=b.read_shift(1);return U[1].v=b.read_shift(L,"utf8"),U}return j.qpro&&b.l++,U[1].v=b.read_shift(y-b.l,"cstr"),U}function h(b,w,j){var y=q(7+j.length);y.write_shift(1,255),y.write_shift(2,w),y.write_shift(2,b),y.write_shift(1,39);for(var U=0;U<y.length;++U){var L=j.charCodeAt(U);y.write_shift(1,L>=128?95:L)}return y.write_shift(1,0),y}function u(b,w,j){var y=f(b,w,j);return y[1].v=b.read_shift(2,"i"),y}function m(b,w,j){var y=q(7);return y.write_shift(1,255),y.write_shift(2,w),y.write_shift(2,b),y.write_shift(2,j,"i"),y}function p(b,w,j){var y=f(b,w,j);return y[1].v=b.read_shift(8,"f"),y}function x(b,w,j){var y=q(13);return y.write_shift(1,255),y.write_shift(2,w),y.write_shift(2,b),y.write_shift(8,j,"f"),y}function g(b,w,j){var y=b.l+w,U=f(b,w,j);if(U[1].v=b.read_shift(8,"f"),j.qpro)b.l=y;else{var L=b.read_shift(2);A(b.slice(b.l,b.l+L),U),b.l+=L}return U}function T(b,w,j){var y=w&32768;return w&=-32769,w=(y?b:0)+(w>=8192?w-16384:w),(y?"":"$")+(j?ot(w):nt(w))}var _={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},S=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(b,w){_t(b,0);for(var j=[],y=0,U="",L="",Y="",Z="";b.l<b.length;){var Q=b[b.l++];switch(Q){case 0:j.push(b.read_shift(8,"f"));break;case 1:L=T(w[0].c,b.read_shift(2),!0),U=T(w[0].r,b.read_shift(2),!1),j.push(L+U);break;case 2:{var ge=T(w[0].c,b.read_shift(2),!0),M=T(w[0].r,b.read_shift(2),!1);L=T(w[0].c,b.read_shift(2),!0),U=T(w[0].r,b.read_shift(2),!1),j.push(ge+M+":"+L+U)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:j.push("("+j.pop()+")");break;case 5:j.push(b.read_shift(2));break;case 6:{for(var oe="";Q=b[b.l++];)oe+=String.fromCharCode(Q);j.push('"'+oe.replace(/"/g,'""')+'"')}break;case 8:j.push("-"+j.pop());break;case 23:j.push("+"+j.pop());break;case 22:j.push("NOT("+j.pop()+")");break;case 20:case 21:Z=j.pop(),Y=j.pop(),j.push(["AND","OR"][Q-20]+"("+Y+","+Z+")");break;default:if(Q<32&&S[Q])Z=j.pop(),Y=j.pop(),j.push(Y+S[Q]+Z);else if(_[Q]){if(y=_[Q][1],y==69&&(y=b[b.l++]),y>j.length){console.error("WK1 bad formula parse 0x"+Q.toString(16)+":|"+j.join("|")+"|");return}var ie=j.slice(-y);j.length-=y,j.push(_[Q][0]+"("+ie.join(",")+")")}else return Q<=7?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=24?console.error("WK1 unsupported op "+Q.toString(16)):Q<=30?console.error("WK1 invalid opcode "+Q.toString(16)):Q<=115?console.error("WK1 unsupported function opcode "+Q.toString(16)):console.error("WK1 unrecognized opcode "+Q.toString(16))}}j.length==1?w[1].f=""+j[0]:console.error("WK1 bad formula parse |"+j.join("|")+"|")}function D(b){var w=[{c:0,r:0},{t:"n",v:0},0];return w[0].r=b.read_shift(2),w[3]=b[b.l++],w[0].c=b[b.l++],w}function z(b,w){var j=D(b);return j[1].t="s",j[1].v=b.read_shift(w-4,"cstr"),j}function C(b,w,j,y){var U=q(6+y.length);U.write_shift(2,b),U.write_shift(1,j),U.write_shift(1,w),U.write_shift(1,39);for(var L=0;L<y.length;++L){var Y=y.charCodeAt(L);U.write_shift(1,Y>=128?95:Y)}return U.write_shift(1,0),U}function I(b,w){var j=D(b);j[1].v=b.read_shift(2);var y=j[1].v>>1;if(j[1].v&1)switch(y&7){case 0:y=(y>>3)*5e3;break;case 1:y=(y>>3)*500;break;case 2:y=(y>>3)/20;break;case 3:y=(y>>3)/200;break;case 4:y=(y>>3)/2e3;break;case 5:y=(y>>3)/2e4;break;case 6:y=(y>>3)/16;break;case 7:y=(y>>3)/64;break}return j[1].v=y,j}function O(b,w){var j=D(b),y=b.read_shift(4),U=b.read_shift(4),L=b.read_shift(2);if(L==65535)return y===0&&U===3221225472?(j[1].t="e",j[1].v=15):y===0&&U===3489660928?(j[1].t="e",j[1].v=42):j[1].v=0,j;var Y=L&32768;return L=(L&32767)-16446,j[1].v=(1-Y*2)*(U*Math.pow(2,L+32)+y*Math.pow(2,L)),j}function P(b,w,j,y){var U=q(14);if(U.write_shift(2,b),U.write_shift(1,j),U.write_shift(1,w),y==0)return U.write_shift(4,0),U.write_shift(4,0),U.write_shift(2,65535),U;var L=0,Y=0,Z=0,Q=0;return y<0&&(L=1,y=-y),Y=Math.log2(y)|0,y/=Math.pow(2,Y-31),Q=y>>>0,Q&2147483648||(y/=2,++Y,Q=y>>>0),y-=Q,Q|=2147483648,Q>>>=0,y*=Math.pow(2,32),Z=y>>>0,U.write_shift(4,Z),U.write_shift(4,Q),Y+=16383+(L?32768:0),U.write_shift(2,Y),U}function H(b,w){var j=O(b);return b.l+=w-14,j}function W(b,w){var j=D(b),y=b.read_shift(4);return j[1].v=y>>6,j}function te(b,w){var j=D(b),y=b.read_shift(8,"f");return j[1].v=y,j}function pe(b,w){var j=te(b);return b.l+=w-10,j}function me(b,w){return b[b.l+w-1]==0?b.read_shift(w,"cstr"):""}function Ne(b,w){var j=b[b.l++];j>w-1&&(j=w-1);for(var y="";y.length<j;)y+=String.fromCharCode(b[b.l++]);return y}function ve(b,w,j){if(!(!j.qpro||w<21)){var y=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var U=b.read_shift(w-21,"cstr");return[y,U]}}function je(b,w){for(var j={},y=b.l+w;b.l<y;){var U=b.read_shift(2);if(U==14e3){for(j[U]=[0,""],j[U][0]=b.read_shift(2);b[b.l];)j[U][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return j}function ce(b,w){var j=q(5+b.length);j.write_shift(2,14e3),j.write_shift(2,w);for(var y=0;y<b.length;++y){var U=b.charCodeAt(y);j[j.l++]=U>127?95:U}return j[j.l++]=0,j}var xe={0:{n:"BOF",f:fl},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:me},222:{n:"SHEETNAMELP",f:Ne},65535:{n:""}},_e={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:O},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:H},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:je},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:W},38:{n:"??"},39:{n:"NUMBER27",f:te},40:{n:"FORMULA28",f:pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:me},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ve},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:n,to_workbook:r}}(),Kh=/^\s|\s$|[\t\n\r]/;function gl(t,r){if(!r.bookSST)return"";var e=[qe];e[e.length]=ne("sst",null,{xmlns:Kr[0],count:t.Count,uniqueCount:t.Unique});for(var s=0;s!=t.length;++s)if(t[s]!=null){var n=t[s],i="<si>";n.r?i+=n.r:(i+="<t",n.t||(n.t=""),n.t.match(Kh)&&(i+=' xml:space="preserve"'),i+=">"+Fe(n.t)+"</t>"),i+="</si>",e[e.length]=i}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function qh(t){return[t.read_shift(4),t.read_shift(4)]}function Yh(t,r){return r||(r=q(8)),r.write_shift(4,t.Count),r.write_shift(4,t.Unique),r}var Jh=Uf;function Qh(t){var r=vt();ee(r,159,Yh(t));for(var e=0;e<t.length;++e)ee(r,19,Jh(t[e]));return ee(r,160),r.end()}function Zh(t){for(var r=[],e=t.split(""),s=0;s<e.length;++s)r[s]=e[s].charCodeAt(0);return r}function vl(t){var r=0,e,s=Zh(t),n=s.length+1,i,o,l,c,f;for(e=br(n),e[0]=s.length,i=1;i!=n;++i)e[i]=s[i-1];for(i=n-1;i>=0;--i)o=e[i],l=r&16384?1:0,c=r<<1&32767,f=l|c,r=f^o;return r^52811}var eu=function(){function t(n,i){switch(i.type){case"base64":return r(Jt(n),i);case"binary":return r(n,i);case"buffer":return r(Ae&&Buffer.isBuffer(n)?n.toString("binary"):Ns(n),i);case"array":return r(jn(n),i)}throw new Error("Unrecognized type "+i.type)}function r(n,i){var o=i||{},l=o.dense?[]:{},c=n.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var f={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,h){Array.isArray(l)&&(l[h]=[]);for(var u=/\\\w+\b/g,m=0,p,x=-1;p=u.exec(d);){switch(p[0]){case"\\cell":var g=d.slice(m,u.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++x,g.length){var T={v:g,t:"s"};Array.isArray(l)?l[h][x]=T:l[De({r:h,c:x})]=T}break}m=u.lastIndex}x>f.e.c&&(f.e.c=x)}),l["!ref"]=Ke(f),l}function e(n,i){return Nr(t(n,i),i)}function s(n){for(var i=["{\\rtf1\\ansi"],o=Le(n["!ref"]),l,c=Array.isArray(n),f=o.s.r;f<=o.e.r;++f){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var h=De({r:f,c:d});l=c?(n[f]||[])[d]:n[h],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(Qt(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:s}}();function $i(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}var tu=6,Yt=tu;function ln(t){return Math.floor((t+Math.round(128/Yt)/256)*Yt)}function cn(t){return Math.floor((t-5)/Yt*100+.5)/100}function la(t){return Math.round((t*Yt+5)/Yt*256)/256}function Oa(t){t.width?(t.wpx=ln(t.width),t.wch=cn(t.wpx),t.MDW=Yt):t.wpx?(t.wch=cn(t.wpx),t.width=la(t.wch),t.MDW=Yt):typeof t.wch=="number"&&(t.width=la(t.wch),t.wpx=ln(t.width),t.MDW=Yt),t.customWidth&&delete t.customWidth}var ru=96,yl=ru;function dn(t){return t*96/yl}function bl(t){return t*yl/96}function su(t){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var s=e[0];s<=e[1];++s)t[s]!=null&&(r[r.length]=ne("numFmt",null,{numFmtId:s,formatCode:Fe(t[s])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=ne("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function nu(t){var r=[];return r[r.length]=ne("cellXfs",null),t.forEach(function(e){r[r.length]=ne("xf",null,e)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=ne("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function wl(t,r){var e=[qe,ne("styleSheet",null,{xmlns:Kr[0],"xmlns:vt":Je.vt})],s;return t.SSF&&(s=su(t.SSF))!=null&&(e[e.length]=s),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=nu(r.cellXfs))&&(e[e.length]=s),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function au(t,r){var e=t.read_shift(2),s=lt(t);return[e,s]}function iu(t,r,e){e||(e=q(6+4*r.length)),e.write_shift(2,t),Ze(r,e);var s=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),s}function ou(t,r,e){var s={};s.sz=t.read_shift(2)/20;var n=Kf(t);n.fItalic&&(s.italic=1),n.fCondense&&(s.condense=1),n.fExtend&&(s.extend=1),n.fShadow&&(s.shadow=1),n.fOutline&&(s.outline=1),n.fStrikeout&&(s.strike=1);var i=t.read_shift(2);switch(i===700&&(s.bold=1),t.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(s.underline=o);var l=t.read_shift(1);l>0&&(s.family=l);var c=t.read_shift(1);switch(c>0&&(s.charset=c),t.l++,s.color=Xf(t),t.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=lt(t),s}function lu(t,r){r||(r=q(25+4*32)),r.write_shift(2,t.sz*20),qf(t,r),r.write_shift(2,t.bold?700:400);var e=0;t.vertAlign=="superscript"?e=1:t.vertAlign=="subscript"&&(e=2),r.write_shift(2,e),r.write_shift(1,t.underline||0),r.write_shift(1,t.family||0),r.write_shift(1,t.charset||0),r.write_shift(1,0),an(t.color,r);var s=0;return s=2,r.write_shift(1,s),Ze(t.name,r),r.length>r.l?r.slice(0,r.l):r}var cu=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Hn,du=$t;function Hi(t,r){r||(r=q(4*3+8*7+16*1)),Hn||(Hn=_a(cu));var e=Hn[t.patternType];e==null&&(e=40),r.write_shift(4,e);var s=0;if(e!=40)for(an({auto:1},r),an({auto:1},r);s<12;++s)r.write_shift(4,0);else{for(;s<4;++s)r.write_shift(4,0);for(;s<12;++s)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function fu(t,r){var e=t.l+r,s=t.read_shift(2),n=t.read_shift(2);return t.l=e,{ixfe:s,numFmtId:n}}function _l(t,r,e){e||(e=q(16)),e.write_shift(2,r||0),e.write_shift(2,t.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var s=0;return e.write_shift(1,s),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function ss(t,r){return r||(r=q(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var hu=$t;function uu(t,r){return r||(r=q(51)),r.write_shift(1,0),ss(null,r),ss(null,r),ss(null,r),ss(null,r),ss(null,r),r.length>r.l?r.slice(0,r.l):r}function xu(t,r){return r||(r=q(12+4*10)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),nn(t.name||"",r),r.length>r.l?r.slice(0,r.l):r}function mu(t,r,e){var s=q(2052);return s.write_shift(4,t),nn(r,s),nn(e,s),s.length>s.l?s.slice(0,s.l):s}function pu(t,r){if(r){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)r[n]!=null&&++e}),e!=0&&(ee(t,615,Lt(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)r[n]!=null&&ee(t,44,iu(n,r[n]))}),ee(t,616))}}function gu(t){var r=1;ee(t,611,Lt(r)),ee(t,43,lu({sz:12,color:{theme:1},name:"Calibri",family:2})),ee(t,612)}function vu(t){var r=2;ee(t,603,Lt(r)),ee(t,45,Hi({patternType:"none"})),ee(t,45,Hi({patternType:"gray125"})),ee(t,604)}function yu(t){var r=1;ee(t,613,Lt(r)),ee(t,46,uu()),ee(t,614)}function bu(t){var r=1;ee(t,626,Lt(r)),ee(t,47,_l({numFmtId:0},65535)),ee(t,627)}function wu(t,r){ee(t,617,Lt(r.length)),r.forEach(function(e){ee(t,47,_l(e,0))}),ee(t,618)}function _u(t){var r=1;ee(t,619,Lt(r)),ee(t,48,xu({xfId:0,name:"Normal"})),ee(t,620)}function Su(t){var r=0;ee(t,505,Lt(r)),ee(t,506)}function Nu(t){var r=0;ee(t,508,mu(r,"TableStyleMedium9","PivotStyleMedium4")),ee(t,509)}function ju(t,r){var e=vt();return ee(e,278),pu(e,t.SSF),gu(e),vu(e),yu(e),bu(e),wu(e,r.cellXfs),_u(e),Su(e),Nu(e),ee(e,279),e.end()}function Sl(t,r){if(r&&r.themeXLSX)return r.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var e=[qe];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function Eu(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:lt(t)}}function Tu(t){var r=q(12+2*t.name.length);return r.write_shift(4,t.flags),r.write_shift(4,t.version),Ze(t.name,r),r.slice(0,r.l)}function Cu(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function Au(t){var r=q(4+8*t.length);r.write_shift(4,t.length);for(var e=0;e<t.length;++e)r.write_shift(4,t[e][0]),r.write_shift(4,t[e][1]);return r}function ku(t,r){var e=q(8+2*r.length);return e.write_shift(4,t),Ze(r,e),e.slice(0,e.l)}function Ru(t){return t.l+=4,t.read_shift(4)!=0}function Fu(t,r){var e=q(8);return e.write_shift(4,t),e.write_shift(4,1),e}function Du(){var t=vt();return ee(t,332),ee(t,334,Lt(1)),ee(t,335,Tu({name:"XLDAPR",version:12e4,flags:3496657072})),ee(t,336),ee(t,339,ku(1,"XLDAPR")),ee(t,52),ee(t,35,Lt(514)),ee(t,4096,Lt(0)),ee(t,4097,Ct(1)),ee(t,36),ee(t,53),ee(t,340),ee(t,337,Fu(1)),ee(t,51,Au([[1,0]])),ee(t,338),ee(t,333),t.end()}function Nl(){var t=[qe];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Ou(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=De(e);var s=t.read_shift(1);return s&2&&(r.l="1"),s&8&&(r.a="1"),r}var Ir=1024;function jl(t,r){for(var e=[21600,21600],s=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),n=[ne("xml",null,{"xmlns:v":St.v,"xmlns:o":St.o,"xmlns:x":St.x,"xmlns:mv":St.mv}).replace(/\/>/,">"),ne("o:shapelayout",ne("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ne("v:shapetype",[ne("v:stroke",null,{joinstyle:"miter"}),ne("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:s})];Ir<t*1e3;)Ir+=1e3;return r.forEach(function(i){var o=Qe(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?ne("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,f=ne("v:fill",c,l),d={on:"t",obscured:"t"};++Ir,n=n.concat(["<v:shape"+vs({id:"_x0000_s"+Ir,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",f,ne("v:shadow",null,d),ne("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",st("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),st("x:AutoFill","False"),st("x:Row",String(o.r)),st("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),n.push("</xml>"),n.join("")}function El(t){var r=[qe,ne("comments",null,{xmlns:Kr[0]})],e=[];return r.push("<authors>"),t.forEach(function(s){s[1].forEach(function(n){var i=Fe(n.a);e.indexOf(i)==-1&&(e.push(i),r.push("<author>"+i+"</author>")),n.T&&n.ID&&e.indexOf("tc="+n.ID)==-1&&(e.push("tc="+n.ID),r.push("<author>tc="+n.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),t.forEach(function(s){var n=0,i=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?n=e.indexOf("tc="+s[1][0].ID):s[1].forEach(function(c){c.a&&(n=e.indexOf(Fe(c.a))),i.push(c.t||"")}),r.push('<comment ref="'+s[0]+'" authorId="'+n+'"><text>'),i.length<=1)r.push(st("t",Fe(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;r.push(st("t",Fe(o)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Iu(t,r,e){var s=[qe,ne("ThreadedComments",null,{xmlns:Je.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(n){var i="";(n[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&r.indexOf(o.a)==-1&&r.push(o.a);var c={ref:n[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(o.a)).slice(-12)+"}"),s.push(ne("threadedComment",st("text",o.t||""),c))})}),s.push("</ThreadedComments>"),s.join("")}function Pu(t){var r=[qe,ne("personList",null,{xmlns:Je.TCMNT,"xmlns:x":Kr[0]}).replace(/[\/]>/,">")];return t.forEach(function(e,s){r.push(ne("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join("")}function Lu(t){var r={};r.iauthor=t.read_shift(4);var e=Cr(t);return r.rfx=e.s,r.ref=De(e.s),t.l+=16,r}function Bu(t,r){return r==null&&(r=q(36)),r.write_shift(4,t[1].iauthor),Yr(t[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var Mu=lt;function zu(t){return Ze(t.slice(0,54))}function Uu(t){var r=vt(),e=[];return ee(r,628),ee(r,630),t.forEach(function(s){s[1].forEach(function(n){e.indexOf(n.a)>-1||(e.push(n.a.slice(0,54)),ee(r,632,zu(n.a)))})}),ee(r,631),ee(r,633),t.forEach(function(s){s[1].forEach(function(n){n.iauthor=e.indexOf(n.a);var i={s:Qe(s[0]),e:Qe(s[0])};ee(r,635,Bu([i,n])),n.t&&n.t.length>0&&ee(r,637,Hf(n)),ee(r,636),delete n.iauthor})}),ee(r,634),ee(r,629),r.end()}function $u(t,r){r.FullPaths.forEach(function(e,s){if(s!=0){var n=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");n.slice(-1)!=="/"&&Oe.utils.cfb_add(t,n,r.FileIndex[s].content)}})}var Tl=["xlsb","xlsm","xlam","biff8","xla"],Hu=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(s,n,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var f=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=r.c:--d,c?f+=r.r:--f,n+(l?"":"$")+ot(d)+(c?"":"$")+nt(f)}return function(n,i){return r=i,n.replace(t,e)}}(),Ia=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Pa=function(){return function(r,e){return r.replace(Ia,function(s,n,i,o,l,c){var f=Aa(o)-(i?0:e.c),d=Ca(c)-(l?0:e.r),h=d==0?"":l?d+1:"["+d+"]",u=f==0?"":i?f+1:"["+f+"]";return n+"R"+h+"C"+u})}}();function Wu(t,r){return t.replace(Ia,function(e,s,n,i,o,l){return s+(n=="$"?n+i:ot(Aa(i)+r.c))+(o=="$"?o+l:nt(Ca(l)+r.r))})}function Gu(t){return t.length!=1}function Xe(t){t.l+=1}function lr(t,r){var e=t.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function Cl(t,r,e){var s=2;if(e){if(e.biff>=2&&e.biff<=5)return Al(t);e.biff==12&&(s=4)}var n=t.read_shift(s),i=t.read_shift(s),o=lr(t),l=lr(t);return{s:{r:n,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Al(t){var r=lr(t),e=lr(t),s=t.read_shift(1),n=t.read_shift(1);return{s:{r:r[0],c:s,cRel:r[1],rRel:r[2]},e:{r:e[0],c:n,cRel:e[1],rRel:e[2]}}}function Vu(t,r,e){if(e.biff<8)return Al(t);var s=t.read_shift(e.biff==12?4:2),n=t.read_shift(e.biff==12?4:2),i=lr(t),o=lr(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:n,c:o[0],cRel:o[1],rRel:o[2]}}}function kl(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return Xu(t);var s=t.read_shift(e&&e.biff==12?4:2),n=lr(t);return{r:s,c:n[0],cRel:n[1],rRel:n[2]}}function Xu(t){var r=lr(t),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function Ku(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function qu(t,r,e){var s=e&&e.biff?e.biff:8;if(s>=2&&s<=5)return Yu(t);var n=t.read_shift(s>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;n>524287;)n-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:n,c:i,cRel:o,rRel:l}}function Yu(t){var r=t.read_shift(2),e=t.read_shift(1),s=(r&32768)>>15,n=(r&16384)>>14;return r&=16383,s==1&&r>=8192&&(r=r-16384),n==1&&e>=128&&(e=e-256),{r,c:e,cRel:n,rRel:s}}function Ju(t,r,e){var s=(t[t.l++]&96)>>5,n=Cl(t,e.biff>=2&&e.biff<=5?6:8,e);return[s,n]}function Qu(t,r,e){var s=(t[t.l++]&96)>>5,n=t.read_shift(2,"i"),i=8;if(e)switch(e.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=Cl(t,i,e);return[s,n,o]}function Zu(t,r,e){var s=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[s]}function ex(t,r,e){var s=(t[t.l++]&96)>>5,n=t.read_shift(2),i=8;if(e)switch(e.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[s,n]}function tx(t,r,e){var s=(t[t.l++]&96)>>5,n=Vu(t,r-1,e);return[s,n]}function rx(t,r,e){var s=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[s]}function Wi(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function sx(t,r,e){t.l+=2;for(var s=t.read_shift(e&&e.biff==2?1:2),n=[],i=0;i<=s;++i)n.push(t.read_shift(e&&e.biff==2?1:2));return n}function nx(t,r,e){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(e&&e.biff==2?1:2)]}function ax(t,r,e){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(e&&e.biff==2?1:2)]}function ix(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function ox(t,r,e){var s=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[s]}function Rl(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function lx(t){return t.read_shift(2),Rl(t)}function cx(t){return t.read_shift(2),Rl(t)}function dx(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var n=kl(t,0,e);return[s,n]}function fx(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var n=qu(t,0,e);return[s,n]}function hx(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var i=kl(t,0,e);return[s,n,i]}function ux(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var n=t.read_shift(e&&e.biff<=3?1:2);return[um[n],Ol[n],s]}function xx(t,r,e){var s=t[t.l++],n=t.read_shift(1),i=e&&e.biff<=3?[s==88?-1:0,t.read_shift(1)]:mx(t);return[n,(i[0]===0?Ol:hm)[i[1]]]}function mx(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function px(t,r,e){t.l+=e&&e.biff==2?3:4}function gx(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var s=t.read_shift(2),n=t.read_shift(e&&e.biff==2?1:2);return[s,n]}function vx(t){return t.l++,Ts[t.read_shift(1)]}function yx(t){return t.l++,t.read_shift(2)}function bx(t){return t.l++,t.read_shift(1)!==0}function wx(t){return t.l++,Jr(t)}function _x(t,r,e){return t.l++,ul(t,r-1,e)}function Sx(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=hh(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=Ts[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=Jr(t);break;case 2:e[1]=ph(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function Nx(t,r,e){for(var s=t.read_shift(e.biff==12?4:2),n=[],i=0;i!=s;++i)n.push((e.biff==12?Cr:yh)(t));return n}function jx(t,r,e){var s=0,n=0;e.biff==12?(s=t.read_shift(4),n=t.read_shift(4)):(n=1+t.read_shift(1),s=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--s,--n==0&&(n=256));for(var i=0,o=[];i!=s&&(o[i]=[]);++i)for(var l=0;l!=n;++l)o[i][l]=Sx(t,e.biff);return o}function Ex(t,r,e){var s=t.read_shift(1)>>>5&3,n=!e||e.biff>=8?4:2,i=t.read_shift(n);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[s,0,i]}function Tx(t,r,e){if(e.biff==5)return Cx(t);var s=t.read_shift(1)>>>5&3,n=t.read_shift(2),i=t.read_shift(4);return[s,n,i]}function Cx(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var s=t.read_shift(2);return t.l+=12,[r,e,s]}function Ax(t,r,e){var s=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var n=t.read_shift(e&&e.biff==2?1:2);return[s,n]}function kx(t,r,e){var s=t.read_shift(1)>>>5&3,n=t.read_shift(e&&e.biff==2?1:2);return[s,n]}function Rx(t,r,e){var s=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[s]}function Fx(t,r,e){var s=(t[t.l++]&96)>>5,n=t.read_shift(2),i=4;if(e)switch(e.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[s,n]}var Dx=$t,Ox=$t,Ix=$t;function Cs(t,r,e){return t.l+=2,[Ku(t)]}function La(t){return t.l+=6,[]}var Px=Cs,Lx=La,Bx=La,Mx=Cs;function Fl(t){return t.l+=2,[fl(t),t.read_shift(2)&1]}var zx=Cs,Ux=Fl,$x=La,Hx=Cs,Wx=Cs,Gx=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Vx(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(4),n=t.read_shift(2),i=t.read_shift(2),o=Gx[e>>2&31];return{ixti:r,coltype:e&3,rt:o,idx:s,c:n,C:i}}function Xx(t){return t.l+=2,[t.read_shift(4)]}function Kx(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function qx(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function Yx(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function Jx(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function Qx(t){return t.l+=4,[0,0]}var Gi={1:{n:"PtgExp",f:gx},2:{n:"PtgTbl",f:Ix},3:{n:"PtgAdd",f:Xe},4:{n:"PtgSub",f:Xe},5:{n:"PtgMul",f:Xe},6:{n:"PtgDiv",f:Xe},7:{n:"PtgPower",f:Xe},8:{n:"PtgConcat",f:Xe},9:{n:"PtgLt",f:Xe},10:{n:"PtgLe",f:Xe},11:{n:"PtgEq",f:Xe},12:{n:"PtgGe",f:Xe},13:{n:"PtgGt",f:Xe},14:{n:"PtgNe",f:Xe},15:{n:"PtgIsect",f:Xe},16:{n:"PtgUnion",f:Xe},17:{n:"PtgRange",f:Xe},18:{n:"PtgUplus",f:Xe},19:{n:"PtgUminus",f:Xe},20:{n:"PtgPercent",f:Xe},21:{n:"PtgParen",f:Xe},22:{n:"PtgMissArg",f:Xe},23:{n:"PtgStr",f:_x},26:{n:"PtgSheet",f:Kx},27:{n:"PtgEndSheet",f:qx},28:{n:"PtgErr",f:vx},29:{n:"PtgBool",f:bx},30:{n:"PtgInt",f:yx},31:{n:"PtgNum",f:wx},32:{n:"PtgArray",f:rx},33:{n:"PtgFunc",f:ux},34:{n:"PtgFuncVar",f:xx},35:{n:"PtgName",f:Ex},36:{n:"PtgRef",f:dx},37:{n:"PtgArea",f:Ju},38:{n:"PtgMemArea",f:Ax},39:{n:"PtgMemErr",f:Dx},40:{n:"PtgMemNoMem",f:Ox},41:{n:"PtgMemFunc",f:kx},42:{n:"PtgRefErr",f:Rx},43:{n:"PtgAreaErr",f:Zu},44:{n:"PtgRefN",f:fx},45:{n:"PtgAreaN",f:tx},46:{n:"PtgMemAreaN",f:Yx},47:{n:"PtgMemNoMemN",f:Jx},57:{n:"PtgNameX",f:Tx},58:{n:"PtgRef3d",f:hx},59:{n:"PtgArea3d",f:Qu},60:{n:"PtgRefErr3d",f:Fx},61:{n:"PtgAreaErr3d",f:ex},255:{}},Zx={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},em={1:{n:"PtgElfLel",f:Fl},2:{n:"PtgElfRw",f:Hx},3:{n:"PtgElfCol",f:Px},6:{n:"PtgElfRwV",f:Wx},7:{n:"PtgElfColV",f:Mx},10:{n:"PtgElfRadical",f:zx},11:{n:"PtgElfRadicalS",f:$x},13:{n:"PtgElfColS",f:Lx},15:{n:"PtgElfColSV",f:Bx},16:{n:"PtgElfRadicalLel",f:Ux},25:{n:"PtgList",f:Vx},29:{n:"PtgSxName",f:Xx},255:{}},tm={0:{n:"PtgAttrNoop",f:Qx},1:{n:"PtgAttrSemi",f:ox},2:{n:"PtgAttrIf",f:ax},4:{n:"PtgAttrChoose",f:sx},8:{n:"PtgAttrGoto",f:nx},16:{n:"PtgAttrSum",f:px},32:{n:"PtgAttrBaxcel",f:Wi},33:{n:"PtgAttrBaxcel",f:Wi},64:{n:"PtgAttrSpace",f:lx},65:{n:"PtgAttrSpaceSemi",f:cx},128:{n:"PtgAttrIfError",f:ix},255:{}};function rm(t,r,e,s){if(s.biff<8)return $t(t,r);for(var n=t.l+r,i=[],o=0;o!==e.length;++o)switch(e[o][0]){case"PtgArray":e[o][1]=jx(t,0,s),i.push(e[o][1]);break;case"PtgMemArea":e[o][2]=Nx(t,e[o][1],s),i.push(e[o][2]);break;case"PtgExp":s&&s.biff==12&&(e[o][1][1]=t.read_shift(4),i.push(e[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[o][0]}return r=n-t.l,r!==0&&i.push($t(t,r)),i}function sm(t,r,e){for(var s=t.l+r,n,i,o=[];s!=t.l;)r=s-t.l,i=t[t.l],n=Gi[i]||Gi[Zx[i]],(i===24||i===25)&&(n=(i===24?em:tm)[t[t.l+1]]),!n||!n.f?$t(t,r):o.push([n.n,n.f(t,r,e)]);return o}function nm(t){for(var r=[],e=0;e<t.length;++e){for(var s=t[e],n=[],i=0;i<s.length;++i){var o=s[i];if(o)switch(o[0]){case 2:n.push('"'+o[1].replace(/"/g,'""')+'"');break;default:n.push(o[1])}else n.push("")}r.push(n.join(","))}return r.join(";")}var am={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function im(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Dl(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var s=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!s)return"SH33TJSERR1";var n="";if(e.biff>8)switch(t[s[0]][0]){case 357:return n=s[1]==-1?"#REF":t.SheetNames[s[1]],s[1]==s[2]?n:n+":"+t.SheetNames[s[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[s[0]][0];case 355:default:return"SH33TJSSRC"+t[s[0]][0]}switch(t[s[0]][0][0]){case 1025:return n=s[1]==-1?"#REF":t.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?n:n+":"+t.SheetNames[s[2]];case 14849:return t[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[s[0]][0][3]?(n=s[1]==-1?"#REF":t[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?n:n+":"+t[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function Vi(t,r,e){var s=Dl(t,r,e);return s=="#REF"?s:im(s,e)}function Hr(t,r,e,s,n){var i=n&&n.biff||8,o={s:{c:0,r:0}},l=[],c,f,d,h=0,u=0,m,p="";if(!t[0]||!t[0][0])return"";for(var x=-1,g="",T=0,_=t[0].length;T<_;++T){var S=t[0][T];switch(S[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),f=l.pop(),x>=0){switch(t[0][x][1][0]){case 0:g=We(" ",t[0][x][1][1]);break;case 1:g=We("\r",t[0][x][1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}f=f+g,x=-1}l.push(f+am[S[0]]+c);break;case"PtgIsect":c=l.pop(),f=l.pop(),l.push(f+" "+c);break;case"PtgUnion":c=l.pop(),f=l.pop(),l.push(f+","+c);break;case"PtgRange":c=l.pop(),f=l.pop(),l.push(f+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=cs(S[1][1],o,n),l.push(ds(d,i));break;case"PtgRefN":d=e?cs(S[1][1],e,n):S[1][1],l.push(ds(d,i));break;case"PtgRef3d":h=S[1][1],d=cs(S[1][2],o,n),p=Vi(s,h,n),l.push(p+"!"+ds(d,i));break;case"PtgFunc":case"PtgFuncVar":var A=S[1][0],D=S[1][1];A||(A=0),A&=127;var z=A==0?[]:l.slice(-A);l.length-=A,D==="User"&&(D=z.shift()),l.push(D+"("+z.join(",")+")");break;case"PtgBool":l.push(S[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(S[1]);break;case"PtgNum":l.push(String(S[1]));break;case"PtgStr":l.push('"'+S[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(S[1]);break;case"PtgAreaN":m=ki(S[1][1],e?{s:e}:o,n),l.push(Un(m,n));break;case"PtgArea":m=ki(S[1][1],o,n),l.push(Un(m,n));break;case"PtgArea3d":h=S[1][1],m=S[1][2],p=Vi(s,h,n),l.push(p+"!"+Un(m,n));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=S[1][2];var C=(s.names||[])[u-1]||(s[0]||[])[u],I=C?C.Name:"SH33TJSNAME"+String(u);I&&I.slice(0,6)=="_xlfn."&&!n.xlfn&&(I=I.slice(6)),l.push(I);break;case"PtgNameX":var O=S[1][1];u=S[1][2];var P;if(n.biff<=5)O<0&&(O=-O),s[O]&&(P=s[O][u]);else{var H="";if(((s[O]||[])[0]||[])[0]==14849||(((s[O]||[])[0]||[])[0]==1025?s[O][u]&&s[O][u].itab>0&&(H=s.SheetNames[s[O][u].itab-1]+"!"):H=s.SheetNames[u-1]+"!"),s[O]&&s[O][u])H+=s[O][u].Name;else if(s[0]&&s[0][u])H+=s[0][u].Name;else{var W=(Dl(s,O,n)||"").split(";;");W[u-1]?H=W[u-1]:H+="SH33TJSERRX"}l.push(H);break}P||(P={Name:"SH33TJSERRY"}),l.push(P.Name);break;case"PtgParen":var te="(",pe=")";if(x>=0){switch(g="",t[0][x][1][0]){case 2:te=We(" ",t[0][x][1][1])+te;break;case 3:te=We("\r",t[0][x][1][1])+te;break;case 4:pe=We(" ",t[0][x][1][1])+pe;break;case 5:pe=We("\r",t[0][x][1][1])+pe;break;default:if(n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}l.push(te+l.pop()+pe);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:S[1][1],r:S[1][0]};var me={c:e.c,r:e.r};if(s.sharedf[De(d)]){var Ne=s.sharedf[De(d)];l.push(Hr(Ne,o,me,s,n))}else{var ve=!1;for(c=0;c!=s.arrayf.length;++c)if(f=s.arrayf[c],!(d.c<f[0].s.c||d.c>f[0].e.c)&&!(d.r<f[0].s.r||d.r>f[0].e.r)){l.push(Hr(f[1],o,me,s,n)),ve=!0;break}ve||l.push(S[1])}break;case"PtgArray":l.push("{"+nm(S[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+S[1].idx+"[#"+S[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(S));default:throw new Error("Unrecognized Formula Token: "+String(S))}var je=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(n.biff!=3&&x>=0&&je.indexOf(t[0][T][0])==-1){S=t[0][x];var ce=!0;switch(S[1][0]){case 4:ce=!1;case 0:g=We(" ",S[1][1]);break;case 5:ce=!1;case 1:g=We("\r",S[1][1]);break;default:if(g="",n.WTF)throw new Error("Unexpected PtgAttrSpaceType "+S[1][0])}l.push((ce?g:"")+l.pop()+(ce?"":g)),x=-1}}if(l.length>1&&n.WTF)throw new Error("bad formula stack");return l[0]}function om(t){if(t==null){var r=q(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof t=="number")return wr(t);return wr(0)}function lm(t,r,e,s,n){var i=_r(r,e,n),o=om(t.v),l=q(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var f=q(t.bf.length),d=0;d<t.bf.length;++d)f[d]=t.bf[d];var h=rt([i,o,l,f]);return h}function En(t,r,e){var s=t.read_shift(4),n=sm(t,s,e),i=t.read_shift(4),o=i>0?rm(t,i,n,e):null;return[n,o]}var cm=En,Tn=En,dm=En,fm=En,hm={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Ol={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},um={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function xm(t){var r="of:="+t.replace(Ia,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function mm(t){return t.replace(/\./,"!")}var fs=typeof Map<"u";function Ba(t,r,e){var s=0,n=t.length;if(e){if(fs?e.has(r):Object.prototype.hasOwnProperty.call(e,r)){for(var i=fs?e.get(r):e[r];s<i.length;++s)if(t[i[s]].t===r)return t.Count++,i[s]}}else for(;s<n;++s)if(t[s].t===r)return t.Count++,s;return t[n]={t:r},t.Count++,t.Unique++,e&&(fs?(e.has(r)||e.set(r,[]),e.get(r).push(n)):(Object.prototype.hasOwnProperty.call(e,r)||(e[r]=[]),e[r].push(n))),n}function Cn(t,r){var e={min:t+1,max:t+1},s=-1;return r.MDW&&(Yt=r.MDW),r.width!=null?e.customWidth=1:r.wpx!=null?s=cn(r.wpx):r.wch!=null&&(s=r.wch),s>-1?(e.width=la(s),e.customWidth=1):r.width!=null&&(e.width=r.width),r.hidden&&(e.hidden=!0),r.level!=null&&(e.outlineLevel=e.level=r.level),e}function Il(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function dr(t,r,e){var s=e.revssf[r.z!=null?r.z:"General"],n=60,i=t.length;if(s==null&&e.ssf){for(;n<392;++n)if(e.ssf[n]==null){ko(r.z,n),e.ssf[n]=r.z,e.revssf[r.z]=s=n;break}}for(n=0;n!=i;++n)if(t[n].numFmtId===s)return n;return t[i]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function pm(t,r,e){if(t&&t["!ref"]){var s=Le(t["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+e+"): "+t["!ref"])}}function gm(t){if(t.length===0)return"";for(var r='<mergeCells count="'+t.length+'">',e=0;e!=t.length;++e)r+='<mergeCell ref="'+Ke(t[e])+'"/>';return r+"</mergeCells>"}function vm(t,r,e,s,n){var i=!1,o={},l=null;if(s.bookType!=="xlsx"&&r.vbaraw){var c=r.SheetNames[e];try{r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}i=!0,o.codeName=gs(Fe(c))}if(t&&t["!outline"]){var f={summaryBelow:1,summaryRight:1};t["!outline"].above&&(f.summaryBelow=0),t["!outline"].left&&(f.summaryRight=0),l=(l||"")+ne("outlinePr",null,f)}!i&&!l||(n[n.length]=ne("sheetPr",l,o))}var ym=["objects","scenarios","selectLockedCells","selectUnlockedCells"],bm=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function wm(t){var r={sheet:1};return ym.forEach(function(e){t[e]!=null&&t[e]&&(r[e]="1")}),bm.forEach(function(e){t[e]!=null&&!t[e]&&(r[e]="0")}),t.password&&(r.password=vl(t.password).toString(16).toUpperCase()),ne("sheetProtection",null,r)}function _m(t){return Il(t),ne("pageMargins",null,t)}function Sm(t,r){for(var e=["<cols>"],s,n=0;n!=r.length;++n)(s=r[n])&&(e[e.length]=ne("col",null,Cn(n,s)));return e[e.length]="</cols>",e.join("")}function Nm(t,r,e,s){var n=typeof t.ref=="string"?t.ref:Ke(t.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var i=e.Workbook.Names,o=jt(n);o.s.r==o.e.r&&(o.e.r=jt(r["!ref"]).e.r,n=Ke(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+e.SheetNames[s]+"'!"+n;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+e.SheetNames[s]+"'!"+n}),ne("autoFilter",null,{ref:n})}function jm(t,r,e,s){var n={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(n.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),ne("sheetViews",ne("sheetView",null,n),{})}function Em(t,r,e,s){if(t.c&&e["!comments"].push([r,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var n="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":n=t.v?"1":"0";break;case"n":n=""+t.v;break;case"e":n=Ts[t.v];break;case"d":s&&s.cellDates?n=xt(t.v,-1).toISOString():(t=bt(t),t.t="n",n=""+(t.v=yt(xt(t.v)))),typeof t.z>"u"&&(t.z=Ge[14]);break;default:n=t.v;break}var l=st("v",Fe(n)),c={r},f=dr(s.cellXfs,t,s);switch(f!==0&&(c.s=f),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=st("v",""+Ba(s.Strings,t.v,s.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,r.length)==r?{t:"array",ref:t.F}:null;l=ne("f",Fe(t.f),d)+(t.v!=null?l:"")}return t.l&&e["!links"].push([r,t.l]),t.D&&(c.cm=1),ne("c",l,c)}function Tm(t,r,e,s){var n=[],i=[],o=Le(t["!ref"]),l="",c,f="",d=[],h=0,u=0,m=t["!rows"],p=Array.isArray(t),x={r:f},g,T=-1;for(u=o.s.c;u<=o.e.c;++u)d[u]=ot(u);for(h=o.s.r;h<=o.e.r;++h){for(i=[],f=nt(h),u=o.s.c;u<=o.e.c;++u){c=d[u]+f;var _=p?(t[h]||[])[u]:t[c];_!==void 0&&(l=Em(_,c,t,r))!=null&&i.push(l)}(i.length>0||m&&m[h])&&(x={r:f},m&&m[h]&&(g=m[h],g.hidden&&(x.hidden=1),T=-1,g.hpx?T=dn(g.hpx):g.hpt&&(T=g.hpt),T>-1&&(x.ht=T,x.customHeight=1),g.level&&(x.outlineLevel=g.level)),n[n.length]=ne("row",i.join(""),x))}if(m)for(;h<m.length;++h)m&&m[h]&&(x={r:h+1},g=m[h],g.hidden&&(x.hidden=1),T=-1,g.hpx?T=dn(g.hpx):g.hpt&&(T=g.hpt),T>-1&&(x.ht=T,x.customHeight=1),g.level&&(x.outlineLevel=g.level),n[n.length]=ne("row","",x));return n.join("")}function Pl(t,r,e,s){var n=[qe,ne("worksheet",null,{xmlns:Kr[0],"xmlns:r":Je.r})],i=e.SheetNames[t],o=0,l="",c=e.Sheets[i];c==null&&(c={});var f=c["!ref"]||"A1",d=Le(f);if(d.e.c>16383||d.e.r>1048575){if(r.WTF)throw new Error("Range "+f+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),f=Ke(d)}s||(s={}),c["!comments"]=[];var h=[];vm(c,e,t,r,n),n[n.length]=ne("dimension",null,{ref:f}),n[n.length]=jm(c,r,t,e),r.sheetFormat&&(n[n.length]=ne("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(n[n.length]=Sm(c,c["!cols"])),n[o=n.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Tm(c,r),l.length>0&&(n[n.length]=l)),n.length>o+1&&(n[n.length]="</sheetData>",n[o]=n[o].replace("/>",">")),c["!protect"]&&(n[n.length]=wm(c["!protect"])),c["!autofilter"]!=null&&(n[n.length]=Nm(c["!autofilter"],c,e,t)),c["!merges"]!=null&&c["!merges"].length>0&&(n[n.length]=gm(c["!merges"]));var u=-1,m,p=-1;return c["!links"].length>0&&(n[n.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(p=Re(s,-1,Fe(x[1].Target).replace(/#.*$/,""),Te.HLINK),m["r:id"]="rId"+p),(u=x[1].Target.indexOf("#"))>-1&&(m.location=Fe(x[1].Target.slice(u+1))),x[1].Tooltip&&(m.tooltip=Fe(x[1].Tooltip)),n[n.length]=ne("hyperlink",null,m))}),n[n.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(n[n.length]=_m(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(n[n.length]=st("ignoredErrors",ne("ignoredError",null,{numberStoredAsText:1,sqref:f}))),h.length>0&&(p=Re(s,-1,"../drawings/drawing"+(t+1)+".xml",Te.DRAW),n[n.length]=ne("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=h),c["!comments"].length>0&&(p=Re(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Te.VML),n[n.length]=ne("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),n.length>1&&(n[n.length]="</worksheet>",n[1]=n[1].replace("/>",">")),n.join("")}function Cm(t,r){var e={},s=t.l+r;e.r=t.read_shift(4),t.l+=4;var n=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=s,i&7&&(e.level=i&7),i&16&&(e.hidden=!0),i&32&&(e.hpt=n/20),e}function Am(t,r,e){var s=q(145),n=(e["!rows"]||[])[t]||{};s.write_shift(4,t),s.write_shift(4,0);var i=320;n.hpx?i=dn(n.hpx)*20:n.hpt&&(i=n.hpt*20),s.write_shift(2,i),s.write_shift(1,0);var o=0;n.level&&(o|=n.level),n.hidden&&(o|=16),(n.hpx||n.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var l=0,c=s.l;s.l+=4;for(var f={r:t,c:0},d=0;d<16;++d)if(!(r.s.c>d+1<<10||r.e.c<d<<10)){for(var h=-1,u=-1,m=d<<10;m<d+1<<10;++m){f.c=m;var p=Array.isArray(e)?(e[f.r]||[])[f.c]:e[De(f)];p&&(h<0&&(h=m),u=m)}h<0||(++l,s.write_shift(4,h),s.write_shift(4,u))}var x=s.l;return s.l=c,s.write_shift(4,l),s.l=x,s.length>s.l?s.slice(0,s.l):s}function km(t,r,e,s){var n=Am(s,e,r);(n.length>17||(r["!rows"]||[])[s])&&ee(t,0,n)}var Rm=Cr,Fm=Yr;function Dm(){}function Om(t,r){var e={},s=t[t.l];return++t.l,e.above=!(s&64),e.left=!(s&128),t.l+=18,e.name=Wf(t),e}function Im(t,r,e){e==null&&(e=q(84+4*t.length));var s=192;r&&(r.above&&(s&=-65),r.left&&(s&=-129)),e.write_shift(1,s);for(var n=1;n<3;++n)e.write_shift(1,0);return an({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),Jo(t,e),e.slice(0,e.l)}function Pm(t){var r=kt(t);return[r]}function Lm(t,r,e){return e==null&&(e=q(8)),jr(r,e)}function Bm(t){var r=Er(t);return[r]}function Mm(t,r,e){return e==null&&(e=q(4)),Tr(r,e)}function zm(t){var r=kt(t),e=t.read_shift(1);return[r,e,"b"]}function Um(t,r,e){return e==null&&(e=q(9)),jr(r,e),e.write_shift(1,t.v?1:0),e}function $m(t){var r=Er(t),e=t.read_shift(1);return[r,e,"b"]}function Hm(t,r,e){return e==null&&(e=q(5)),Tr(r,e),e.write_shift(1,t.v?1:0),e}function Wm(t){var r=kt(t),e=t.read_shift(1);return[r,e,"e"]}function Gm(t,r,e){return e==null&&(e=q(9)),jr(r,e),e.write_shift(1,t.v),e}function Vm(t){var r=Er(t),e=t.read_shift(1);return[r,e,"e"]}function Xm(t,r,e){return e==null&&(e=q(8)),Tr(r,e),e.write_shift(1,t.v),e.write_shift(2,0),e.write_shift(1,0),e}function Km(t){var r=kt(t),e=t.read_shift(4);return[r,e,"s"]}function qm(t,r,e){return e==null&&(e=q(12)),jr(r,e),e.write_shift(4,r.v),e}function Ym(t){var r=Er(t),e=t.read_shift(4);return[r,e,"s"]}function Jm(t,r,e){return e==null&&(e=q(8)),Tr(r,e),e.write_shift(4,r.v),e}function Qm(t){var r=kt(t),e=Jr(t);return[r,e,"n"]}function Zm(t,r,e){return e==null&&(e=q(16)),jr(r,e),wr(t.v,e),e}function ep(t){var r=Er(t),e=Jr(t);return[r,e,"n"]}function tp(t,r,e){return e==null&&(e=q(12)),Tr(r,e),wr(t.v,e),e}function rp(t){var r=kt(t),e=Qo(t);return[r,e,"n"]}function sp(t,r,e){return e==null&&(e=q(12)),jr(r,e),Zo(t.v,e),e}function np(t){var r=Er(t),e=Qo(t);return[r,e,"n"]}function ap(t,r,e){return e==null&&(e=q(8)),Tr(r,e),Zo(t.v,e),e}function ip(t){var r=kt(t),e=ka(t);return[r,e,"is"]}function op(t){var r=kt(t),e=lt(t);return[r,e,"str"]}function lp(t,r,e){return e==null&&(e=q(12+4*t.v.length)),jr(r,e),Ze(t.v,e),e.length>e.l?e.slice(0,e.l):e}function cp(t){var r=Er(t),e=lt(t);return[r,e,"str"]}function dp(t,r,e){return e==null&&(e=q(8+4*t.v.length)),Tr(r,e),Ze(t.v,e),e.length>e.l?e.slice(0,e.l):e}function fp(t,r,e){var s=t.l+r,n=kt(t);n.r=e["!row"];var i=t.read_shift(1),o=[n,i,"b"];if(e.cellFormula){t.l+=2;var l=Tn(t,s-t.l,e);o[3]=Hr(l,null,n,e.supbooks,e)}else t.l=s;return o}function hp(t,r,e){var s=t.l+r,n=kt(t);n.r=e["!row"];var i=t.read_shift(1),o=[n,i,"e"];if(e.cellFormula){t.l+=2;var l=Tn(t,s-t.l,e);o[3]=Hr(l,null,n,e.supbooks,e)}else t.l=s;return o}function up(t,r,e){var s=t.l+r,n=kt(t);n.r=e["!row"];var i=Jr(t),o=[n,i,"n"];if(e.cellFormula){t.l+=2;var l=Tn(t,s-t.l,e);o[3]=Hr(l,null,n,e.supbooks,e)}else t.l=s;return o}function xp(t,r,e){var s=t.l+r,n=kt(t);n.r=e["!row"];var i=lt(t),o=[n,i,"str"];if(e.cellFormula){t.l+=2;var l=Tn(t,s-t.l,e);o[3]=Hr(l,null,n,e.supbooks,e)}else t.l=s;return o}var mp=Cr,pp=Yr;function gp(t,r){return r==null&&(r=q(4)),r.write_shift(4,t),r}function vp(t,r){var e=t.l+r,s=Cr(t),n=Ra(t),i=lt(t),o=lt(t),l=lt(t);t.l=e;var c={rfx:s,relId:n,loc:i,display:l};return o&&(c.Tooltip=o),c}function yp(t,r){var e=q(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));Yr({s:Qe(t[0]),e:Qe(t[0])},e),Fa("rId"+r,e);var s=t[1].Target.indexOf("#"),n=s==-1?"":t[1].Target.slice(s+1);return Ze(n||"",e),Ze(t[1].Tooltip||"",e),Ze("",e),e.slice(0,e.l)}function bp(){}function wp(t,r,e){var s=t.l+r,n=el(t),i=t.read_shift(1),o=[n];if(o[2]=i,e.cellFormula){var l=cm(t,s-t.l,e);o[1]=l}else t.l=s;return o}function _p(t,r,e){var s=t.l+r,n=Cr(t),i=[n];if(e.cellFormula){var o=fm(t,s-t.l,e);i[1]=o,t.l=s}else t.l=s;return i}function Sp(t,r,e){e==null&&(e=q(18));var s=Cn(t,r);e.write_shift(-4,t),e.write_shift(-4,t),e.write_shift(4,(s.width||10)*256),e.write_shift(4,0);var n=0;return r.hidden&&(n|=1),typeof s.width=="number"&&(n|=2),r.level&&(n|=r.level<<8),e.write_shift(2,n),e}var Ll=["left","right","top","bottom","header","footer"];function Np(t){var r={};return Ll.forEach(function(e){r[e]=Jr(t)}),r}function jp(t,r){return r==null&&(r=q(6*8)),Il(t),Ll.forEach(function(e){wr(t[e],r)}),r}function Ep(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function Tp(t,r,e){e==null&&(e=q(30));var s=924;return(((r||{}).Views||[])[0]||{}).RTL&&(s|=32),e.write_shift(2,s),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function Cp(t){var r=q(24);return r.write_shift(4,4),r.write_shift(4,1),Yr(t,r),r}function Ap(t,r){return r==null&&(r=q(16*4+2)),r.write_shift(2,t.password?vl(t.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,t[e[0]]!=null&&!t[e[0]]?1:0):r.write_shift(4,t[e[0]]!=null&&t[e[0]]?0:1)}),r}function kp(){}function Rp(){}function Fp(t,r,e,s,n,i,o){if(r.v===void 0)return!1;var l="";switch(r.t){case"b":l=r.v?"1":"0";break;case"d":r=bt(r),r.z=r.z||Ge[14],r.v=yt(xt(r.v)),r.t="n";break;case"n":case"e":l=""+r.v;break;default:l=r.v;break}var c={r:e,c:s};switch(c.s=dr(n.cellXfs,r,n),r.l&&i["!links"].push([De(c),r.l]),r.c&&i["!comments"].push([De(c),r.c]),r.t){case"s":case"str":return n.bookSST?(l=Ba(n.Strings,r.v,n.revStrings),c.t="s",c.v=l,o?ee(t,18,Jm(r,c)):ee(t,7,qm(r,c))):(c.t="str",o?ee(t,17,dp(r,c)):ee(t,6,lp(r,c))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?o?ee(t,13,ap(r,c)):ee(t,2,sp(r,c)):o?ee(t,16,tp(r,c)):ee(t,5,Zm(r,c)),!0;case"b":return c.t="b",o?ee(t,15,Hm(r,c)):ee(t,4,Um(r,c)),!0;case"e":return c.t="e",o?ee(t,14,Xm(r,c)):ee(t,3,Gm(r,c)),!0}return o?ee(t,12,Mm(r,c)):ee(t,1,Lm(r,c)),!0}function Dp(t,r,e,s){var n=Le(r["!ref"]||"A1"),i,o="",l=[];ee(t,145);var c=Array.isArray(r),f=n.e.r;r["!rows"]&&(f=Math.max(n.e.r,r["!rows"].length-1));for(var d=n.s.r;d<=f;++d){o=nt(d),km(t,r,n,d);var h=!1;if(d<=n.e.r)for(var u=n.s.c;u<=n.e.c;++u){d===n.s.r&&(l[u]=ot(u)),i=l[u]+o;var m=c?(r[d]||[])[u]:r[i];if(!m){h=!1;continue}h=Fp(t,m,d,u,s,r,h)}}ee(t,146)}function Op(t,r){!r||!r["!merges"]||(ee(t,177,gp(r["!merges"].length)),r["!merges"].forEach(function(e){ee(t,176,pp(e))}),ee(t,178))}function Ip(t,r){!r||!r["!cols"]||(ee(t,390),r["!cols"].forEach(function(e,s){e&&ee(t,60,Sp(s,e))}),ee(t,391))}function Pp(t,r){!r||!r["!ref"]||(ee(t,648),ee(t,649,Cp(Le(r["!ref"]))),ee(t,650))}function Lp(t,r,e){r["!links"].forEach(function(s){if(s[1].Target){var n=Re(e,-1,s[1].Target.replace(/#.*$/,""),Te.HLINK);ee(t,494,yp(s,n))}}),delete r["!links"]}function Bp(t,r,e,s){if(r["!comments"].length>0){var n=Re(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Te.VML);ee(t,551,Fa("rId"+n)),r["!legacy"]=n}}function Mp(t,r,e,s){if(r["!autofilter"]){var n=r["!autofilter"],i=typeof n.ref=="string"?n.ref:Ke(n.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var o=e.Workbook.Names,l=jt(i);l.s.r==l.e.r&&(l.e.r=jt(r["!ref"]).e.r,i=Ke(l));for(var c=0;c<o.length;++c){var f=o[c];if(f.Name=="_xlnm._FilterDatabase"&&f.Sheet==s){f.Ref="'"+e.SheetNames[s]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+e.SheetNames[s]+"'!"+i}),ee(t,161,Yr(Le(i))),ee(t,162)}}function zp(t,r,e){ee(t,133),ee(t,137,Tp(r,e)),ee(t,138),ee(t,134)}function Up(t,r){r["!protect"]&&ee(t,535,Ap(r["!protect"]))}function $p(t,r,e,s){var n=vt(),i=e.SheetNames[t],o=e.Sheets[i]||{},l=i;try{e&&e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}var c=Le(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ee(n,129),(e.vbaraw||o["!outline"])&&ee(n,147,Im(l,o["!outline"])),ee(n,148,Fm(c)),zp(n,o,e.Workbook),Ip(n,o),Dp(n,o,t,r),Up(n,o),Mp(n,o,e,t),Op(n,o),Lp(n,o,s),o["!margins"]&&ee(n,476,jp(o["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&Pp(n,o),Bp(n,o,t,s),ee(n,130),n.end()}function Hp(t,r){t.l+=10;var e=lt(t);return{name:e}}var Wp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Gp(t){return!t.Workbook||!t.Workbook.WBProps?"false":_f(t.Workbook.WBProps.date1904)?"true":"false"}var Vp="][*?/\\".split("");function Bl(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return Vp.forEach(function(s){if(t.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}function Xp(t,r,e){t.forEach(function(s,n){Bl(s);for(var i=0;i<n;++i)if(s==t[i])throw new Error("Duplicate Sheet Name: "+s);if(e){var o=r&&r[n]&&r[n].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Kp(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var r=t.Workbook&&t.Workbook.Sheets||[];Xp(t.SheetNames,r,!!t.vbaraw);for(var e=0;e<t.SheetNames.length;++e)pm(t.Sheets[t.SheetNames[e]],t.SheetNames[e],e)}function Ml(t){var r=[qe];r[r.length]=ne("workbook",null,{xmlns:Kr[0],"xmlns:r":Je.r});var e=t.Workbook&&(t.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Wp.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(s.codeName=t.Workbook.WBProps.CodeName,delete s.CodeName)),r[r.length]=ne("workbookPr",null,s);var n=t.Workbook&&t.Workbook.Sheets||[],i=0;if(n&&n[0]&&n[0].Hidden){for(r[r.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!n[i]||!n[i].Hidden);++i);i==t.SheetNames.length&&(i=0),r[r.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:Fe(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),n[i])switch(n[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}r[r.length]=ne("sheet",null,o)}return r[r.length]="</sheets>",e&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(r[r.length]=ne("definedName",Fe(l.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function qp(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=oa(t),e.name=lt(t),e}function Yp(t,r){return r||(r=q(127)),r.write_shift(4,t.Hidden),r.write_shift(4,t.iTabID),Fa(t.strRelID,r),Ze(t.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function Jp(t,r){var e={},s=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var n=r>8?lt(t):"";return n.length>0&&(e.CodeName=n),e.autoCompressPictures=!!(s&65536),e.backupFile=!!(s&64),e.checkCompatibility=!!(s&4096),e.date1904=!!(s&1),e.filterPrivacy=!!(s&8),e.hidePivotFieldList=!!(s&1024),e.promptedSolutions=!!(s&16),e.publishItems=!!(s&2048),e.refreshAllConnections=!!(s&262144),e.saveExternalLinkValues=!!(s&128),e.showBorderUnselectedTables=!!(s&4),e.showInkAnnotation=!!(s&32),e.showObjects=["all","placeholders","none"][s>>13&3],e.showPivotChartFilter=!!(s&32768),e.updateLinks=["userSet","never","always"][s>>8&3],e}function Qp(t,r){r||(r=q(72));var e=0;return t&&t.filterPrivacy&&(e|=8),r.write_shift(4,e),r.write_shift(4,0),Jo(t&&t.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function Zp(t,r,e){var s=t.l+r;t.l+=4,t.l+=1;var n=t.read_shift(4),i=Gf(t),o=dm(t,0,e),l=Ra(t);t.l=s;var c={Name:i,Ptg:o};return n<268435455&&(c.Sheet=n),l&&(c.Comment=l),c}function e1(t,r){ee(t,143);for(var e=0;e!=r.SheetNames.length;++e){var s=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e]&&r.Workbook.Sheets[e].Hidden||0,n={Hidden:s,iTabID:e+1,strRelID:"rId"+(e+1),name:r.SheetNames[e]};ee(t,156,Yp(n))}ee(t,144)}function t1(t,r){r||(r=q(127));for(var e=0;e!=4;++e)r.write_shift(4,0);return Ze("SheetJS",r),Ze(Js.version,r),Ze(Js.version,r),Ze("7262",r),r.length>r.l?r.slice(0,r.l):r}function r1(t,r){r||(r=q(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,t),r.write_shift(4,t);var e=120;return r.write_shift(1,e),r.length>r.l?r.slice(0,r.l):r}function s1(t,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var e=r.Workbook.Sheets,s=0,n=-1,i=-1;s<e.length;++s)!e[s]||!e[s].Hidden&&n==-1?n=s:e[s].Hidden==1&&i==-1&&(i=s);i>n||(ee(t,135),ee(t,158,r1(n)),ee(t,136))}}function n1(t,r){var e=vt();return ee(e,131),ee(e,128,t1()),ee(e,153,Qp(t.Workbook&&t.Workbook.WBProps||null)),s1(e,t),e1(e,t),ee(e,132),e.end()}function a1(t,r,e){return(r.slice(-4)===".bin"?n1:Ml)(t)}function i1(t,r,e,s,n){return(r.slice(-4)===".bin"?$p:Pl)(t,e,s,n)}function o1(t,r,e){return(r.slice(-4)===".bin"?ju:wl)(t,e)}function l1(t,r,e){return(r.slice(-4)===".bin"?Qh:gl)(t,e)}function c1(t,r,e){return(r.slice(-4)===".bin"?Uu:El)(t)}function d1(t){return(t.slice(-4)===".bin"?Du:Nl)()}function f1(t,r){var e=[];return t.Props&&e.push(oh(t.Props,r)),t.Custprops&&e.push(lh(t.Props,t.Custprops)),e.join("")}function h1(){return""}function u1(t,r){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(s,n){var i=[];i.push(ne("NumberFormat",null,{"ss:Format":Fe(Ge[s.numFmtId])}));var o={"ss:ID":"s"+(21+n)};e.push(ne("Style",i.join(""),o))}),ne("Styles",e.join(""))}function zl(t){return ne("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Pa(t.Ref,{r:0,c:0})})}function x1(t){if(!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,e=[],s=0;s<r.length;++s){var n=r[s];n.Sheet==null&&(n.Name.match(/^_xlfn\./)||e.push(zl(n)))}return ne("Names",e.join(""))}function m1(t,r,e,s){if(!t||!((s||{}).Workbook||{}).Names)return"";for(var n=s.Workbook.Names,i=[],o=0;o<n.length;++o){var l=n[o];l.Sheet==e&&(l.Name.match(/^_xlfn\./)||i.push(zl(l)))}return i.join("")}function p1(t,r,e,s){if(!t)return"";var n=[];if(t["!margins"]&&(n.push("<PageSetup>"),t["!margins"].header&&n.push(ne("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&n.push(ne("Footer",null,{"x:Margin":t["!margins"].footer})),n.push(ne("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),n.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[e])if(s.Workbook.Sheets[e].Hidden)n.push(ne("Visible",s.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<e&&!(s.Workbook.Sheets[i]&&!s.Workbook.Sheets[i].Hidden);++i);i==e&&n.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&n.push("<DisplayRightToLeft/>"),t["!protect"]&&(n.push(st("ProtectContents","True")),t["!protect"].objects&&n.push(st("ProtectObjects","True")),t["!protect"].scenarios&&n.push(st("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?n.push(st("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&n.push(st("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&n.push("<"+o[1]+"/>")})),n.length==0?"":ne("WorksheetOptions",n.join(""),{xmlns:St.x})}function g1(t){return t.map(function(r){var e=wf(r.t||""),s=ne("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return ne("Comment",s,{"ss:Author":r.a})}).join("")}function v1(t,r,e,s,n,i,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+Fe(Pa(t.f,o))),t.F&&t.F.slice(0,r.length)==r){var c=Qe(t.F.slice(r.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=Fe(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=Fe(t.l.Tooltip))),e["!merges"])for(var f=e["!merges"],d=0;d!=f.length;++d)f[d].s.c!=o.c||f[d].s.r!=o.r||(f[d].e.c>f[d].s.c&&(l["ss:MergeAcross"]=f[d].e.c-f[d].s.c),f[d].e.r>f[d].s.r&&(l["ss:MergeDown"]=f[d].e.r-f[d].s.r));var h="",u="";switch(t.t){case"z":if(!s.sheetStubs)return"";break;case"n":h="Number",u=String(t.v);break;case"b":h="Boolean",u=t.v?"1":"0";break;case"e":h="Error",u=Ts[t.v];break;case"d":h="DateTime",u=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Ge[14]);break;case"s":h="String",u=bf(t.v||"");break}var m=dr(s.cellXfs,t,s);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=o.c+1;var p=t.v!=null?u:"",x=t.t=="z"?"":'<Data ss:Type="'+h+'">'+p+"</Data>";return(t.c||[]).length>0&&(x+=g1(t.c)),ne("Cell",x,l)}function y1(t,r){var e='<Row ss:Index="'+(t+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=bl(r.hpt)),r.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(e+=' ss:Hidden="1"')),e+">"}function b1(t,r,e,s){if(!t["!ref"])return"";var n=Le(t["!ref"]),i=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(g,T){Oa(g);var _=!!g.width,S=Cn(T,g),A={"ss:Index":T+1};_&&(A["ss:Width"]=ln(S.width)),g.hidden&&(A["ss:Hidden"]="1"),l.push(ne("Column",null,A))});for(var c=Array.isArray(t),f=n.s.r;f<=n.e.r;++f){for(var d=[y1(f,(t["!rows"]||[])[f])],h=n.s.c;h<=n.e.c;++h){var u=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>h)&&!(i[o].s.r>f)&&!(i[o].e.c<h)&&!(i[o].e.r<f)){(i[o].s.c!=h||i[o].s.r!=f)&&(u=!0);break}if(!u){var m={r:f,c:h},p=De(m),x=c?(t[f]||[])[h]:t[p];d.push(v1(x,p,t,r,e,s,m))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function w1(t,r,e){var s=[],n=e.SheetNames[t],i=e.Sheets[n],o=i?m1(i,r,t,e):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=i?b1(i,r,t,e):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(p1(i,r,t,e)),s.join("")}function _1(t,r){r||(r={}),t.SSF||(t.SSF=bt(Ge)),t.SSF&&(Sn(),_n(t.SSF),r.revssf=Nn(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF,r.cellXfs=[],dr(r.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(f1(t,r)),e.push(h1()),e.push(""),e.push("");for(var s=0;s<t.SheetNames.length;++s)e.push(ne("Worksheet",w1(s,r,t),{"ss:Name":Fe(t.SheetNames[s])}));return e[2]=u1(t,r),e[3]=x1(t),qe+ne("Workbook",e.join(""),{xmlns:St.ss,"xmlns:o":St.o,"xmlns:x":St.x,"xmlns:ss":St.ss,"xmlns:dt":St.dt,"xmlns:html":St.html})}var Wn={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function S1(t,r){var e=[],s=[],n=[],i=0,o,l=yi(Fi,"n"),c=yi(Di,"n");if(t.Props)for(o=at(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?e:Object.prototype.hasOwnProperty.call(c,o[i])?s:n).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=at(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?e:Object.prototype.hasOwnProperty.call(c,o[i])?s:n).push([o[i],t.Custprops[o[i]]]);var f=[];for(i=0;i<n.length;++i)dl.indexOf(n[i][0])>-1||ol.indexOf(n[i][0])>-1||n[i][1]!=null&&f.push(n[i]);s.length&&Oe.utils.cfb_add(r,"/SummaryInformation",Bi(s,Wn.SI,c,Di)),(e.length||f.length)&&Oe.utils.cfb_add(r,"/DocumentSummaryInformation",Bi(e,Wn.DSI,l,Fi,f.length?f:null,Wn.UDI))}function N1(t,r){var e=r||{},s=Oe.utils.cfb_new({root:"R"}),n="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":n="/Workbook",e.biff=8;break;case"biff5":n="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Oe.utils.cfb_add(s,n,Ul(t,e)),e.biff==8&&(t.Props||t.Custprops)&&S1(t,s),e.biff==8&&t.vbaraw&&$u(s,Oe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),s}var j1={0:{f:Cm},1:{f:Pm},2:{f:rp},3:{f:Wm},4:{f:zm},5:{f:Qm},6:{f:op},7:{f:Km},8:{f:xp},9:{f:up},10:{f:fp},11:{f:hp},12:{f:Bm},13:{f:np},14:{f:Vm},15:{f:$m},16:{f:ep},17:{f:cp},18:{f:Ym},19:{f:ka},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Zp},40:{},42:{},43:{f:ou},44:{f:au},45:{f:du},46:{f:hu},47:{f:fu},48:{},49:{f:Bf},50:{},51:{f:Cu},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Mh},62:{f:ip},63:{f:Ou},64:{f:kp},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:$t,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ep},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Om},148:{f:Rm,p:16},151:{f:bp},152:{},153:{f:Jp},154:{},155:{},156:{f:qp},157:{},158:{},159:{T:1,f:qh},160:{T:-1},161:{T:1,f:Cr},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:mp},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Eu},336:{T:-1},337:{f:Ru,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:oa},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Dh},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:wp},427:{f:_p},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Np},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Dm},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:vp},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:oa},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Mu},633:{T:1},634:{T:-1},635:{T:1,f:Lu},636:{T:-1},637:{f:$f},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Hp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Rp},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ae(t,r,e,s){var n=r;if(!isNaN(n)){var i=s||(e||[]).length||0,o=t.next(4);o.write_shift(2,n),o.write_shift(2,i),i>0&&Ta(e)&&t.push(e)}}function E1(t,r,e,s){var n=(e||[]).length||0;if(n<=8224)return ae(t,r,e,n);var i=r;if(!isNaN(i)){for(var o=e.parts||[],l=0,c=0,f=0;f+(o[l]||8224)<=8224;)f+=o[l]||8224,l++;var d=t.next(4);for(d.write_shift(2,i),d.write_shift(2,f),t.push(e.slice(c,c+f)),c+=f;c<n;){for(d=t.next(4),d.write_shift(2,60),f=0;f+(o[l]||8224)<=8224;)f+=o[l]||8224,l++;d.write_shift(2,f),t.push(e.slice(c,c+f)),c+=f}}}function As(t,r,e){return t||(t=q(7)),t.write_shift(2,r),t.write_shift(2,e),t.write_shift(2,0),t.write_shift(1,0),t}function T1(t,r,e,s){var n=q(9);return As(n,t,r),hl(e,s||"b",n),n}function C1(t,r,e){var s=q(8+2*e.length);return As(s,t,r),s.write_shift(1,e.length),s.write_shift(e.length,e,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function A1(t,r,e,s){if(r.v!=null)switch(r.t){case"d":case"n":var n=r.t=="d"?yt(xt(r.v)):r.v;n==(n|0)&&n>=0&&n<65536?ae(t,2,Hh(e,s,n)):ae(t,3,$h(e,s,n));return;case"b":case"e":ae(t,5,T1(e,s,r.v,r.t));return;case"s":case"str":ae(t,4,C1(e,s,(r.v||"").slice(0,255)));return}ae(t,1,As(null,e,s))}function k1(t,r,e,s){var n=Array.isArray(r),i=Le(r["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(s.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Ke(i)}for(var f=i.s.r;f<=i.e.r;++f){l=nt(f);for(var d=i.s.c;d<=i.e.c;++d){f===i.s.r&&(c[d]=ot(d)),o=c[d]+l;var h=n?(r[f]||[])[d]:r[o];h&&A1(t,h,f,d)}}}function R1(t,r){for(var e=r||{},s=vt(),n=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==e.sheet&&(n=i);if(n==0&&e.sheet&&t.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return ae(s,e.biff==4?1033:e.biff==3?521:9,Da(t,16,e)),k1(s,t.Sheets[t.SheetNames[n]],n,e),ae(s,10),s.end()}function F1(t,r,e){ae(t,49,jh({sz:12,name:"Arial"},e))}function D1(t,r,e){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var n=s[0];n<=s[1];++n)r[n]!=null&&ae(t,1054,Ch(n,r[n],e))})}function O1(t,r){var e=q(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),ae(t,2151,e),e=q(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),ml(Le(r["!ref"]||"A1"),e),e.write_shift(4,4),ae(t,2152,e)}function I1(t,r){for(var e=0;e<16;++e)ae(t,224,zi({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(s){ae(t,224,zi(s,0,r))})}function P1(t,r){for(var e=0;e<r["!links"].length;++e){var s=r["!links"][e];ae(t,440,Ph(s)),s[1].Tooltip&&ae(t,2048,Lh(s))}delete r["!links"]}function L1(t,r){if(r){var e=0;r.forEach(function(s,n){++e<=256&&s&&ae(t,125,zh(Cn(n,s),n))})}}function B1(t,r,e,s,n){var i=16+dr(n.cellXfs,r,n);if(r.v==null&&!r.bf){ae(t,513,_r(e,s,i));return}if(r.bf)ae(t,6,lm(r,e,s,n,i));else switch(r.t){case"d":case"n":var o=r.t=="d"?yt(xt(r.v)):r.v;ae(t,515,Fh(e,s,o,i));break;case"b":case"e":ae(t,517,Rh(e,s,r.v,i,n,r.t));break;case"s":case"str":if(n.bookSST){var l=Ba(n.Strings,r.v,n.revStrings);ae(t,253,Eh(e,s,l,i))}else ae(t,516,Th(e,s,(r.v||"").slice(0,255),i,n));break;default:ae(t,513,_r(e,s,i))}}function M1(t,r,e){var s=vt(),n=e.SheetNames[t],i=e.Sheets[n]||{},o=(e||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(i),f=r.biff==8,d,h="",u=[],m=Le(i["!ref"]||"A1"),p=f?65536:16384;if(m.e.c>255||m.e.r>=p){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,p-1)}ae(s,2057,Da(e,16,r)),ae(s,13,Ct(1)),ae(s,12,Ct(100)),ae(s,15,ut(!0)),ae(s,17,ut(!1)),ae(s,16,wr(.001)),ae(s,95,ut(!0)),ae(s,42,ut(!1)),ae(s,43,ut(!1)),ae(s,130,Ct(1)),ae(s,128,kh()),ae(s,131,ut(!1)),ae(s,132,ut(!1)),f&&L1(s,i["!cols"]),ae(s,512,Ah(m,r)),f&&(i["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){h=nt(x);for(var g=m.s.c;g<=m.e.c;++g){x===m.s.r&&(u[g]=ot(g)),d=u[g]+h;var T=c?(i[x]||[])[g]:i[d];T&&(B1(s,T,x,g,r),f&&T.l&&i["!links"].push([d,T.l]))}}var _=l.CodeName||l.name||n;return f&&ae(s,574,Nh((o.Views||[])[0])),f&&(i["!merges"]||[]).length&&ae(s,229,Ih(i["!merges"])),f&&P1(s,i),ae(s,442,xl(_)),f&&O1(s,i),ae(s,10),s.end()}function z1(t,r,e){var s=vt(),n=(t||{}).Workbook||{},i=n.Sheets||[],o=n.WBProps||{},l=e.biff==8,c=e.biff==5;if(ae(s,2057,Da(t,5,e)),e.bookType=="xla"&&ae(s,135),ae(s,225,l?Ct(1200):null),ae(s,193,fh(2)),c&&ae(s,191),c&&ae(s,192),ae(s,226),ae(s,92,bh("SheetJS",e)),ae(s,66,Ct(l?1200:1252)),l&&ae(s,353,Ct(0)),l&&ae(s,448),ae(s,317,Uh(t.SheetNames.length)),l&&t.vbaraw&&ae(s,211),l&&t.vbaraw){var f=o.CodeName||"ThisWorkbook";ae(s,442,xl(f))}ae(s,156,Ct(17)),ae(s,25,ut(!1)),ae(s,18,ut(!1)),ae(s,19,Ct(0)),l&&ae(s,431,ut(!1)),l&&ae(s,444,Ct(0)),ae(s,61,Sh()),ae(s,64,ut(!1)),ae(s,141,Ct(0)),ae(s,34,ut(Gp(t)=="true")),ae(s,14,ut(!0)),l&&ae(s,439,ut(!1)),ae(s,218,Ct(0)),F1(s,t,e),D1(s,t.SSF,e),I1(s,e),l&&ae(s,352,ut(!1));var d=s.end(),h=vt();l&&ae(h,140,Bh()),l&&e.Strings&&E1(h,252,_h(e.Strings)),ae(h,10);var u=h.end(),m=vt(),p=0,x=0;for(x=0;x<t.SheetNames.length;++x)p+=(l?12:11)+(l?2:1)*t.SheetNames[x].length;var g=d.length+p+u.length;for(x=0;x<t.SheetNames.length;++x){var T=i[x]||{};ae(m,133,wh({pos:g,hs:T.Hidden||0,dt:0,name:t.SheetNames[x]},e)),g+=r[x].length}var _=m.end();if(p!=_.length)throw new Error("BS8 "+p+" != "+_.length);var S=[];return d.length&&S.push(d),_.length&&S.push(_),u.length&&S.push(u),rt(S)}function U1(t,r){var e=r||{},s=[];t&&!t.SSF&&(t.SSF=bt(Ge)),t&&t.SSF&&(Sn(),_n(t.SSF),e.revssf=Nn(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ma(e),e.cellXfs=[],dr(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var n=0;n<t.SheetNames.length;++n)s[s.length]=M1(n,e,t);return s.unshift(z1(t,s,e)),rt(s)}function Ul(t,r){for(var e=0;e<=t.SheetNames.length;++e){var s=t.Sheets[t.SheetNames[e]];if(!(!s||!s["!ref"])){var n=jt(s["!ref"]);n.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var i=r||{};switch(i.biff||2){case 8:case 5:return U1(t,r);case 4:case 3:case 2:return R1(t,r)}throw new Error("invalid type "+i.bookType+" for BIFF")}function $1(t,r,e,s){for(var n=t["!merges"]||[],i=[],o=r.s.c;o<=r.e.c;++o){for(var l=0,c=0,f=0;f<n.length;++f)if(!(n[f].s.r>e||n[f].s.c>o)&&!(n[f].e.r<e||n[f].e.c<o)){if(n[f].s.r<e||n[f].s.c<o){l=-1;break}l=n[f].e.r-n[f].s.r+1,c=n[f].e.c-n[f].s.c+1;break}if(!(l<0)){var d=De({r:e,c:o}),h=s.dense?(t[e]||[])[o]:t[d],u=h&&h.v!=null&&(h.h||yf(h.w||(Qt(h),h.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),s.editable?u='<span contenteditable="true">'+u+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+h.l.Target+'">'+u+"</a>")),m.id=(s.id||"sjs")+"-"+d,i.push(ne("td",u,m))}}var p="<tr>";return p+i.join("")+"</tr>"}var H1='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',W1="</body></html>";function G1(t,r,e){var s=[];return s.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function $l(t,r){var e=r||{},s=e.header!=null?e.header:H1,n=e.footer!=null?e.footer:W1,i=[s],o=jt(t["!ref"]);e.dense=Array.isArray(t),i.push(G1(t,o,e));for(var l=o.s.r;l<=o.e.r;++l)i.push($1(t,o,l,e));return i.push("</table>"+n),i.join("")}function Hl(t,r,e){var s=e||{},n=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")n=s.origin;else{var o=typeof s.origin=="string"?Qe(s.origin):s.origin;n=o.r,i=o.c}var l=r.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,l.length),f={s:{r:0,c:0},e:{r:n,c:i}};if(t["!ref"]){var d=jt(t["!ref"]);f.s.r=Math.min(f.s.r,d.s.r),f.s.c=Math.min(f.s.c,d.s.c),f.e.r=Math.max(f.e.r,d.e.r),f.e.c=Math.max(f.e.c,d.e.c),n==-1&&(f.e.r=n=d.e.r+1)}var h=[],u=0,m=t["!rows"]||(t["!rows"]=[]),p=0,x=0,g=0,T=0,_=0,S=0;for(t["!cols"]||(t["!cols"]=[]);p<l.length&&x<c;++p){var A=l[p];if(Xi(A)){if(s.display)continue;m[x]={hidden:!0}}var D=A.children;for(g=T=0;g<D.length;++g){var z=D[g];if(!(s.display&&Xi(z))){var C=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):Sf(z.innerHTML),I=z.getAttribute("data-z")||z.getAttribute("z");for(u=0;u<h.length;++u){var O=h[u];O.s.c==T+i&&O.s.r<x+n&&x+n<=O.e.r&&(T=O.e.c+1-i,u=-1)}S=+z.getAttribute("colspan")||1,((_=+z.getAttribute("rowspan")||1)>1||S>1)&&h.push({s:{r:x+n,c:T+i},e:{r:x+n+(_||1)-1,c:T+i+(S||1)-1}});var P={t:"s",v:C},H=z.getAttribute("data-t")||z.getAttribute("t")||"";C!=null&&(C.length==0?P.t=H||"z":s.raw||C.trim().length==0||H=="s"||(C==="TRUE"?P={t:"b",v:!0}:C==="FALSE"?P={t:"b",v:!1}:isNaN(qt(C))?isNaN(ps(C).getDate())||(P={t:"d",v:xt(C)},s.cellDates||(P={t:"n",v:yt(P.v)}),P.z=s.dateNF||Ge[14]):P={t:"n",v:qt(C)})),P.z===void 0&&I!=null&&(P.z=I);var W="",te=z.getElementsByTagName("A");if(te&&te.length)for(var pe=0;pe<te.length&&!(te[pe].hasAttribute("href")&&(W=te[pe].getAttribute("href"),W.charAt(0)!="#"));++pe);W&&W.charAt(0)!="#"&&(P.l={Target:W}),s.dense?(t[x+n]||(t[x+n]=[]),t[x+n][T+i]=P):t[De({c:T+i,r:x+n})]=P,f.e.c<T+i&&(f.e.c=T+i),T+=S}}++x}return h.length&&(t["!merges"]=(t["!merges"]||[]).concat(h)),f.e.r=Math.max(f.e.r,x-1+n),t["!ref"]=Ke(f),x>=c&&(t["!fullref"]=Ke((f.e.r=l.length-p+x-1+n,f))),t}function Wl(t,r){var e=r||{},s=e.dense?[]:{};return Hl(s,t,r)}function V1(t,r){return Nr(Wl(t,r),r)}function Xi(t){var r="",e=X1(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function X1(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var K1=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+vs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return qe+r}}(),Ki=function(){var t=function(i){return Fe(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,s=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Fe(o.SheetNames[l])+`" table:style-name="ta1">
`);var f=0,d=0,h=jt(i["!ref"]||"A1"),u=i["!merges"]||[],m=0,p=Array.isArray(i);if(i["!cols"])for(d=0;d<=h.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",g=i["!rows"]||[];for(f=0;f<h.s.r;++f)x=g[f]?' table:style-name="ro'+g[f].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;f<=h.e.r;++f){for(x=g[f]?' table:style-name="ro'+g[f].ods+'"':"",c.push("        <table:table-row"+x+`>
`),d=0;d<h.s.c;++d)c.push(r);for(;d<=h.e.c;++d){var T=!1,_={},S="";for(m=0;m!=u.length;++m)if(!(u[m].s.c>d)&&!(u[m].s.r>f)&&!(u[m].e.c<d)&&!(u[m].e.r<f)){(u[m].s.c!=d||u[m].s.r!=f)&&(T=!0),_["table:number-columns-spanned"]=u[m].e.c-u[m].s.c+1,_["table:number-rows-spanned"]=u[m].e.r-u[m].s.r+1;break}if(T){c.push(e);continue}var A=De({r:f,c:d}),D=p?(i[f]||[])[d]:i[A];if(D&&D.f&&(_["table:formula"]=Fe(xm(D.f)),D.F&&D.F.slice(0,A.length)==A)){var z=jt(D.F);_["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,_["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!D){c.push(r);continue}switch(D.t){case"b":S=D.v?"TRUE":"FALSE",_["office:value-type"]="boolean",_["office:boolean-value"]=D.v?"true":"false";break;case"n":S=D.w||String(D.v||0),_["office:value-type"]="float",_["office:value"]=D.v||0;break;case"s":case"str":S=D.v==null?"":D.v,_["office:value-type"]="string";break;case"d":S=D.w||xt(D.v).toISOString(),_["office:value-type"]="date",_["office:date-value"]=xt(D.v).toISOString(),_["table:style-name"]="ce1";break;default:c.push(r);continue}var C=t(S);if(D.l&&D.l.Target){var I=D.l.Target;I=I.charAt(0)=="#"?"#"+mm(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),C=ne("text:a",C,{"xlink:href":I.replace(/&/g,"&amp;")})}c.push("          "+ne("table:table-cell",ne("text:p",C,{}),_)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},n=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(f){return o.Sheets[f]}).forEach(function(f){if(f&&f["!cols"]){for(var d=0;d<f["!cols"].length;++d)if(f["!cols"][d]){var h=f["!cols"][d];if(h.width==null&&h.wpx==null&&h.wch==null)continue;Oa(h),h.ods=l;var u=f["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(f){return o.Sheets[f]}).forEach(function(f){if(f&&f["!rows"]){for(var d=0;d<f["!rows"].length;++d)if(f["!rows"][d]){f["!rows"][d].ods=c;var h=f["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[qe],f=vs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=vs({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+f+d+`>
`),c.push(al().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+f+`>
`),n(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var h=0;h!=o.SheetNames.length;++h)c.push(s(o.Sheets[o.SheetNames[h]],o,h));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Gl(t,r){if(r.bookType=="fods")return Ki(t,r);var e=Sa(),s="",n=[],i=[];return s="mimetype",we(e,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",we(e,s,Ki(t,r)),n.push([s,"text/xml"]),i.push([s,"ContentFile"]),s="styles.xml",we(e,s,K1(t,r)),n.push([s,"text/xml"]),i.push([s,"StylesFile"]),s="meta.xml",we(e,s,qe+al()),n.push([s,"text/xml"]),i.push([s,"MetadataFile"]),s="manifest.rdf",we(e,s,ih(i)),n.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",we(e,s,nh(n)),e}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function fn(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function q1(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):It(gs(t))}function Y1(t,r){e:for(var e=0;e<=t.length-r.length;++e){for(var s=0;s<r.length;++s)if(t[e+s]!=r[s])continue e;return!0}return!1}function cr(t){var r=t.reduce(function(n,i){return n+i.length},0),e=new Uint8Array(r),s=0;return t.forEach(function(n){e.set(n,s),s+=n.length}),e}function J1(t,r,e){var s=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,n=e/Math.pow(10,s-6176);t[r+15]|=s>>7,t[r+14]|=(s&127)<<1;for(var i=0;n>=1;++i,n/=256)t[r+i]=n&255;t[r+15]|=e>=0?0:128}function ys(t,r){var e=r?r[0]:0,s=t[e]&127;e:if(t[e++]>=128&&(s|=(t[e]&127)<<7,t[e++]<128||(s|=(t[e]&127)<<14,t[e++]<128)||(s|=(t[e]&127)<<21,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),s}function ke(t){var r=new Uint8Array(7);r[0]=t&127;var e=1;e:if(t>127){if(r[e-1]|=128,r[e]=t>>7&127,++e,t<=16383||(r[e-1]|=128,r[e]=t>>14&127,++e,t<=2097151)||(r[e-1]|=128,r[e]=t>>21&127,++e,t<=268435455)||(r[e-1]|=128,r[e]=t/256>>>21&127,++e,t<=34359738367)||(r[e-1]|=128,r[e]=t/65536>>>21&127,++e,t<=4398046511103))break e;r[e-1]|=128,r[e]=t/16777216>>>21&127,++e}return r.slice(0,e)}function Mr(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function Ye(t){for(var r=[],e=[0];e[0]<t.length;){var s=e[0],n=ys(t,e),i=n&7;n=Math.floor(n/8);var o=0,l;if(n==0)break;switch(i){case 0:{for(var c=e[0];t[e[0]++]>=128;);l=t.slice(c,e[0])}break;case 5:o=4,l=t.slice(e[0],e[0]+o),e[0]+=o;break;case 1:o=8,l=t.slice(e[0],e[0]+o),e[0]+=o;break;case 2:o=ys(t,e),l=t.slice(e[0],e[0]+o),e[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(n," at offset ").concat(s))}var f={data:l,type:i};r[n]==null?r[n]=[f]:r[n].push(f)}return r}function et(t){var r=[];return t.forEach(function(e,s){e.forEach(function(n){n.data&&(r.push(ke(s*8+n.type)),n.type==2&&r.push(ke(n.data.length)),r.push(n.data))})}),cr(r)}function Ft(t){for(var r,e=[],s=[0];s[0]<t.length;){var n=ys(t,s),i=Ye(t.slice(s[0],s[0]+n));s[0]+=n;var o={id:Mr(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Ye(l.data),f=Mr(c[3][0].data);o.messages.push({meta:c,data:t.slice(s[0],s[0]+f)}),s[0]+=f}),(r=i[3])!=null&&r[0]&&(o.merge=Mr(i[3][0].data)>>>0>0),e.push(o)}return e}function Rr(t){var r=[];return t.forEach(function(e){var s=[];s[1]=[{data:ke(e.id),type:0}],s[2]=[],e.merge!=null&&(s[3]=[{data:ke(+!!e.merge),type:0}]);var n=[];e.messages.forEach(function(o){n.push(o.data),o.meta[3]=[{type:0,data:ke(o.data.length)}],s[2].push({data:et(o.meta),type:2})});var i=et(s);r.push(ke(i.length)),r.push(i),n.forEach(function(o){return r.push(o)})}),cr(r)}function Q1(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],s=ys(r,e),n=[];e[0]<r.length;){var i=r[e[0]]&3;if(i==0){var o=r[e[0]++]>>2;if(o<60)++o;else{var l=o-59;o=r[e[0]],l>1&&(o|=r[e[0]+1]<<8),l>2&&(o|=r[e[0]+2]<<16),l>3&&(o|=r[e[0]+3]<<24),o>>>=0,o++,e[0]+=l}n.push(r.slice(e[0],e[0]+o)),e[0]+=o;continue}else{var c=0,f=0;if(i==1?(f=(r[e[0]]>>2&7)+4,c=(r[e[0]++]&224)<<3,c|=r[e[0]++]):(f=(r[e[0]++]>>2)+1,i==2?(c=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(c=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),n=[cr(n)],c==0)throw new Error("Invalid offset 0");if(c>n[0].length)throw new Error("Invalid offset beyond length");if(f>=c)for(n.push(n[0].slice(-c)),f-=c;f>=n[n.length-1].length;)n.push(n[n.length-1]),f-=n[n.length-1].length;n.push(n[0].slice(-c,-c+f))}}var d=cr(n);if(d.length!=s)throw new Error("Unexpected length: ".concat(d.length," != ").concat(s));return d}function Dt(t){for(var r=[],e=0;e<t.length;){var s=t[e++],n=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(Q1(s,t.slice(e,e+n))),e+=n}if(e!==t.length)throw new Error("data is not a valid framed stream!");return cr(r)}function Fr(t){for(var r=[],e=0;e<t.length;){var s=Math.min(t.length-e,268435455),n=new Uint8Array(4);r.push(n);var i=ke(s),o=i.length;r.push(i),s<=60?(o++,r.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,r.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,r.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,r.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,r.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),r.push(t.slice(e,e+s)),o+=s,n[0]=0,n[1]=o&255,n[2]=o>>8&255,n[3]=o>>16&255,e+=s}return cr(r)}function Gn(t,r){var e=new Uint8Array(32),s=fn(e),n=12,i=0;switch(e[0]=5,t.t){case"n":e[1]=2,J1(e,n,t.v),i|=1,n+=16;break;case"b":e[1]=6,s.setFloat64(n,t.v?1:0,!0),i|=2,n+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[1]=3,s.setUint32(n,r.indexOf(t.v),!0),i|=8,n+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(8,i,!0),e.slice(0,n)}function Vn(t,r){var e=new Uint8Array(32),s=fn(e),n=12,i=0;switch(e[0]=3,t.t){case"n":e[2]=2,s.setFloat64(n,t.v,!0),i|=32,n+=8;break;case"b":e[2]=6,s.setFloat64(n,t.v?1:0,!0),i|=32,n+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[2]=3,s.setUint32(n,r.indexOf(t.v),!0),i|=16,n+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(4,i,!0),e.slice(0,n)}function rr(t){var r=Ye(t);return ys(r[1][0].data)}function Z1(t,r,e){var s,n,i,o;if(!((s=t[6])!=null&&s[0])||!((n=t[7])!=null&&n[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&Mr(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,f=fn(t[7][0].data),d=0,h=[],u=fn(t[4][0].data),m=0,p=[],x=0;x<r.length;++x){if(r[x]==null){f.setUint16(x*2,65535,!0),u.setUint16(x*2,65535);continue}f.setUint16(x*2,d,!0),u.setUint16(x*2,m,!0);var g,T;switch(typeof r[x]){case"string":g=Gn({t:"s",v:r[x]},e),T=Vn({t:"s",v:r[x]},e);break;case"number":g=Gn({t:"n",v:r[x]},e),T=Vn({t:"n",v:r[x]},e);break;case"boolean":g=Gn({t:"b",v:r[x]},e),T=Vn({t:"b",v:r[x]},e);break;default:throw new Error("Unsupported value "+r[x])}h.push(g),d+=g.length,p.push(T),m+=T.length,++c}for(t[2][0].data=ke(c);x<t[7][0].data.length/2;++x)f.setUint16(x*2,65535,!0),u.setUint16(x*2,65535,!0);return t[6][0].data=cr(h),t[3][0].data=cr(p),c}function eg(t,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=jt(e["!ref"]);s.s.r=s.s.c=0;var n=!1;s.e.c>9&&(n=!0,s.e.c=9),s.e.r>49&&(n=!0,s.e.r=49),n&&console.error("The Numbers writer is currently limited to ".concat(Ke(s)));var i=hn(e,{range:s,header:1}),o=["~Sh33tJ5~"];i.forEach(function(w){return w.forEach(function(j){typeof j=="string"&&o.push(j)})});var l={},c=[],f=Oe.read(r.numbers,{type:"base64"});f.FileIndex.map(function(w,j){return[w,f.FullPaths[j]]}).forEach(function(w){var j=w[0],y=w[1];if(j.type==2&&j.name.match(/\.iwa/)){var U=j.content,L=Dt(U),Y=Ft(L);Y.forEach(function(Z){c.push(Z.id),l[Z.id]={deps:[],location:y,type:Mr(Z.messages[0].meta[1][0].data)}})}}),c.sort(function(w,j){return w-j});var d=c.filter(function(w){return w>1}).map(function(w){return[w,ke(w)]});f.FileIndex.map(function(w,j){return[w,f.FullPaths[j]]}).forEach(function(w){var j=w[0];if(w[1],!!j.name.match(/\.iwa/)){var y=Ft(Dt(j.content));y.forEach(function(U){U.messages.forEach(function(L){d.forEach(function(Y){U.messages.some(function(Z){return Mr(Z.meta[1][0].data)!=11006&&Y1(Z.data,Y[1])})&&l[Y[0]].deps.push(U.id)})})})}});for(var h=Oe.find(f,l[1].location),u=Ft(Dt(h.content)),m,p=0;p<u.length;++p){var x=u[p];x.id==1&&(m=x)}var g=rr(Ye(m.messages[0].data)[1][0].data);for(h=Oe.find(f,l[g].location),u=Ft(Dt(h.content)),p=0;p<u.length;++p)x=u[p],x.id==g&&(m=x);for(g=rr(Ye(m.messages[0].data)[2][0].data),h=Oe.find(f,l[g].location),u=Ft(Dt(h.content)),p=0;p<u.length;++p)x=u[p],x.id==g&&(m=x);for(g=rr(Ye(m.messages[0].data)[2][0].data),h=Oe.find(f,l[g].location),u=Ft(Dt(h.content)),p=0;p<u.length;++p)x=u[p],x.id==g&&(m=x);var T=Ye(m.messages[0].data);{T[6][0].data=ke(s.e.r+1),T[7][0].data=ke(s.e.c+1);var _=rr(T[46][0].data),S=Oe.find(f,l[_].location),A=Ft(Dt(S.content));{for(var D=0;D<A.length&&A[D].id!=_;++D);if(A[D].id!=_)throw"Bad ColumnRowUIDMapArchive";var z=Ye(A[D].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var C=0;C<=s.e.c;++C){var I=[];I[1]=I[2]=[{type:0,data:ke(C+420690)}],z[1].push({type:2,data:et(I)}),z[2].push({type:0,data:ke(C)}),z[3].push({type:0,data:ke(C)})}z[4]=[],z[5]=[],z[6]=[];for(var O=0;O<=s.e.r;++O)I=[],I[1]=I[2]=[{type:0,data:ke(O+726270)}],z[4].push({type:2,data:et(I)}),z[5].push({type:0,data:ke(O)}),z[6].push({type:0,data:ke(O)});A[D].messages[0].data=et(z)}S.content=Fr(Rr(A)),S.size=S.content.length,delete T[46];var P=Ye(T[4][0].data);{P[7][0].data=ke(s.e.r+1);var H=Ye(P[1][0].data),W=rr(H[2][0].data);S=Oe.find(f,l[W].location),A=Ft(Dt(S.content));{if(A[0].id!=W)throw"Bad HeaderStorageBucket";var te=Ye(A[0].messages[0].data);for(O=0;O<i.length;++O){var pe=Ye(te[2][0].data);pe[1][0].data=ke(O),pe[4][0].data=ke(i[O].length),te[2][O]={type:te[2][0].type,data:et(pe)}}A[0].messages[0].data=et(te)}S.content=Fr(Rr(A)),S.size=S.content.length;var me=rr(P[2][0].data);S=Oe.find(f,l[me].location),A=Ft(Dt(S.content));{if(A[0].id!=me)throw"Bad HeaderStorageBucket";for(te=Ye(A[0].messages[0].data),C=0;C<=s.e.c;++C)pe=Ye(te[2][0].data),pe[1][0].data=ke(C),pe[4][0].data=ke(s.e.r+1),te[2][C]={type:te[2][0].type,data:et(pe)};A[0].messages[0].data=et(te)}S.content=Fr(Rr(A)),S.size=S.content.length;var Ne=rr(P[4][0].data);(function(){for(var w=Oe.find(f,l[Ne].location),j=Ft(Dt(w.content)),y,U=0;U<j.length;++U){var L=j[U];L.id==Ne&&(y=L)}var Y=Ye(y.messages[0].data);{Y[3]=[];var Z=[];o.forEach(function(M,oe){Z[1]=[{type:0,data:ke(oe)}],Z[2]=[{type:0,data:ke(1)}],Z[3]=[{type:2,data:q1(M)}],Y[3].push({type:2,data:et(Z)})})}y.messages[0].data=et(Y);var Q=Rr(j),ge=Fr(Q);w.content=ge,w.size=w.content.length})();var ve=Ye(P[3][0].data);{var je=ve[1][0];delete ve[2];var ce=Ye(je.data);{var xe=rr(ce[2][0].data);(function(){for(var w=Oe.find(f,l[xe].location),j=Ft(Dt(w.content)),y,U=0;U<j.length;++U){var L=j[U];L.id==xe&&(y=L)}var Y=Ye(y.messages[0].data);{delete Y[6],delete ve[7];var Z=new Uint8Array(Y[5][0].data);Y[5]=[];for(var Q=0,ge=0;ge<=s.e.r;++ge){var M=Ye(Z);Q+=Z1(M,i[ge],o),M[1][0].data=ke(ge),Y[5].push({data:et(M),type:2})}Y[1]=[{type:0,data:ke(s.e.c+1)}],Y[2]=[{type:0,data:ke(s.e.r+1)}],Y[3]=[{type:0,data:ke(Q)}],Y[4]=[{type:0,data:ke(s.e.r+1)}]}y.messages[0].data=et(Y);var oe=Rr(j),ie=Fr(oe);w.content=ie,w.size=w.content.length})()}je.data=et(ce)}P[3][0].data=et(ve)}T[4][0].data=et(P)}m.messages[0].data=et(T);var _e=Rr(u),b=Fr(_e);return h.content=b,h.size=h.content.length,f}function tg(t){return function(e){for(var s=0;s!=t.length;++s){var n=t[s];e[n[0]]===void 0&&(e[n[0]]=n[1]),n[2]==="n"&&(e[n[0]]=Number(e[n[0]]))}}}function Ma(t){tg([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function rg(t,r){return r.bookType=="ods"?Gl(t,r):r.bookType=="numbers"?eg(t,r):r.bookType=="xlsb"?sg(t,r):ng(t,r)}function sg(t,r){Ir=1024,t&&!t.SSF&&(t.SSF=bt(Ge)),t&&t.SSF&&(Sn(),_n(t.SSF),r.revssf=Nn(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fs?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e=r.bookType=="xlsb"?"bin":"xml",s=Tl.indexOf(r.bookType)>-1,n=rl();Ma(r=r||{});var i=Sa(),o="",l=0;if(r.cellXfs=[],dr(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",we(i,o,il(t.Props,r)),n.coreprops.push(o),Re(r.rels,2,o,Te.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],f=0;f<t.SheetNames.length;++f)(t.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(t.SheetNames[f]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,we(i,o,ll(t.Props)),n.extprops.push(o),Re(r.rels,3,o,Te.EXT_PROPS),t.Custprops!==t.Props&&at(t.Custprops||{}).length>0&&(o="docProps/custom.xml",we(i,o,cl(t.Custprops)),n.custprops.push(o),Re(r.rels,4,o,Te.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},h=t.Sheets[t.SheetNames[l-1]],u=(h||{})["!type"]||"sheet";switch(u){case"chart":default:o="xl/worksheets/sheet"+l+"."+e,we(i,o,i1(l-1,o,r,t,d)),n.sheets.push(o),Re(r.wbrels,-1,"worksheets/sheet"+l+"."+e,Te.WS[0])}if(h){var m=h["!comments"],p=!1,x="";m&&m.length>0&&(x="xl/comments"+l+"."+e,we(i,x,c1(m,x)),n.comments.push(x),Re(d,-1,"../comments"+l+"."+e,Te.CMNT),p=!0),h["!legacy"]&&p&&we(i,"xl/drawings/vmlDrawing"+l+".vml",jl(l,h["!comments"])),delete h["!comments"],delete h["!legacy"]}d["!id"].rId1&&we(i,nl(o),Lr(d))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+e,we(i,o,l1(r.Strings,o,r)),n.strs.push(o),Re(r.wbrels,-1,"sharedStrings."+e,Te.SST)),o="xl/workbook."+e,we(i,o,a1(t,o)),n.workbooks.push(o),Re(r.rels,1,o,Te.WB),o="xl/theme/theme1.xml",we(i,o,Sl(t.Themes,r)),n.themes.push(o),Re(r.wbrels,-1,"theme/theme1.xml",Te.THEME),o="xl/styles."+e,we(i,o,o1(t,o,r)),n.styles.push(o),Re(r.wbrels,-1,"styles."+e,Te.STY),t.vbaraw&&s&&(o="xl/vbaProject.bin",we(i,o,t.vbaraw),n.vba.push(o),Re(r.wbrels,-1,"vbaProject.bin",Te.VBA)),o="xl/metadata."+e,we(i,o,d1(o)),n.metadata.push(o),Re(r.wbrels,-1,"metadata."+e,Te.XLMETA),we(i,"[Content_Types].xml",sl(n,r)),we(i,"_rels/.rels",Lr(r.rels)),we(i,"xl/_rels/workbook."+e+".rels",Lr(r.wbrels)),delete r.revssf,delete r.ssf,i}function ng(t,r){Ir=1024,t&&!t.SSF&&(t.SSF=bt(Ge)),t&&t.SSF&&(Sn(),_n(t.SSF),r.revssf=Nn(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,fs?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e="xml",s=Tl.indexOf(r.bookType)>-1,n=rl();Ma(r=r||{});var i=Sa(),o="",l=0;if(r.cellXfs=[],dr(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",we(i,o,il(t.Props,r)),n.coreprops.push(o),Re(r.rels,2,o,Te.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],f=0;f<t.SheetNames.length;++f)(t.Workbook.Sheets[f]||{}).Hidden!=2&&c.push(t.SheetNames[f]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,we(i,o,ll(t.Props)),n.extprops.push(o),Re(r.rels,3,o,Te.EXT_PROPS),t.Custprops!==t.Props&&at(t.Custprops||{}).length>0&&(o="docProps/custom.xml",we(i,o,cl(t.Custprops)),n.custprops.push(o),Re(r.rels,4,o,Te.CUST_PROPS));var d=["SheetJ5"];for(r.tcid=0,l=1;l<=t.SheetNames.length;++l){var h={"!id":{}},u=t.Sheets[t.SheetNames[l-1]],m=(u||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+e,we(i,o,Pl(l-1,r,t,h)),n.sheets.push(o),Re(r.wbrels,-1,"worksheets/sheet"+l+"."+e,Te.WS[0])}if(u){var p=u["!comments"],x=!1,g="";if(p&&p.length>0){var T=!1;p.forEach(function(_){_[1].forEach(function(S){S.T==!0&&(T=!0)})}),T&&(g="xl/threadedComments/threadedComment"+l+"."+e,we(i,g,Iu(p,d,r)),n.threadedcomments.push(g),Re(h,-1,"../threadedComments/threadedComment"+l+"."+e,Te.TCMNT)),g="xl/comments"+l+"."+e,we(i,g,El(p)),n.comments.push(g),Re(h,-1,"../comments"+l+"."+e,Te.CMNT),x=!0}u["!legacy"]&&x&&we(i,"xl/drawings/vmlDrawing"+l+".vml",jl(l,u["!comments"])),delete u["!comments"],delete u["!legacy"]}h["!id"].rId1&&we(i,nl(o),Lr(h))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+e,we(i,o,gl(r.Strings,r)),n.strs.push(o),Re(r.wbrels,-1,"sharedStrings."+e,Te.SST)),o="xl/workbook."+e,we(i,o,Ml(t)),n.workbooks.push(o),Re(r.rels,1,o,Te.WB),o="xl/theme/theme1.xml",we(i,o,Sl(t.Themes,r)),n.themes.push(o),Re(r.wbrels,-1,"theme/theme1.xml",Te.THEME),o="xl/styles."+e,we(i,o,wl(t,r)),n.styles.push(o),Re(r.wbrels,-1,"styles."+e,Te.STY),t.vbaraw&&s&&(o="xl/vbaProject.bin",we(i,o,t.vbaraw),n.vba.push(o),Re(r.wbrels,-1,"vbaProject.bin",Te.VBA)),o="xl/metadata."+e,we(i,o,Nl()),n.metadata.push(o),Re(r.wbrels,-1,"metadata."+e,Te.XLMETA),d.length>1&&(o="xl/persons/person.xml",we(i,o,Pu(d)),n.people.push(o),Re(r.wbrels,-1,"persons/person.xml",Te.PEOPLE)),we(i,"[Content_Types].xml",sl(n,r)),we(i,"_rels/.rels",Lr(r.rels)),we(i,"xl/_rels/workbook."+e+".rels",Lr(r.wbrels)),delete r.revssf,delete r.ssf,i}function ag(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=Jt(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function Vl(t,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return js(r.file,Oe.write(t,{type:Ae?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Oe.write(t,r)}function ig(t,r){var e=bt(r||{}),s=rg(t,e);return og(s,e)}function og(t,r){var e={},s=Ae?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(e.compression="DEFLATE"),r.password)e.type=s;else switch(r.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":e.type=s;break;default:throw new Error("Unrecognized type "+r.type)}var n=t.FullPaths?Oe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!r.compression}):t.generate(e);if(typeof Deno<"u"&&typeof n=="string"){if(r.type=="binary"||r.type=="base64")return n;n=new Uint8Array(wn(n))}return r.password&&typeof encrypt_agile<"u"?Vl(encrypt_agile(n,r.password),r):r.type==="file"?js(r.file,n):r.type=="string"?os(n):n}function lg(t,r){var e=r||{},s=N1(t,e);return Vl(s,e)}function Ut(t,r,e){e||(e="");var s=e+t;switch(r.type){case"base64":return ms(gs(s));case"binary":return gs(s);case"string":return t;case"file":return js(r.file,s,"utf8");case"buffer":return Ae?Zt(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Ut(s,{type:"binary"}).split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function cg(t,r){switch(r.type){case"base64":return ms(t);case"binary":return t;case"string":return t;case"file":return js(r.file,t,"binary");case"buffer":return Ae?Zt(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function $s(t,r){switch(r.type){case"string":case"base64":case"binary":for(var e="",s=0;s<t.length;++s)e+=String.fromCharCode(t[s]);return r.type=="base64"?ms(e):r.type=="string"?os(e):e;case"file":return js(r.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+r.type)}}function Xl(t,r){Pd(),Kp(t);var e=bt(r||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var s=Xl(t,e);return e.type="array",wn(s)}var n=0;if(e.sheet&&(typeof e.sheet=="number"?n=e.sheet:n=t.SheetNames.indexOf(e.sheet),!t.SheetNames[n]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Ut(_1(t,e),e);case"slk":case"sylk":return Ut(Gh.from_sheet(t.Sheets[t.SheetNames[n]],e),e);case"htm":case"html":return Ut($l(t.Sheets[t.SheetNames[n]],e),e);case"txt":return cg(ql(t.Sheets[t.SheetNames[n]],e),e);case"csv":return Ut(za(t.Sheets[t.SheetNames[n]],e),e,"\uFEFF");case"dif":return Ut(Vh.from_sheet(t.Sheets[t.SheetNames[n]],e),e);case"dbf":return $s(Wh.from_sheet(t.Sheets[t.SheetNames[n]],e),e);case"prn":return Ut(Xh.from_sheet(t.Sheets[t.SheetNames[n]],e),e);case"rtf":return Ut(eu.from_sheet(t.Sheets[t.SheetNames[n]],e),e);case"eth":return Ut(pl.from_sheet(t.Sheets[t.SheetNames[n]],e),e);case"fods":return Ut(Gl(t,e),e);case"wk1":return $s(Ui.sheet_to_wk1(t.Sheets[t.SheetNames[n]],e),e);case"wk3":return $s(Ui.book_to_wk3(t,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),$s(Ul(t,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),lg(t,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return ig(t,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function dg(t){if(!t.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(t.bookType=e.slice(1)),t.bookType=r[t.bookType]||t.bookType}}function Kl(t,r,e){var s={};return s.type="file",s.file=r,dg(s),Xl(t,s)}function fg(t,r,e,s,n,i,o,l){var c=nt(e),f=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),h=!0,u=n===1?[]:{};if(n!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:e,enumerable:!1})}catch{u.__rowNum__=e}else u.__rowNum__=e;if(!o||t[e])for(var m=r.s.c;m<=r.e.c;++m){var p=o?t[e][m]:t[s[m]+c];if(p===void 0||p.t===void 0){if(f===void 0)continue;i[m]!=null&&(u[i[m]]=f);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[m]!=null){if(x==null)if(p.t=="e"&&x===null)u[i[m]]=null;else if(f!==void 0)u[i[m]]=f;else if(d&&x===null)u[i[m]]=null;else continue;else u[i[m]]=d&&(p.t!=="n"||p.t==="n"&&l.rawNumbers!==!1)?x:Qt(p,x,l);x!=null&&(h=!1)}}return{row:u,isempty:h}}function hn(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},s=0,n=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},f=r||{},d=f.range!=null?f.range:t["!ref"];switch(f.header===1?s=1:f.header==="A"?s=2:Array.isArray(f.header)?s=3:f.header==null&&(s=0),typeof d){case"string":c=Le(d);break;case"number":c=Le(t["!ref"]),c.s.r=d;break;default:c=d}s>0&&(n=0);var h=nt(c.s.r),u=[],m=[],p=0,x=0,g=Array.isArray(t),T=c.s.r,_=0,S={};g&&!t[T]&&(t[T]=[]);var A=f.skipHidden&&t["!cols"]||[],D=f.skipHidden&&t["!rows"]||[];for(_=c.s.c;_<=c.e.c;++_)if(!(A[_]||{}).hidden)switch(u[_]=ot(_),e=g?t[T][_]:t[u[_]+h],s){case 1:i[_]=_-c.s.c;break;case 2:i[_]=u[_];break;case 3:i[_]=f.header[_-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=o=Qt(e,null,f),x=S[o]||0,!x)S[o]=1;else{do l=o+"_"+x++;while(S[l]);S[o]=x,S[l]=1}i[_]=l}for(T=c.s.r+n;T<=c.e.r;++T)if(!(D[T]||{}).hidden){var z=fg(t,c,T,u,s,i,g,f);(z.isempty===!1||(s===1?f.blankrows!==!1:f.blankrows))&&(m[p++]=z.row)}return m.length=p,m}var qi=/"/g;function hg(t,r,e,s,n,i,o,l){for(var c=!0,f=[],d="",h=nt(e),u=r.s.c;u<=r.e.c;++u)if(s[u]){var m=l.dense?(t[e]||[])[u]:t[s[u]+h];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(l.rawNumbers&&m.t=="n"?m.v:Qt(m,null,l));for(var p=0,x=0;p!==d.length;++p)if((x=d.charCodeAt(p))===n||x===i||x===34||l.forceQuotes){d='"'+d.replace(qi,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(qi,'""')+'"')):d="";f.push(d)}return l.blankrows===!1&&c?null:f.join(o)}function za(t,r){var e=[],s=r??{};if(t==null||t["!ref"]==null)return"";var n=Le(t["!ref"]),i=s.FS!==void 0?s.FS:",",o=i.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,c=l.charCodeAt(0),f=new RegExp((i=="|"?"\\|":i)+"+$"),d="",h=[];s.dense=Array.isArray(t);for(var u=s.skipHidden&&t["!cols"]||[],m=s.skipHidden&&t["!rows"]||[],p=n.s.c;p<=n.e.c;++p)(u[p]||{}).hidden||(h[p]=ot(p));for(var x=0,g=n.s.r;g<=n.e.r;++g)(m[g]||{}).hidden||(d=hg(t,n,g,h,o,c,i,s),d!=null&&(s.strip&&(d=d.replace(f,"")),(d||s.blankrows!==!1)&&e.push((x++?l:"")+d)));return delete s.dense,e.join("")}function ql(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=za(t,r);return e}function ug(t){var r="",e,s="";if(t==null||t["!ref"]==null)return[];var n=Le(t["!ref"]),i="",o=[],l,c=[],f=Array.isArray(t);for(l=n.s.c;l<=n.e.c;++l)o[l]=ot(l);for(var d=n.s.r;d<=n.e.r;++d)for(i=nt(d),l=n.s.c;l<=n.e.c;++l)if(r=o[l]+i,e=f?(t[d]||[])[l]:t[r],s="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;s=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)s=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)s=""+e.v;else if(e.t=="b")s=e.v?"TRUE":"FALSE";else if(e.w!==void 0)s="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?s="'"+e.v:s=""+e.v}}c[c.length]=r+"="+s}return c}function Yl(t,r,e){var s=e||{},n=+!s.skipHeader,i=t||{},o=0,l=0;if(i&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?Qe(s.origin):s.origin;o=c.r,l=c.c}var f,d={s:{c:0,r:0},e:{c:l,r:o+r.length-1+n}};if(i["!ref"]){var h=Le(i["!ref"]);d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),o==-1&&(o=h.e.r+1,d.e.r=o+r.length-1+n)}else o==-1&&(o=0,d.e.r=r.length-1+n);var u=s.header||[],m=0;r.forEach(function(x,g){at(x).forEach(function(T){(m=u.indexOf(T))==-1&&(u[m=u.length]=T);var _=x[T],S="z",A="",D=De({c:l+m,r:o+g+n});f=bs(i,D),_&&typeof _=="object"&&!(_ instanceof Date)?i[D]=_:(typeof _=="number"?S="n":typeof _=="boolean"?S="b":typeof _=="string"?S="s":_ instanceof Date?(S="d",s.cellDates||(S="n",_=yt(_)),A=s.dateNF||Ge[14]):_===null&&s.nullError&&(S="e",_=0),f?(f.t=S,f.v=_,delete f.w,delete f.R,A&&(f.z=A)):i[D]=f={t:S,v:_},A&&(f.z=A))})}),d.e.c=Math.max(d.e.c,l+u.length-1);var p=nt(o);if(n)for(m=0;m<u.length;++m)i[ot(m+l)+p]={t:"s",v:u[m]};return i["!ref"]=Ke(d),i}function xg(t,r){return Yl(null,t,r)}function bs(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var s=Qe(r);return t[s.r]||(t[s.r]=[]),t[s.r][s.c]||(t[s.r][s.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?bs(t,De(r)):bs(t,De({r,c:e||0}))}function mg(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function pg(){return{SheetNames:[],Sheets:{}}}function gg(t,r,e,s){var n=1;if(!e)for(;n<=65535&&t.SheetNames.indexOf(e="Sheet"+n)!=-1;++n,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&t.SheetNames.indexOf(e)>=0){var i=e.match(/(^.*?)(\d+)$/);n=i&&+i[2]||0;var o=i&&i[1]||e;for(++n;n<=65535&&t.SheetNames.indexOf(e=o+n)!=-1;++n);}if(Bl(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function vg(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var s=mg(t,r);switch(t.Workbook.Sheets[s]||(t.Workbook.Sheets[s]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[s].Hidden=e}function yg(t,r){return t.z=r,t}function Jl(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function bg(t,r,e){return Jl(t,"#"+r,e)}function wg(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function _g(t,r,e,s){for(var n=typeof r!="string"?r:Le(r),i=typeof r=="string"?r:Ke(r),o=n.s.r;o<=n.e.r;++o)for(var l=n.s.c;l<=n.e.c;++l){var c=bs(t,o,l);c.t="n",c.F=i,delete c.v,o==n.s.r&&l==n.s.c&&(c.f=e,s&&(c.D=!0))}return t}var zr={encode_col:ot,encode_row:nt,encode_cell:De,encode_range:Ke,decode_col:Aa,decode_row:Ca,split_cell:Lf,decode_cell:Qe,decode_range:jt,format_cell:Qt,sheet_add_aoa:Yo,sheet_add_json:Yl,sheet_add_dom:Hl,aoa_to_sheet:qr,json_to_sheet:xg,table_to_sheet:Wl,table_to_book:V1,sheet_to_csv:za,sheet_to_txt:ql,sheet_to_json:hn,sheet_to_html:$l,sheet_to_formulae:ug,sheet_to_row_object_array:hn,sheet_get_cell:bs,book_new:pg,book_append_sheet:gg,book_set_sheet_visibility:vg,cell_set_number_format:yg,cell_set_hyperlink:Jl,cell_set_internal_link:bg,cell_add_comment:wg,sheet_set_array_formula:_g,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Sg({user:t,onNavigate:r}){const[e,s]=B.useState([]),[n,i]=B.useState([]),[o,l]=B.useState(!1),[c,f]=B.useState(""),[d,h]=B.useState(""),[u,m]=B.useState("all"),[p,x]=B.useState(""),[g,T]=B.useState(""),[_,S]=B.useState([]),[A,D]=B.useState(!1),[z,C]=B.useState(30),[I,O]=B.useState(1),[P,H]=B.useState({name:"",branch:"",phone:"",user_type:""});B.useEffect(()=>{W(),te()},[]);const W=async()=>{try{const{data:y,error:U}=await he.from("branches").select("*").order("name",{ascending:!0});if(U)throw U;i(y||[])}catch(y){console.error("지점 목록 로드 오류:",y)}},te=async()=>{l(!0);try{let y=he.from("users").select("*").order("created_at",{ascending:!1});$r(t)||(y=y.eq("branch",t.branch));const{data:U,error:L}=await y;if(L)throw L;s(U||[])}catch(y){console.error("사용자 로드 오류:",y),alert("사용자 목록을 불러오는데 실패했습니다.")}finally{l(!1)}},pe=async(y,U)=>{const L=U?"승인":"거부";if(window.confirm(`이 사용자를 ${L}하시겠습니까?`))try{const Y={status:U?"approved":"rejected"};if(U){const{data:Q}=await he.from("users").select("referral_code").eq("id",y).single();if(!Q?.referral_code){const{data:ge}=await he.from("users").select("referral_code").not("referral_code","is",null).order("referral_code",{ascending:!1}).limit(1),M=ge?.[0]?.referral_code||"LAS0000",ie=parseInt(M.replace("LAS",""))+1;Y.referral_code=`LAS${String(ie).padStart(4,"0")}`}}const{error:Z}=await he.from("users").update(Y).eq("id",y);if(Z)throw Z;alert(`${L}되었습니다.`),te()}catch(Y){console.error("승인/거부 오류:",Y),alert(`${L} 처리에 실패했습니다.`)}},me=async y=>{if(window.confirm("정말로 이 사용자를 삭제하시겠습니까?"))try{const{error:U}=await he.from("users").delete().eq("id",y);if(U)throw U;alert("삭제되었습니다."),te()}catch(U){console.error("삭제 오류:",U),alert("삭제에 실패했습니다.")}},Ne=y=>{H({id:y.id,name:y.name,branch:y.branch,phone:y.phone,user_type:y.user_type}),D(!0)},ve=async()=>{if(P.id&&window.confirm("수정 내용을 저장하시겠습니까?"))try{const{error:y}=await he.from("users").update({name:P.name,phone:P.phone,branch:P.branch,user_type:P.user_type}).eq("id",P.id);if(y)throw y;alert("수정되었습니다."),D(!1),te()}catch(y){console.error("수정 오류:",y),alert("수정에 실패했습니다.")}},je=y=>{S(U=>U.includes(y)?U.filter(L=>L!==y):[...U,y])},ce=async()=>{if(_.length===0){alert("다운로드할 직원을 선택해주세요.");return}try{l(!0);const y=e.filter(ge=>_.includes(ge.id)),U=await Promise.all(y.map(async ge=>{const M=p||new Date(ge.created_at).toISOString().split("T")[0],oe=g||new Date().toISOString().split("T")[0],{data:ie,error:Be}=await he.from("work_diaries").select("work_hours").eq("user_id",ge.id).gte("work_date",M).lte("work_date",oe);Be&&console.error(`근무일지 조회 오류 (user_id: ${ge.id}):`,Be);const ye=ie?.reduce((Se,Ce)=>Se+(parseFloat(Ce.work_hours)||0),0)||0,de=ge.ssn?ge.ssn.substring(0,6)+"-*******":"-",Ee=ge.account_number?ge.account_number.substring(0,ge.account_number.length-4)+"****":"-";return{지점명:ge.branch||"-",이름:ge.name||"-",전화번호:ge.phone||"-",구분:ge.user_type||"-",근무시작일:new Date(M).toLocaleDateString("ko-KR"),근무종료일:new Date(oe).toLocaleDateString("ko-KR"),총근무시간:`${ye.toFixed(1)}시간`,주민번호:de,예금주:ge.account_holder||"-",기관명:ge.bank_name||"-",계좌번호:Ee}})),L=zr.json_to_sheet(U),Y=zr.book_new();zr.book_append_sheet(Y,L,"직원목록");const Q=`직원목록_${(p&&g?`${p}_${g}`:`전체기간_${new Date().toISOString().split("T")[0]}`).replace(/-/g,"")}.xlsx`;Kl(Y,Q)}catch(y){console.error("엑셀 다운로드 오류:",y),alert("엑셀 파일 생성 중 오류가 발생했습니다.")}finally{l(!1)}},xe=e.filter(y=>{const U=y.name?.toLowerCase().includes(c.toLowerCase())||y.email?.toLowerCase().includes(c.toLowerCase()),L=!d||y.branch===d,Y=u==="all"||y.user_type===u;let Z=!0;if(p||g){const Q=new Date(y.created_at);p&&(Z=Z&&Q>=new Date(p)),g&&(Z=Z&&Q<=new Date(g))}return U&&L&&Y&&Z}),_e=Math.ceil(xe.length/z),b=(I-1)*z,w=b+z,j=xe.slice(b,w);return B.useEffect(()=>{O(1)},[c,d,u,p,g,z]),a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[a.jsx("div",{className:"bg-white border-b pb-4 mb-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("button",{onClick:()=>r("AdminDashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",style:{fontSize:"15px"},children:[a.jsx(At,{size:20}),"나가기"]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Book",className:"h-10"}),a.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:"직원정보관리"})]}),a.jsx("div",{className:"w-24"})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"검색"}),a.jsx("input",{type:"text",placeholder:"이름 또는 이메일",value:c,onChange:y=>f(y.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"}})]}),$r(t)&&a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"지점"}),a.jsxs("select",{value:d,onChange:y=>h(y.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"},children:[a.jsx("option",{value:"",children:"전체"}),n.map(y=>a.jsx("option",{value:y.name,children:y.name},y.id))]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"직원구분"}),a.jsxs("select",{value:u,onChange:y=>m(y.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"},children:[a.jsx("option",{value:"all",children:"전체"}),a.jsx("option",{value:"점주",children:"점주"}),a.jsx("option",{value:"점장",children:"점장"}),a.jsx("option",{value:"직원",children:"직원"}),a.jsx("option",{value:"모니터링요원",children:"모니터링요원"}),a.jsx("option",{value:"계약근무",children:"계약근무"}),a.jsx("option",{value:"지점관리자",children:"지점관리자"})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"근무시작일"}),a.jsx("input",{type:"date",value:p,onChange:y=>x(y.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"}})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"근무종료일"}),a.jsx("input",{type:"date",value:g,onChange:y=>T(y.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"}})]}),a.jsx("div",{className:"flex-1 flex items-end",children:a.jsxs("button",{onClick:ce,className:"w-full py-2 flex items-center justify-center gap-2 text-white font-bold rounded-lg hover:opacity-90",style:{backgroundColor:"#5B7FC8",fontSize:"15px",borderRadius:"10px",height:"42px"},children:[a.jsx(yr,{size:18}),"엑셀다운로드(",xe.length.toString().padStart(2,"0"),")"]})})]}),a.jsxs("div",{className:"mt-4 flex justify-start items-center gap-4",children:[a.jsxs("div",{className:"text-gray-600",style:{fontSize:"15px"},children:["총 ",a.jsx("strong",{style:{color:"#249689",fontSize:"16px"},children:xe.length}),"명"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm text-gray-600",children:"페이지당:"}),a.jsxs("select",{value:z,onChange:y=>C(Number(y.target.value)),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm",style:{fontSize:"14px"},children:[a.jsx("option",{value:30,children:"30개"}),a.jsx("option",{value:50,children:"50개"}),a.jsx("option",{value:100,children:"100개"})]})]})]})]}),o?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block w-8 h-8 border-4 border-gray-200 border-t-[#249689] rounded-full animate-spin"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"로딩 중..."})]}):xe.length===0?a.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm border",children:a.jsx("p",{className:"text-gray-500",style:{fontSize:"15px"},children:"조건에 맞는 직원이 없습니다."})}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left",children:a.jsx("input",{type:"checkbox",onChange:y=>{y.target.checked?S(xe.map(U=>U.id)):S([])},checked:_.length===xe.length&&xe.length>0,className:"rounded border-gray-300"})}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"이름"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"이메일"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"전화번호"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"지점"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"직원구분"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"상태"}),a.jsx("th",{className:"px-4 py-3 text-center font-bold",style:{fontSize:"14px"},children:"관리"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:j.map(y=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3",children:a.jsx("input",{type:"checkbox",checked:_.includes(y.id),onChange:()=>je(y.id),className:"rounded border-gray-300"})}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:y.name}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:y.email}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:y.phone}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:y.branch}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:y.user_type}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold",style:{backgroundColor:y.status==="approved"?"#D1FAE5":y.status==="pending"?"#FEF3C7":"#FEE2E2",color:y.status==="approved"?"#065F46":y.status==="pending"?"#92400E":"#991B1B"},children:y.status==="approved"?"승인됨":y.status==="pending"?"대기중":"거부됨"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[y.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>pe(y.id,!0),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"승인",children:a.jsx(ro,{size:18})}),a.jsx("button",{onClick:()=>pe(y.id,!1),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"거부",children:a.jsx(so,{size:18})})]}),a.jsx("button",{onClick:()=>Ne(y),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"수정",children:a.jsx(pa,{size:18})}),a.jsx("button",{onClick:()=>me(y.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"삭제",children:a.jsx(Sr,{size:18})})]})})]},y.id))})]})}),_e>1&&a.jsxs("div",{className:"mt-4 flex justify-center items-center gap-2",children:[a.jsx("button",{onClick:()=>O(y=>Math.max(1,y-1)),disabled:I===1,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:"이전"}),a.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,_e)},(y,U)=>{let L;return _e<=5||I<=3?L=U+1:I>=_e-2?L=_e-4+U:L=I-2+U,a.jsx("button",{onClick:()=>O(L),className:`px-3 py-1 border rounded ${I===L?"text-white font-bold":"hover:bg-gray-50"}`,style:{fontSize:"14px",backgroundColor:I===L?"#249689":"white",borderColor:I===L?"#249689":"#d1d5db"},children:L},L)})}),a.jsx("button",{onClick:()=>O(y=>Math.min(_e,y+1)),disabled:I===_e,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:"다음"}),a.jsxs("span",{className:"ml-4 text-sm text-gray-600",children:[I," / ",_e," 페이지"]})]})]})]}),A&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:y=>y.target.style.display="none"}),a.jsx("h2",{className:"text-xl font-bold",style:{color:"#249689"},children:"직원정보수정"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:"이름"}),a.jsx("input",{type:"text",value:P.name,onChange:y=>H({...P,name:y.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:"지점"}),a.jsxs("select",{value:P.branch,onChange:y=>H({...P,branch:y.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[a.jsx("option",{value:"",children:"선택"}),n.map(y=>a.jsx("option",{value:y.name,children:y.name},y.name))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:"전화번호"}),a.jsx("input",{type:"text",value:P.phone,onChange:y=>H({...P,phone:y.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:"직원구분"}),a.jsxs("select",{value:P.user_type,onChange:y=>H({...P,user_type:y.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[a.jsx("option",{value:"점주",children:"점주"}),a.jsx("option",{value:"점장",children:"점장"}),a.jsx("option",{value:"직원",children:"직원"}),a.jsx("option",{value:"모니터링요원",children:"모니터링요원"}),a.jsx("option",{value:"계약근무",children:"계약근무"}),a.jsx("option",{value:"지점관리자",children:"지점관리자"})]})]})]}),a.jsxs("div",{className:"flex gap-2 mt-6",children:[a.jsx("button",{onClick:ve,className:"flex-1 py-2 text-white font-bold rounded-lg hover:opacity-90",style:{backgroundColor:"#249689",fontSize:"15px"},children:"저장"}),a.jsx("button",{onClick:()=>D(!1),className:"flex-1 py-2 font-bold rounded-lg hover:bg-gray-50",style:{border:"2px solid #7f95eb",backgroundColor:"white",fontSize:"15px"},children:"취소"})]})]})})]})}function Ng({user:t,onNavigate:r}){const[e,s]=B.useState([]),[n,i]=B.useState(null),[o,l]=B.useState(!1),[c,f]=B.useState("date"),[d,h]=B.useState(""),[u,m]=B.useState(""),[p,x]=B.useState("");B.useEffect(()=>{g()},[]);const g=async()=>{l(!0);try{let I=he.from("work_diaries").select("*").order("created_at",{ascending:!1});$r(t)||(I=I.eq("branch_name",t.branch));const{data:O,error:P}=await I;if(P)throw P;s(O||[]),O&&O.length>0&&i(O[0])}catch(I){console.error("근무일지 로드 오류:",I),alert("근무일지를 불러오는데 실패했습니다.")}finally{l(!1)}},T=()=>{g()},_=()=>{h(""),m(""),x(""),g()},A=[...e.filter(I=>{const O=!d.trim()||I.user_name?.toLowerCase().includes(d.toLowerCase());let P=!0;if(u||p){const H=new Date(I.work_date);if(u){const W=new Date(u);W.setHours(0,0,0,0),H<W&&(P=!1)}if(p){const W=new Date(p);W.setHours(23,59,59,999),H>W&&(P=!1)}}return O&&P})].sort((I,O)=>{if(c==="date"){const P=new Date(I.created_at);return new Date(O.created_at)-P}else{const P=new Date(I.created_at),H=new Date(O.created_at);return P-H}}),z=(I=>I.reduce((O,P)=>{const H=parseFloat(P.work_hours)||0;return O+H},0))(A),C=I=>I?new Date(I).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}).replace("일일","일"):"-";return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white shadow-md p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[a.jsxs("button",{onClick:()=>r("AdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[a.jsx(At,{size:20}),"나가기"]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:I=>I.target.style.display="none"}),a.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:$r(t)?"근무일지 관리":"우리지점 근무일지"})]}),a.jsx("div",{style:{width:"100px"}})]})}),a.jsx("div",{className:"max-w-7xl mx-auto p-6",children:a.jsxs("div",{className:"flex gap-6",style:{height:"calc(100vh - 200px)"},children:[a.jsxs("div",{className:"w-80 bg-white rounded-lg shadow-lg overflow-hidden flex flex-col",children:[a.jsxs("div",{className:"p-4 border-b bg-gray-50 space-y-3",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:[a.jsx(Ks,{size:12,className:"inline mr-1"}),"이름 검색"]}),a.jsx("input",{type:"text",value:d,onChange:I=>h(I.target.value),placeholder:"이름 입력",className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg text-sm"})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:[a.jsx(qs,{size:12,className:"inline mr-1"}),"근무일자"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("input",{type:"date",value:u,onChange:I=>m(I.target.value),className:"flex-1 px-2 py-1.5 border border-gray-300 rounded-lg text-xs"}),a.jsx("span",{className:"text-xs",children:"~"}),a.jsx("input",{type:"date",value:p,onChange:I=>x(I.target.value),className:"flex-1 px-2 py-1.5 border border-gray-300 rounded-lg text-xs"})]})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:T,className:"flex-1 px-3 py-1.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700 text-sm font-bold",children:[a.jsx(ir,{size:14,className:"inline mr-1"}),"검색"]}),a.jsx("button",{onClick:_,className:"px-3 py-1.5 bg-gray-200 rounded-lg hover:bg-gray-300 text-sm",children:"초기화"})]}),a.jsxs("div",{className:"pt-2 border-t",children:[a.jsx("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:"정렬"}),a.jsxs("select",{value:c,onChange:I=>f(I.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg text-sm",children:[a.jsx("option",{value:"date",children:"최근 순"}),a.jsx("option",{value:"old",children:"오래된 순"})]})]}),a.jsxs("div",{className:"text-xs text-gray-600 text-center pt-2 border-t space-y-1",children:[a.jsxs("div",{children:["총 ",a.jsx("strong",{className:"text-teal-600",children:A.length}),"건"]}),a.jsxs("div",{className:"font-bold text-teal-600",children:["총 근무시간: ",z.toFixed(1),"시간"]})]})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:o?a.jsx("div",{className:"p-8 text-center text-gray-500",children:"로딩 중..."}):A.length===0?a.jsx("div",{className:"p-8 text-center text-gray-500",children:d||u||p?"검색 결과가 없습니다.":"근무일지가 없습니다."}):A.map(I=>a.jsxs("div",{onClick:()=>i(I),className:`p-4 border-b cursor-pointer hover:bg-gray-50 transition-colors ${n?.id===I.id?"bg-teal-50 border-l-4 border-teal-500":""}`,children:[a.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[a.jsx(Ks,{size:16,style:{color:"#249689"}}),a.jsx("span",{className:"font-bold",style:{fontSize:"15px"},children:I.branch_name||"-"})]}),a.jsx("div",{className:"text-sm text-gray-600 mb-1",children:I.user_name||"이름 없음"}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[a.jsx(qs,{size:12}),I.work_date||"-"]}),a.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-1",children:[a.jsx(Uc,{size:12}),I.start_time," - ",I.end_time," (",I.work_hours,"h)"]})]},I.id))})]}),a.jsx("div",{className:"flex-1 bg-white rounded-lg shadow-lg overflow-hidden",children:n?a.jsx("div",{className:"h-full overflow-y-auto p-6",children:a.jsxs("div",{className:"max-w-2xl mx-auto",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx($c,{size:28,style:{color:"#249689"}}),a.jsx("h2",{className:"text-2xl font-bold",style:{color:"#249689"},children:"근무일지 상세"})]}),a.jsxs("div",{className:"text-lg font-bold",style:{color:"#249689"},children:["(총근무시간 ",z.toFixed(1),"시간)"]})]}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:"지점명"}),a.jsx("p",{className:"font-medium",children:n.branch_name||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:"작성자"}),a.jsx("p",{className:"font-medium",children:n.user_name||"-"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:"근무일자"}),a.jsx("p",{className:"font-medium",children:C(n.work_date)})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:"근무시간"}),a.jsxs("p",{className:"font-medium",children:[n.start_time," - ",n.end_time,a.jsxs("span",{className:"ml-2 text-teal-600",children:["(",n.work_hours,"시간)"]})]})]})]})}),(n.daily_check_clean||n.daily_check_training||n.daily_check_list)&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"일일 확인목록"}),a.jsxs("div",{className:"space-y-2 bg-gray-50 rounded-lg p-4",children:[n.daily_check_clean&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-green-600",children:"✓"}),a.jsx("span",{children:"매장 청결점검"})]}),n.daily_check_training&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-green-600",children:"✓"}),a.jsx("span",{children:"직원 업무교육"})]}),n.daily_check_list&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-green-600",children:"✓"}),a.jsx("span",{children:"직원 체크리스트 점검"})]})]})]}),n.out_content&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"외근 시 내용"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsx("p",{className:"whitespace-pre-wrap",children:n.out_content})})]}),n.exemplary_content&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"주인형 모집내용"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsx("p",{className:"whitespace-pre-wrap",children:n.exemplary_content})})]}),n.memorable_customer&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"오늘 인상깊은 고객"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsx("p",{className:"whitespace-pre-wrap",children:n.memorable_customer})})]}),n.suggestions&&a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"건의사항"}),a.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:a.jsx("p",{className:"whitespace-pre-wrap",children:n.suggestions})})]}),a.jsxs("div",{className:"text-sm text-gray-500 text-right mt-8",children:["작성일시: ",new Date(n.created_at).toLocaleString("ko-KR")]})]})}):a.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:"좌측 목록에서 근무일지를 선택해주세요."})})]})})]})}function jg({user:t,onNavigate:r}){const[e,s]=B.useState([]),[n,i]=B.useState(!1),[o,l]=B.useState(""),[c,f]=B.useState(""),[d,h]=B.useState([]);B.useEffect(()=>{u(),m()},[]);const u=async()=>{try{const{data:_,error:S}=await he.from("branches").select("*").eq("is_active",!0).order("name",{ascending:!0});if(S)throw S;h(_||[])}catch(_){console.error("지점 목록 로드 오류:",_)}},m=async()=>{i(!0);try{console.log("📊 구매자 정보 로딩...");let _=he.from("sales").select("*").order("created_at",{ascending:!1});$r(t)||(console.log("🔒 자기 지점만 필터링:",t.branch),_=_.eq("branch_name",t.branch));const{data:S,error:A}=await _;if(A)throw console.error("❌ Supabase 오류:",A),A;console.log("✅ 구매자 데이터:",S),s(S||[])}catch(_){console.error("❌ 구매자 정보 로드 오류:",_),alert(`구매자 정보를 불러오는데 실패했습니다.
오류: ${_.message}`)}finally{i(!1)}},p=_=>{if(!_)return"-";const S=_.replace(/[^\d]/g,"");return S.length===11?`${S.slice(0,3)}-${S.slice(3,7)}-${S.slice(7)}`:S.length===10?`${S.slice(0,3)}-${S.slice(3,6)}-${S.slice(6)}`:_},x=_=>_?_.replace(/[^\d]/g,""):"",T=e.filter(_=>{const S=_.customer_name?.toLowerCase().includes(o.toLowerCase())||_.phone?.includes(o)||_.customer_phone?.includes(o)||_.email?.toLowerCase().includes(o.toLowerCase())||_.customer_email?.toLowerCase().includes(o.toLowerCase()),A=!c||_.branch_name===c;return S&&A}).reduce((_,S)=>{const A=x(S.phone||S.customer_phone||""),z=`${S.customer_name||""}-${A}`;return _.some(C=>{const I=x(C.phone||C.customer_phone||"");return`${C.customer_name||""}-${I}`===z})||_.push(S),_},[]);return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white shadow-md p-6",children:a.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[a.jsxs("button",{onClick:()=>r("AdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[a.jsx(At,{size:20}),"나가기"]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:_=>_.target.style.display="none"}),a.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"구매고객조회"})]}),a.jsx("div",{style:{width:"100px"}})]})}),a.jsx("div",{className:"max-w-7xl mx-auto p-6",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[a.jsxs("div",{className:"p-4 border-b flex items-center gap-2",children:[a.jsx("div",{className:"flex-1 flex items-center gap-2",children:a.jsx("input",{type:"text",value:o,onChange:_=>l(_.target.value),placeholder:"이름, 전화번호, 이메일",className:"flex-1 px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})}),$r(t)&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("label",{className:"font-bold",style:{color:"#000000",fontSize:"15px"},children:[a.jsx(mn,{size:18,className:"inline mr-1"}),"지점"]}),a.jsxs("select",{value:c,onChange:_=>f(_.target.value),className:"px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[a.jsx("option",{value:"",children:"전체"}),d.map(_=>a.jsx("option",{value:_.name,children:_.name},_.id))]})]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("button",{onClick:m,className:"px-4 py-2 flex items-center gap-2 font-bold text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#249689",fontSize:"15px",borderRadius:"10px",width:"120px",justifyContent:"center"},title:"검색",children:[a.jsx(ir,{size:18}),"검색"]}),a.jsxs("button",{onClick:()=>{l(""),f("")},className:"px-4 py-2 flex items-center gap-2 font-bold hover:bg-gray-50",style:{backgroundColor:"white",border:"2px solid #249689",borderRadius:"10px",color:"#249689",fontSize:"15px",width:"120px",justifyContent:"center"},title:"검색 조건 초기화",children:[a.jsx(Ur,{size:18}),"초기화"]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"지점"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"이름"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"전화번호"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"이메일"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"주소"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"결제방법"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"수량"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"등록일"})]})}),a.jsx("tbody",{children:n?a.jsx("tr",{children:a.jsx("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:"로딩 중..."})}):T.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:"구매자 정보가 없습니다."})}):T.map(_=>a.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:_.branch_name||_.user_branch||"-"}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:_.customer_name||"-"}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:p(_.phone||_.customer_phone)}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:_.email||_.customer_email||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:_.address||"-"}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:_.payment_method||"-"}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:_.quantity||"-"}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:_.created_at?new Date(_.created_at).toLocaleDateString("ko-KR"):"-"})]},_.id))})]})})]})})]})}const Eg=()=>{const t=[];for(let i=8;i<=22;i++){for(let o=0;o<60;o+=30){if(i===8&&o<30)continue;if(i===22&&o>30)break;const l=`${String(i).padStart(2,"0")}:${String(o).padStart(2,"0")}`;t.push(l)}if(i===22&&t.includes(`${String(22).padStart(2,"0")}:${String(30).padStart(2,"0")}`))break}return t},Yi=Eg();function Tg({user:t,onNavigate:r}){const[e,s]=B.useState({workDate:"",startTime:"",endTime:"",dailyCheckClean:!1,dailyCheckTraining:!1,dailyCheckList:!1,outContent:"",exemplaryContent:"",memorableCustomer:"",suggestions:""}),[n,i]=B.useState(0),[o,l]=B.useState(!1),c=t?.user_type==="점장"||t?.user_type==="지점관리자"||t?.userType==="점장"||t?.userType==="지점관리자",f=u=>{const{name:m,value:p,type:x,checked:g}=u.target;s({...e,[m]:x==="checkbox"?g:p})};B.useEffect(()=>{if(!e.workDate||!e.startTime||!e.endTime){i(0);return}try{const u=new Date(`${e.workDate}T${e.startTime}:00`),m=new Date(`${e.workDate}T${e.endTime}:00`);if(isNaN(u.getTime())||isNaN(m.getTime())){i(0);return}const x=(m-u)/(1e3*60*60);i(x>0?parseFloat(x.toFixed(1)):0)}catch(u){console.error("시간 계산 오류:",u),i(0)}},[e.workDate,e.startTime,e.endTime]);const d=async u=>{if(u.preventDefault(),!e.workDate){alert("출근일을 선택해주세요");return}if(!e.startTime){alert("출근시간을 선택해주세요");return}if(!e.endTime){alert("퇴근시간을 선택해주세요");return}if(n<=0){alert("퇴근시간이 출근시간보다 늦어야 합니다");return}l(!0);try{const m={user_id:t.id,user_name:t.name,branch_name:t.branch,work_date:e.workDate,start_time:e.startTime,end_time:e.endTime,work_hours:n,daily_check_clean:e.dailyCheckClean,daily_check_training:e.dailyCheckTraining,daily_check_list:e.dailyCheckList,out_content:e.outContent.trim()||null,exemplary_content:e.exemplaryContent.trim()||null,memorable_customer:e.memorableCustomer.trim()||null,suggestions:e.suggestions.trim()||null};console.log("근무일지 저장 데이터:",m),alert("근무일지가 제출되었습니다!"),r&&r("dashboard")}catch(m){console.error("근무일지 제출 오류:",m),alert("근무일지 제출 중 오류가 발생했습니다: "+m.message)}finally{l(!1)}},h=()=>{e.workDate||e.startTime||e.endTime||e.outContent||e.exemplaryContent||e.memorableCustomer||e.suggestions||e.dailyCheckClean||e.dailyCheckTraining||e.dailyCheckList?window.confirm("작성 중인 내용이 있습니다. 나가기하시겠습니까?")&&r&&r("Dashboard"):r&&r("Dashboard")};return a.jsx("div",{className:"min-h-screen bg-gray-50 p-2",children:a.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg p-4",children:[a.jsx("div",{className:"flex flex-col items-center justify-center mb-2",children:a.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:u=>u.target.style.display="none"}),a.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:c?"SM점장 근무일지":"점주근무일지"})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"지점명"}),a.jsx("input",{type:"text",value:t?.branch||"Current User's brname",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"이름"}),a.jsx("input",{type:"text",value:t?.name||"Current User's name",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"border-t pt-2",children:[a.jsx("h3",{className:"font-bold mb-2",style:{color:"#000000",fontSize:"15px"},children:"근무일자 시간을 선택해 주세요"}),a.jsxs("div",{className:"mb-2",children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"출근일"}),a.jsx("input",{type:"date",name:"workDate",value:e.workDate,onChange:f,required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"출근시간"}),a.jsxs("select",{name:"startTime",value:e.startTime,onChange:f,required:!0,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[a.jsx("option",{value:"",children:"선택"}),Yi.map(u=>a.jsx("option",{value:u,children:u},`start-${u}`))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"퇴근시간"}),a.jsxs("select",{name:"endTime",value:e.endTime,onChange:f,required:!0,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[a.jsx("option",{value:"",children:"선택"}),Yi.map(u=>a.jsx("option",{value:u,children:u},`end-${u}`))]})]})]}),a.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:"#d1fae5",border:"2px solid #10b981"},children:a.jsxs("p",{className:"font-bold text-center",style:{color:"#059669",fontSize:"16px"},children:["총 근무시간: ",n," 시간"]})})]}),c&&a.jsxs("div",{className:"border-t pt-2",children:[a.jsx("h3",{className:"font-bold mb-2",style:{color:"#000000",fontSize:"15px"},children:"일일 확인목록"}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"dailyCheckClean",checked:e.dailyCheckClean,onChange:f,className:"w-5 h-5"}),a.jsx("span",{style:{color:"#000000",fontSize:"15px"},children:"매장 청결점검"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"dailyCheckTraining",checked:e.dailyCheckTraining,onChange:f,className:"w-5 h-5"}),a.jsx("span",{style:{color:"#000000",fontSize:"15px"},children:"직원 업무교육"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"dailyCheckList",checked:e.dailyCheckList,onChange:f,className:"w-5 h-5"}),a.jsx("span",{style:{color:"#000000",fontSize:"15px"},children:"직원 체크리스트 점검"})]})]})]}),a.jsxs("div",{className:"border-t pt-2",children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"외근 시 내용을 적어주세요"}),a.jsx("textarea",{name:"outContent",value:e.outContent,onChange:f,placeholder:"외근 시 내용을 적어주세요",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"주인형 모집내용을 적어주세요"}),a.jsx("textarea",{name:"exemplaryContent",value:e.exemplaryContent,onChange:f,placeholder:"주인형 모집내용을 적어주세요",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"오늘 인상깊은 고객에 대해 적어주세요"}),a.jsx("textarea",{name:"memorableCustomer",value:e.memorableCustomer,onChange:f,placeholder:"오늘 인상깊은 고객에 대해 적어주세요",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"건의사항이 있으시면 적어주세요"}),a.jsx("textarea",{name:"suggestions",value:e.suggestions,onChange:f,placeholder:"건의사항이 있으시면 적어주세요",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{className:"flex gap-2 pt-2",children:[a.jsx("button",{type:"button",onClick:d,disabled:o,className:"flex-1 py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:o?"저장 중...":"제출"}),a.jsx("button",{type:"button",onClick:h,disabled:o,className:"flex-1 py-2.5 font-bold rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:"나가기"})]})]})]})})}function Cg({user:t,onNavigate:r}){const[e,s]=B.useState({customerName:"",age:"",address:"",phone:"",email:"",paymentMethod:"카드",quantity:"",depositor:"",depositAmount:"",orderDetails:"",needsShipping:!1,privacyAgreed:!1,marketingAgreed:!1}),[n,i]=B.useState(!1),[o,l]=B.useState(!1),c=m=>{const p=m.replace(/[^\d]/g,"");return p.length<=3?p:p.length<=7?`${p.slice(0,3)}-${p.slice(3)}`:`${p.slice(0,3)}-${p.slice(3,7)}-${p.slice(7,11)}`},f=m=>{const p=m.replace(/[^\d]/g,"");return p?p.replace(/\B(?=(\d{3})+(?!\d))/g,",")+"원":""},d=m=>{const{name:p,value:x,type:g,checked:T}=m.target;let _=g==="checkbox"?T:x;p==="phone"&&(_=c(x)),p==="depositAmount"&&(_=f(x)),s({...e,[p]:_})},h=()=>{if(!e.quantity||e.quantity<1)return alert("판매수량을 입력해주세요"),!1;if(!e.depositAmount?.trim())return alert("입금액을 입력해주세요"),!1;if(e.needsShipping){if(!e.customerName?.trim())return alert("배송을 위해 구매자 이름을 입력해주세요"),!1;if(!e.address?.trim())return alert("배송을 위해 주소를 입력해주세요"),!1;if(!e.phone?.trim())return alert("배송을 위해 연락처를 입력해주세요"),!1}return e.paymentMethod==="입금"&&!e.depositor?.trim()?(alert("입금자명을 입력해주세요"),!1):e.privacyAgreed?!0:(alert("개인정보 수집 및 이용에 동의해주세요"),!1)},u=async()=>{if(h()){i(!0),console.log("=== 저장 시작 ===");try{const m={user_id:t?.id||null,branch_name:t?.branch||null,user_name:t?.name||null,user_branch:t?.branch||null,customer_name:e.customerName?.trim()||null,phone:e.phone?.trim()||null,customer_email:e.email?.trim()||null,address:e.address?.trim()||null,payment_method:e.paymentMethod||null,quantity:parseInt(e.quantity),depositor:e.depositor?.trim()||null,deposit_amount:e.depositAmount?.replace(/,/g,"")||null,order_details:e.orderDetails?.trim()||null,age:e.age?parseInt(e.age):null,needs_shipping:e.needsShipping,privacy_agreed:e.privacyAgreed,marketing_agreed:e.marketingAgreed};console.log("Insert Data:",m);const{data:p,error:x}=await he.from("sales").insert([m]).select();if(x)throw x;console.log("저장 성공:",p),alert("저장되었습니다!"),s({customerName:"",age:"",address:"",phone:"",email:"",paymentMethod:"카드",quantity:"",depositor:"",depositAmount:"",orderDetails:"",needsShipping:!1,privacyAgreed:!1,marketingAgreed:!1})}catch(m){console.error("=== 저장 오류 상세 ==="),console.error("Error:",m),alert("저장 중 오류가 발생했습니다: "+m.message)}finally{i(!1)}}};return a.jsxs("div",{className:"min-h-screen bg-gray-50 p-2",children:[a.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg",style:{padding:"12px",paddingBottom:"24px"},children:[a.jsx("div",{className:"flex flex-col items-center justify-center mb-2",children:a.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:m=>m.target.style.display="none"}),a.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"LAS Book Store"})]})}),a.jsxs("div",{className:"grid grid-cols-2 gap-1 mb-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"지점명"}),a.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-2 py-1.5 border border-gray-300 bg-gray-50",style:{borderRadius:"8px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"이름"}),a.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-2 py-1.5 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2 bg-gray-50",children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"needsShipping",checked:e.needsShipping,onChange:d,className:"w-4 h-4"}),a.jsx("span",{className:"font-bold",style:{color:"#249689",fontSize:"16px"},children:"📦 배송이 필요합니다"})]}),a.jsx("p",{className:"text-xs text-gray-600 mt-1 ml-6",children:e.needsShipping?"✓ 배송 선택: 이름, 연락처, 주소가 필수입니다":"배송을 선택하지 않으면 구매자 정보는 선택사항입니다"})]}),a.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[a.jsx("h3",{className:"font-bold mb-2 text-lg",style:{color:"#249689",fontSize:"18px"},children:"구매자 기본정보"}),a.jsxs("div",{className:"space-y-1.5",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["이름 ",e.needsShipping&&a.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),a.jsx("input",{type:"text",name:"customerName",value:e.customerName,onChange:d,placeholder:"구매자 성함을 적어주세요",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"나이"}),a.jsx("input",{type:"text",name:"age",value:e.age,onChange:d,placeholder:"구매자 나이를 적어주세요",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["주소 ",e.needsShipping&&a.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),a.jsx("input",{type:"text",name:"address",value:e.address,onChange:d,placeholder:"구매자 주소를 적어주세요",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["연락처 ",e.needsShipping&&a.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),a.jsx("input",{type:"tel",name:"phone",value:e.phone,onChange:d,placeholder:"구매자 연락처를 적어주세요",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"이메일"}),a.jsx("input",{type:"email",name:"email",value:e.email,onChange:d,placeholder:"구매자 이메일을 적어주세요",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]})]})]}),a.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[a.jsx("h3",{className:"font-bold mb-2 text-lg",style:{color:"#249689",fontSize:"18px"},children:"결제정보"}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[a.jsx("input",{type:"radio",name:"paymentMethod",value:"카드",checked:e.paymentMethod==="카드",onChange:d,className:"w-3.5 h-3.5"}),a.jsx("span",{style:{color:"#000000",fontSize:"15px",fontWeight:"bold"},children:"카드"})]}),a.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[a.jsx("input",{type:"radio",name:"paymentMethod",value:"입금",checked:e.paymentMethod==="입금",onChange:d,className:"w-3.5 h-3.5"}),a.jsx("span",{style:{color:"#000000",fontSize:"15px",fontWeight:"bold"},children:"입금"})]})]}),a.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["판매수량 ",a.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),a.jsx("input",{type:"number",name:"quantity",value:e.quantity,onChange:d,placeholder:"수량",min:"1",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["입금액 ",a.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),a.jsx("input",{type:"text",name:"depositAmount",value:e.depositAmount,onChange:d,placeholder:"입금액",className:"w-full px-2 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px",textAlign:"right"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["입금자명 ",e.paymentMethod==="입금"&&a.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),a.jsx("input",{type:"text",name:"depositor",value:e.depositor,onChange:d,placeholder:"입금자명",disabled:e.paymentMethod==="카드",className:"w-full px-2 py-1.5 border border-gray-300 disabled:bg-gray-100 disabled:text-gray-400",style:{borderRadius:"8px",fontSize:"15px"}})]})]})]})]}),a.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[a.jsx("h3",{className:"font-bold mb-1.5 text-lg",style:{color:"#249689",fontSize:"18px"},children:"주문정보"}),a.jsx("textarea",{name:"orderDetails",value:e.orderDetails,onChange:d,placeholder:"주문상품명과 수량을 적어주세요",rows:3,className:"w-full px-2 py-1.5 border border-gray-300",style:{borderRadius:"8px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[a.jsx("h3",{className:"font-bold mb-1.5 text-lg",style:{color:"#249689",fontSize:"18px"},children:"개인정보 수집 및 이용 동의"}),a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"privacyAgreed",checked:e.privacyAgreed,onChange:d,className:"w-4 h-4 mt-0.5"}),a.jsxs("span",{style:{color:"#000000",fontSize:"14px"},children:["개인정보 수집 및 이용에 동의합니다 ",a.jsx("span",{style:{color:"#ef4444"},children:"*"})]})]}),a.jsx("button",{type:"button",onClick:()=>l(!0),className:"text-sm underline whitespace-nowrap",style:{color:"#249689"},children:"📄 내용보기"})]}),a.jsx("div",{className:"pt-2 border-t border-gray-300",children:a.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"marketingAgreed",checked:e.marketingAgreed,onChange:d,className:"w-4 h-4 mt-0.5"}),a.jsxs("span",{style:{fontSize:"14px",flex:1},children:[a.jsx("span",{className:"font-bold",children:"(선택)"})," 이벤트 및 마케팅 정보 수신에 동의합니다"]})]})})]}),a.jsxs("div",{className:"flex gap-2",style:{marginTop:"20px",marginBottom:"24px"},children:[a.jsx("button",{onClick:u,disabled:n,className:"flex-1 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:n?"저장 중...":"확인"}),a.jsx("button",{onClick:()=>r?.("Dashboard"),disabled:n,className:"flex-1 py-2 font-bold rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:"나가기"})]})]})]}),o&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto p-6",children:[a.jsx("h2",{className:"font-bold mb-4",style:{color:"#249689",fontSize:"24px"},children:"개인정보 수집 및 이용 동의서"}),a.jsxs("div",{className:"space-y-4 text-sm",style:{color:"#333"},children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"1. 개인정보의 수집 및 이용 목적"}),a.jsx("p",{className:"ml-4",children:"- 상품 주문 및 배송"}),a.jsx("p",{className:"ml-4",children:"- 결제 처리 및 영수증 발행"}),a.jsx("p",{className:"ml-4",children:"- 고객 문의 응대 및 불만 처리"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"2. 수집하는 개인정보의 항목"}),a.jsx("p",{className:"ml-4",children:"- 필수항목: 이름, 연락처, 주소(배송 시)"}),a.jsx("p",{className:"ml-4",children:"- 선택항목: 이메일, 나이"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"3. 개인정보의 보유 및 이용 기간"}),a.jsx("p",{className:"ml-4",children:"- 수집된 개인정보는 목적 달성 후 지체 없이 파기합니다."}),a.jsx("p",{className:"ml-4",children:"- 단, 관계 법령에 의해 보존할 필요가 있는 경우 해당 기간 동안 보관합니다."})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"4. 동의를 거부할 권리 및 거부 시 불이익"}),a.jsx("p",{className:"ml-4",children:"- 귀하는 개인정보 수집 및 이용을 거부할 권리가 있습니다."}),a.jsx("p",{className:"ml-4",children:"- 단, 필수항목 미동의 시 상품 구매 및 배송이 제한될 수 있습니다."})]})]}),a.jsx("button",{onClick:()=>l(!1),className:"w-full mt-6 py-3 text-white font-bold rounded-lg",style:{backgroundColor:"#249689"},children:"확인"})]})})]})}function Ql({user:t,onNavigate:r,config:e}){const[s,n]=B.useState(""),[i,o]=B.useState(""),[l,c]=B.useState(""),[f,d]=B.useState([]),[h,u]=B.useState([]),[m,p]=B.useState(!1),[x,g]=B.useState([]),[T,_]=B.useState("all"),[S,A]=B.useState(!1),[D,z]=B.useState(null),C=t?.user_type==="시스템관리자";B.useEffect(()=>{e.showBranchFilter&&I(),O()},[]);const I=async()=>{try{const{data:b,error:w}=await he.from("branches").select("*").order("name",{ascending:!0});if(w)throw w;u(b||[])}catch(b){console.error("지점 조회 오류:",b)}},O=async()=>{p(!0);try{let b=he.from("sales").select("*").order("created_at",{ascending:!1});e.filterByBranch&&t?.branch&&(b=b.eq("branch_name",t.branch));const{data:w,error:j}=await b;if(j){console.error("전체 목록 조회 오류:",j),alert("데이터를 불러오는 중 오류가 발생했습니다: "+j.message);return}console.log("조회된 데이터:",w),d(w||[])}catch(b){console.error("데이터 조회 오류:",b),alert("데이터를 불러오는 중 오류가 발생했습니다: "+b.message)}finally{p(!1)}},P=async()=>{p(!0);try{let b=he.from("sales").select("*").order("created_at",{ascending:!1});if(e.filterByBranch&&t?.branch&&(b=b.eq("branch_name",t.branch)),e.showBranchFilter&&T!=="all"&&(b=b.eq("branch_name",T)),s.trim()){const y=e.searchFields.map(U=>`${U}.ilike.%${s}%`).join(",");b=b.or(y)}if(i){const y=new Date(i);y.setHours(0,0,0,0),b=b.gte("created_at",y.toISOString())}if(l){const y=new Date(l);y.setHours(23,59,59,999),b=b.lte("created_at",y.toISOString())}const{data:w,error:j}=await b;if(j){console.error("검색 오류:",j),alert("검색 중 오류가 발생했습니다: "+j.message);return}console.log("검색 결과:",w),d(w||[]),(!w||w.length===0)&&alert("검색 결과가 없습니다")}catch(b){console.error("검색 오류:",b),alert("검색 중 오류가 발생했습니다: "+b.message)}finally{p(!1)}},H=()=>{n(""),o(""),c(""),_("all"),g([]),O()},W=b=>{g(w=>w.some(y=>y.id===b.id)?w.filter(y=>y.id!==b.id):[...w,b])},te=b=>{b.target.checked?g([...f]):g([])},pe=b=>new Date(b).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}),me=b=>{if(!b)return"-";const w=b.replace(/[^\d]/g,"");return w.length===11?`${w.slice(0,3)}-${w.slice(3,7)}-${w.slice(7)}`:w.length===10?`${w.slice(0,3)}-${w.slice(3,6)}-${w.slice(6)}`:b},Ne=(b,w)=>{w&&w.stopPropagation(),z(b),A(!0)},ve=async()=>{if(D)try{const{error:b}=await he.from("sales").delete().eq("id",D.id);if(b)throw b;alert("삭제되었습니다."),A(!1),z(null),g(w=>w.filter(j=>j.id!==D.id)),O()}catch(b){console.error("삭제 실패:",b),alert("삭제에 실패했습니다.")}},je=()=>{if(x.length===0){alert("출력할 항목을 선택해주세요");return}const b=window.open("","_blank");if(!b){alert("팝업이 차단되었습니다. 팝업 차단을 해제해주세요.");return}const w=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>${e.printTitle}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: 'Malgun Gothic', sans-serif; padding: 0; line-height: 1.4; }
          @page { size: A4; margin: 10mm; }
          .page { width: 100%; display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 5mm; page-break-after: always; padding: 5mm; }
          .page:last-child { page-break-after: auto; }
          .invoice { border: 2px solid #249689; padding: 5mm; background: white; border-radius: 3mm; display: flex; flex-direction: column; height: 100%; }
          .invoice-header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 3mm; margin-bottom: 3mm; }
          .invoice-header h1 { font-size: 14pt; font-weight: bold; margin-bottom: 1mm; }
          .invoice-number { font-size: 9pt; color: #666; }
          .section { margin-bottom: 3mm; }
          .section-title { font-size: 10pt; font-weight: bold; background-color: #f0f0f0; padding: 1.5mm; margin-bottom: 1.5mm; border-left: 3mm solid #249689; }
          .field { display: flex; padding: 1mm 0; font-size: 9pt; }
          .field-label { font-weight: bold; width: 18mm; flex-shrink: 0; }
          .field-value { flex: 1; word-break: break-all; }
          .order-box { border: 1px solid #ddd; padding: 2mm; background-color: #fafafa; min-height: 15mm; max-height: 25mm; font-size: 8pt; white-space: pre-wrap; word-break: break-word; overflow: hidden; }
          .footer { margin-top: auto; padding-top: 2mm; border-top: 1px dashed #ccc; text-align: center; font-size: 7pt; color: #666; }
          @media print { body { margin: 0; padding: 0; } .page { page-break-after: always; } .page:last-child { page-break-after: auto; } }
        </style>
      </head>
      <body>
        ${(()=>{let j="";for(let y=0;y<x.length;y+=4){j+='<div class="page">';for(let U=y;U<Math.min(y+4,x.length);U++){const L=x[U];j+=`
                <div class="invoice">
                  <div class="invoice-header">
                    <h1>${e.printHeaderTitle}</h1>
                    <div class="invoice-number">No. ${String(U+1).padStart(4,"0")}</div>
                  </div>
                  <div class="section">
                    <div class="section-title">${e.printSectionTitle}</div>
                    <div class="field"><div class="field-label">성명</div><div class="field-value">${L.customer_name||"-"}</div></div>
                    <div class="field"><div class="field-label">연락처</div><div class="field-value">${me(L.customer_phone||L.phone)}</div></div>
                    <div class="field"><div class="field-label">주소</div><div class="field-value">${L.address||"-"}</div></div>
                  </div>
                  <div class="section">
                    <div class="section-title">주문 정보</div>
                    <div class="field"><div class="field-label">주문일</div><div class="field-value">${pe(L.created_at)}</div></div>
                    ${e.showBranchInPrint?`<div class="field"><div class="field-label">지점</div><div class="field-value">${L.branch_name||"-"}</div></div>`:""}
                    <div class="field"><div class="field-label">수량</div><div class="field-value">${L.quantity||"-"}${e.quantityUnit}</div></div>
                    <div style="margin-top: 1.5mm;"><div class="field-label" style="margin-bottom: 1mm;">주문내역</div><div class="order-box">${L.order_details||"주문 정보 없음"}</div></div>
                  </div>
                  <div class="footer">${e.printFooter}<br/>발행일: ${new Date().toLocaleDateString("ko-KR")}</div>
                </div>
              `}j+="</div>"}return j})()}
        <script>
          window.onload = function() { setTimeout(function() { window.print(); }, 500); }
          window.onafterprint = function() { window.close(); };
        <\/script>
      </body>
      </html>
    `;b.document.write(w),b.document.close(),b.focus()},ce=()=>{if(x.length===0){alert("다운로드할 항목을 선택해주세요");return}const b=x.map((Z,Q)=>e.excelColumns.map(ge=>{switch(ge){case"번호":return Q+1;case"주문일":return pe(Z.created_at);case"지점":return Z.branch_name||"";case"이름":return Z.customer_name||"";case"연락처":return me(Z.customer_phone||Z.phone);case"주소":return Z.address||"";case"수량":return Z.quantity||"";case"주문내역":return(Z.order_details||"").replace(/\n/g," ");default:return""}}));let w="\uFEFF";w+=e.excelColumns.join(",")+`
`,b.forEach(Z=>{const Q=Z.map(ge=>{const M=String(ge);return M.includes(",")||M.includes('"')||M.includes(`
`)?'"'+M.replace(/"/g,'""')+'"':M});w+=Q.join(",")+`
`});const j=new Blob([w],{type:"text/csv;charset=utf-8;"}),y=document.createElement("a"),U=URL.createObjectURL(j),L=new Date().toISOString().slice(0,10),Y=e.getFileName(t,L);y.setAttribute("href",U),y.setAttribute("download",Y),y.style.visibility="hidden",document.body.appendChild(y),y.click(),document.body.removeChild(y)},xe=b=>x.some(w=>w.id===b.id),_e=f.length>0&&x.length===f.length;return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("div",{className:e.containerClass,children:a.jsxs("div",{className:e.cardClass,children:[a.jsxs("div",{className:e.headerClass,children:[e.showBackButton&&a.jsxs("button",{onClick:()=>r(e.backNavigation),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[a.jsx("span",{style:{fontSize:"18px"},children:"←"}),e.backButtonText]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:b=>b.target.style.display="none"}),a.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:e.title})]}),a.jsx("div",{style:{width:"100px"}})]}),e.showBranchInfo&&t?.user_type==="지점관리자"&&a.jsx("div",{className:"mb-4 p-3 bg-purple-50 border border-purple-200 rounded-lg",children:a.jsxs("p",{className:"text-sm",style:{color:"#8b5cf6"},children:["🛡️ ",a.jsx("strong",{children:t.branch})," 지점의 데이터만 표시됩니다"]})}),a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"flex gap-2 items-center",children:[e.showBranchFilter&&a.jsxs("select",{value:T,onChange:b=>_(b.target.value),className:"px-3 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px",width:"150px"},children:[a.jsx("option",{value:"all",children:"전체 지점"}),h.map(b=>a.jsx("option",{value:b.name,children:b.name},b.id))]}),a.jsx("label",{className:"font-bold whitespace-nowrap",style:{color:"#000000",fontSize:"15px"},children:"📅 주문일자"}),a.jsx("input",{type:"date",value:i,onChange:b=>o(b.target.value),className:"px-3 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px",width:"150px"}}),a.jsx("span",{className:"font-bold",style:{color:"#000000",fontSize:"15px"},children:"~"}),a.jsx("input",{type:"date",value:l,onChange:b=>c(b.target.value),className:"px-3 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px",width:"150px"}}),a.jsx("input",{type:"text",value:s,onChange:b=>n(b.target.value),onKeyPress:b=>b.key==="Enter"&&P(),placeholder:e.searchPlaceholder,className:"flex-1 px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}}),a.jsxs("button",{onClick:P,disabled:m,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50 whitespace-nowrap",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px",width:"120px",justifyContent:"center"},children:[a.jsx(ir,{size:18}),m?"검색 중...":"검색"]}),a.jsxs("button",{onClick:H,disabled:m,className:"px-6 py-2 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50 whitespace-nowrap flex items-center gap-2",style:{border:"2px solid #249689",backgroundColor:"white",borderRadius:"10px",fontSize:"15px",color:"#249689",width:"120px",justifyContent:"center"},children:[a.jsx(Ur,{size:18}),"초기화"]})]})}),x.length>0&&a.jsxs("div",{className:"mb-4 p-4 rounded-lg flex items-center justify-between",style:{backgroundColor:"#f0fffe",border:"2px solid #249689"},children:[a.jsxs("span",{className:"font-bold",style:{color:"#249689",fontSize:"15px"},children:["📋 선택된 항목: ",x.length,"건"]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:ce,className:"px-6 py-2 font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2",style:{backgroundColor:"#5B7FD4",color:"white",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(yr,{size:18}),"엑셀다운로드(",x.length.toString().padStart(2,"0"),")"]}),a.jsxs("button",{onClick:je,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(Hc,{size:18}),"인쇄"]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[a.jsx("th",{className:"px-2 py-3 text-center font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689",width:"50px"},children:a.jsx("input",{type:"checkbox",checked:_e,onChange:te,className:"w-4 h-4"})}),e.tableColumns.map((b,w)=>a.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:b},w)),C&&a.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689",width:"80px"},children:"관리"})]})}),a.jsx("tbody",{children:m?a.jsx("tr",{children:a.jsx("td",{colSpan:e.tableColumns.length+(C?2:1),className:"px-4 py-8 text-center",style:{fontSize:"16px"},children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2",style:{borderColor:"#249689"}}),"로딩 중..."]})})}):f.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:e.tableColumns.length+(C?2:1),className:"px-4 py-8 text-center text-gray-500",style:{fontSize:"16px"},children:a.jsxs("div",{children:[a.jsx("p",{className:"mb-2",children:"등록된 주문 내역이 없습니다"}),a.jsx("p",{className:"text-sm",children:"판매관리에서 판매 데이터를 추가하세요"})]})})}):f.map(b=>a.jsxs("tr",{className:`border-b border-gray-200 hover:bg-gray-50 transition-colors ${xe(b)?"bg-blue-50":""}`,children:[a.jsx("td",{className:"px-2 py-3 text-center",children:a.jsx("input",{type:"checkbox",checked:xe(b),onChange:()=>W(b),className:"w-4 h-4"})}),e.renderTableRow(b,pe,me),C&&a.jsx("td",{className:"px-3 py-3 text-center",children:a.jsx("button",{onClick:w=>Ne(b,w),className:"p-2 bg-red-500 text-white rounded hover:bg-red-600 inline-flex items-center justify-center",title:"삭제",children:a.jsx(Sr,{size:16})})})]},b.id))})]})}),f.length>0&&a.jsxs("div",{className:"mt-4 text-right text-gray-600",style:{fontSize:"13px"},children:["총 ",a.jsx("strong",{style:{color:"#249689"},children:f.length}),"건"]})]})}),S&&D&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",style:{borderRadius:"10px"},children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-center text-red-600",children:"⚠️ 삭제 확인"}),a.jsxs("div",{className:"mb-6",children:[a.jsx("p",{className:"text-gray-700 mb-4",children:"정말로 이 주문 내역을 삭제하시겠습니까?"}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2 text-sm",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"고객명:"})," ",D.customer_name]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"주문일:"})," ",pe(D.created_at)]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"지점:"})," ",D.branch_name||"-"]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"주문내역:"})," ",D.order_details||"-"]})]}),a.jsx("p",{className:"text-red-600 text-sm mt-4 font-semibold",children:"※ 삭제된 데이터는 복구할 수 없습니다."})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{A(!1),z(null)},className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",style:{borderRadius:"10px"},children:"취소"}),a.jsx("button",{onClick:ve,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 font-medium",style:{borderRadius:"10px"},children:"삭제"})]})]})})]})}function Ag({user:t,onNavigate:r}){const e={containerClass:"max-w-5xl mx-auto p-6",cardClass:"bg-white rounded-lg shadow-lg p-6",headerClass:"flex items-center justify-between mb-8",title:"주문목록",showBackButton:!0,backNavigation:"Dashboard",backButtonText:"나가기",showBranchInfo:!0,showBranchFilter:!1,filterByBranch:!0,searchPlaceholder:"이름, 전화번호, 이메일로 검색",searchFields:["customer_name","phone","email"],tableColumns:["이름","연락처","주소","주문정보","주문일"],renderTableRow:(s,n,i)=>a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:s.customer_name}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:i(s.phone)}),a.jsxs("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:[s.address?.substring(0,30),s.address?.length>30?"...":""]}),a.jsxs("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:[s.order_details?.substring(0,20),s.order_details?.length>20?"...":""]}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:n(s.created_at)})]}),printTitle:"배송 송장",printHeaderTitle:"📦 배송 송장",printSectionTitle:"📍 수취인 정보",printFooter:"LAS Book Store · 배송 송장",showBranchInPrint:!1,quantityUnit:"개",excelColumns:["번호","주문일","이름","연락처","주소","수량","주문내역"],getFileName:(s,n)=>{const i=s?.branch||"지점명",o=s?.name||"사용자";return`주문목록_${i}_${o}_${n}.csv`}};return a.jsx(Ql,{user:t,onNavigate:r,config:e})}function Zl({user:t,onNavigate:r,isAdminView:e=!1,title:s="구매이력조회",showBranchFilter:n=!1,navigateBack:i="Dashboard"}){const[o,l]=B.useState([]),[c,f]=B.useState([]),[d,h]=B.useState([]),[u,m]=B.useState(!1),[p,x]=B.useState("all"),[g,T]=B.useState(""),[_,S]=B.useState(""),[A,D]=B.useState(""),[z,C]=B.useState(!1),[I,O]=B.useState(null),[P,H]=B.useState(!1),[W,te]=B.useState(null),pe=d.length,me=d.reduce((L,Y)=>L+(Y.quantity||0),0),Ne=e?p==="all"?"전체":p:t?.branch||"-";B.useEffect(()=>{n&&ve(),je()},[]),B.useEffect(()=>{ce()},[o,p,g,_,A]);const ve=async()=>{try{const{data:L,error:Y}=await he.from("users").select("branch").not("branch","is",null).order("branch");if(Y)throw Y;const Z=[...new Set(L.map(Q=>Q.branch))];f(Z.map(Q=>({branch_name:Q})))}catch(L){console.error("지점 조회 실패:",L),alert("지점 목록을 불러오는데 실패했습니다.")}},je=async()=>{m(!0);try{let L=he.from("sales").select("*").order("created_at",{ascending:!1});!e&&t?.branch&&(L=L.eq("user_branch",t.branch));const{data:Y,error:Z}=await L;if(Z)throw Z;l(Y||[]),h(Y||[])}catch(L){console.error("구매이력 조회 실패:",L),alert("구매이력을 불러오는데 실패했습니다.")}finally{m(!1)}},ce=()=>{let L=[...o];if(n&&p!=="all"&&(L=L.filter(Y=>Y.user_branch===p)),g&&(L=L.filter(Y=>new Date(Y.created_at).toISOString().split("T")[0]>=g)),_&&(L=L.filter(Y=>new Date(Y.created_at).toISOString().split("T")[0]<=_)),A.trim()){const Y=A.toLowerCase().trim();L=L.filter(Z=>Z.customer_name?.toLowerCase().includes(Y)||Z.phone?.includes(Y)||Z.depositor?.toLowerCase().includes(Y))}h(L)},xe=()=>{ce()},_e=()=>{x("all"),T(""),S(""),D("")},b=L=>{te(L),H(!0)},w=async()=>{if(W)try{const{error:L}=await he.from("sales").delete().eq("id",W.id);if(L)throw L;alert("삭제되었습니다."),H(!1),te(null),je()}catch(L){console.error("삭제 실패:",L),alert("삭제에 실패했습니다.")}},j=t?.user_type==="시스템관리자",y=L=>{if(!L)return"-";const Y=new Date(L);return`${Y.getFullYear()}.${String(Y.getMonth()+1).padStart(2,"0")}.${String(Y.getDate()).padStart(2,"0")}`},U=L=>{if(!L)return"-";const Y=L.toString().replace(/\D/g,"");return Y.length===11?Y.replace(/(\d{3})(\d{4})(\d{4})/,"$1-$2-$3"):Y.length===10?Y.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"):L};return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsx("div",{className:"bg-white shadow-sm",children:a.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:a.jsxs("div",{className:"flex items-center justify-between relative",children:[a.jsxs("button",{onClick:()=>{console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),console.log("🔙 PurchaseHistoryBase - 나가기 버튼 클릭됨"),console.log("📌 navigateBack 원본 값:",i),console.log("📌 navigateBack 타입:",typeof i),console.log("📌 navigateBack 길이:",i?.length),console.log("📌 navigateBack 문자코드:",[...i].map(L=>L.charCodeAt(0))),console.log("📌 isAdminView:",e),console.log("📌 title:",s),console.log("📌 showBranchFilter:",n),console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),r(i)},className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800",children:[a.jsx(At,{size:20}),a.jsx("span",{children:"나가기"})]}),a.jsxs("div",{className:"absolute left-1/2 transform -translate-x-1/2 flex items-center gap-2",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10",onError:L=>L.target.style.display="none"}),a.jsx("h1",{className:"text-4xl font-bold",style:{color:"#249689"},children:s})]}),a.jsx("div",{style:{width:"120px"}})]})})}),a.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[a.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[a.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border-2 border-blue-200",children:[a.jsx("div",{className:"text-sm text-blue-600 mb-1",children:"📦 총 판매건수"}),a.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:[pe,"건"]})]}),a.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border-2 border-green-200",children:[a.jsx("div",{className:"text-sm text-green-600 mb-1",children:"📚 총 판매수량"}),a.jsxs("div",{className:"text-2xl font-bold text-green-700",children:[me,"권"]})]}),a.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 border-2 border-yellow-200",children:[a.jsx("div",{className:"text-sm text-yellow-600 mb-1",children:"🏢 조회지점"}),a.jsx("div",{className:"text-2xl font-bold text-yellow-700",children:Ne})]})]}),a.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:a.jsxs("div",{className:"flex items-center gap-3",children:[n?a.jsxs("select",{value:p,onChange:L=>x(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500",children:[a.jsx("option",{value:"all",children:"전체 지점"}),c.map(L=>a.jsx("option",{value:L.branch_name,children:L.branch_name},L.branch_name))]}):a.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-300 rounded-lg font-medium",style:{color:"#249689"},children:t?.branch||"-"}),a.jsx("span",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"구매일자"}),a.jsx("input",{type:"date",value:g,onChange:L=>T(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"}),a.jsx("span",{className:"text-gray-500",children:"~"}),a.jsx("input",{type:"date",value:_,onChange:L=>S(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"}),a.jsx("input",{type:"text",value:A,onChange:L=>D(L.target.value),onKeyPress:L=>L.key==="Enter"&&xe(),placeholder:"이름, 연락처, 입금자명 검색",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"}),a.jsxs("button",{onClick:xe,className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 flex items-center gap-2 whitespace-nowrap",children:[a.jsx(ir,{size:18}),"검색"]}),a.jsxs("button",{onClick:_e,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center gap-2 whitespace-nowrap",children:[a.jsx(Ur,{size:18}),"초기화"]})]})}),a.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:u?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"로딩 중..."})}):d.length===0?a.jsx("div",{className:"text-center py-12",children:a.jsx("p",{className:"text-gray-500",children:"조회된 구매이력이 없습니다."})}):a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"실명"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"구매일자"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"지점"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"연락처"}),a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"수량"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"결제정보"}),a.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"주문내역"}),j&&a.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"관리"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:d.map((L,Y)=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3 text-sm",children:L.customer_name||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:y(L.created_at)}),a.jsx("td",{className:"px-4 py-3 text-sm",children:L.user_branch||"-"}),a.jsx("td",{className:"px-4 py-3 text-sm",children:U(L.phone)}),a.jsxs("td",{className:"px-4 py-3 text-sm text-center",children:[L.quantity||0,"개"]}),a.jsx("td",{className:"px-4 py-3 text-sm",children:a.jsxs("div",{children:[a.jsx("div",{className:"font-medium",children:L.payment_method||"-"}),L.payment_method==="입금"&&a.jsxs("div",{className:"text-gray-600 text-xs",children:[L.depositor&&`${L.depositor} / `,L.deposit_amount&&`${L.deposit_amount.toLocaleString()}원`]})]})}),a.jsx("td",{className:"px-4 py-3 text-sm",children:a.jsx("div",{className:"max-w-xs truncate text-gray-600",children:L.order_details||"-"})}),j&&a.jsx("td",{className:"px-4 py-3 text-sm text-center",children:a.jsx("button",{onClick:()=>b(L),className:"p-2 bg-red-500 text-white rounded hover:bg-red-600 inline-flex items-center justify-center",title:"삭제",children:a.jsx(Sr,{size:16})})})]},L.id||Y))})]})}),a.jsx("div",{className:"mt-4 flex items-center justify-between",children:a.jsxs("div",{className:"text-lg font-bold",style:{color:"#249689"},children:["검색결과: ",d.length.toLocaleString(),"건"]})})]}),z&&I&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:a.jsxs("div",{className:"p-6",children:[a.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",style:{color:"#249689"},children:"🏢 구매이력상세"}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-lg font-bold mb-3 text-gray-800",children:"📋 판매 정보"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"판매일자"}),a.jsx("p",{className:"font-medium",children:y(I.created_at)})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"판매 지점"}),a.jsx("p",{className:"font-medium",children:I.user_branch||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"수량"}),a.jsxs("p",{className:"font-medium",children:[I.quantity||0,"개"]})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"주문내역"}),a.jsx("p",{className:"font-medium",children:I.order_details||"-"})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-lg font-bold mb-3 text-gray-800",children:"👤 구매자 정보"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"이름"}),a.jsx("p",{className:"font-medium",children:I.customer_name||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"전화번호"}),a.jsx("p",{className:"font-medium",children:U(I.phone)})]})]})]}),a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-lg font-bold mb-3 text-gray-800",children:"💳 결제 정보"}),a.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"결제 방법"}),a.jsx("p",{className:"font-medium",children:I.payment_method||"-"})]}),I.payment_method==="입금"&&a.jsxs(a.Fragment,{children:[a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"입금자명"}),a.jsx("p",{className:"font-medium",children:I.depositor||"-"})]}),a.jsxs("div",{children:[a.jsx("span",{className:"text-sm text-gray-600",children:"입금액"}),a.jsx("p",{className:"font-bold text-lg",style:{color:"#249689"},children:I.deposit_amount?`${I.deposit_amount.toLocaleString()}원`:"-"})]})]})]})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>window.print(),className:"flex-1 px-4 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 font-medium",children:"🖨️ 출력"}),a.jsx("button",{onClick:()=>C(!1),className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:"❌ 닫기"})]})]})})}),P&&W&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-center text-red-600",children:"⚠️ 삭제 확인"}),a.jsxs("div",{className:"mb-6",children:[a.jsx("p",{className:"text-gray-700 mb-4",children:"정말로 이 구매이력을 삭제하시겠습니까?"}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2 text-sm",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"고객명:"})," ",W.customer_name]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"구매일자:"})," ",y(W.created_at)]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"지점:"})," ",W.user_branch]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"주문내역:"})," ",W.order_details||"-"]})]}),a.jsx("p",{className:"text-red-600 text-sm mt-4 font-semibold",children:"※ 삭제된 데이터는 복구할 수 없습니다."})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{H(!1),te(null)},className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:"취소"}),a.jsx("button",{onClick:w,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 font-medium",children:"삭제"})]})]})})]})}function kg({user:t,onNavigate:r}){return a.jsx(Zl,{user:t,onNavigate:r,isAdminView:!1,title:"구매이력조회",showBranchFilter:!1,navigateBack:"Dashboard"})}function Rg({user:t,onNavigate:r,onLogout:e}){return a.jsx("div",{className:"min-h-screen bg-white",children:a.jsx("div",{className:"max-w-md mx-auto p-6",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:s=>s.target.style.display="none"}),a.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"시스템관리"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"🏢 지점명"}),a.jsx("input",{type:"text",value:t?.branch||"본사",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"👤 이름"}),a.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("button",{onClick:()=>r("SystemAdminUsers"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(ma,{size:20}),"직원정보관리"]}),a.jsxs("button",{onClick:()=>r("SystemAdminBranches"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(mn,{size:20}),"지점관리"]}),a.jsxs("button",{onClick:()=>r("SystemAdminShipping"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(eo,{size:20}),"주문목록관리"]}),a.jsxs("button",{onClick:()=>r("SystemAdminPurchases"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(to,{size:20}),"구매이력조회"]}),a.jsxs("button",{onClick:()=>r("SystemAdminCustomers"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(Xs,{size:20}),"구매자정보"]}),a.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminEventMenu"),r("AdminEventMenu")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#dc2626",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(ua,{size:20}),"이벤트관리"]}),a.jsxs("button",{onClick:e,className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(xa,{size:20}),"LogOut"]})]})]})})})}function Fg({user:t,onNavigate:r}){const[e,s]=B.useState([]),[n,i]=B.useState(!1),[o,l]=B.useState(!1),[c,f]=B.useState("create"),[d,h]=B.useState(null),[u,m]=B.useState({name:"",address:"",manager_name:"",phone:""});B.useEffect(()=>{p()},[]);const p=async()=>{i(!0);try{console.log("Fetching branches...");const{data:D,error:z}=await he.from("branches").select("*").order("created_at",{ascending:!1});if(z)throw console.error("Supabase error:",z),z;console.log("Branches loaded:",D),console.log("Number of branches:",D?.length),D&&D.length>0&&(console.log("First branch:",D[0]),console.log("Branch columns:",Object.keys(D[0]))),s(D||[])}catch(D){console.error("Load branches error:",D),alert("지점 목록을 불러오는 중 오류가 발생했습니다: "+D.message)}finally{i(!1)}},x=D=>{const{name:z,value:C}=D.target;console.log(`Form change: ${z} = ${C}`),m({...u,[z]:C})},g=()=>{console.log("Opening create modal"),f("create"),m({name:"",address:"",manager_name:"",phone:""}),l(!0)},T=D=>{console.log("Opening edit modal for:",D),f("edit"),h(D),m({name:D.name||"",address:D.address||"",manager_name:D.manager_name||"",phone:D.phone||""}),l(!0)},_=async()=>{if(!u.name.trim()){alert("지점명을 입력해주세요");return}i(!0);try{if(c==="create"){console.log("Creating branch:",u);const D={name:u.name.trim(),manager_name:u.manager_name.trim()||null};u.address.trim()&&(D.address=u.address.trim()),u.phone.trim()&&(D.phone=u.phone.trim());const{data:z,error:C}=await he.from("branches").insert([D]).select();if(C)throw console.error("Insert error:",C),C;console.log("Branch created successfully:",z),alert("지점이 생성되었습니다!")}else{console.log("Updating branch:",u);const D={name:u.name.trim(),manager_name:u.manager_name.trim()||null};u.address.trim()&&(D.address=u.address.trim()),u.phone.trim()&&(D.phone=u.phone.trim());const{data:z,error:C}=await he.from("branches").update(D).eq("id",d.id).select();if(C)throw console.error("Update error:",C),C;console.log("Branch updated successfully:",z),alert("지점 정보가 수정되었습니다!")}l(!1),p()}catch(D){console.error("Save branch error:",D),alert(`지점 저장 중 오류가 발생했습니다.
오류: ${D.message}`)}finally{i(!1)}},S=async D=>{if(window.confirm(`"${D.name}" 지점을 삭제하시겠습니까?

이 지점에 속한 직원들의 지점명도 함께 확인해주세요.`)){i(!0);try{console.log("Deleting branch:",D.id);const{error:z}=await he.from("branches").delete().eq("id",D.id);if(z)throw console.error("Delete error:",z),z;console.log("Branch deleted successfully"),alert("지점이 삭제되었습니다!"),p()}catch(z){console.error("Delete branch error:",z),alert("지점 삭제 중 오류가 발생했습니다: "+z.message)}finally{i(!1)}}},A=()=>{if(e.length===0){alert("다운로드할 지점 데이터가 없습니다.");return}try{const z=[["지점명","지점주소","지점장","연락처"].join(","),...e.map(H=>[H.name||"",H.address||"",H.manager_name||"",H.phone||""].map(W=>`"${W}"`).join(","))].join(`
`),C="\uFEFF",I=new Blob([C+z],{type:"text/csv;charset=utf-8;"}),O=document.createElement("a"),P=URL.createObjectURL(I);O.setAttribute("href",P),O.setAttribute("download",`지점정보_${new Date().toISOString().split("T")[0]}.csv`),O.style.visibility="hidden",document.body.appendChild(O),O.click(),document.body.removeChild(O)}catch(D){console.error("Excel download error:",D),alert("엑셀 다운로드 중 오류가 발생했습니다.")}};return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("div",{className:"max-w-5xl mx-auto p-6",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsxs("button",{onClick:()=>r("SystemAdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[a.jsx(At,{size:20}),"나가기"]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:D=>D.target.style.display="none"}),a.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"지점정보관리"})]}),a.jsx("div",{style:{width:"100px"}})]}),a.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[a.jsxs("div",{className:"font-bold",style:{color:"#249689",fontSize:"15px"},children:["지점수 ",e.length.toString().padStart(2,"0")]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:A,disabled:n,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50",style:{backgroundColor:"#5B7FD4",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(yr,{size:18}),"엑셀다운로드(",e.length.toString().padStart(2,"0"),")"]}),a.jsxs("button",{onClick:g,disabled:n,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(ga,{size:18}),"지점 생성"]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[a.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:"지점명"}),a.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:"지점주소"}),a.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:"지점장"}),a.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:"연락처"}),a.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689",width:"120px"},children:"관리"})]})}),a.jsx("tbody",{children:n?a.jsx("tr",{children:a.jsx("td",{colSpan:"5",className:"px-4 py-8 text-center",style:{fontSize:"16px"},children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2",style:{borderColor:"#249689"}}),"로딩 중..."]})})}):e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:"5",className:"px-4 py-8 text-center text-gray-500",style:{fontSize:"16px"},children:a.jsxs("div",{children:[a.jsx(mn,{size:48,className:"mx-auto mb-2 opacity-30"}),a.jsx("p",{className:"mb-2",children:"등록된 지점이 없습니다"}),a.jsx("p",{className:"text-sm",children:'상단의 "지점 생성" 버튼을 클릭하여 지점을 추가하세요'})]})})}):e.map(D=>a.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors",children:[a.jsx("td",{className:"px-3 py-3 font-bold",style:{fontSize:"14px",color:"#249689"},children:D.name}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:D.address||"-"}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:D.manager_name||"-"}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:D.phone||"-"}),a.jsx("td",{className:"px-3 py-3 text-center",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("button",{onClick:()=>T(D),className:"p-2 rounded-lg hover:bg-blue-50 transition-colors",style:{color:"#2563eb"},title:"수정",children:a.jsx(pa,{size:18})}),a.jsx("button",{onClick:()=>S(D),className:"p-2 rounded-lg hover:bg-red-50 transition-colors",style:{color:"#dc2626"},title:"삭제",children:a.jsx(Sr,{size:18})})]})})]},D.id))})]})}),e.length>0&&a.jsxs("div",{className:"mt-4 text-right text-gray-600",style:{fontSize:"13px"},children:["총 ",a.jsx("strong",{style:{color:"#249689"},children:e.length}),"개 지점"]})]})}),o&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>l(!1),children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-md w-full",onClick:D=>D.stopPropagation(),style:{borderRadius:"10px"},children:[a.jsx("h3",{className:"font-bold mb-4",style:{color:"#249689",fontSize:"20px"},children:c==="create"?"지점 생성":"지점정보수정"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:["지점명 ",a.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),c==="create"?a.jsx("input",{type:"text",name:"name",value:u.name,onChange:x,placeholder:"서초점",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}}):a.jsxs("select",{name:"name",value:u.name,onChange:x,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[a.jsx("option",{value:"",children:"선택하세요"}),e.map(D=>a.jsx("option",{value:D.name,children:D.name},D.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"지점주소"}),a.jsx("input",{type:"text",name:"address",value:u.address,onChange:x,placeholder:"서울시 서초구...",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"지점장"}),a.jsx("input",{type:"text",name:"manager_name",value:u.manager_name,onChange:x,placeholder:"홍길동",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"연락처"}),a.jsx("input",{type:"tel",name:"phone",value:u.phone,onChange:x,placeholder:"010-1234-5678",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),a.jsxs("div",{className:"flex gap-2 mt-6",children:[a.jsx("button",{onClick:_,disabled:n,className:"flex-1 py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:n?"저장 중...":c==="create"?"생성":"수정"}),a.jsx("button",{onClick:()=>l(!1),disabled:n,className:"flex-1 py-2.5 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50",style:{border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:"취소"})]})]})})]})}const Dg=async t=>{try{let r="LAS";if(t==="직원"||t==="점주"||t==="점장")r="LAS1";else if(t==="모니터링요원")r="LAS3";else return null;const{data:e,error:s}=await he.from("users").select("referral_code").like("referral_code",`${r}%`).order("referral_code",{ascending:!1}).limit(1);if(s)throw s;let n=1;return e&&e.length>0&&e[0].referral_code&&(n=parseInt(e[0].referral_code.slice(4))+1),r+String(n).padStart(3,"0")}catch(r){return console.error("추천인 코드 생성 오류:",r),null}},Hs=t=>{if(!t)return"";const r=t.replace(/[^0-9]/g,"");return r.length<=3?r:r.length<=7?`${r.slice(0,3)}-${r.slice(3)}`:r.length<=11?`${r.slice(0,3)}-${r.slice(3,7)}-${r.slice(7)}`:`${r.slice(0,3)}-${r.slice(3,7)}-${r.slice(7,11)}`};function Og({user:t,onNavigate:r}){const[e,s]=B.useState([]),[n,i]=B.useState([]),[o,l]=B.useState(!1),[c,f]=B.useState(""),[d,h]=B.useState(""),[u,m]=B.useState("all"),[p,x]=B.useState(""),[g,T]=B.useState(""),[_,S]=B.useState([]),[A,D]=B.useState(!1),[z,C]=B.useState(null),[I,O]=B.useState(null),[P,H]=B.useState(30),[W,te]=B.useState(1),[pe,me]=B.useState({name:"",branch:"",phone:"",user_type:""});B.useEffect(()=>{Ne(),ve()},[]);const Ne=async()=>{try{const{data:M,error:oe}=await he.from("branches").select("*").order("name",{ascending:!0});if(oe)throw oe;i(M||[])}catch(M){console.error("지점 조회 오류:",M)}},ve=async()=>{l(!0);try{const{data:M,error:oe}=await he.from("users").select("*").order("created_at",{ascending:!1});if(oe)throw oe;s(M||[])}catch(M){console.error("직원 조회 오류:",M),alert("직원 목록을 불러오는 중 오류가 발생했습니다.")}finally{l(!1)}},je=async M=>{if(window.confirm("이 직원을 승인하시겠습니까?")){l(!0);try{const oe=e.find(de=>de.id===M);let ie=null;oe&&(ie=await Dg(oe.user_type));const Be={status:"approved",approved_at:new Date().toISOString()};ie&&(Be.referral_code=ie);const{error:ye}=await he.from("users").update(Be).eq("id",M);if(ye)throw ye;alert(ie?`직원이 승인되었습니다!
고유코드: ${ie}`:"직원이 승인되었습니다!"),ve()}catch(oe){console.error("승인 오류:",oe),alert("승인 처리 중 오류가 발생했습니다.")}finally{l(!1)}}},ce=async M=>{if(window.confirm(`이 직원을 거부하시겠습니까?
거부된 직원은 삭제됩니다.`)){l(!0);try{const{error:oe}=await he.from("users").delete().eq("id",M);if(oe)throw oe;alert("직원이 거부되었습니다!"),ve()}catch(oe){console.error("거부 오류:",oe),alert("거부 처리 중 오류가 발생했습니다.")}finally{l(!1)}}},xe=async M=>{const oe="las0000";if(window.confirm(`${M.name}(${M.email})님의 비밀번호를 초기화하시겠습니까?

초기화 비밀번호: ${oe}

※ 직원에게 유선으로 전달해주세요.`)){O(M.id);try{const{error:ie}=await he.from("users").update({password:oe}).eq("id",M.id);if(ie)throw ie;alert(`비밀번호가 초기화되었습니다!

초기화 비밀번호: ${oe}

※ 직원에게 유선으로 초기화 비밀번호를 전달하고,
로그인 후 반드시 비밀번호를 변경하도록 안내해주세요.`)}catch(ie){console.error("비밀번호 초기화 오류:",ie),alert("비밀번호 초기화에 실패했습니다.")}finally{O(null)}}},_e=M=>{C(M),me({name:M.name,branch:M.branch,phone:Hs(M.phone),user_type:M.user_type}),D(!0)},b=M=>{const{name:oe,value:ie}=M.target;me(oe==="phone"?{...pe,[oe]:Hs(ie)}:{...pe,[oe]:ie})},w=async()=>{if(!pe.name.trim()){alert("이름을 입력해주세요.");return}if(window.confirm("수정하시겠습니까?")){l(!0);try{const{error:M}=await he.from("users").update({name:pe.name,phone:pe.phone,branch:pe.branch,user_type:pe.user_type}).eq("id",z.id);if(M)throw M;alert("수정되었습니다!"),D(!1),ve()}catch(M){console.error("수정 오류:",M),alert("수정 처리 중 오류가 발생했습니다.")}finally{l(!1)}}},j=async(M,oe)=>{if(window.confirm(`${oe}님을 삭제하시겠습니까?`)){l(!0);try{const{error:ie}=await he.from("users").delete().eq("id",M);if(ie)throw ie;alert("삭제되었습니다!"),ve()}catch(ie){console.error("삭제 오류:",ie),alert("삭제 처리 중 오류가 발생했습니다.")}finally{l(!1)}}},y=M=>{S(oe=>oe.includes(M)?oe.filter(ie=>ie!==M):[...oe,M])},U=async()=>{if(_.length===0){alert("다운로드할 직원을 선택해주세요.");return}try{l(!0);const M=e.filter(Ee=>_.includes(Ee.id)),oe=await Promise.all(M.map(async Ee=>{const Se=p||new Date(Ee.created_at).toISOString().split("T")[0],Ce=g||new Date().toISOString().split("T")[0],{data:Me,error:er}=await he.from("work_diaries").select("work_hours").eq("user_id",Ee.id).gte("work_date",Se).lte("work_date",Ce);er&&console.error(`근무일지 조회 오류 (user_id: ${Ee.id}):`,er);const Bt=Me?.reduce((mt,pt)=>mt+(parseFloat(pt.work_hours)||0),0)||0,ct=Ee.ssn?Ee.ssn.substring(0,6)+"-*******":"-",Ve=Ee.account_number?Ee.account_number.substring(0,Ee.account_number.length-4)+"****":"-";return{지점명:Ee.branch||"-",이름:Ee.name||"-",전화번호:Hs(Ee.phone)||"-",구분:Ee.user_type||"-",근무시작일:new Date(Se).toLocaleDateString("ko-KR"),근무종료일:new Date(Ce).toLocaleDateString("ko-KR"),총근무시간:`${Bt.toFixed(1)}시간`,주민번호:ct,예금주:Ee.account_holder||"-",기관명:Ee.bank_name||"-",계좌번호:Ve}})),ie=zr.json_to_sheet(oe),Be=zr.book_new();zr.book_append_sheet(Be,ie,"직원목록");const de=`직원목록_${(p&&g?`${p}_${g}`:`전체기간_${new Date().toISOString().split("T")[0]}`).replace(/-/g,"")}.xlsx`;Kl(Be,de)}catch(M){console.error("엑셀 다운로드 오류:",M),alert("엑셀 파일 생성 중 오류가 발생했습니다.")}finally{l(!1)}},L=e.filter(M=>{const oe=M.name?.toLowerCase().includes(c.toLowerCase())||M.email?.toLowerCase().includes(c.toLowerCase()),ie=!d||M.branch===d,Be=u==="all"||M.user_type===u;let ye=!0;if(p||g){const de=new Date(M.created_at);p&&(ye=ye&&de>=new Date(p)),g&&(ye=ye&&de<=new Date(g))}return oe&&ie&&Be&&ye}),Y=Math.ceil(L.length/P),Z=(W-1)*P,Q=Z+P,ge=L.slice(Z,Q);return B.useEffect(()=>{te(1)},[c,d,u,p,g,P]),a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[a.jsx("div",{className:"bg-white border-b pb-4 mb-6",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("button",{onClick:()=>r("SystemAdminDashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",style:{fontSize:"15px"},children:[a.jsx(At,{size:20}),"나가기"]}),a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Book",className:"h-10"}),a.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:"직원정보관리"})]}),a.jsx("div",{className:"w-24"})]})}),a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[a.jsx("h2",{className:"text-lg font-bold mb-4",style:{color:"#249689"},children:"검색 조건"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"이름 / 이메일"}),a.jsxs("div",{className:"relative",children:[a.jsx("input",{type:"text",value:c,onChange:M=>f(M.target.value),placeholder:"검색어를 입력하세요",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"}}),a.jsx(ir,{className:"absolute left-3 top-2.5 text-gray-400",size:18})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"지점"}),a.jsxs("select",{value:d,onChange:M=>h(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"},children:[a.jsx("option",{value:"",children:"전체 지점"}),n.map(M=>a.jsx("option",{value:M.name,children:M.name},M.name))]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"직원구분"}),a.jsxs("select",{value:u,onChange:M=>m(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"},children:[a.jsx("option",{value:"all",children:"전체"}),a.jsx("option",{value:"점주",children:"점주"}),a.jsx("option",{value:"점장",children:"점장"}),a.jsx("option",{value:"직원",children:"직원"}),a.jsx("option",{value:"모니터링요원",children:"모니터링요원"}),a.jsx("option",{value:"계약근무",children:"계약근무"}),a.jsx("option",{value:"지점관리자",children:"지점관리자"}),a.jsx("option",{value:"시스템관리자",children:"시스템관리자"})]})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"근무 시작일"}),a.jsx("input",{type:"date",value:p,onChange:M=>x(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"}})]}),a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"근무 종료일"}),a.jsx("input",{type:"date",value:g,onChange:M=>T(M.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"}})]})]}),a.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsxs("div",{className:"text-gray-600",style:{fontSize:"15px"},children:["총 ",a.jsx("strong",{style:{color:"#249689",fontSize:"16px"},children:L.length}),"명"]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("label",{className:"text-sm text-gray-600",children:"페이지당:"}),a.jsxs("select",{value:P,onChange:M=>H(Number(M.target.value)),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm",style:{fontSize:"14px"},children:[a.jsx("option",{value:30,children:"30개"}),a.jsx("option",{value:50,children:"50개"}),a.jsx("option",{value:100,children:"100개"})]})]})]}),a.jsxs("button",{onClick:U,className:"flex items-center gap-2 px-6 py-2 text-white rounded-lg hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#249689",fontSize:"15px",borderRadius:"10px"},children:[a.jsx(yr,{size:18}),"엑셀다운로드(",_.length,")"]})]})]}),o?a.jsxs("div",{className:"text-center py-12",children:[a.jsx("div",{className:"inline-block w-8 h-8 border-4 border-gray-200 border-t-[#249689] rounded-full animate-spin"}),a.jsx("p",{className:"mt-4 text-gray-600",children:"로딩 중..."})]}):L.length===0?a.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm border",children:a.jsx("p",{className:"text-gray-500",style:{fontSize:"15px"},children:"조건에 맞는 직원이 없습니다."})}):a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{className:"bg-gray-50 border-b",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left",children:a.jsx("input",{type:"checkbox",onChange:M=>{M.target.checked?S(L.map(oe=>oe.id)):S([])},checked:_.length===L.length&&L.length>0,className:"rounded border-gray-300"})}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"이름"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"이메일"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"전화번호"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"지점"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"직원구분"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"고유코드"}),a.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"상태"}),a.jsx("th",{className:"px-4 py-3 text-center font-bold",style:{fontSize:"14px"},children:"관리"})]})}),a.jsx("tbody",{className:"divide-y divide-gray-200",children:ge.map(M=>a.jsxs("tr",{className:"hover:bg-gray-50",children:[a.jsx("td",{className:"px-4 py-3",children:a.jsx("input",{type:"checkbox",checked:_.includes(M.id),onChange:()=>y(M.id),className:"rounded border-gray-300"})}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:M.name}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:M.email}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:Hs(M.phone)||"-"}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:M.branch}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:M.user_type}),a.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px",fontWeight:"bold",color:"#249689"},children:M.referral_code||"-"}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold",style:{backgroundColor:M.status==="approved"?"#D1FAE5":M.status==="pending"?"#FEF3C7":"#FEE2E2",color:M.status==="approved"?"#065F46":M.status==="pending"?"#92400E":"#991B1B"},children:M.status==="approved"?"승인됨":M.status==="pending"?"대기중":"거부됨"})}),a.jsx("td",{className:"px-4 py-3",children:a.jsx("div",{className:"flex items-center justify-center gap-2",children:M.status==="pending"?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>je(M.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"승인",children:a.jsx(ro,{size:18})}),a.jsx("button",{onClick:()=>ce(M.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"거부",children:a.jsx(so,{size:18})})]}):a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:()=>_e(M),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"수정",children:a.jsx(pa,{size:18})}),M.id!==t.id&&a.jsx("button",{onClick:()=>xe(M),disabled:I===M.id,className:"p-1 hover:bg-purple-50 rounded disabled:opacity-50",style:{color:"#7f95eb"},title:"비밀번호 초기화",children:a.jsx(Wc,{size:18})}),a.jsx("button",{onClick:()=>j(M.id,M.name),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"삭제",children:a.jsx(Sr,{size:18})})]})})})]},M.id))})]})}),Y>1&&a.jsxs("div",{className:"mt-4 flex justify-center items-center gap-2",children:[a.jsx("button",{onClick:()=>te(M=>Math.max(1,M-1)),disabled:W===1,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:"이전"}),a.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,Y)},(M,oe)=>{let ie;return Y<=5||W<=3?ie=oe+1:W>=Y-2?ie=Y-4+oe:ie=W-2+oe,a.jsx("button",{onClick:()=>te(ie),className:`px-3 py-1 border rounded ${W===ie?"text-white font-bold":"hover:bg-gray-50"}`,style:{fontSize:"14px",backgroundColor:W===ie?"#249689":"white",borderColor:W===ie?"#249689":"#d1d5db"},children:ie},ie)})}),a.jsx("button",{onClick:()=>te(M=>Math.min(Y,M+1)),disabled:W===Y,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:"다음"}),a.jsxs("span",{className:"ml-4 text-sm text-gray-600",children:[W," / ",Y," 페이지"]})]})]})]}),A&&z&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>D(!1),children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-md w-full",onClick:M=>M.stopPropagation(),style:{borderRadius:"10px"},children:[a.jsx("div",{className:"flex flex-col items-center mb-6",children:a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:M=>M.target.style.display="none"}),a.jsx("h3",{className:"font-bold",style:{color:"#249689",fontSize:"24px"},children:"직원정보수정"})]})}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold text-sm text-gray-600",children:"이메일 (수정불가)"}),a.jsx("input",{type:"text",value:z.email,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-100",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:["이름 ",a.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),a.jsx("input",{type:"text",name:"name",value:pe.name,onChange:b,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:"전화번호"}),a.jsx("input",{type:"tel",name:"phone",value:pe.phone,onChange:b,placeholder:"010-1234-5678",maxLength:"13",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:"지점"}),a.jsxs("select",{name:"branch",value:pe.branch,onChange:b,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[a.jsx("option",{value:"",children:"선택하세요"}),n.map(M=>a.jsx("option",{value:M.name,children:M.name},M.id))]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:"구분"}),a.jsxs("select",{name:"user_type",value:pe.user_type,onChange:b,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[a.jsx("option",{value:"",children:"선택"}),a.jsx("option",{value:"모니터링요원",children:"모니터링요원"}),a.jsx("option",{value:"점주",children:"점주"}),a.jsx("option",{value:"점장",children:"점장"}),a.jsx("option",{value:"계약근무",children:"계약근무"}),a.jsx("option",{value:"지점관리자",children:"지점관리자"})]})]})]}),a.jsxs("div",{className:"flex gap-2 mt-6",children:[a.jsx("button",{onClick:w,disabled:o,className:"flex-1 py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:o?"저장 중...":a.jsxs(a.Fragment,{children:[a.jsx(Qn,{size:18}),"수정"]})}),a.jsxs("button",{onClick:()=>D(!1),disabled:o,className:"flex-1 py-2.5 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",style:{border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(no,{size:18}),"취소"]})]})]})})]})}function Ig({user:t,onNavigate:r}){const[e,s]=B.useState([]),[n,i]=B.useState(!1),[o,l]=B.useState(""),[c,f]=B.useState(!1),[d,h]=B.useState(null),[u,m]=B.useState(!1),[p,x]=B.useState(null),g=t?.user_type==="시스템관리자";B.useEffect(()=>{T()},[]);const T=async()=>{i(!0);try{const{data:C,error:I}=await he.from("sales").select("customer_name, phone, email, address, age").order("created_at",{ascending:!1});if(I)throw I;console.log("🔍 조회된 원본 데이터:",C);const O=[],P=new Set;C.forEach(H=>{let W;if(H.customer_name&&H.phone)W=`${H.customer_name}-${H.phone}`;else if(H.email)W=`email-${H.email}`;else if(H.phone)W=`phone-${H.phone}`;else if(H.customer_name)W=`name-${H.customer_name}`;else return;P.has(W)||(P.add(W),O.push(H))}),console.log("✅ 중복 제거 후 구매자 목록:",O),s(O)}catch(C){console.error("❌ 구매자 조회 오류:",C),alert("구매자 정보를 불러오는 중 오류가 발생했습니다: "+C.message)}finally{i(!1)}},_=async()=>{if(!o.trim()){T();return}i(!0);try{const{data:C,error:I}=await he.from("sales").select("customer_name, phone, email, address, age").or(`customer_name.ilike.%${o}%,phone.ilike.%${o}%,email.ilike.%${o}%`).order("created_at",{ascending:!1});if(I)throw I;const O=[],P=new Set;C.forEach(H=>{let W;if(H.customer_name&&H.phone)W=`${H.customer_name}-${H.phone}`;else if(H.email)W=`email-${H.email}`;else if(H.phone)W=`phone-${H.phone}`;else if(H.customer_name)W=`name-${H.customer_name}`;else return;P.has(W)||(P.add(W),O.push(H))}),s(O),O.length===0&&alert("검색 결과가 없습니다")}catch(C){console.error("❌ 검색 오류:",C),alert("검색 중 오류가 발생했습니다: "+C.message)}finally{i(!1)}},S=()=>{l(""),T()},A=C=>{h(C),f(!0)},D=(C,I)=>{I.stopPropagation(),x(C),m(!0)},z=async()=>{if(p)try{const{error:C}=await he.from("sales").delete().eq("customer_name",p.customer_name).eq("phone",p.phone);if(C)throw C;alert("삭제되었습니다."),m(!1),x(null),o.trim()?_():T()}catch(C){console.error("삭제 실패:",C),alert("삭제에 실패했습니다.")}};return a.jsxs("div",{className:"min-h-screen bg-white",children:[a.jsx("div",{className:"max-w-6xl mx-auto p-6",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsxs("button",{onClick:()=>r("SystemAdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[a.jsx(At,{size:20}),"나가기"]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:C=>C.target.style.display="none"}),a.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"구매자정보"})]}),a.jsx("div",{style:{width:"100px"}})]}),a.jsx("div",{className:"mb-6 p-3 rounded-lg",style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6"},children:a.jsxs("p",{className:"text-sm",style:{color:"#1e40af"},children:["ℹ️ 구매자 정보는 ",a.jsx("strong",{children:"조회만 가능"}),"하며 수정할 수 없습니다."]})}),a.jsx("div",{className:"mb-6",children:a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:o,onChange:C=>l(C.target.value),onKeyPress:C=>C.key==="Enter"&&_(),placeholder:"이름, 전화번호, 이메일로 검색",disabled:n,className:"flex-1 px-4 py-2 border border-gray-300 disabled:bg-gray-100",style:{borderRadius:"10px",fontSize:"15px"}}),a.jsxs("button",{onClick:_,disabled:n,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50 whitespace-nowrap",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px",width:"120px",justifyContent:"center"},children:[a.jsx(ir,{size:18}),"검색"]}),a.jsxs("button",{onClick:S,disabled:n,className:"px-6 py-2 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50 flex items-center gap-2 whitespace-nowrap",style:{border:"2px solid #249689",backgroundColor:"white",borderRadius:"10px",fontSize:"15px",color:"#249689",width:"120px",justifyContent:"center"},children:[a.jsx(Ur,{size:18}),"초기화"]})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[a.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689",width:"80px"},children:"상세"}),a.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:"이름"}),a.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:"전화번호"}),a.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:"주소"}),a.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:"이메일"}),g&&a.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689",width:"80px"},children:"관리"})]})}),a.jsx("tbody",{children:n?a.jsx("tr",{children:a.jsx("td",{colSpan:g?"6":"5",className:"px-4 py-8 text-center",children:a.jsxs("div",{className:"flex items-center justify-center gap-2",children:[a.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2",style:{borderColor:"#249689"}}),"로딩 중..."]})})}):e.length===0?a.jsx("tr",{children:a.jsxs("td",{colSpan:g?"6":"5",className:"px-4 py-8 text-center text-gray-500",children:[a.jsx(ma,{size:48,className:"mx-auto mb-2 opacity-30"}),a.jsx("p",{className:"mb-2",children:"등록된 구매자 정보가 없습니다"}),a.jsx("p",{className:"text-sm",children:"판매 데이터가 생성되면 자동으로 표시됩니다"})]})}):e.map((C,I)=>a.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>A(C),children:[a.jsx("td",{className:"px-3 py-3 text-center",children:a.jsx("button",{onClick:O=>{O.stopPropagation(),A(C)},className:"p-2 rounded-full hover:bg-gray-200 transition-colors",style:{color:"#249689"},title:"상세보기",children:a.jsx(ao,{size:16})})}),a.jsx("td",{className:"px-3 py-3 font-bold",style:{fontSize:"15px"},children:C.customer_name||"-"}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:C.phone||"-"}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:C.address?C.address.length>30?C.address.substring(0,30)+"...":C.address:"-"}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:C.email||"-"}),g&&a.jsx("td",{className:"px-3 py-3 text-center",children:a.jsx("button",{onClick:O=>D(C,O),className:"p-2 bg-red-500 text-white rounded hover:bg-red-600 inline-flex items-center justify-center",title:"삭제",children:a.jsx(Sr,{size:16})})})]},I))})]})}),e.length>0&&a.jsxs("div",{className:"mt-4 text-right text-gray-600",style:{fontSize:"13px"},children:["총 ",a.jsx("strong",{style:{color:"#249689"},children:e.length}),"명"]})]})}),c&&d&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>f(!1),children:a.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[85vh] overflow-y-auto",onClick:C=>C.stopPropagation(),style:{borderRadius:"10px"},children:[a.jsx("div",{className:"flex items-center justify-between mb-4",children:a.jsx("h3",{className:"font-bold",style:{color:"#249689",fontSize:"20px"},children:"👤 구매자 상세정보"})}),a.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"#f0fffe",border:"2px solid #249689"},children:[a.jsx("h4",{className:"font-bold mb-3",style:{color:"#249689",fontSize:"16px"},children:"기본정보"}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:"이름"}),a.jsx("p",{className:"text-sm",children:d.customer_name||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:"나이"}),a.jsx("p",{className:"text-sm",children:d.age?`${d.age}세`:"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:"전화번호"}),a.jsx("p",{className:"text-sm",children:d.phone||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:"이메일"}),a.jsx("p",{className:"text-sm break-all",children:d.email||"-"})]}),a.jsxs("div",{className:"col-span-2",children:[a.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:"주소"}),a.jsx("p",{className:"text-sm",children:d.address||"-"})]})]})]}),a.jsx("div",{className:"mt-4 flex justify-end",children:a.jsxs("button",{onClick:()=>f(!1),className:"px-6 py-2 font-bold rounded-lg hover:bg-gray-100 transition-colors flex items-center gap-2",style:{border:"2px solid #249689",backgroundColor:"white",borderRadius:"10px",fontSize:"15px",color:"#249689"},children:[a.jsx(no,{size:18}),"닫기"]})})]})}),u&&p&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",style:{borderRadius:"10px"},children:[a.jsx("h2",{className:"text-xl font-bold mb-4 text-center text-red-600",children:"⚠️ 삭제 확인"}),a.jsxs("div",{className:"mb-6",children:[a.jsx("p",{className:"text-gray-700 mb-4",children:"정말로 이 구매자의 모든 구매 기록을 삭제하시겠습니까?"}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2 text-sm",children:[a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"이름:"})," ",p.customer_name]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"전화번호:"})," ",p.phone]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"이메일:"})," ",p.email||"-"]}),a.jsxs("p",{children:[a.jsx("span",{className:"font-semibold",children:"주소:"})," ",p.address||"-"]})]}),a.jsx("p",{className:"text-red-600 text-sm mt-4 font-semibold",children:"※ 삭제된 데이터는 복구할 수 없습니다."})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx("button",{onClick:()=>{m(!1),x(null)},className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",style:{borderRadius:"10px"},children:"취소"}),a.jsx("button",{onClick:z,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 font-medium",style:{borderRadius:"10px"},children:"삭제"})]})]})})]})}function Pg({user:t,onNavigate:r}){return a.jsx(Zl,{user:t,onNavigate:r,isAdminView:!0,title:"구매이력조회",showBranchFilter:!0,navigateBack:"SystemAdminDashboard"})}function Lg({user:t,onNavigate:r}){const e={containerClass:"max-w-6xl mx-auto p-6",cardClass:"bg-white rounded-lg shadow-lg p-6",headerClass:"flex items-center justify-between mb-8",title:"주문목록",showBackButton:!0,backNavigation:"system-admin",backButtonText:"나가기",showBranchInfo:!1,showBranchFilter:!0,filterByBranch:!1,searchPlaceholder:"이름, 전화번호, 이메일로 검색",searchFields:["customer_name","phone","customer_phone","email","address"],tableColumns:["주문일","지점","이름","연락처","주소","수량","주문내역"],renderTableRow:(s,n,i)=>a.jsxs(a.Fragment,{children:[a.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:n(s.created_at)}),a.jsx("td",{className:"px-3 py-3 font-bold",style:{fontSize:"15px",color:"#249689"},children:s.branch_name||"-"}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:s.customer_name||"-"}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:i(s.customer_phone||s.phone)}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:s.address?s.address.length>30?s.address.substring(0,30)+"...":s.address:"-"}),a.jsxs("td",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"15px"},children:[s.quantity||0,"개"]}),a.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:s.order_details?s.order_details.length>20?s.order_details.substring(0,20)+"...":s.order_details:"-"})]}),printTitle:"주문목록",printHeaderTitle:"주문목록",printSectionTitle:"수취인 정보",printFooter:"LAS Book Store · 주문목록",showBranchInPrint:!0,quantityUnit:"권",excelColumns:["번호","주문일","지점","이름","연락처","주소","수량","주문내역"],getFileName:(s,n)=>`주문목록_전체_${n}.csv`};return a.jsx(Ql,{user:t,onNavigate:r,config:e})}function Bg({user:t,onBack:r,onNavigate:e}){const[s,n]=B.useState(null),[i,o]=B.useState(!0),[l,c]=B.useState(!1),[f,d]=B.useState(!1),[h,u]=B.useState({name:"",phone:""}),[m,p]=B.useState({currentPassword:"",newPassword:"",confirmPassword:""});B.useEffect(()=>{x()},[t]);const x=async()=>{o(!0);try{const{data:D,error:z}=await he.from("users").select("*").eq("id",t.id).single();if(z)throw z;console.log("✅ 사용자 정보 로드:",D),n(D),u({name:D.name||"",phone:D.phone||""})}catch(D){console.error("❌ 사용자 정보 조회 오류:",D),alert("사용자 정보를 불러오는데 실패했습니다.")}finally{o(!1)}},g=D=>{u({...h,[D.target.name]:D.target.value})},T=D=>{p({...m,[D.target.name]:D.target.value})},_=async()=>{if(!h.name.trim()){alert("이름을 입력해주세요.");return}o(!0);try{const{error:D}=await he.from("users").update({name:h.name,phone:h.phone}).eq("id",t.id);if(D)throw D;alert("정보가 수정되었습니다."),c(!1),x()}catch(D){console.error("정보 수정 오류:",D),alert("정보 수정에 실패했습니다.")}finally{o(!1)}},S=async()=>{const{currentPassword:D,newPassword:z,confirmPassword:C}=m;if(!D||!z||!C){alert("모든 비밀번호 필드를 입력해주세요.");return}if(z.length<6){alert("새 비밀번호는 6자 이상이어야 합니다.");return}if(z!==C){alert("새 비밀번호가 일치하지 않습니다.");return}o(!0);try{const{data:I,error:O}=await he.from("users").select("password").eq("id",t.id).single();if(O)throw O;if(I.password!==D){alert("현재 비밀번호가 일치하지 않습니다."),o(!1);return}const{error:P}=await he.from("users").update({password:z}).eq("id",t.id);if(P)throw P;alert("비밀번호가 변경되었습니다."),d(!1),p({currentPassword:"",newPassword:"",confirmPassword:""})}catch(I){console.error("비밀번호 변경 오류:",I),alert("비밀번호 변경에 실패했습니다.")}finally{o(!1)}},A=()=>{d(!1),p({currentPassword:"",newPassword:"",confirmPassword:""})};return i&&!s?a.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:"#249689"}}),a.jsx("p",{className:"text-gray-600",children:"로딩 중..."})]})}):a.jsx("div",{className:"flex items-start justify-center min-h-screen bg-gray-50 p-2",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md mt-10",children:[a.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-4",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:D=>D.target.style.display="none"}),a.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"28px"},children:"내 정보관리"})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[a.jsx(Gc,{size:18}),"이메일"]}),a.jsx("input",{type:"text",value:s?.email||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[a.jsx(Ks,{size:18}),"이름"]}),l?a.jsx("input",{type:"text",name:"name",value:h.name,onChange:g,className:"w-full px-4 py-2 border border-gray-300 focus:border-teal-500 focus:outline-none",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}}):a.jsx("input",{type:"text",value:s?.name||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[a.jsx(Vc,{size:18}),"전화번호"]}),l?a.jsx("input",{type:"tel",name:"phone",value:h.phone,onChange:g,className:"w-full px-4 py-2 border border-gray-300 focus:border-teal-500 focus:outline-none",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}}):a.jsx("input",{type:"text",value:s?.phone||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[a.jsx(mn,{size:18}),"지점"]}),a.jsx("input",{type:"text",value:s?.branch||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[a.jsx(Xc,{size:18}),"구분"]}),a.jsx("input",{type:"text",value:s?.user_type||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),s?.referral_code&&a.jsxs("div",{children:[a.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[a.jsx(ti,{size:18}),"고유코드"]}),a.jsx("div",{className:"w-full px-4 py-3 border-2 font-bold",style:{borderRadius:"10px",backgroundColor:"#D1FAE5",borderColor:"#14B8A6",color:"#0D9488",fontSize:"16px",letterSpacing:"0.5px"},children:s.referral_code}),a.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"* 이벤트 참가자 추천 시 이 코드를 알려주세요"}),a.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:a.jsxs("p",{className:"text-xs leading-relaxed",style:{color:"#92400E"},children:["💡 ",a.jsx("span",{className:"font-bold",children:"안내:"})," 이름과 전화번호는 직접 수정할 수 있습니다. 지점이나 구분(직급) 변경이 필요한 경우 관리자에게 문의해 주세요"]})})]}),a.jsx("div",{className:"mt-6 space-y-2.5",children:l?a.jsxs(a.Fragment,{children:[a.jsx("button",{onClick:_,disabled:i,className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:i?"저장 중...":"저장"}),a.jsx("button",{onClick:()=>{c(!1),u({name:s.name||"",phone:s.phone||""})},className:"w-full py-3 font-bold rounded-lg transition-colors",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:"취소"})]}):f?a.jsxs("div",{className:"space-y-2.5",children:[a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-3",children:a.jsxs("h3",{className:"font-bold mb-2 flex items-center gap-2",style:{color:"#000000",fontSize:"15px"},children:[a.jsx(ri,{size:18}),"비밀번호 변경"]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"14px"},children:"현재 비밀번호 *"}),a.jsx("input",{type:"password",name:"currentPassword",value:m.currentPassword,onChange:T,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},placeholder:"••••••"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"14px"},children:"새 비밀번호 *"}),a.jsx("input",{type:"password",name:"newPassword",value:m.newPassword,onChange:T,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},placeholder:"새 비밀번호 (6자 이상)"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"14px"},children:"새 비밀번호 확인 *"}),a.jsx("input",{type:"password",name:"confirmPassword",value:m.confirmPassword,onChange:T,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},placeholder:"새 비밀번호 다시 입력하세요"})]}),a.jsx("button",{onClick:S,disabled:i,className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:i?"변경 중...":"비밀번호 변경"}),a.jsx("button",{onClick:A,className:"w-full py-3 font-bold rounded-lg transition-colors",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:"취소"})]}):a.jsxs(a.Fragment,{children:[a.jsxs("button",{onClick:()=>c(!0),className:"w-full py-3 flex items-center justify-center gap-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(va,{size:18}),"정보 수정"]}),s?.referral_code&&a.jsxs("button",{onClick:()=>e("MyQRCode"),className:"w-full py-3 flex items-center justify-center gap-2 font-bold rounded-lg hover:opacity-90 transition-opacity",style:{color:"white",border:"none",backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(ti,{size:18}),"내 QR 코드"]}),a.jsxs("button",{onClick:()=>d(!0),className:"w-full py-3 flex items-center justify-center gap-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#8B8FD9",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(ri,{size:18}),"비밀번호 변경"]}),a.jsxs("button",{onClick:r,className:"w-full py-3 flex items-center justify-center gap-2 font-bold rounded-lg hover:bg-gray-50 transition-colors",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(At,{size:18}),"나가기"]})]})})]})]})})}var ks={},Mg=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},ec={},Et={};let Ua;const zg=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Et.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17};Et.getSymbolTotalCodewords=function(r){return zg[r]};Et.getBCHDigit=function(t){let r=0;for(;t!==0;)r++,t>>>=1;return r};Et.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');Ua=r};Et.isKanjiModeEnabled=function(){return typeof Ua<"u"};Et.toSJIS=function(r){return Ua(r)};var An={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function r(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}t.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},t.from=function(s,n){if(t.isValid(s))return s;try{return r(s)}catch{return n}}})(An);function tc(){this.buffer=[],this.length=0}tc.prototype={get:function(t){const r=Math.floor(t/8);return(this.buffer[r]>>>7-t%8&1)===1},put:function(t,r){for(let e=0;e<r;e++)this.putBit((t>>>r-e-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),t&&(this.buffer[r]|=128>>>this.length%8),this.length++}};var Ug=tc;function Rs(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}Rs.prototype.set=function(t,r,e,s){const n=t*this.size+r;this.data[n]=e,s&&(this.reservedBit[n]=!0)};Rs.prototype.get=function(t,r){return this.data[t*this.size+r]};Rs.prototype.xor=function(t,r,e){this.data[t*this.size+r]^=e};Rs.prototype.isReserved=function(t,r){return this.reservedBit[t*this.size+r]};var $g=Rs,rc={};(function(t){const r=Et.getSymbolSize;t.getRowColCoords=function(s){if(s===1)return[];const n=Math.floor(s/7)+2,i=r(s),o=i===145?26:Math.ceil((i-13)/(2*n-2))*2,l=[i-7];for(let c=1;c<n-1;c++)l[c]=l[c-1]-o;return l.push(6),l.reverse()},t.getPositions=function(s){const n=[],i=t.getRowColCoords(s),o=i.length;for(let l=0;l<o;l++)for(let c=0;c<o;c++)l===0&&c===0||l===0&&c===o-1||l===o-1&&c===0||n.push([i[l],i[c]]);return n}})(rc);var sc={};const Hg=Et.getSymbolSize,Ji=7;sc.getPositions=function(r){const e=Hg(r);return[[0,0],[e-Ji,0],[0,e-Ji]]};var nc={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const r={N1:3,N2:3,N3:40,N4:10};t.isValid=function(n){return n!=null&&n!==""&&!isNaN(n)&&n>=0&&n<=7},t.from=function(n){return t.isValid(n)?parseInt(n,10):void 0},t.getPenaltyN1=function(n){const i=n.size;let o=0,l=0,c=0,f=null,d=null;for(let h=0;h<i;h++){l=c=0,f=d=null;for(let u=0;u<i;u++){let m=n.get(h,u);m===f?l++:(l>=5&&(o+=r.N1+(l-5)),f=m,l=1),m=n.get(u,h),m===d?c++:(c>=5&&(o+=r.N1+(c-5)),d=m,c=1)}l>=5&&(o+=r.N1+(l-5)),c>=5&&(o+=r.N1+(c-5))}return o},t.getPenaltyN2=function(n){const i=n.size;let o=0;for(let l=0;l<i-1;l++)for(let c=0;c<i-1;c++){const f=n.get(l,c)+n.get(l,c+1)+n.get(l+1,c)+n.get(l+1,c+1);(f===4||f===0)&&o++}return o*r.N2},t.getPenaltyN3=function(n){const i=n.size;let o=0,l=0,c=0;for(let f=0;f<i;f++){l=c=0;for(let d=0;d<i;d++)l=l<<1&2047|n.get(f,d),d>=10&&(l===1488||l===93)&&o++,c=c<<1&2047|n.get(d,f),d>=10&&(c===1488||c===93)&&o++}return o*r.N3},t.getPenaltyN4=function(n){let i=0;const o=n.data.length;for(let c=0;c<o;c++)i+=n.data[c];return Math.abs(Math.ceil(i*100/o/5)-10)*r.N4};function e(s,n,i){switch(s){case t.Patterns.PATTERN000:return(n+i)%2===0;case t.Patterns.PATTERN001:return n%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(n+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(n/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return n*i%2+n*i%3===0;case t.Patterns.PATTERN110:return(n*i%2+n*i%3)%2===0;case t.Patterns.PATTERN111:return(n*i%3+(n+i)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}t.applyMask=function(n,i){const o=i.size;for(let l=0;l<o;l++)for(let c=0;c<o;c++)i.isReserved(c,l)||i.xor(c,l,e(n,c,l))},t.getBestMask=function(n,i){const o=Object.keys(t.Patterns).length;let l=0,c=1/0;for(let f=0;f<o;f++){i(f),t.applyMask(f,n);const d=t.getPenaltyN1(n)+t.getPenaltyN2(n)+t.getPenaltyN3(n)+t.getPenaltyN4(n);t.applyMask(f,n),d<c&&(c=d,l=f)}return l}})(nc);var kn={};const ar=An,Ws=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],Gs=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];kn.getBlocksCount=function(r,e){switch(e){case ar.L:return Ws[(r-1)*4+0];case ar.M:return Ws[(r-1)*4+1];case ar.Q:return Ws[(r-1)*4+2];case ar.H:return Ws[(r-1)*4+3];default:return}};kn.getTotalCodewordsCount=function(r,e){switch(e){case ar.L:return Gs[(r-1)*4+0];case ar.M:return Gs[(r-1)*4+1];case ar.Q:return Gs[(r-1)*4+2];case ar.H:return Gs[(r-1)*4+3];default:return}};var ac={},Rn={};const hs=new Uint8Array(512),un=new Uint8Array(256);(function(){let r=1;for(let e=0;e<255;e++)hs[e]=r,un[r]=e,r<<=1,r&256&&(r^=285);for(let e=255;e<512;e++)hs[e]=hs[e-255]})();Rn.log=function(r){if(r<1)throw new Error("log("+r+")");return un[r]};Rn.exp=function(r){return hs[r]};Rn.mul=function(r,e){return r===0||e===0?0:hs[un[r]+un[e]]};(function(t){const r=Rn;t.mul=function(s,n){const i=new Uint8Array(s.length+n.length-1);for(let o=0;o<s.length;o++)for(let l=0;l<n.length;l++)i[o+l]^=r.mul(s[o],n[l]);return i},t.mod=function(s,n){let i=new Uint8Array(s);for(;i.length-n.length>=0;){const o=i[0];for(let c=0;c<n.length;c++)i[c]^=r.mul(n[c],o);let l=0;for(;l<i.length&&i[l]===0;)l++;i=i.slice(l)}return i},t.generateECPolynomial=function(s){let n=new Uint8Array([1]);for(let i=0;i<s;i++)n=t.mul(n,new Uint8Array([1,r.exp(i)]));return n}})(ac);const ic=ac;function $a(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}$a.prototype.initialize=function(r){this.degree=r,this.genPoly=ic.generateECPolynomial(this.degree)};$a.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(r.length+this.degree);e.set(r);const s=ic.mod(e,this.genPoly),n=this.degree-s.length;if(n>0){const i=new Uint8Array(this.degree);return i.set(s,n),i}return s};var Wg=$a,oc={},fr={},Ha={};Ha.isValid=function(r){return!isNaN(r)&&r>=1&&r<=40};var Ht={};const lc="[0-9]+",Gg="[A-Z $%*+\\-./:]+";let ws="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";ws=ws.replace(/u/g,"\\u");const Vg="(?:(?![A-Z0-9 $%*+\\-./:]|"+ws+`)(?:.|[\r
]))+`;Ht.KANJI=new RegExp(ws,"g");Ht.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Ht.BYTE=new RegExp(Vg,"g");Ht.NUMERIC=new RegExp(lc,"g");Ht.ALPHANUMERIC=new RegExp(Gg,"g");const Xg=new RegExp("^"+ws+"$"),Kg=new RegExp("^"+lc+"$"),qg=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Ht.testKanji=function(r){return Xg.test(r)};Ht.testNumeric=function(r){return Kg.test(r)};Ht.testAlphanumeric=function(r){return qg.test(r)};(function(t){const r=Ha,e=Ht;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!r.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return e.testNumeric(i)?t.NUMERIC:e.testAlphanumeric(i)?t.ALPHANUMERIC:e.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function s(n){if(typeof n!="string")throw new Error("Param is not a string");switch(n.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+n)}}t.from=function(i,o){if(t.isValid(i))return i;try{return s(i)}catch{return o}}})(fr);(function(t){const r=Et,e=kn,s=An,n=fr,i=Ha,o=7973,l=r.getBCHDigit(o);function c(u,m,p){for(let x=1;x<=40;x++)if(m<=t.getCapacity(x,p,u))return x}function f(u,m){return n.getCharCountIndicator(u,m)+4}function d(u,m){let p=0;return u.forEach(function(x){const g=f(x.mode,m);p+=g+x.getBitsLength()}),p}function h(u,m){for(let p=1;p<=40;p++)if(d(u,p)<=t.getCapacity(p,m,n.MIXED))return p}t.from=function(m,p){return i.isValid(m)?parseInt(m,10):p},t.getCapacity=function(m,p,x){if(!i.isValid(m))throw new Error("Invalid QR Code version");typeof x>"u"&&(x=n.BYTE);const g=r.getSymbolTotalCodewords(m),T=e.getTotalCodewordsCount(m,p),_=(g-T)*8;if(x===n.MIXED)return _;const S=_-f(x,m);switch(x){case n.NUMERIC:return Math.floor(S/10*3);case n.ALPHANUMERIC:return Math.floor(S/11*2);case n.KANJI:return Math.floor(S/13);case n.BYTE:default:return Math.floor(S/8)}},t.getBestVersionForData=function(m,p){let x;const g=s.from(p,s.M);if(Array.isArray(m)){if(m.length>1)return h(m,g);if(m.length===0)return 1;x=m[0]}else x=m;return c(x.mode,x.getLength(),g)},t.getEncodedBits=function(m){if(!i.isValid(m)||m<7)throw new Error("Invalid QR Code version");let p=m<<12;for(;r.getBCHDigit(p)-l>=0;)p^=o<<r.getBCHDigit(p)-l;return m<<12|p}})(oc);var cc={};const ca=Et,dc=1335,Yg=21522,Qi=ca.getBCHDigit(dc);cc.getEncodedBits=function(r,e){const s=r.bit<<3|e;let n=s<<10;for(;ca.getBCHDigit(n)-Qi>=0;)n^=dc<<ca.getBCHDigit(n)-Qi;return(s<<10|n)^Yg};var fc={};const Jg=fr;function Wr(t){this.mode=Jg.NUMERIC,this.data=t.toString()}Wr.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)};Wr.prototype.getLength=function(){return this.data.length};Wr.prototype.getBitsLength=function(){return Wr.getBitsLength(this.data.length)};Wr.prototype.write=function(r){let e,s,n;for(e=0;e+3<=this.data.length;e+=3)s=this.data.substr(e,3),n=parseInt(s,10),r.put(n,10);const i=this.data.length-e;i>0&&(s=this.data.substr(e),n=parseInt(s,10),r.put(n,i*3+1))};var Qg=Wr;const Zg=fr,Xn=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Gr(t){this.mode=Zg.ALPHANUMERIC,this.data=t}Gr.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)};Gr.prototype.getLength=function(){return this.data.length};Gr.prototype.getBitsLength=function(){return Gr.getBitsLength(this.data.length)};Gr.prototype.write=function(r){let e;for(e=0;e+2<=this.data.length;e+=2){let s=Xn.indexOf(this.data[e])*45;s+=Xn.indexOf(this.data[e+1]),r.put(s,11)}this.data.length%2&&r.put(Xn.indexOf(this.data[e]),6)};var ev=Gr;const tv=fr;function Vr(t){this.mode=tv.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}Vr.getBitsLength=function(r){return r*8};Vr.prototype.getLength=function(){return this.data.length};Vr.prototype.getBitsLength=function(){return Vr.getBitsLength(this.data.length)};Vr.prototype.write=function(t){for(let r=0,e=this.data.length;r<e;r++)t.put(this.data[r],8)};var rv=Vr;const sv=fr,nv=Et;function Xr(t){this.mode=sv.KANJI,this.data=t}Xr.getBitsLength=function(r){return r*13};Xr.prototype.getLength=function(){return this.data.length};Xr.prototype.getBitsLength=function(){return Xr.getBitsLength(this.data.length)};Xr.prototype.write=function(t){let r;for(r=0;r<this.data.length;r++){let e=nv.toSJIS(this.data[r]);if(e>=33088&&e<=40956)e-=33088;else if(e>=57408&&e<=60351)e-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);e=(e>>>8&255)*192+(e&255),t.put(e,13)}};var av=Xr,hc={exports:{}};(function(t){var r={single_source_shortest_paths:function(e,s,n){var i={},o={};o[s]=0;var l=r.PriorityQueue.make();l.push(s,0);for(var c,f,d,h,u,m,p,x,g;!l.empty();){c=l.pop(),f=c.value,h=c.cost,u=e[f]||{};for(d in u)u.hasOwnProperty(d)&&(m=u[d],p=h+m,x=o[d],g=typeof o[d]>"u",(g||x>p)&&(o[d]=p,l.push(d,p),i[d]=f))}if(typeof n<"u"&&typeof o[n]>"u"){var T=["Could not find a path from ",s," to ",n,"."].join("");throw new Error(T)}return i},extract_shortest_path_from_predecessor_list:function(e,s){for(var n=[],i=s;i;)n.push(i),e[i],i=e[i];return n.reverse(),n},find_path:function(e,s,n){var i=r.single_source_shortest_paths(e,s,n);return r.extract_shortest_path_from_predecessor_list(i,n)},PriorityQueue:{make:function(e){var s=r.PriorityQueue,n={},i;e=e||{};for(i in s)s.hasOwnProperty(i)&&(n[i]=s[i]);return n.queue=[],n.sorter=e.sorter||s.default_sorter,n},default_sorter:function(e,s){return e.cost-s.cost},push:function(e,s){var n={value:e,cost:s};this.queue.push(n),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=r})(hc);var iv=hc.exports;(function(t){const r=fr,e=Qg,s=ev,n=rv,i=av,o=Ht,l=Et,c=iv;function f(T){return unescape(encodeURIComponent(T)).length}function d(T,_,S){const A=[];let D;for(;(D=T.exec(S))!==null;)A.push({data:D[0],index:D.index,mode:_,length:D[0].length});return A}function h(T){const _=d(o.NUMERIC,r.NUMERIC,T),S=d(o.ALPHANUMERIC,r.ALPHANUMERIC,T);let A,D;return l.isKanjiModeEnabled()?(A=d(o.BYTE,r.BYTE,T),D=d(o.KANJI,r.KANJI,T)):(A=d(o.BYTE_KANJI,r.BYTE,T),D=[]),_.concat(S,A,D).sort(function(C,I){return C.index-I.index}).map(function(C){return{data:C.data,mode:C.mode,length:C.length}})}function u(T,_){switch(_){case r.NUMERIC:return e.getBitsLength(T);case r.ALPHANUMERIC:return s.getBitsLength(T);case r.KANJI:return i.getBitsLength(T);case r.BYTE:return n.getBitsLength(T)}}function m(T){return T.reduce(function(_,S){const A=_.length-1>=0?_[_.length-1]:null;return A&&A.mode===S.mode?(_[_.length-1].data+=S.data,_):(_.push(S),_)},[])}function p(T){const _=[];for(let S=0;S<T.length;S++){const A=T[S];switch(A.mode){case r.NUMERIC:_.push([A,{data:A.data,mode:r.ALPHANUMERIC,length:A.length},{data:A.data,mode:r.BYTE,length:A.length}]);break;case r.ALPHANUMERIC:_.push([A,{data:A.data,mode:r.BYTE,length:A.length}]);break;case r.KANJI:_.push([A,{data:A.data,mode:r.BYTE,length:f(A.data)}]);break;case r.BYTE:_.push([{data:A.data,mode:r.BYTE,length:f(A.data)}])}}return _}function x(T,_){const S={},A={start:{}};let D=["start"];for(let z=0;z<T.length;z++){const C=T[z],I=[];for(let O=0;O<C.length;O++){const P=C[O],H=""+z+O;I.push(H),S[H]={node:P,lastCount:0},A[H]={};for(let W=0;W<D.length;W++){const te=D[W];S[te]&&S[te].node.mode===P.mode?(A[te][H]=u(S[te].lastCount+P.length,P.mode)-u(S[te].lastCount,P.mode),S[te].lastCount+=P.length):(S[te]&&(S[te].lastCount=P.length),A[te][H]=u(P.length,P.mode)+4+r.getCharCountIndicator(P.mode,_))}}D=I}for(let z=0;z<D.length;z++)A[D[z]].end=0;return{map:A,table:S}}function g(T,_){let S;const A=r.getBestModeForData(T);if(S=r.from(_,A),S!==r.BYTE&&S.bit<A.bit)throw new Error('"'+T+'" cannot be encoded with mode '+r.toString(S)+`.
 Suggested mode is: `+r.toString(A));switch(S===r.KANJI&&!l.isKanjiModeEnabled()&&(S=r.BYTE),S){case r.NUMERIC:return new e(T);case r.ALPHANUMERIC:return new s(T);case r.KANJI:return new i(T);case r.BYTE:return new n(T)}}t.fromArray=function(_){return _.reduce(function(S,A){return typeof A=="string"?S.push(g(A,null)):A.data&&S.push(g(A.data,A.mode)),S},[])},t.fromString=function(_,S){const A=h(_,l.isKanjiModeEnabled()),D=p(A),z=x(D,S),C=c.find_path(z.map,"start","end"),I=[];for(let O=1;O<C.length-1;O++)I.push(z.table[C[O]].node);return t.fromArray(m(I))},t.rawSplit=function(_){return t.fromArray(h(_,l.isKanjiModeEnabled()))}})(fc);const Fn=Et,Kn=An,ov=Ug,lv=$g,cv=rc,dv=sc,da=nc,fa=kn,fv=Wg,xn=oc,hv=cc,uv=fr,qn=fc;function xv(t,r){const e=t.size,s=dv.getPositions(r);for(let n=0;n<s.length;n++){const i=s[n][0],o=s[n][1];for(let l=-1;l<=7;l++)if(!(i+l<=-1||e<=i+l))for(let c=-1;c<=7;c++)o+c<=-1||e<=o+c||(l>=0&&l<=6&&(c===0||c===6)||c>=0&&c<=6&&(l===0||l===6)||l>=2&&l<=4&&c>=2&&c<=4?t.set(i+l,o+c,!0,!0):t.set(i+l,o+c,!1,!0))}}function mv(t){const r=t.size;for(let e=8;e<r-8;e++){const s=e%2===0;t.set(e,6,s,!0),t.set(6,e,s,!0)}}function pv(t,r){const e=cv.getPositions(r);for(let s=0;s<e.length;s++){const n=e[s][0],i=e[s][1];for(let o=-2;o<=2;o++)for(let l=-2;l<=2;l++)o===-2||o===2||l===-2||l===2||o===0&&l===0?t.set(n+o,i+l,!0,!0):t.set(n+o,i+l,!1,!0)}}function gv(t,r){const e=t.size,s=xn.getEncodedBits(r);let n,i,o;for(let l=0;l<18;l++)n=Math.floor(l/3),i=l%3+e-8-3,o=(s>>l&1)===1,t.set(n,i,o,!0),t.set(i,n,o,!0)}function Yn(t,r,e){const s=t.size,n=hv.getEncodedBits(r,e);let i,o;for(i=0;i<15;i++)o=(n>>i&1)===1,i<6?t.set(i,8,o,!0):i<8?t.set(i+1,8,o,!0):t.set(s-15+i,8,o,!0),i<8?t.set(8,s-i-1,o,!0):i<9?t.set(8,15-i-1+1,o,!0):t.set(8,15-i-1,o,!0);t.set(s-8,8,1,!0)}function vv(t,r){const e=t.size;let s=-1,n=e-1,i=7,o=0;for(let l=e-1;l>0;l-=2)for(l===6&&l--;;){for(let c=0;c<2;c++)if(!t.isReserved(n,l-c)){let f=!1;o<r.length&&(f=(r[o]>>>i&1)===1),t.set(n,l-c,f),i--,i===-1&&(o++,i=7)}if(n+=s,n<0||e<=n){n-=s,s=-s;break}}}function yv(t,r,e){const s=new ov;e.forEach(function(c){s.put(c.mode.bit,4),s.put(c.getLength(),uv.getCharCountIndicator(c.mode,t)),c.write(s)});const n=Fn.getSymbolTotalCodewords(t),i=fa.getTotalCodewordsCount(t,r),o=(n-i)*8;for(s.getLengthInBits()+4<=o&&s.put(0,4);s.getLengthInBits()%8!==0;)s.putBit(0);const l=(o-s.getLengthInBits())/8;for(let c=0;c<l;c++)s.put(c%2?17:236,8);return bv(s,t,r)}function bv(t,r,e){const s=Fn.getSymbolTotalCodewords(r),n=fa.getTotalCodewordsCount(r,e),i=s-n,o=fa.getBlocksCount(r,e),l=s%o,c=o-l,f=Math.floor(s/o),d=Math.floor(i/o),h=d+1,u=f-d,m=new fv(u);let p=0;const x=new Array(o),g=new Array(o);let T=0;const _=new Uint8Array(t.buffer);for(let C=0;C<o;C++){const I=C<c?d:h;x[C]=_.slice(p,p+I),g[C]=m.encode(x[C]),p+=I,T=Math.max(T,I)}const S=new Uint8Array(s);let A=0,D,z;for(D=0;D<T;D++)for(z=0;z<o;z++)D<x[z].length&&(S[A++]=x[z][D]);for(D=0;D<u;D++)for(z=0;z<o;z++)S[A++]=g[z][D];return S}function wv(t,r,e,s){let n;if(Array.isArray(t))n=qn.fromArray(t);else if(typeof t=="string"){let f=r;if(!f){const d=qn.rawSplit(t);f=xn.getBestVersionForData(d,e)}n=qn.fromString(t,f||40)}else throw new Error("Invalid data");const i=xn.getBestVersionForData(n,e);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!r)r=i;else if(r<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=yv(r,e,n),l=Fn.getSymbolSize(r),c=new lv(l);return xv(c,r),mv(c),pv(c,r),Yn(c,e,0),r>=7&&gv(c,r),vv(c,o),isNaN(s)&&(s=da.getBestMask(c,Yn.bind(null,c,e))),da.applyMask(s,c),Yn(c,e,s),{modules:c,version:r,errorCorrectionLevel:e,maskPattern:s,segments:n}}ec.create=function(r,e){if(typeof r>"u"||r==="")throw new Error("No input text");let s=Kn.M,n,i;return typeof e<"u"&&(s=Kn.from(e.errorCorrectionLevel,Kn.M),n=xn.from(e.version),i=da.from(e.maskPattern),e.toSJISFunc&&Fn.setToSJISFunction(e.toSJISFunc)),wv(r,n,s,i)};var uc={},Wa={};(function(t){function r(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let s=e.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+e);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(i){return[i,i]}))),s.length===6&&s.push("F","F");const n=parseInt(s.join(""),16);return{r:n>>24&255,g:n>>16&255,b:n>>8&255,a:n&255,hex:"#"+s.slice(0,6).join("")}}t.getOptions=function(s){s||(s={}),s.color||(s.color={});const n=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,i=s.width&&s.width>=21?s.width:void 0,o=s.scale||4;return{width:i,scale:i?4:o,margin:n,color:{dark:r(s.color.dark||"#000000ff"),light:r(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},t.getScale=function(s,n){return n.width&&n.width>=s+n.margin*2?n.width/(s+n.margin*2):n.scale},t.getImageWidth=function(s,n){const i=t.getScale(s,n);return Math.floor((s+n.margin*2)*i)},t.qrToImageData=function(s,n,i){const o=n.modules.size,l=n.modules.data,c=t.getScale(o,i),f=Math.floor((o+i.margin*2)*c),d=i.margin*c,h=[i.color.light,i.color.dark];for(let u=0;u<f;u++)for(let m=0;m<f;m++){let p=(u*f+m)*4,x=i.color.light;if(u>=d&&m>=d&&u<f-d&&m<f-d){const g=Math.floor((u-d)/c),T=Math.floor((m-d)/c);x=h[l[g*o+T]?1:0]}s[p++]=x.r,s[p++]=x.g,s[p++]=x.b,s[p]=x.a}}})(Wa);(function(t){const r=Wa;function e(n,i,o){n.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,o,l){let c=l,f=o;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),o||(f=s()),c=r.getOptions(c);const d=r.getImageWidth(i.modules.size,c),h=f.getContext("2d"),u=h.createImageData(d,d);return r.qrToImageData(u.data,i,c),e(h,f,d),h.putImageData(u,0,0),f},t.renderToDataURL=function(i,o,l){let c=l;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),c||(c={});const f=t.render(i,o,c),d=c.type||"image/png",h=c.rendererOpts||{};return f.toDataURL(d,h.quality)}})(uc);var xc={};const _v=Wa;function Zi(t,r){const e=t.a/255,s=r+'="'+t.hex+'"';return e<1?s+" "+r+'-opacity="'+e.toFixed(2).slice(1)+'"':s}function Jn(t,r,e){let s=t+r;return typeof e<"u"&&(s+=" "+e),s}function Sv(t,r,e){let s="",n=0,i=!1,o=0;for(let l=0;l<t.length;l++){const c=Math.floor(l%r),f=Math.floor(l/r);!c&&!i&&(i=!0),t[l]?(o++,l>0&&c>0&&t[l-1]||(s+=i?Jn("M",c+e,.5+f+e):Jn("m",n,0),n=0,i=!1),c+1<r&&t[l+1]||(s+=Jn("h",o),o=0)):n++}return s}xc.render=function(r,e,s){const n=_v.getOptions(e),i=r.modules.size,o=r.modules.data,l=i+n.margin*2,c=n.color.light.a?"<path "+Zi(n.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",f="<path "+Zi(n.color.dark,"stroke")+' d="'+Sv(o,i,n.margin)+'"/>',d='viewBox="0 0 '+l+" "+l+'"',u='<svg xmlns="http://www.w3.org/2000/svg" '+(n.width?'width="'+n.width+'" height="'+n.width+'" ':"")+d+' shape-rendering="crispEdges">'+c+f+`</svg>
`;return typeof s=="function"&&s(null,u),u};const Nv=Mg,ha=ec,mc=uc,jv=xc;function Ga(t,r,e,s,n){const i=[].slice.call(arguments,1),o=i.length,l=typeof i[o-1]=="function";if(!l&&!Nv())throw new Error("Callback required as last argument");if(l){if(o<2)throw new Error("Too few arguments provided");o===2?(n=e,e=r,r=s=void 0):o===3&&(r.getContext&&typeof n>"u"?(n=s,s=void 0):(n=s,s=e,e=r,r=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(e=r,r=s=void 0):o===2&&!r.getContext&&(s=e,e=r,r=void 0),new Promise(function(c,f){try{const d=ha.create(e,s);c(t(d,r,s))}catch(d){f(d)}})}try{const c=ha.create(e,s);n(null,t(c,r,s))}catch(c){n(c)}}ks.create=ha.create;ks.toCanvas=Ga.bind(null,mc.render);ks.toDataURL=Ga.bind(null,mc.renderToDataURL);ks.toString=Ga.bind(null,function(t,r,e){return jv.render(t,e)});function Ev({user:t,onBack:r}){const[e,s]=B.useState([]),[n,i]=B.useState(null),[o,l]=B.useState(!0),[c,f]=B.useState(!1),[d,h]=B.useState(null),[u,m]=B.useState(!1),[p,x]=B.useState(""),g=B.useRef(null),T=t?.name||"사용자",_=t?.branch||"지점",S=t?.referral_code||"LAS0000",A=n?`${n.landing_url}?ref=${S}`:p||`https://lasmanager.vercel.app/event?ref=${S}`;B.useEffect(()=>{D();try{const O=localStorage.getItem(`lastQRLink_${t?.id}`);if(O){const P=JSON.parse(O);x(P.url||"")}}catch(O){console.log("링크 불러오기 실패:",O)}},[]);const D=async()=>{try{l(!0);const{data:O,error:P}=await he.from("events").select("*").eq("status","active").order("created_at",{ascending:!1});if(P)throw P;s(O||[])}catch(O){console.error("이벤트 조회 실패:",O)}finally{l(!1)}},z=async O=>{try{f(!0),console.log("🎨 QR 코드 생성 시작");const P=g.current;if(!P)throw new Error("Canvas not found");const H=P.getContext("2d"),W=new Image;W.crossOrigin="anonymous",await new Promise((b,w)=>{W.onload=b,W.onerror=w,W.src=O.template_image_url}),console.log("✅ 템플릿 이미지 로드:",W.width,"x",W.height),P.width=W.width,P.height=W.height,H.drawImage(W,0,0);const te=await ks.toDataURL(A,{width:1e3,margin:1,color:{dark:"#000000",light:"#FFFFFF"}}),pe=new Image;await new Promise((b,w)=>{pe.onload=b,pe.onerror=w,pe.src=te});const me=O.qr_position,Ne=me.x/100*P.width,ve=me.y/100*P.height,je=me.width/100*P.width,ce=me.height/100*P.height;console.log("📍 QR 그리기:",{qrX:Ne,qrY:ve,qrWidth:je,qrHeight:ce}),H.drawImage(pe,Ne,ve,je,ce);const xe=P.toDataURL("image/png");h(xe),i(O);const _e=`${O.landing_url}?ref=${S}`;try{const b={url:_e,eventId:O.id,eventName:O.name,timestamp:new Date().toISOString()};localStorage.setItem(`lastQRLink_${t?.id}`,JSON.stringify(b)),x(_e)}catch(b){console.log("링크 저장 실패:",b)}console.log("✅ QR 이미지 생성 완료")}catch(P){console.error("QR 생성 실패:",P),alert("QR 코드 생성에 실패했습니다.")}finally{f(!1)}},C=()=>{if(!d)return;const O=document.createElement("a");O.href=d,O.download=`내QR페이지_${S}.png`,document.body.appendChild(O),O.click(),document.body.removeChild(O)},I=()=>{navigator.clipboard.writeText(A),m(!0),setTimeout(()=>m(!1),2e3)};return a.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-cyan-50 p-2 sm:p-2",children:[a.jsxs("div",{className:"max-w-md mx-auto",children:[a.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-2 sm:p-2 mb-2 sm:mb-3",style:{borderRadius:"15px"},children:[a.jsxs("div",{className:"grid grid-cols-3 items-center mb-2",children:[a.jsx("div",{className:"flex justify-start",children:a.jsxs("button",{onClick:()=>{n?(i(null),h(null)):r()},className:"flex items-center gap-1.5 font-bold hover:opacity-70 transition-opacity text-sm sm:text-base",style:{color:"#4A9B8E"},children:[a.jsx(At,{size:18,className:"sm:w-5 sm:h-5"}),"나가기"]})}),a.jsxs("div",{className:"flex items-center justify-center gap-1.5 sm:gap-2",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-8 h-8 sm:w-10 sm:h-10 object-contain",onError:O=>O.target.style.display="none"}),a.jsx("h1",{className:"text-base sm:text-lg font-bold",style:{color:"#249689",whiteSpace:"nowrap"},children:"내 QR페이지 만들기"})]}),a.jsx("div",{})]}),a.jsx("div",{className:"p-2 rounded-lg text-center",style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:"10px"},children:a.jsx("p",{className:"text-xs font-medium",style:{color:"#1e40af"},children:n?"🎉 주천 링크가 생성되었습니다!":"🎨 템플릿을 선택하고 나만의 QR 페이지를 만드세요"})}),!n&&a.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg space-y-3",style:{borderRadius:"10px"},children:[a.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-x-6 gap-y-2 text-sm font-medium text-gray-700 px-2",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-gray-600",children:"👤 이름:"}),a.jsx("span",{className:"font-bold text-gray-900",children:T})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-gray-600",children:"🏢 지점:"}),a.jsx("span",{className:"font-bold text-gray-900",children:_})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-gray-600",children:"🔖 고유번호:"}),a.jsx("span",{className:"font-mono font-bold text-gray-900",children:S})]})]}),a.jsxs("div",{className:"flex gap-2",style:{width:"100%"},children:[a.jsx("input",{type:"text",value:A,readOnly:!0,className:"flex-1 px-3 py-2 text-xs bg-white border border-gray-300 rounded-lg",style:{borderRadius:"8px",minWidth:0},placeholder:"내 주천 링크"}),a.jsx("button",{onClick:I,className:"flex items-center gap-1 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-all text-xs font-medium whitespace-nowrap",style:{backgroundColor:u?"#10B981":"#4A9B8E",borderRadius:"8px"},children:u?a.jsxs(a.Fragment,{children:[a.jsx(Qn,{size:14}),a.jsx("span",{children:"복사됨"})]}):a.jsxs(a.Fragment,{children:[a.jsx(si,{size:14}),a.jsx("span",{children:"복사"})]})})]})]})]}),a.jsx("div",{className:"bg-white rounded-xl shadow-lg p-2 sm:p-2",style:{borderRadius:"15px"},children:o?a.jsx("div",{className:"flex justify-center items-center py-8",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2",style:{borderColor:"#4A9B8E"}})}):n?a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[a.jsx("h2",{className:"text-base sm:text-lg font-bold",style:{color:"#4A9B8E"},children:"🎉 내 QR 페이지"}),a.jsx("button",{onClick:()=>{i(null),h(null)},className:"text-xs text-gray-600 hover:text-gray-900 font-medium",children:"← 다른 템플릿 선택"})]}),c?a.jsxs("div",{className:"text-center py-2 sm:py-6",children:[a.jsx("div",{className:"animate-spin rounded-full h-8 w-8 sm:h-10 sm:w-10 border-b-2 mx-auto mb-2",style:{borderColor:"#4A9B8E"}}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600 font-medium",children:"QR 이미지 생성 중..."}),a.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"잠시만 기다려주세요"})]}):d?a.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[a.jsx("div",{className:"border-4 rounded-xl overflow-hidden shadow-lg",style:{borderColor:"#4A9B8E",borderRadius:"12px"},children:a.jsx("img",{src:d,alt:"내 QR 페이지",className:"w-full h-auto",style:{maxWidth:"300px",margin:"0 auto"}})}),a.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg",style:{borderRadius:"10px"},children:a.jsxs("div",{className:"text-sm space-y-2",children:[a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"👤 이름"}),a.jsx("span",{className:"font-medium",children:T})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"🏢 지점"}),a.jsx("span",{className:"font-medium",children:_})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-gray-600",children:"🔖 고유번호"}),a.jsx("span",{className:"font-mono font-medium",children:S})]})]})}),a.jsxs("button",{onClick:C,className:"w-full py-2 flex items-center justify-center gap-2 text-white rounded-xl hover:opacity-90 font-bold text-base sm:text-lg shadow-lg hover:shadow-xl transition-all",style:{backgroundColor:"#5B9BD5",borderRadius:"12px"},children:[a.jsx(yr,{size:22}),"내 QR페이지 저장"]}),a.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-200",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"🔗 내 주천 링크"}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("input",{type:"text",value:A,readOnly:!0,className:"flex-1 px-3 py-2 text-xs bg-gray-50 border border-gray-300 rounded-lg",style:{borderRadius:"8px"}}),a.jsxs("button",{onClick:I,className:"flex items-center gap-1.5 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-all text-sm font-medium",style:{backgroundColor:u?"#10B981":"#4A9B8E",borderRadius:"8px"},children:[u?a.jsx(Qn,{size:16}):a.jsx(si,{size:16}),u?"복사됨":"복사"]})]})]}),a.jsxs("div",{className:"p-2 bg-yellow-50 rounded-lg border border-yellow-200",style:{borderRadius:"8px"},children:[a.jsx("p",{className:"text-xs text-yellow-800 font-medium mb-1",children:"💡 사용 방법:"}),a.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1 ml-4",children:[a.jsx("li",{children:"• QR 페이지를 생성하여 이미지로 전달하거나"}),a.jsx("li",{children:"• 참가자가 QR 코드를 스캔하면 자동으로 내 고유코드로 연결됩니다"}),a.jsx("li",{children:"• 링크를 복사해 카톡/문자로 전달할 수도 있습니다"})]})]})]})]}):null]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[a.jsx("h2",{className:"text-base sm:text-lg font-bold",style:{color:"#4A9B8E"},children:"📋 템플릿 선택하기"}),e.length>0&&a.jsxs("span",{className:"text-xs text-gray-500",children:["총 ",e.length,"개"]})]}),e.length===0?a.jsxs("div",{className:"text-center py-16 sm:py-8",children:[a.jsx("div",{className:"text-5xl sm:text-6xl mb-2",children:"📅"}),a.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-2",children:"활성화된 템플릿이 없습니다"}),a.jsx("p",{className:"text-xs text-gray-400",children:"관리자에게 문의해주세요"})]}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 sm:gap-2",children:e.map(O=>a.jsxs("div",{onClick:()=>z(O),className:"group cursor-pointer border-2 rounded-xl overflow-hidden hover:shadow-xl hover:scale-105 transition-all duration-300",style:{borderColor:"#E0E0E0",borderRadius:"12px"},children:[O.template_image_url&&a.jsxs("div",{className:"relative overflow-hidden",style:{backgroundColor:"#f5f5f5"},children:[a.jsx("img",{src:O.template_image_url,alt:O.name,className:"w-full h-auto object-cover group-hover:opacity-90 transition-opacity",style:{maxHeight:"100px"}}),a.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center",children:a.jsx("span",{className:"text-white font-bold text-sm sm:text-base opacity-0 group-hover:opacity-100 transition-opacity bg-black bg-opacity-50 px-4 py-2 rounded-lg",children:"선택하기"})})]}),a.jsxs("div",{className:"p-2 sm:p-2",children:[a.jsx("h3",{className:"font-bold mb-1 text-sm sm:text-base",style:{color:"#249689"},children:O.name}),O.description&&a.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:O.description})]})]},O.id))})]})})]}),a.jsx("canvas",{ref:g,style:{display:"none"}})]})}function Tv(){const[t,r]=B.useState({parentName:"",phone:"",childGender:"",childAge:"",inquiry:"",referrerCode:"",privacyAgreed:!1,marketingAgreed:!1}),[e,s]=B.useState(!1),[n,i]=B.useState(!1),[o,l]=B.useState(!1),[c,f]=B.useState(!1),[d,h]=B.useState(""),[u,m]=B.useState(""),[p,x]=B.useState(!1),[g,T]=B.useState(""),[_,S]=B.useState(""),[A,D]=B.useState(!1),[z,C]=B.useState(!1),[I,O]=B.useState(!0),P="/videos/mathletter.mp4";B.useEffect(()=>{(async()=>{try{const j=new URLSearchParams(window.location.search).get("ref");if(!j){console.log("❌ 접근 차단: ref 파라미터 없음"),C(!0),O(!1);return}console.log("🔍 추천인 코드 검증 중:",j);const y=await je(j);y.exists&&y.referrerName?(console.log("✅ 유효한 추천인:",y.referrerName),r(U=>({...U,referrerCode:j})),S(y.referrerName),x(!0),C(!1)):(console.log("❌ 접근 차단: 유효하지 않은 추천인 코드"),C(!0)),O(!1)}catch(w){console.error("❌ 접근 검증 오류:",w),C(!0),O(!1)}})()},[]),B.useEffect(()=>{if(z)return;const b=document.createElement("link");b.rel="preload",b.as="video",b.href=P,document.head.appendChild(b);const w=document.createElement("video");return w.src=P,w.preload="auto",w.muted=!0,w.style.display="none",w.style.position="absolute",w.style.pointerEvents="none",document.body.appendChild(w),w.load(),w.addEventListener("loadeddata",()=>{console.log("✅ 영상 프리로드 완료")}),w.addEventListener("error",j=>{console.error("❌ 영상 로드 실패:",j),console.error("파일 경로:",P)}),()=>{document.head.removeChild(b),document.body.removeChild(w)}},[]);const H=b=>{const{name:w,value:j,type:y,checked:U}=b.target;r({...t,[w]:y==="checkbox"?U:j})},W=b=>{const w=b.replace(/[^\d]/g,"");return w.length<=3?w:w.length<=7?`${w.slice(0,3)}-${w.slice(3)}`:`${w.slice(0,3)}-${w.slice(3,7)}-${w.slice(7,11)}`},te=b=>{const w=W(b.target.value);r({...t,phone:w})},pe=()=>{navigator.clipboard.writeText(u).then(()=>{alert("링크가 복사되었습니다!")}).catch(()=>{prompt("링크를 복사하세요:",u)})},me=()=>{navigator.share?navigator.share({title:"수학편지 신청",text:"아이들의 인생을 수학으로 디자인하자!",url:u}).catch(b=>console.log("공유 취소:",b)):pe()},Ne=async()=>{try{const w=await(await fetch(d)).blob(),j=window.URL.createObjectURL(w),y=document.createElement("a");y.href=j,y.download=`QR_${t.referrerCode}.png`,document.body.appendChild(y),y.click(),document.body.removeChild(y),window.URL.revokeObjectURL(j)}catch(b){console.error("QR 다운로드 오류:",b),alert("QR 코드 다운로드에 실패했습니다.")}},ve=()=>{if(!t.parentName.trim())return alert("학부모 이름을 입력해주세요"),!1;if(!t.phone||t.phone.replace(/[^\d]/g,"").length!==11)return alert("휴대전화 번호를 정확히 입력해주세요"),!1;if(!t.childGender)return alert("자녀 성별을 선택해주세요"),!1;if(!t.childAge||t.childAge<1||t.childAge>20)return alert("자녀 연령을 정확히 입력해주세요 (1-20세)"),!1;if(!t.privacyAgreed)return alert("개인정보 수집 및 이용에 동의해주세요"),!1;if(t.referrerCode.trim()){const b=Cd(t.referrerCode);if(!b.isValid)return alert(b.error),!1}return!0},je=async b=>{if(!b||b.trim()==="")return{exists:!0,referrerId:null};try{const{data:w,error:j}=await he.from("users").select("id, name, branch, referral_code").eq("referral_code",b.trim().toUpperCase()).maybeSingle();return j?(console.error("추천인 코드 확인 오류:",j),{exists:!1,referrerId:null,error:"추천인 코드 확인 중 오류가 발생했습니다"}):w?(console.log("✅ 고유번호 확인:",w.referral_code,"-",w.name,"(",w.branch,")"),{exists:!0,referrerId:w.id,referrerName:w.name,referrerBranch:w.branch}):{exists:!1,referrerId:null,error:"존재하지 않는 고유번호입니다"}}catch(w){return console.error("추천인 코드 확인 예외:",w),{exists:!1,referrerId:null,error:"추천인 코드 확인 중 오류가 발생했습니다"}}},ce=async b=>{if(b.preventDefault(),!!ve()){s(!0);try{const w=t.phone.replace(/[^\d]/g,""),{data:j}=await he.from("event_participants").select("id").eq("phone",w).maybeSingle();let y=null;if(t.referrerCode.trim()){const L=await je(t.referrerCode);if(!L.exists){alert(L.error||"존재하지 않는 고유번호입니다"),s(!1);return}y=t.referrerCode.trim().toUpperCase()}const U={parent_name:t.parentName.trim(),phone:w,child_gender:t.childGender,child_age:parseInt(t.childAge),inquiry:t.inquiry.trim()||null,referrer_code:y,privacy_agreed:t.privacyAgreed,marketing_agreed:t.marketingAgreed,created_at:new Date().toISOString()};if(j){const{error:L}=await he.from("event_participants").update(U).eq("id",j.id);if(L)throw L}else{const{error:L}=await he.from("event_participants").insert([U]);if(L)throw L}l(!0)}catch(w){console.error("신청 오류:",w),alert("신청 중 오류가 발생했습니다. 다시 시도해주세요.")}finally{s(!1)}}},xe=()=>{window.location.href="/"},_e=()=>{const b=`${window.location.origin}${window.location.pathname}?ref=${t.referrerCode||"SHARE"}`;navigator.share?navigator.share({title:"수학편지 신청",text:"아이들의 인생을 수학으로 디자인하자!",url:b}).catch(w=>console.log("공유 취소:",w)):navigator.clipboard.writeText(b).then(()=>{alert("링크가 복사되었습니다!")}).catch(()=>{prompt("링크를 복사하세요:",b)})};return I?a.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#f0fffe"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:"#249689"}}),a.jsx("p",{style:{color:"#249689",fontSize:"16px"},children:"링크 검증 중..."})]})}):z?a.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{backgroundColor:"#f0fffe"},children:a.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-md w-full text-center",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{className:"w-20 h-20 mx-auto mb-4 flex items-center justify-center rounded-full",style:{backgroundColor:"#fee"},children:a.jsx("svg",{className:"w-12 h-12",style:{color:"#dc2626"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),a.jsx("h2",{className:"font-bold mb-3",style:{color:"#249689",fontSize:"24px"},children:"접근이 제한되었습니다"}),a.jsx("p",{className:"text-gray-600 mb-2",style:{fontSize:"15px"},children:"이 페이지는 초대 링크를 통해서만 접근할 수 있습니다."}),a.jsx("p",{className:"text-gray-500 text-sm",children:"추천인으로부터 받은 링크나 QR코드를 통해 다시 접속해주세요."})]}),a.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[a.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"💡 올바른 접근 방법"}),a.jsxs("ul",{className:"text-xs text-left space-y-1",style:{color:"#666"},children:[a.jsx("li",{children:"✓ 추천인에게 받은 QR코드 스캔"}),a.jsx("li",{children:"✓ 추천인에게 받은 링크 클릭"}),a.jsx("li",{children:"✓ 카카오톡 등으로 공유받은 링크 사용"})]})]}),a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:a.jsxs("p",{className:"text-xs text-yellow-800",children:[a.jsx("strong",{children:"⚠️ 주의:"})," 직접 URL 입력이나 북마크로는 접근할 수 없습니다."]})}),a.jsx("button",{onClick:()=>window.history.back(),className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689"},children:"이전 페이지로 돌아가기"})]})}):o?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:a.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[a.jsxs("div",{className:"mb-6",children:[a.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx("svg",{className:"w-10 h-10 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),a.jsx("h2",{className:"font-bold mb-2",style:{color:"#249689",fontSize:"24px"},children:"신청이 완료되었습니다!"}),a.jsxs("p",{style:{color:"#666",fontSize:"15px"},children:["소중한 참여 감사드립니다.",a.jsx("br",{}),"아이들의 인생을 수학으로 '디자인'하겠습니다!"]})]}),a.jsxs("div",{className:"space-y-3",children:[a.jsx("button",{onClick:_e,className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689",fontSize:"16px"},children:"친구에게 공유하기"}),a.jsx("button",{onClick:xe,className:"w-full py-3 font-bold rounded-lg hover:bg-gray-50 transition-colors",style:{color:"#000000",border:"2px solid #d1d5db",backgroundColor:"white",fontSize:"16px"},children:"닫기"})]})]})}):a.jsxs("div",{className:"min-h-screen bg-gray-50 p-2",children:[a.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg p-3",children:[a.jsxs("div",{className:"mb-3",children:[a.jsxs("div",{className:"bg-red-700 text-white text-center py-6 rounded-lg mb-1.5",children:[a.jsx("h1",{className:"font-bold mb-1.5",style:{fontSize:"20px"},children:"우리나라를 살리는"}),a.jsx("h2",{className:"font-bold",style:{fontSize:"24px"},children:"수학 대중화 운동"})]}),a.jsx("div",{className:"text-center py-1",children:a.jsx("p",{className:"font-bold !mt-0",style:{color:"#249689",fontSize:"18px"},children:"아이들의 인생을 수학으로 '디자인'하자!"})})]}),a.jsxs("div",{className:"text-center mt-0 mb-2",style:{marginTop:"-4px"},children:[a.jsx("h2",{className:"font-bold",style:{color:"#dc2626",fontSize:"28px",fontFamily:"'Noto Sans KR', sans-serif",fontWeight:"900"},children:"수학편지 신청하기"}),a.jsx("h3",{className:"font-bold",style:{color:"#249689",fontSize:"20px",fontFamily:"'Noto Sans KR', sans-serif",fontWeight:"900"},children:"(수학편지는 매일 무료로 보내드려요!!)"})]}),a.jsx("div",{className:"text-center mb-4",children:a.jsxs("button",{onClick:()=>D(!0),className:"inline-flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-bold transition-all hover:opacity-90 hover:scale-105",style:{backgroundColor:"#3b82f6",color:"white",fontSize:"17px",boxShadow:"0 4px 6px rgba(59, 130, 246, 0.3)"},children:[a.jsxs("svg",{width:"26",height:"26",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{flexShrink:0},children:[a.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"white",fillOpacity:"0.2"}),a.jsx("path",{d:"M10 8L16 12L10 16V8Z",fill:"white"})]}),a.jsx("span",{style:{fontSize:"17px"},children:"수학편지 샘플영상"})]})}),a.jsxs("div",{className:"space-y-2",style:{marginTop:"16px"},children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"학부모이름 *"}),a.jsx("input",{type:"text",name:"parentName",value:t.parentName,onChange:H,placeholder:"학부모님 이름을 입력해주세요",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"휴대전화 *"}),a.jsx("input",{type:"tel",name:"phone",value:t.phone,onChange:te,placeholder:"010-0000-0000",maxLength:13,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"자녀성별 *"}),a.jsxs("div",{className:"flex gap-4",children:[a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer flex-1",children:[a.jsx("input",{type:"radio",name:"childGender",value:"남",checked:t.childGender==="남",onChange:H,className:"w-5 h-5"}),a.jsx("span",{style:{fontSize:"15px"},children:"남"})]}),a.jsxs("label",{className:"flex items-center gap-2 cursor-pointer flex-1",children:[a.jsx("input",{type:"radio",name:"childGender",value:"여",checked:t.childGender==="여",onChange:H,className:"w-5 h-5"}),a.jsx("span",{style:{fontSize:"15px"},children:"여"})]})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"자녀나이 *"}),a.jsx("input",{type:"number",name:"childAge",value:t.childAge,onChange:H,placeholder:"자녀나이를 입력해주세요",min:"1",max:"20",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"문의사항"}),a.jsx("textarea",{name:"inquiry",value:t.inquiry,onChange:H,placeholder:"궁금한 사항이 있으시면 입력해주세요",rows:4,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"추천인(자동입력)"}),p?a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"text",name:"referrerCode",value:_?`${_}(${t.referrerCode})`:t.referrerCode,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",fontSize:"15px"}}),a.jsx("p",{className:"mt-1 text-xs",style:{color:"#249689"},children:"✓ 추천인 코드가 자동으로 입력되었습니다"})]}):a.jsxs(a.Fragment,{children:[a.jsx("input",{type:"text",name:"referrerCode",value:t.referrerCode,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",fontSize:"15px"}}),g&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:g})]})]}),a.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-3 bg-gray-50",children:[a.jsx("h3",{className:"font-bold mb-2 text-lg",style:{color:"#249689",fontSize:"18px"},children:"개인정보 수집 및 이용 동의"}),a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"privacyAgreed",checked:t.privacyAgreed,onChange:H,className:"w-5 h-5 mt-0.5"}),a.jsxs("span",{style:{color:"#000000",fontSize:"14px"},children:["개인정보 수집 및 이용에 동의합니다 ",a.jsx("span",{style:{color:"#ef4444"},children:"*"})]})]}),a.jsx("button",{type:"button",onClick:()=>i(!0),className:"text-sm underline whitespace-nowrap",style:{color:"#249689"},children:"📄 내용보기"})]}),a.jsx("div",{className:"pt-2 border-t border-gray-300",children:a.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[a.jsx("input",{type:"checkbox",name:"marketingAgreed",checked:t.marketingAgreed,onChange:H,className:"w-5 h-5 mt-0.5"}),a.jsxs("span",{style:{fontSize:"14px",flex:1},children:[a.jsx("span",{className:"font-bold",children:"(선택)"})," 이벤트 및 마케팅 정보 수신에 동의합니다"]})]})})]}),a.jsx("div",{className:"flex gap-2 pt-2",children:a.jsx("button",{type:"button",onClick:ce,disabled:e,className:"flex-1 py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#dc2626",fontSize:"16px"},children:e?"신청 중...":"신청하기"})})]}),a.jsx("div",{className:"mt-3 text-center",children:a.jsx("p",{style:{fontSize:"13px",color:"#666"},children:"오늘도 수고하셨습니다."})})]}),c&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[a.jsx("h2",{className:"font-bold mb-4 text-center",style:{color:"#249689",fontSize:"22px"},children:"추천 링크가 생성되었습니다!"}),a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx("img",{src:d,alt:"QR Code",className:"w-64 h-64 border-2 border-gray-300 rounded-lg"})}),a.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[a.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"생성된 링크:"}),a.jsx("div",{className:"bg-white p-3 rounded border border-gray-300 break-all text-sm",children:u})]}),a.jsxs("div",{className:"flex flex-col gap-2",children:[a.jsx("button",{onClick:Ne,className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689"},children:"💾 QR 다운로드"}),a.jsx("button",{onClick:pe,className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#2ca89f"},children:"📋 링크 복사하기"}),a.jsx("button",{onClick:me,className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#3bb5ab"},children:"📤 공유하기"}),a.jsx("button",{onClick:()=>f(!1),className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#6b7280"},children:"✕ 닫기"})]})]})}),n&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-auto",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6 my-8 max-h-[80vh] overflow-y-auto",children:[a.jsx("h2",{className:"font-bold mb-4 text-center",style:{color:"#249689",fontSize:"22px"},children:"개인정보 수집 및 이용 동의"}),a.jsxs("div",{className:"space-y-4 text-sm text-gray-700",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-2",children:"1. 수집하는 개인정보 항목"}),a.jsx("p",{children:"학부모 이름, 휴대전화 번호, 자녀 성별, 자녀 연령, 문의사항"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-2",children:"2. 개인정보의 수집 및 이용 목적"}),a.jsx("p",{children:"이벤트 참여 확인, 당첨자 연락, 상품 배송, 마케팅 및 프로모션 정보 제공"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-2",children:"3. 개인정보의 보유 및 이용 기간"}),a.jsx("p",{children:"이벤트 종료 후 3개월까지 보관 후 파기"})]}),a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold mb-2",children:"4. 동의 거부 권리 및 불이익"}),a.jsx("p",{children:"귀하는 개인정보 수집 및 이용을 거부할 권리가 있으나, 거부 시 이벤트 참여가 제한될 수 있습니다."})]})]}),a.jsx("button",{onClick:()=>i(!1),className:"w-full mt-6 py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689"},children:"확인"})]})}),A&&a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",onClick:()=>D(!1),children:a.jsxs("div",{className:"relative bg-black rounded-lg shadow-2xl max-w-4xl w-full",onClick:b=>b.stopPropagation(),style:{aspectRatio:"16/9"},children:[a.jsx("button",{onClick:()=>D(!1),className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors z-10",style:{fontSize:"32px",fontWeight:"bold"},children:"✕"}),a.jsxs("video",{className:"w-full h-full rounded-lg",controls:!0,autoPlay:!0,playsInline:!0,controlsList:"nodownload",onError:b=>{console.error("비디오 재생 오류:",b),alert(`영상을 불러올 수 없습니다. 파일 경로를 확인해주세요.
경로: `+P)},onLoadedData:()=>console.log("영상 로드 완료"),style:{border:"none",backgroundColor:"#000"},children:[a.jsx("source",{src:P,type:"video/mp4"}),"브라우저가 비디오 태그를 지원하지 않습니다."]})]})})]})}function Cv({user:t,onBack:r,viewMode:e,from:s}){let n=e;n||(s==="/system-admin"||s==="SystemAdminDashboard"?n="system":s==="/admin"||s==="AdminDashboard"?n="admin":s==="/dashboard"||s==="Dashboard"?n="user":t?.user_type==="시스템관리자"||t?.role==="system_admin"||t?.role==="SystemAdmin"?n="system":t?.role==="admin"||t?.role==="manager"||t?.role==="점장"||t?.role==="지점관리자"?n="admin":n="user"),console.log("🎯 ViewMode 결정:",n,"| User Role:",t?.role,"| User Type:",t?.user_type,"| From:",s);const i=n==="admin"||n==="system",[o,l]=B.useState({total:0,thisWeek:0,male:0,female:0}),[c,f]=B.useState([]),[d,h]=B.useState([]),[u,m]=B.useState([]),[p,x]=B.useState([]),[g,T]=B.useState(!0),[_,S]=B.useState([]),[A,D]=B.useState(""),[z,C]=B.useState({branch:"",referrer:"",startDate:"",endDate:""}),[I,O]=B.useState([]),[P,H]=B.useState([]);B.useEffect(()=>{pe()},[]),B.useEffect(()=>{Ne(),me()},[A]);const W=w=>w.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),te=w=>{if(!w)return"";const j=w.toString().replace(/\D/g,"");return j.length===11?j.replace(/(\d{3})(\d{4})(\d{4})/,"$1-$2-$3"):j.length===10?j.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"):w},pe=async()=>{try{const{data:w,error:j}=await he.from("events").select("name").eq("status","active").order("created_at",{ascending:!1});if(j)throw j;S(w||[])}catch(w){console.error("이벤트 목록 로드 실패:",w)}},me=async()=>{try{const{data:w}=await he.from("users").select("branch").not("branch","is",null).order("branch"),j=[...new Set(w?.map(Q=>Q.branch)||[])];O(j);const{data:y}=await he.from("users").select("name, referral_code").not("referral_code","is",null).order("name");let U=he.from("event_participants").select("referrer_code, event_name").not("referrer_code","is",null);A&&(U=U.eq("event_name",A));const{data:L}=await U,Y=new Set(L?.map(Q=>Q.referrer_code)||[]),Z=y?.filter(Q=>Y.has(Q.referral_code)).map(Q=>({referrer_name:Q.name,referrer_code:Q.referral_code}))||[];H(Z)}catch(w){console.error("필터 옵션 로드 실패:",w)}},Ne=async()=>{try{console.log("🚀 데이터 로드 시작..."),T(!0),console.log("📊 통계 데이터 로드 중...");let w=he.from("event_participants").select("child_gender, child_age, event_name, created_at");if(n==="user"&&t?.referral_code)console.log("✅ [일반 유저] 필터 적용 - 추천코드:",t.referral_code),w=w.eq("referrer_code",t.referral_code);else if(n==="admin"&&t?.branch){console.log("✅ [점장/지점관리자] 필터 적용 - 지점:",t.branch);const{data:Se}=await he.from("users").select("referral_code").eq("branch",t.branch).not("referral_code","is",null),Ce=Se?.map(Me=>Me.referral_code)||[];console.log("✅ 지점 직원 수:",Ce.length,"명"),Ce.length>0?w=w.in("referrer_code",Ce):w=w.eq("referrer_code","NONE")}else n==="system"&&console.log("✅ [시스템관리자] 필터 없음 - 전체 데이터");A&&(console.log("✅ 이벤트 필터 적용:",A),w=w.eq("event_name",A));const{data:j,error:y}=await w;if(y)throw y;console.log("📊 통계용 데이터 로드:",j?.length,"명"),j&&j.length>0?console.log("🔍 샘플 데이터 3개:",j.slice(0,3)):console.warn("⚠️ 통계 데이터가 비어있습니다!");const U=j?.length||0,L=j?.filter(Se=>Se.child_gender==="남").length||0,Y=j?.filter(Se=>Se.child_gender==="여").length||0,Z=new Date,Q=Z.getDay(),ge=Q===0?6:Q-1,M=new Date(Z);M.setDate(Z.getDate()-ge),M.setHours(0,0,0,0);const oe=j?.filter(Se=>new Date(Se.created_at)>=M).length||0;console.log("✅ 통계:",{total:U,thisWeek:oe,male:L,female:Y}),l({total:U,thisWeek:oe,male:L,female:Y});const ie={};j?.forEach(Se=>{if(Se.child_age){const Ce=parseInt(Se.child_age);if(Ce>=3&&Ce<=7){const Me=`${Ce}세`;ie[Me]||(ie[Me]={age:Ce,male:0,female:0,total:0}),ie[Me].total++,Se.child_gender==="남"?ie[Me].male++:Se.child_gender==="여"&&ie[Me].female++}}});const Be=Object.keys(ie).map(Se=>({name:Se,...ie[Se]})).sort((Se,Ce)=>Se.age-Ce.age);console.log("✅ 연령 분포:",Be),f(Be),console.log("🏆 추천인 통계 로드 중...");let ye=he.from("event_participants").select("referrer_name, referrer_code").not("referrer_code","is",null);if(n==="user"&&t?.referral_code)ye=ye.eq("referrer_code",t.referral_code);else if(n==="admin"&&t?.branch){const{data:Se}=await he.from("users").select("referral_code").eq("branch",t.branch).not("referral_code","is",null),Ce=Se?.map(Me=>Me.referral_code)||[];Ce.length>0?ye=ye.in("referrer_code",Ce):ye=ye.eq("referrer_code","NONE")}A&&(ye=ye.eq("event_name",A));const{data:de,error:Ee}=await ye;if(Ee&&console.error("❌ 추천인 통계 에러:",Ee),i){const Se=[...new Set(de?.map(Ve=>Ve.referrer_code).filter(Boolean))];let Ce=[];if(Se.length>0){const{data:Ve}=await he.from("users").select("referral_code, name, branch").in("referral_code",Se);Ce=Ve||[]}const Me={};de?.forEach(Ve=>{const mt=Ve.referrer_code,pt=Ce.find(Rt=>Rt.referral_code===Ve.referrer_code);Me[mt]||(Me[mt]={name:Ve.referrer_name||pt?.name||"-",code:Ve.referrer_code,branch:pt?.branch||"-",count:0}),Me[mt].count++});const er=Object.values(Me).sort((Ve,mt)=>mt.count-Ve.count).slice(0,12);console.log("✅ Top 추천인:",er),h(er),console.log("🏢 추천지점 통계 계산 중...");const Bt={};de?.forEach(Ve=>{const pt=Ce.find(Rt=>Rt.referral_code===Ve.referrer_code)?.branch||"-";pt!=="-"&&(Bt[pt]||(Bt[pt]={branch:pt,count:0}),Bt[pt].count++)});const ct=Object.values(Bt).sort((Ve,mt)=>mt.count-Ve.count).slice(0,12);console.log("✅ Top 지점:",ct),m(ct)}else h([]),m([]);console.log("👥 참가자 목록 로드 시작..."),await ve(),console.log("✅ 모든 데이터 로드 완료!")}catch(w){console.error("❌ 데이터 로드 실패:",w),alert("데이터를 불러오는데 실패했습니다: "+w.message)}finally{T(!1)}},ve=async(w=null)=>{try{const j=w!==null?w:z;console.log("🔍 참가자 목록 로드 시작..."),console.log("📋 현재 필터:",j);let y=he.from("event_participants").select("*").order("created_at",{ascending:!1});if(A&&(console.log("✅ 이벤트 필터 적용:",A),y=y.eq("event_name",A)),n==="user"&&t?.referral_code)console.log("✅ [일반 유저] 필터 적용 - 추천코드:",t.referral_code),y=y.eq("referrer_code",t.referral_code);else if(n==="admin"&&t?.branch){console.log("✅ [점장/지점관리자] 필터 적용 - 지점:",t.branch);const{data:M}=await he.from("users").select("referral_code").eq("branch",t.branch).not("referral_code","is",null),oe=M?.map(ie=>ie.referral_code)||[];console.log("✅ 지점 직원 수:",oe.length,"명"),oe.length>0?y=y.in("referrer_code",oe):y=y.eq("referrer_code","NONE")}else n==="system"&&console.log("✅ [시스템관리자] 필터 없음 - 전체 데이터");j.referrer&&(console.log("✅ 추천인 필터 적용:",j.referrer),y=y.eq("referrer_code",j.referrer)),j.startDate&&(console.log("✅ 시작일 필터 적용:",j.startDate),y=y.gte("created_at",`${j.startDate}T00:00:00`)),j.endDate&&(console.log("✅ 종료일 필터 적용:",j.endDate),y=y.lte("created_at",`${j.endDate}T23:59:59`));const{data:U,error:L}=await y;if(L)throw console.error("❌ 쿼리 에러:",L),L;if(console.log("✅ 참가자 기본 데이터 로드:",U?.length,"명"),U&&U.length>0){const M=U.map(oe=>oe.referrer_code);console.log("🔍 DB에 있는 referrer_code 목록:",[...new Set(M)]),console.log("🔍 샘플 데이터 3개:",U.slice(0,3))}else console.warn("⚠️ 참가자 데이터가 비어있습니다!");const Y=[...new Set(U?.map(M=>M.referrer_code).filter(Boolean))];let Z=[];if(Y.length>0){const{data:M,error:oe}=await he.from("users").select("referral_code, name, branch").in("referral_code",Y);oe?console.error("❌ Users 조회 에러:",oe):(Z=M||[],console.log("✅ 추천인 정보 로드:",Z.length,"명"))}const Q=U?.map(M=>{const oe=Z.find(ie=>ie.referral_code===M.referrer_code);return{...M,users:oe?{name:oe.name,branch:oe.branch}:null}})||[];let ge=Q;j.branch&&(console.log("✅ 지점 필터 적용:",j.branch),ge=Q.filter(M=>M.users?.branch===j.branch)),console.log("✅ 최종 참가자 데이터:",ge.length,"명"),console.log("📦 데이터:",ge),x(ge)}catch(j){console.error("❌ 참가자 목록 로드 실패:",j),alert("참가자 목록을 불러오는데 실패했습니다: "+j.message)}},je=(w,j)=>{C(y=>({...y,[w]:j}))},ce=()=>{ve()},xe=()=>{const w={branch:"",referrer:"",startDate:"",endDate:""};C(w),ve(w)},_e=async w=>{if(confirm("정말 삭제하시겠습니까?"))try{const{error:j}=await he.from("event_participants").delete().eq("id",w);if(j)throw j;alert("삭제되었습니다."),Ne()}catch(j){console.error("삭제 실패:",j),alert("삭제에 실패했습니다.")}},b=()=>{if(p.length===0){alert("다운로드할 데이터가 없습니다.");return}const w=["신청일시","학부모명","연락처","자녀성별","자녀나이","추천인","추천인코드","지점","문의사항"],j=p.map(M=>[new Date(M.created_at).toLocaleString("ko-KR"),M.parent_name||"",M.phone||"",M.child_gender||"",M.child_age||"",M.users?.name||M.referrer_name||"",M.referrer_code||"",M.users?.branch||"",M.inquiry||""]),y=[w.join(","),...j.map(M=>M.map(oe=>`"${oe}"`).join(","))].join(`
`),U="\uFEFF",L=new Blob([U+y],{type:"text/csv;charset=utf-8;"}),Y=document.createElement("a"),Z=URL.createObjectURL(L),Q=new Date,ge=Q.getFullYear()+String(Q.getMonth()+1).padStart(2,"0")+String(Q.getDate()).padStart(2,"0");Y.setAttribute("href",Z),Y.setAttribute("download",`이벤트 참가자목록_${ge}.xls`),Y.style.visibility="hidden",document.body.appendChild(Y),Y.click(),document.body.removeChild(Y)};return g?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600 mx-auto mb-4"}),a.jsx("p",{className:"text-gray-600",children:"데이터를 불러오는 중..."})]})}):a.jsx("div",{className:"min-h-screen bg-white",children:a.jsx("div",{className:"max-w-7xl mx-auto p-6",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsxs("button",{onClick:r,className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[a.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[a.jsx("line",{x1:"19",y1:"12",x2:"5",y2:"12"}),a.jsx("polyline",{points:"12 19 5 12 12 5"})]}),"나가기"]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain"}),a.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"이벤트 대시보드"})]}),a.jsx("div",{children:a.jsxs("select",{value:A,onChange:w=>D(w.target.value),className:"px-4 py-2 border-2 rounded-lg font-medium",style:{borderColor:"#249689",color:"#249689",borderRadius:"10px",fontSize:"15px",minWidth:"200px"},children:[a.jsx("option",{value:"",children:"전체 이벤트"}),_.map(w=>a.jsx("option",{value:w.name,children:w.name},w.name))]})})]}),a.jsx("div",{className:"mb-6 p-3 rounded-lg",style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6"},children:a.jsx("p",{className:"text-sm",style:{color:"#1e40af"},children:"ℹ️ 이벤트 참가자 정보를 조회하고 관리합니다"})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[a.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow-lg p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-blue-100 text-sm mb-2",children:"전체 참가자"}),a.jsxs("p",{className:"text-4xl font-bold",children:[o.total,"명"]})]}),a.jsx("div",{className:"text-5xl",children:"👥"})]})}),a.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg shadow-lg p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-purple-100 text-sm mb-2",children:"이번주 참가자"}),a.jsxs("p",{className:"text-4xl font-bold",children:[o.thisWeek,"명"]})]}),a.jsx("div",{className:"text-5xl",children:"📅"})]})}),a.jsx("div",{className:"bg-gradient-to-br from-sky-500 to-sky-600 rounded-lg shadow-lg p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-sky-100 text-sm mb-2",children:"남학생"}),a.jsxs("p",{className:"text-4xl font-bold",children:[o.male,"명"]})]}),a.jsx("div",{className:"text-5xl",children:"👦"})]})}),a.jsx("div",{className:"bg-gradient-to-br from-pink-500 to-pink-600 rounded-lg shadow-lg p-6 text-white",children:a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-pink-100 text-sm mb-2",children:"여학생"}),a.jsxs("p",{className:"text-4xl font-bold",children:[o.female,"명"]})]}),a.jsx("div",{className:"text-5xl",children:"👧"})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#249689"},children:"📊 연령 분포"}),a.jsxs("div",{className:"space-y-4",children:[c.map((w,j)=>a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center justify-between mb-2",children:[a.jsx("span",{className:"font-semibold",children:w.name}),a.jsxs("span",{className:"text-sm text-gray-600",children:["남 ",w.male,"명 / 여 ",w.female,"명 (총 ",w.total,"명)"]})]}),a.jsxs("div",{className:"w-full bg-gray-200 rounded-full h-6 overflow-hidden flex",children:[a.jsx("div",{className:"bg-sky-500 flex items-center justify-center text-white text-xs font-bold",style:{width:`${w.male/w.total*100}%`},children:w.male>0&&`${w.male}`}),a.jsx("div",{className:"bg-pink-500 flex items-center justify-center text-white text-xs font-bold",style:{width:`${w.female/w.total*100}%`},children:w.female>0&&`${w.female}`})]})]},j)),c.length===0&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:a.jsx("p",{children:"연령 데이터가 없습니다"})})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#249689"},children:"🎯 성별 비율"}),a.jsx("div",{className:"flex items-center justify-center",children:a.jsxs("div",{className:"relative w-64 h-64",children:[a.jsx("svg",{viewBox:"0 0 100 100",className:"transform -rotate-90",children:o.total>0&&a.jsxs(a.Fragment,{children:[a.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"transparent",stroke:"#0ea5e9",strokeWidth:"20",strokeDasharray:`${o.male/o.total*251.2} 251.2`}),a.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"transparent",stroke:"#ec4899",strokeWidth:"20",strokeDasharray:`${o.female/o.total*251.2} 251.2`,strokeDashoffset:`-${o.male/o.total*251.2}`})]})}),a.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"text-3xl font-bold",style:{color:"#249689"},children:o.total}),a.jsx("p",{className:"text-sm text-gray-600",children:"총 참가자"})]})})]})}),a.jsxs("div",{className:"mt-6 space-y-3",children:[a.jsxs("div",{className:"flex items-center justify-between p-3 bg-sky-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 bg-sky-500 rounded"}),a.jsx("span",{className:"font-semibold",children:"남학생"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold text-sky-600",children:[o.male,"명"]}),a.jsxs("p",{className:"text-xs text-gray-600",children:[o.total>0?(o.male/o.total*100).toFixed(1):0,"%"]})]})]}),a.jsxs("div",{className:"flex items-center justify-between p-3 bg-pink-50 rounded-lg",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("div",{className:"w-4 h-4 bg-pink-500 rounded"}),a.jsx("span",{className:"font-semibold",children:"여학생"})]}),a.jsxs("div",{className:"text-right",children:[a.jsxs("p",{className:"font-bold text-pink-600",children:[o.female,"명"]}),a.jsxs("p",{className:"text-xs text-gray-600",children:[o.total>0?(o.female/o.total*100).toFixed(1):0,"%"]})]})]})]})]})]}),n==="system"&&a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[a.jsx("h3",{className:"text-xl font-bold mb-6",style:{color:"#249689"},children:"🏆 추천 매장 Top 12"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:u.map((w,j)=>a.jsxs("div",{className:"relative bg-gradient-to-br from-white to-gray-50 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 px-3 py-2 border-2 hover:scale-105",style:{borderColor:j===0?"#FFD700":j===1?"#C0C0C0":j===2?"#CD7F32":"#249689",backgroundColor:j<3?"#fffbf0":"white"},children:[a.jsx("div",{className:"absolute -top-1.5 -left-1.5 w-6 h-6 rounded-full flex items-center justify-center text-white font-bold shadow-lg text-xs",style:{backgroundColor:j===0?"#FFD700":j===1?"#C0C0C0":j===2?"#CD7F32":"#249689"},children:j+1}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[a.jsx("span",{style:{fontSize:"20px"},children:j===0?"🏅":j===1?"🥈":j===2?"🥉":"🏪"}),a.jsx("div",{className:"flex-1",children:a.jsx("p",{className:"font-bold text-sm",style:{color:"#1f2937"},children:w.branch})})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-lg font-bold",style:{color:"#249689"},children:w.count}),a.jsx("p",{className:"text-xs text-gray-500",children:"명"})]})]})]},j))}),u.length===0&&a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx("p",{className:"text-lg mb-2",children:"🏪"}),a.jsx("p",{children:"지점 데이터가 없습니다"})]})]}),i&&a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[a.jsx("h3",{className:"text-xl font-bold mb-6",style:{color:"#249689"},children:"🏆 추천인 Top 12"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:d.map((w,j)=>a.jsxs("div",{className:"relative bg-gradient-to-br from-white to-gray-50 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 px-3 py-2 border-2 hover:scale-105",style:{borderColor:j===0?"#FFD700":j===1?"#C0C0C0":j===2?"#CD7F32":"#249689",backgroundColor:j<3?"#fffbf0":"white"},children:[a.jsx("div",{className:"absolute -top-1.5 -left-1.5 w-6 h-6 rounded-full flex items-center justify-center text-white font-bold shadow-lg text-xs",style:{backgroundColor:j===0?"#FFD700":j===1?"#C0C0C0":j===2?"#CD7F32":"#249689"},children:j+1}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[a.jsx("span",{style:{fontSize:"20px"},children:j===0?"👑":j===1?"🥈":j===2?"🥉":"⭐"}),a.jsxs("div",{className:"flex-1",children:[a.jsxs("p",{className:"font-bold text-sm",style:{color:"#1f2937"},children:[w.name,"(",w.code,")"]}),a.jsxs("p",{className:"text-xs text-gray-500",children:["📍 ",w.branch]})]})]}),a.jsxs("div",{className:"text-right",children:[a.jsx("p",{className:"text-lg font-bold",style:{color:"#249689"},children:w.count}),a.jsx("p",{className:"text-xs text-gray-500",children:"명"})]})]})]},j))}),d.length===0&&a.jsxs("div",{className:"text-center py-12 text-gray-500",children:[a.jsx("p",{className:"text-lg mb-2",children:"🏆"}),a.jsx("p",{children:"추천인 데이터가 없습니다"})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[a.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#249689"},children:"🔍 검색 필터"}),i?a.jsxs("div",{className:"flex items-end gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"추천인"}),a.jsxs("select",{value:z.referrer,onChange:w=>je("referrer",w.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[a.jsx("option",{value:"",children:"전체"}),P.map(w=>a.jsxs("option",{value:w.referrer_code,children:[w.referrer_name,"(",w.referrer_code,")"]},w.referrer_code))]})]}),a.jsxs("div",{style:{width:"160px"},children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"시작일"}),a.jsx("input",{type:"date",value:z.startDate,onChange:w=>je("startDate",w.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{style:{width:"160px"},children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"종료일"}),a.jsx("input",{type:"date",value:z.endDate,onChange:w=>je("endDate",w.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsxs("button",{onClick:ce,className:"py-2 text-white rounded-lg hover:opacity-90 font-bold whitespace-nowrap flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px",width:"110px"},children:[a.jsx(ir,{size:18}),"검색"]}),a.jsxs("button",{onClick:xe,className:"py-2 border-2 rounded-lg hover:bg-gray-50 font-bold whitespace-nowrap flex items-center justify-center gap-2",style:{borderColor:"#249689",color:"#249689",borderRadius:"10px",fontSize:"15px",width:"110px"},children:[a.jsx(Ur,{size:18}),"초기화"]}),a.jsxs("button",{onClick:b,className:"px-4 py-2 text-white rounded-lg hover:opacity-90 font-bold whitespace-nowrap flex items-center gap-2",style:{backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(yr,{size:18}),"엑셀다운로드(",W(p.length),"명)"]})]})]}):a.jsxs("div",{className:"flex items-end gap-4",children:[a.jsxs("div",{style:{width:"160px"},children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"시작일"}),a.jsx("input",{type:"date",value:z.startDate,onChange:w=>je("startDate",w.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{style:{width:"160px"},children:[a.jsx("label",{className:"block text-sm font-medium mb-1",children:"종료일"}),a.jsx("input",{type:"date",value:z.endDate,onChange:w=>je("endDate",w.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),a.jsxs("div",{className:"flex gap-2 ml-auto",children:[a.jsxs("button",{onClick:ce,className:"py-2 text-white rounded-lg hover:opacity-90 font-bold whitespace-nowrap flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px",width:"110px"},children:[a.jsx(ir,{size:18}),"검색"]}),a.jsxs("button",{onClick:xe,className:"py-2 border-2 rounded-lg hover:bg-gray-50 font-bold whitespace-nowrap flex items-center justify-center gap-2",style:{borderColor:"#249689",color:"#249689",borderRadius:"10px",fontSize:"15px",width:"110px"},children:[a.jsx(Ur,{size:18}),"초기화"]}),a.jsxs("button",{onClick:b,className:"px-4 py-2 text-white rounded-lg hover:opacity-90 font-bold whitespace-nowrap flex items-center gap-2",style:{backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(yr,{size:18}),"엑셀다운로드(",W(p.length),"명)"]})]})]})]}),a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-4",children:[a.jsx("h3",{className:"text-xl font-bold",style:{color:"#249689"},children:"👥 참가자 목록"}),a.jsxs("div",{className:"text-lg font-bold",style:{color:"#249689"},children:["검색결과: ",W(p.length),"명"]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"w-full",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"border-b-2",style:{borderColor:"#249689"},children:[a.jsx("th",{className:"px-3 py-2 text-left",children:"신청일시"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"학부모명"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"연락처"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"자녀성별"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"자녀나이"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"추천인"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"추천인코드"}),a.jsx("th",{className:"px-3 py-2 text-left",children:"지점"}),n==="system"&&a.jsx("th",{className:"px-3 py-2 text-center",children:"삭제"})]})}),a.jsx("tbody",{children:p.map(w=>a.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[a.jsx("td",{className:"px-3 py-3 text-sm",children:new Date(w.created_at).toLocaleString("ko-KR")}),a.jsx("td",{className:"px-3 py-3",children:w.parent_name}),a.jsx("td",{className:"px-3 py-3",children:te(w.phone)}),a.jsx("td",{className:"px-3 py-3",children:w.child_gender}),a.jsxs("td",{className:"px-3 py-3",children:[w.child_age,"세"]}),a.jsx("td",{className:"px-3 py-3",children:w.users?.name||w.referrer_name||"-"}),a.jsx("td",{className:"px-3 py-3",children:w.referrer_code||"-"}),a.jsx("td",{className:"px-3 py-3",children:w.users?.branch||"-"}),n==="system"&&a.jsx("td",{className:"px-3 py-3 text-center",children:a.jsx("button",{onClick:()=>_e(w.id),className:"text-red-600 hover:text-red-800",children:"🗑️"})})]},w.id))})]})}),p.length===0&&a.jsx("div",{className:"text-center py-8 text-gray-500",children:"참가자가 없습니다"})]})]})})})}function Av({user:t,onNavigate:r,onLogout:e,onBack:s}){const n=t?.user_type==="시스템관리자";return a.jsx("div",{className:"min-h-screen bg-white",children:a.jsx("div",{className:"max-w-md mx-auto p-6",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain"}),a.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"이벤트 관리"})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"🏢 지점명"}),a.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"👤 이름"}),a.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: adminEvent"),r("adminEvent")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(ua,{size:20}),"이벤트 대시보드"]}),a.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminEventManager"),r("AdminEventManager")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(Vs,{size:20}),"이벤트 템플릿 관리"]}),a.jsxs("button",{onClick:()=>{console.log("🧭 Navigate back"),s?s():r(n?"SystemAdminDashboard":"AdminDashboard")},className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(At,{size:20}),"나가기"]})]})]})})})}const kv=({showBelow:t=300})=>{const[r,e]=B.useState(!1);B.useEffect(()=>{const n=()=>{window.pageYOffset>t?e(!0):e(!1)};return window.addEventListener("scroll",n),()=>window.removeEventListener("scroll",n)},[t]);const s=()=>{window.scrollTo({top:0,behavior:"smooth"})};return r?a.jsx("button",{onClick:s,className:"scroll-to-top","aria-label":"맨 위로 가기",style:{position:"fixed",bottom:"30px",right:"30px",width:"50px",height:"50px",borderRadius:"50%",background:"linear-gradient(135deg, #1e9a8a, #2cb5a3)",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(30, 154, 138, 0.3)",transition:"all 0.3s ease",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:n=>{n.target.style.transform="translateY(-3px)",n.target.style.boxShadow="0 6px 16px rgba(30, 154, 138, 0.4)"},onMouseLeave:n=>{n.target.style.transform="translateY(0)",n.target.style.boxShadow="0 4px 12px rgba(30, 154, 138, 0.3)"},onMouseDown:n=>{n.target.style.transform="translateY(-1px)"},children:"↑"}):null};function Rv({user:t,onBack:r}){const[e,s]=B.useState([]),[n,i]=B.useState(!0),[o,l]=B.useState("all"),[c,f]=B.useState(!1);B.useEffect(()=>{d()},[o]);const d=async()=>{try{i(!0);let h=he.from("events").select("*").order("created_at",{ascending:!1});o!=="all"&&(h=h.eq("status",o));const{data:u,error:m}=await h;if(m)throw m;s(u||[])}catch(h){console.error("이벤트 조회 실패:",h)}finally{i(!1)}};return a.jsxs("div",{className:"min-h-screen bg-gray-50",children:[a.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-8",children:[a.jsxs("button",{onClick:r,className:"flex items-center gap-1 font-bold hover:opacity-70 transition-opacity",style:{color:"#4A9B8E",fontSize:"16px"},children:[a.jsx(At,{size:20}),"나가기"]}),a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain",onError:h=>h.target.style.display="none"}),a.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"이벤트 템플릿 관리"})]}),a.jsx("div",{style:{width:"80px"}})]}),a.jsx("div",{className:"mb-6 p-3 rounded-lg",style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:"10px"},children:a.jsx("p",{className:"text-sm",style:{color:"#1e40af"},children:"ℹ️ 이벤트 템플릿을 생성하고 관리합니다"})}),a.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200",children:[a.jsx("div",{className:"flex gap-2",children:[{value:"all",label:"전체"},{value:"active",label:"진행중"},{value:"scheduled",label:"예정"},{value:"ended",label:"종료"},{value:"inactive",label:"비활성"}].map(h=>a.jsx("button",{onClick:()=>l(h.value),className:`px-4 py-2 font-medium transition-colors ${o===h.value?"border-b-2":"text-gray-600 hover:text-gray-900"}`,style:o===h.value?{color:"#249689",borderColor:"#249689"}:{},children:h.label},h.value))}),a.jsxs("button",{onClick:()=>f(!0),className:"flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90 font-bold mb-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(ga,{size:20}),"생성하기"]})]})]}),n?a.jsx("div",{className:"flex justify-center items-center py-20",children:a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2",style:{borderColor:"#249689"}})}):e.length===0?a.jsxs("div",{className:"text-center py-20 bg-white rounded-lg shadow-sm border",children:[a.jsx(qs,{size:64,className:"mx-auto mb-4",style:{color:"#249689"}}),a.jsx("p",{className:"text-gray-600 mb-4",children:"등록된 이벤트가 없습니다"}),a.jsx("button",{onClick:()=>f(!0),className:"px-6 py-2 text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#249689",borderRadius:"10px"},children:"첫 이벤트 만들기"})]}):a.jsx("div",{className:"grid grid-cols-4 gap-4 max-h-[calc(100vh-300px)] overflow-y-auto pr-2",children:e.map(h=>a.jsx(Fv,{event:h,onRefresh:d},h.id))})]}),c&&a.jsx(Dv,{onClose:()=>f(!1),onSuccess:()=>{f(!1),d()}})]})}function Fv({event:t,onRefresh:r}){const[e,s]=B.useState(!1),n=async()=>{try{const c=t.status==="active"?"inactive":"active",{error:f}=await he.from("events").update({status:c}).eq("id",t.id);if(f)throw f;r()}catch(c){console.error("상태 변경 실패:",c)}},i=async()=>{if(confirm("정말 이 이벤트를 삭제하시겠습니까?"))try{const{error:c}=await he.from("events").delete().eq("id",t.id);if(c)throw c;r()}catch(c){console.error("삭제 실패:",c)}},o=c=>{const f={active:{text:"진행중",color:"bg-green-100 text-green-800"},inactive:{text:"비활성",color:"bg-gray-100 text-gray-800"},scheduled:{text:"예정",color:"bg-blue-100 text-blue-800"},ended:{text:"종료",color:"bg-red-100 text-red-800"}},d=f[c]||f.inactive;return a.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${d.color}`,children:d.text})},l=c=>c?new Date(c).toLocaleDateString("ko-KR"):"-";return a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden hover:shadow-md transition-shadow",children:[t.template_image_url?a.jsx("div",{className:"h-32 bg-gray-100 relative overflow-hidden",children:a.jsx("img",{src:t.template_image_url,alt:t.name,className:"w-full h-full object-contain",onError:c=>{c.target.style.display="none",c.target.parentElement.innerHTML='<div class="w-full h-full flex items-center justify-center text-gray-400"><span>이미지를 불러올 수 없습니다</span></div>'}})}):a.jsx("div",{className:"h-32 bg-gray-100 flex items-center justify-center",children:a.jsx("span",{className:"text-gray-400 text-xs",children:"이미지 없음"})}),a.jsxs("div",{className:"p-3",children:[a.jsxs("div",{className:"flex items-start justify-between mb-2",children:[a.jsx("h3",{className:"text-sm font-semibold text-gray-900 line-clamp-1",children:t.name}),o(t.status)]}),t.description&&a.jsx("p",{className:"text-xs text-gray-600 mb-2 line-clamp-1",children:t.description}),a.jsxs("div",{className:"text-xs text-gray-500 space-y-1 mb-3",children:[a.jsxs("div",{children:["시작: ",l(t.start_date)]}),a.jsxs("div",{children:["종료: ",l(t.end_date)]})]}),a.jsxs("div",{className:"flex gap-1",children:[a.jsxs("button",{onClick:n,className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-xs",style:{borderRadius:"8px"},children:[t.status==="active"?a.jsx(Kc,{size:14}):a.jsx(ao,{size:14}),a.jsx("span",{className:"hidden lg:inline",children:t.status==="active"?"비활성":"활성"})]}),a.jsx("button",{onClick:()=>s(!0),className:"px-2 py-1.5 rounded hover:opacity-80",style:{backgroundColor:"#249689",color:"white",borderRadius:"8px"},children:a.jsx(va,{size:14})}),a.jsx("button",{onClick:i,className:"px-2 py-1.5 bg-red-100 text-red-700 rounded hover:bg-red-200",style:{borderRadius:"8px"},children:a.jsx(Sr,{size:14})})]})]})]}),e&&a.jsx(Ov,{event:t,onClose:()=>s(!1),onSuccess:()=>{s(!1),r()}})]})}function pc({imageUrl:t,position:r,onPositionChange:e}){const[s,n]=B.useState(!1),[i,o]=B.useState(null),[l,c]=B.useState(null),f=B.useRef(null),d=B.useRef(null),[h,u]=B.useState(!1),m=()=>d.current?d.current.getBoundingClientRect():null,p=S=>{if(!d.current||!h)return;const A=m();if(!A||S.clientX<A.left||S.clientX>A.right||S.clientY<A.top||S.clientY>A.bottom)return;const D=(S.clientX-A.left)/A.width*100,z=(S.clientY-A.top)/A.height*100;console.log("🖱️ 드래그 시작:",{clientX:S.clientX,clientY:S.clientY,imgLeft:A.left,imgTop:A.top,imgWidth:A.width,imgHeight:A.height,x:D,y:z}),o({x:D,y:z}),c({x:D,y:z}),n(!0)},x=S=>{if(!s||!d.current)return;const A=m();if(!A)return;const D=(S.clientX-A.left)/A.width*100,z=(S.clientY-A.top)/A.height*100,C=Math.max(0,Math.min(100,D)),I=Math.max(0,Math.min(100,z));c({x:C,y:I})},g=()=>{if(!s||!i||!l)return;const S=Math.min(i.x,l.x),A=Math.min(i.y,l.y),D=Math.abs(l.x-i.x),z=Math.abs(l.y-i.y);if(D>1&&z>1){const C={x:Math.max(0,Math.min(100,S)),y:Math.max(0,Math.min(100,A)),width:Math.min(100-S,D),height:Math.min(100-A,z)};e(C),console.log("✅ QR 위치 선택됨:",C),console.log("📊 실제 좌표:",{left:`${S.toFixed(2)}%`,top:`${A.toFixed(2)}%`,right:`${(S+D).toFixed(2)}%`,bottom:`${(A+z).toFixed(2)}%`,width:`${D.toFixed(2)}%`,height:`${z.toFixed(2)}%`})}n(!1),o(null),c(null)},T=()=>{if(!s||!i||!l)return{};const S=Math.min(i.x,l.x),A=Math.min(i.y,l.y),D=Math.abs(l.x-i.x),z=Math.abs(l.y-i.y);return{left:`${S}%`,top:`${A}%`,width:`${D}%`,height:`${z}%`}},_=()=>!r||r.width===0?{}:{left:`${r.x}%`,top:`${r.y}%`,width:`${r.width}%`,height:`${r.height}%`};return a.jsxs("div",{ref:f,className:"relative w-full ",style:{minHeight:"350px"},onMouseDown:p,onMouseMove:x,onMouseUp:g,onMouseLeave:g,children:[a.jsx("img",{ref:d,src:t,alt:"Template",className:"w-full h-auto block cursor-crosshair",style:{maxHeight:"500px",objectFit:"contain"},draggable:"false",onDragStart:S=>S.preventDefault(),onLoad:()=>{u(!0),console.log("✅ 이미지 로드 완료:",t)},onError:S=>{console.error("❌ 이미지 로드 실패:",t),u(!1)}}),s&&i&&l&&a.jsx("div",{className:"absolute border-2 border-blue-500 bg-blue-200 bg-opacity-30 pointer-events-none",style:T()}),!s&&r&&r.width>0&&a.jsx("div",{className:"absolute border-4 border-green-500 bg-green-200 bg-opacity-40 pointer-events-none flex items-center justify-center",style:_(),children:a.jsx("span",{className:"text-xs font-bold text-green-700 bg-white px-2 py-1 rounded shadow-lg",children:"QR 위치"})})]})}function Dv({onClose:t,onSuccess:r}){const[e,s]=B.useState({name:"",description:"",landing_url:"",template_image_url:"",qr_position:null,start_date:"",end_date:"",status:"active"}),[n,i]=B.useState(!1),[o,l]=B.useState(!1),[c,f]=B.useState(""),[d,h]=B.useState({type:"",message:""}),u=async x=>{const g=x.target.files[0];if(!g){console.log("❌ 파일이 선택되지 않음");return}console.log("📂 선택된 파일:",g.name,g.size,"bytes");const T=URL.createObjectURL(g);f(T),h({type:"uploading",message:"이미지 업로드 중..."}),console.log("👁️ 미리보기 URL 생성:",T);try{i(!0);const _=g.name.split(".").pop(),A=`event-templates/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${_}`}`;console.log("📁 업로드 경로:",A);const{data:D,error:z}=await he.storage.from("event-images").upload(A,g);if(z){console.error("❌ Storage 업로드 실패:",z),h({type:"error",message:"이미지 업로드 실패: "+z.message}),i(!1);return}console.log("✅ 업로드 성공:",D),console.log("📁 저장된 경로:",A);const C="https://sgxnxbhbyvrmgrzhosyh.supabase.co";console.log("🔧 Supabase URL:",C);const I=`${C}/storage/v1/object/public/event-images/${A}`;console.log("🔗 구성한 Public URL:",I),s(O=>{const P={...O,template_image_url:I};return console.log("✅ FormData 업데이트!"),console.log("   → template_image_url:",P.template_image_url),P}),setTimeout(()=>{console.log("🔄 previewUrl 제거, template_image_url로 교체"),f("")},100),h({type:"success",message:"✅ 이미지 업로드 완료! 이제 QR 위치를 선택하세요."}),console.log("🎉 이미지 업로드 프로세스 완료!")}catch(_){console.error("❌ 이미지 업로드 에러:",_),h({type:"error",message:"이미지 업로드 중 오류 발생: "+_.message})}finally{i(!1),console.log("🔄 업로딩 상태 종료")}},m=(x,g)=>{if(!x||!g)return"active";const T=new Date;T.setHours(0,0,0,0);const _=new Date(x);_.setHours(0,0,0,0);const S=new Date(g);return S.setHours(0,0,0,0),T>S?"ended":T<_?"scheduled":"active"},p=async x=>{if(x.preventDefault(),console.log("🚀 생성하기 버튼 클릭!"),console.log("📋 현재 formData:",e),!e.name){console.log("❌ 검증 실패: 이벤트명 없음"),h({type:"error",message:"이벤트명을 입력해주세요."});return}if(!e.landing_url){console.log("❌ 검증 실패: 랜딩페이지 URL 없음"),h({type:"error",message:"랜딩페이지 URL을 입력해주세요."});return}if(n){console.log("❌ 검증 실패: 업로드 진행 중"),h({type:"error",message:"이미지 업로드가 진행 중입니다. 잠시만 기다려주세요."});return}if(console.log("🔍 template_image_url 확인:",e.template_image_url),!e.template_image_url||e.template_image_url===""){console.log("❌ 검증 실패: template_image_url 없음"),console.log("   - previewUrl:",c),h({type:"error",message:"템플릿 이미지를 업로드해주세요."});return}if(console.log("🔍 qr_position 확인:",e.qr_position),!e.qr_position||e.qr_position.width===0){console.log("❌ 검증 실패: QR 위치 미선택"),h({type:"error",message:"QR 코드 위치를 선택해주세요. 이미지에서 마우스로 드래그하여 QR 영역을 선택하세요."});return}try{l(!0),h({type:"uploading",message:"이벤트 생성 중..."}),console.log("📝 저장할 데이터:",e);const g=m(e.start_date,e.end_date),T={...e,status:g};console.log("📅 계산된 상태:",g);const{error:_}=await he.from("events").insert([T]);if(_)throw console.error("❌ DB 저장 실패:",_),_;console.log("✅ 이벤트 생성 성공!"),h({type:"success",message:"✅ 이벤트가 성공적으로 생성되었습니다!"}),setTimeout(r,500)}catch(g){console.error("❌ 이벤트 생성 실패:",g),h({type:"error",message:"❌ 이벤트 생성에 실패했습니다: "+g.message})}finally{l(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-50 p-4 overflow-y-auto",style:{paddingTop:"2rem"},children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm relative",style:{borderRadius:"10px"},children:a.jsxs("div",{className:"p-5 max-h-[90vh] overflow-y-auto",children:[a.jsx("div",{className:"flex flex-col items-center justify-center mb-3",children:a.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain",onError:x=>x.target.style.display="none"}),a.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"28px"},children:"템플릿 만들기"})]})}),d.message&&a.jsx("div",{className:`mb-3 p-3 rounded-lg ${d.type==="error"?"bg-red-50 border-2 border-red-300":d.type==="success"?"bg-green-50 border-2 border-green-300":"bg-blue-50 border-2 border-blue-300"}`,style:{borderRadius:"10px"},children:a.jsx("p",{className:`text-sm font-medium ${d.type==="error"?"text-red-700":d.type==="success"?"text-green-700":"text-blue-700"}`,children:d.message})}),a.jsxs("form",{onSubmit:p,className:"space-y-2",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["이벤트명 ",a.jsx("span",{style:{color:"red"},children:"*"})]}),a.jsx("input",{type:"text",value:e.name,onChange:x=>s(g=>({...g,name:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"예: 수학편지 신청 이벤트",style:{borderRadius:"10px"},required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),a.jsx("textarea",{value:e.description,onChange:x=>s(g=>({...g,description:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:"2",placeholder:"이벤트에 대한 간단한 설명",style:{borderRadius:"10px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["랜딩페이지 URL ",a.jsx("span",{style:{color:"red"},children:"*"})]}),a.jsx("input",{type:"url",value:e.landing_url,onChange:x=>s(g=>({...g,landing_url:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"https://example.com/event",style:{borderRadius:"10px"},required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"시작일"}),a.jsx("input",{type:"date",value:e.start_date,onChange:x=>s(g=>({...g,start_date:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"종료일"}),a.jsx("input",{type:"date",value:e.end_date,onChange:x=>s(g=>({...g,end_date:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["템플릿 이미지 ",a.jsx("span",{style:{color:"red"},children:"*"})]}),a.jsx("input",{type:"file",accept:"image/*",onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"},disabled:n})]}),a.jsxs("div",{className:"p-3 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border-2 border-blue-300 shadow-md",style:{borderRadius:"10px"},children:[a.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2 text-center",children:"📍 QR코드 위치를 선택하세요"}),a.jsx("div",{className:"relative inline-block border-4 border-blue-400 rounded bg-white shadow-xl w-full",style:{borderRadius:"10px",minHeight:"400px"},children:n?a.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"400px"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-3"}),a.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"⏳ 이미지 업로드 중..."})]})}):c||e.template_image_url?a.jsx(pc,{imageUrl:c||e.template_image_url,position:e.qr_position,onPositionChange:x=>s(g=>({...g,qr_position:x}))}):a.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"400px"},children:a.jsxs("div",{className:"text-center text-gray-400",children:[a.jsx("svg",{className:"w-16 h-16 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),a.jsx("p",{className:"text-sm",children:"이미지를 선택해주세요"})]})})}),e.qr_position&&e.qr_position.width>0&&a.jsx("div",{className:"mt-2 p-2 bg-green-50 rounded border border-green-300",style:{borderRadius:"10px"},children:a.jsx("p",{className:"text-xs text-green-700 font-medium text-center",children:"✅ QR 위치가 선택되었습니다!"})})]}),a.jsxs("div",{className:"flex gap-3 pt-3",children:[a.jsx("button",{type:"button",onClick:t,className:"w-full py-3 flex items-center justify-center gap-2 bg-white text-gray-700 border-2 border-gray-300 rounded-lg hover:bg-gray-50 font-bold",style:{borderRadius:"10px",fontSize:"15px"},children:"나가기"}),a.jsxs("button",{type:"submit",disabled:o||n,className:"w-full py-3 flex items-center justify-center gap-2 text-white rounded-lg hover:opacity-90 disabled:opacity-50 font-bold",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(ga,{size:18}),o?"생성 중...":"생성하기"]})]})]})]})})})}function Ov({event:t,onClose:r,onSuccess:e}){const[s,n]=B.useState({name:t.name||"",description:t.description||"",landing_url:t.landing_url||"",template_image_url:t.template_image_url||"",qr_position:t.qr_position||{x:0,y:0,width:0,height:0},status:t.status||"active",start_date:t.start_date||"",end_date:t.end_date||""}),[i,o]=B.useState(!1),[l,c]=B.useState(!1),[f,d]=B.useState(""),[h,u]=B.useState({type:"",message:""}),m=async g=>{const T=g.target.files[0];if(!T)return;const _=URL.createObjectURL(T);d(_),u({type:"uploading",message:"이미지 업로드 중..."});try{o(!0);const S=T.name.split(".").pop(),D=`event-templates/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${S}`}`,{data:z,error:C}=await he.storage.from("event-images").upload(D,T);if(C)throw C;const O=`https://sgxnxbhbyvrmgrzhosyh.supabase.co/storage/v1/object/public/event-images/${D}`;n(P=>({...P,template_image_url:O})),setTimeout(()=>d(""),100),u({type:"success",message:"✅ 이미지 업로드 완료!"})}catch(S){u({type:"error",message:"이미지 업로드 실패: "+S.message})}finally{o(!1)}},p=(g,T)=>{if(!g||!T)return"active";const _=new Date;_.setHours(0,0,0,0);const S=new Date(g);S.setHours(0,0,0,0);const A=new Date(T);return A.setHours(0,0,0,0),_>A?"ended":_<S?"scheduled":"active"},x=async g=>{if(g.preventDefault(),!s.name||!s.landing_url){u({type:"error",message:"필수 항목을 입력해주세요."});return}if(!s.template_image_url){u({type:"error",message:"템플릿 이미지를 업로드해주세요."});return}if(!s.qr_position||s.qr_position.width===0){u({type:"error",message:"QR 코드 위치를 선택해주세요."});return}try{c(!0),u({type:"uploading",message:"이벤트 수정 중..."});const T=p(s.start_date,s.end_date),_={...s,status:T};console.log("📅 계산된 상태:",T);const{error:S}=await he.from("events").update(_).eq("id",t.id);if(S)throw S;u({type:"success",message:"✅ 이벤트가 성공적으로 수정되었습니다!"}),setTimeout(e,500)}catch(T){u({type:"error",message:"❌ 이벤트 수정에 실패했습니다: "+T.message})}finally{c(!1)}};return a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-50 p-4 overflow-y-auto",style:{paddingTop:"2rem"},children:a.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm relative",style:{borderRadius:"10px"},children:a.jsxs("div",{className:"p-4 max-h-[85vh] overflow-y-auto",children:[a.jsx("div",{className:"flex flex-col items-center justify-center mb-2.5",children:a.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[a.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain",onError:g=>g.target.style.display="none"}),a.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"28px"},children:"이벤트 수정하기"})]})}),h.message&&a.jsx("div",{className:`mb-3 p-3 rounded-lg ${h.type==="error"?"bg-red-50 border-2 border-red-300":h.type==="success"?"bg-green-50 border-2 border-green-300":"bg-blue-50 border-2 border-blue-300"}`,style:{borderRadius:"10px"},children:a.jsx("p",{className:`text-sm font-medium ${h.type==="error"?"text-red-700":h.type==="success"?"text-green-700":"text-blue-700"}`,children:h.message})}),a.jsxs("form",{onSubmit:x,className:"space-y-1.5",children:[a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:["이벤트명 ",a.jsx("span",{style:{color:"red"},children:"*"})]}),a.jsx("input",{type:"text",value:s.name,onChange:g=>n(T=>({...T,name:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"예: 수학편지 신청 이벤트",style:{borderRadius:"10px"},required:!0})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:"설명"}),a.jsx("textarea",{value:s.description,onChange:g=>n(T=>({...T,description:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:"2",placeholder:"이벤트에 대한 간단한 설명",style:{borderRadius:"10px"}})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:["랜딩페이지 URL ",a.jsx("span",{style:{color:"red"},children:"*"})]}),a.jsx("input",{type:"url",value:s.landing_url,onChange:g=>n(T=>({...T,landing_url:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"https://example.com/event",style:{borderRadius:"10px"},required:!0})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:"시작일"}),a.jsx("input",{type:"date",value:s.start_date,onChange:g=>n(T=>({...T,start_date:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:"종료일"}),a.jsx("input",{type:"date",value:s.end_date,onChange:g=>n(T=>({...T,end_date:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]})]}),a.jsxs("div",{children:[a.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:["템플릿 이미지 ",a.jsx("span",{style:{color:"red"},children:"*"})]}),a.jsx("input",{type:"file",accept:"image/*",onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"},disabled:i})]}),a.jsxs("div",{className:"p-3 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border-2 border-blue-300 shadow-md",style:{borderRadius:"10px"},children:[a.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2 text-center",children:"📍 QR코드 위치를 선택하세요"}),a.jsx("div",{className:"relative inline-block border-4 border-blue-400 rounded bg-white shadow-xl w-full",style:{borderRadius:"10px",minHeight:"280px"},children:i?a.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"280px"},children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-3"}),a.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"⏳ 이미지 업로드 중..."})]})}):f||s.template_image_url?a.jsx(pc,{imageUrl:f||s.template_image_url,position:s.qr_position,onPositionChange:g=>n(T=>({...T,qr_position:g}))}):a.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"280px"},children:a.jsxs("div",{className:"text-center text-gray-400",children:[a.jsx("svg",{className:"w-16 h-16 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:a.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),a.jsx("p",{className:"text-sm",children:"이미지를 선택해주세요"})]})})}),s.qr_position&&s.qr_position.width>0&&a.jsx("div",{className:"mt-2 p-2 bg-green-50 rounded border border-green-300",style:{borderRadius:"10px"},children:a.jsx("p",{className:"text-xs text-green-700 font-medium text-center",children:"✅ QR 위치가 선택되었습니다!"})})]}),a.jsxs("div",{className:"flex gap-3 pt-3",children:[a.jsx("button",{type:"button",onClick:r,className:"w-full py-3 flex items-center justify-center gap-2 bg-white text-gray-700 border-2 border-gray-300 rounded-lg hover:bg-gray-50 font-bold",style:{borderRadius:"10px",fontSize:"15px"},children:"나가기"}),a.jsxs("button",{type:"submit",disabled:l||i,className:"w-full py-3 flex items-center justify-center gap-2 text-white rounded-lg hover:opacity-90 disabled:opacity-50 font-bold",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[a.jsx(va,{size:18}),l?"저장 중...":"수정하기"]})]})]})]})})})}function Iv(){const[t,r]=B.useState(null),[e,s]=B.useState("/dashboard"),n=Ic(),i=Pc();B.useEffect(()=>{console.log("Current User:",t),console.log("Current Path:",i.pathname),console.log("Previous Path:",e)},[t,i,e]);const o=h=>{console.log("Auto login:",h),r(h),h.user_type==="시스템관리자"?n("/system-admin"):n("/dashboard")},l=async()=>{try{console.log("Logging out..."),await he.auth.signOut(),r(null),n("/")}catch(h){console.error("로그아웃 오류:",h),alert("로그아웃 중 오류가 발생했습니다.")}},c=h=>{const u=typeof h=="string"?h.trim():h;console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),console.log("🔄 handleNavigate 호출"),console.log("📌 원본 페이지:",`"${h}"`),console.log("📌 정제된 페이지:",`"${u}"`),console.log("📌 페이지 타입:",typeof h);const m={hero:"/",login:"/login",signup:"/signup",event:"/event",Dashboard:"/dashboard",dashboard:"/dashboard",AdminDashboard:"/admin",admin:"/admin",AdminUsers:"/admin/users",AdminWorkDiary:"/admin/workdiary",AdminCustomers:"/admin/customers",AdminEventMenu:"/admin/event-menu",adminEvent:"/admin/event",AdminEventDashboard:"/admin/event",AdminEventManager:"/admin/event-manager",MyInfo:"/myinfo",MyQRCode:"/myqrcode",WorkDiary:"/workdiary",CustomerManagement:"/customers",ShippingList:"/shipping",PurchaseHistory:"/purchases",purchases:"/purchases",SystemAdminDashboard:"/system-admin","system-admin":"/system-admin",SystemAdminBranches:"/system-admin/branches",SystemAdminUsers:"/system-admin/users",SystemAdminCustomers:"/system-admin/customers",SystemAdminPurchases:"/system-admin/purchases",SystemAdminShipping:"/system-admin/shipping",Profile:"/profile"},p=m[u];if(console.log("🎯 매핑된 경로:",p),!p){console.error("❌ 알 수 없는 페이지:",u),console.error("❌ 사용 가능한 페이지:",Object.keys(m).join(", ")),console.error("❌ HeroPage(/)로 리다이렉트됨"),console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),n("/");return}(u==="AdminEventDashboard"||u==="adminEvent")&&(s(i.pathname),console.log("✅ 이전 경로 저장:",i.pathname)),console.log("✅ 성공:",u,"→",p),console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),n(p)},f=h=>{console.log("Login:",h),r(h),h.user_type==="시스템관리자"?n("/system-admin"):n("/dashboard")},d=h=>{console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),console.log("App.jsx - handleSwitchMode 호출됨"),console.log("현재 모드:",t?.loginMode),console.log("새로운 모드:",h);const u={...t,loginMode:h};r(u),h===Ys.MANAGER?(console.log("MANAGER 모드로 전환 → /admin으로 이동"),n("/admin")):h===Ys.EMPLOYEE&&(console.log("EMPLOYEE 모드로 전환 → /dashboard로 이동"),n("/dashboard")),console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")};return a.jsxs(a.Fragment,{children:[a.jsxs(Lc,{children:[a.jsx(Ie,{path:"/",element:a.jsx(Ad,{onNavigate:c,onAutoLogin:o})}),a.jsx(Ie,{path:"/login",element:a.jsx(kd,{onNavigate:c,onLogin:f})}),a.jsx(Ie,{path:"/signup",element:a.jsx(Rd,{onNavigate:c})}),a.jsx(Ie,{path:"/event",element:a.jsx(Tv,{})}),a.jsx(Ie,{path:"/dashboard",element:t?a.jsx(Fd,{user:t,onNavigate:c,onLogout:l,onSwitchMode:d}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/admin",element:t&&rs(t)?a.jsx(Dd,{user:t,onNavigate:c,onLogout:l,onSwitchMode:d}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/admin/users",element:t&&rs(t)?a.jsx(Sg,{user:t,onNavigate:c}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/admin/workdiary",element:t&&rs(t)?a.jsx(Ng,{user:t,onNavigate:c}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/admin/customers",element:t&&rs(t)?a.jsx(jg,{user:t,onNavigate:c}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/admin/event-menu",element:t&&t.user_type==="시스템관리자"?a.jsx(Av,{user:t,onNavigate:c,onLogout:l,onBack:()=>n("/system-admin")}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/admin/event-manager",element:t&&t.user_type==="시스템관리자"?a.jsx(Rv,{user:t,onBack:()=>n("/admin/event-menu")}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/admin/event",element:t?a.jsx(Cv,{user:t,onNavigate:c,onLogout:l,from:e,onBack:()=>{console.log("🔙 AdminEventDashboard 뒤로가기"),console.log("   이전 경로:",e),e&&e!=="/admin/event"?(console.log("   → 저장된 경로로 이동:",e),n(e)):t.user_type==="시스템관리자"?(console.log("   → 시스템관리자: /admin/event-menu"),n("/admin/event-menu")):rs(t)?(console.log("   → 매장관리자: /admin"),n("/admin")):(console.log("   → 일반 직원: /dashboard"),n("/dashboard"))}}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/myinfo",element:t?a.jsx(Bg,{user:t,onBack:()=>n("/dashboard"),onNavigate:c}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/myqrcode",element:t?a.jsx(Ev,{user:t,onBack:()=>n("/myinfo")}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/workdiary",element:t?a.jsx(Tg,{user:t,onNavigate:c,onLogout:l}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/customers",element:t?a.jsx(Cg,{user:t,onNavigate:c}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/shipping",element:t?a.jsx(Ag,{user:t,onNavigate:c}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/purchases",element:t?a.jsx(kg,{user:t,onNavigate:c}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/system-admin",element:t&&t.user_type==="시스템관리자"?a.jsx(Rg,{user:t,onNavigate:c,onLogout:l}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"/system-admin/branches",element:t&&t.user_type==="시스템관리자"?a.jsx(Fg,{user:t,onNavigate:c}):a.jsx($e,{to:"/system-admin",replace:!0})}),a.jsx(Ie,{path:"/system-admin/users",element:t&&t.user_type==="시스템관리자"?a.jsx(Og,{user:t,onNavigate:c}):a.jsx($e,{to:"/system-admin",replace:!0})}),a.jsx(Ie,{path:"/system-admin/customers",element:t&&t.user_type==="시스템관리자"?a.jsx(Ig,{user:t,onNavigate:c}):a.jsx($e,{to:"/system-admin",replace:!0})}),a.jsx(Ie,{path:"/system-admin/purchases",element:t&&t.user_type==="시스템관리자"?a.jsx(Pg,{user:t,onNavigate:c}):a.jsx($e,{to:"/system-admin",replace:!0})}),a.jsx(Ie,{path:"/system-admin/shipping",element:t&&t.user_type==="시스템관리자"?a.jsx(Lg,{user:t,onNavigate:c}):a.jsx($e,{to:"/system-admin",replace:!0})}),a.jsx(Ie,{path:"/profile",element:t?a.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:a.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md",children:[a.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:"#249689"},children:"내 정보관리"}),a.jsxs("div",{className:"mb-4 space-y-2",children:[a.jsxs("p",{className:"text-gray-600",children:["이름: ",t.name]}),a.jsxs("p",{className:"text-gray-600",children:["이메일: ",t.email]}),a.jsxs("p",{className:"text-gray-600",children:["지점: ",t.branch]})]}),a.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"상세 프로필 페이지는 준비중입니다."}),a.jsx("button",{onClick:()=>{t.user_type==="시스템관리자"?n("/system-admin"):n("/dashboard")},className:"w-full py-2 text-white font-bold rounded-lg",style:{backgroundColor:"#249689"},children:"대시보드로 돌아가기"})]})}):a.jsx($e,{to:"/login",replace:!0})}),a.jsx(Ie,{path:"*",element:a.jsx($e,{to:"/",replace:!0})})]}),a.jsx(kv,{})]})}function Pv(){return a.jsx(Oc,{children:a.jsx(Iv,{})})}Zn.createRoot(document.getElementById("root")).render(a.jsx(Bc.StrictMode,{children:a.jsx(Pv,{})}));
