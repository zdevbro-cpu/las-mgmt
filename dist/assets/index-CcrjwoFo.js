const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-ponyfill-DIMAIuBD.js","assets/vendor-BLl87vHU.js"])))=>i.map(i=>d[i]);
import{r as B,a as Oc,u as so,B as Ic,b as Pc,R as Lc,c as Be,N as We,d as Bc}from"./vendor-BLl87vHU.js";import{A as Ot,S as Mc,F as rn,a as sn,T as no,P as ao,B as Sa,U as nn,L as Na,b as zc,c as ja,C as an,D as Er,d as io,X as oo,e as Ea,f as Ar,g as rs,h as Uc,i as $c,j as jn,R as Yr,k as Hc,l as Ta,K as Wc,m as la,n as lo,E as co,M as Gc,o as Vc,p as Xc,Q as ni,q as ai,r as Ca,s as ii,t as Kc,u as Yc,v as qc,w as Jc,x as Qc}from"./icons-CJ3ZiyGK.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=e(a);fetch(a.href,i)}})();var ho={exports:{}},En={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Zc=B,e0=Symbol.for("react.element"),t0=Symbol.for("react.fragment"),r0=Object.prototype.hasOwnProperty,s0=Zc.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,n0={key:!0,ref:!0,__self:!0,__source:!0};function fo(t,r,e){var s,a={},i=null,o=null;e!==void 0&&(i=""+e),r.key!==void 0&&(i=""+r.key),r.ref!==void 0&&(o=r.ref);for(s in r)r0.call(r,s)&&!n0.hasOwnProperty(s)&&(a[s]=r[s]);if(t&&t.defaultProps)for(s in r=t.defaultProps,r)a[s]===void 0&&(a[s]=r[s]);return{$$typeof:e0,type:t,key:i,ref:o,props:a,_owner:s0.current}}En.Fragment=t0;En.jsx=fo;En.jsxs=fo;ho.exports=En;var n=ho.exports,ca={},oi=Oc;ca.createRoot=oi.createRoot,ca.hydrateRoot=oi.hydrateRoot;const a0="1.35.7",uo={"X-Client-Info":`supabase-js/${a0}`},i0="supabase.auth.token";function o0(t){return t.replace(/\/$/,"")}const l0=()=>typeof window<"u",c0="1.24.0",d0="http://localhost:9999",h0={"X-Client-Info":`gotrue-js/${c0}`},Hs=10,br={ERROR_MESSAGE:"Request Failed",MAX_RETRIES:10,RETRY_INTERVAL:2},hs="supabase.auth.token",f0={name:"sb",lifetime:60*60*8,domain:"",path:"/",sameSite:"lax"};var Fs=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};const u0=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),x0=(t,r)=>{if(!t?.status)return r({message:br.ERROR_MESSAGE});if(typeof t.json!="function")return r(t);t.json().then(e=>r({message:u0(e),status:t?.status||500}))},m0=(t,r,e)=>{const s={method:t,headers:r?.headers||{}};return t==="GET"||(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),s.body=JSON.stringify(e)),s};function Tn(t,r,e,s,a){return Fs(this,void 0,void 0,function*(){return new Promise((i,o)=>{t(e,m0(r,s,a)).then(l=>{if(!l.ok)throw l;return s?.noResolveJson?i:l.json()}).then(l=>i(l)).catch(l=>x0(l,o))})})}function Gn(t,r,e){return Fs(this,void 0,void 0,function*(){return Tn(t,"GET",r,e)})}function pt(t,r,e,s){return Fs(this,void 0,void 0,function*(){return Tn(t,"POST",r,s,e)})}function li(t,r,e,s){return Fs(this,void 0,void 0,function*(){return Tn(t,"PUT",r,s,e)})}function p0(t,r,e,s){return Fs(this,void 0,void 0,function*(){return Tn(t,"DELETE",r,s,e)})}function g0(t,r,e){const s=e||{},a=encodeURIComponent,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if(typeof a!="function")throw new TypeError("option encode is invalid");if(!i.test(t))throw new TypeError("argument name is invalid");const o=a(r);if(o&&!i.test(o))throw new TypeError("argument val is invalid");let l=t+"="+o;if(s.maxAge!=null){const c=s.maxAge-0;if(isNaN(c)||!isFinite(c))throw new TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(c)}if(s.domain){if(!i.test(s.domain))throw new TypeError("option domain is invalid");l+="; Domain="+s.domain}if(s.path){if(!i.test(s.path))throw new TypeError("option path is invalid");l+="; Path="+s.path}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");l+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(l+="; HttpOnly"),s.secure&&(l+="; Secure"),s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case"lax":l+="; SameSite=Lax";break;case"strict":l+="; SameSite=Strict";break;case"none":l+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return l}function v0(t){if(!t||!t.headers||!t.headers.host)throw new Error('The "host" request header is not available');const r=t.headers.host.indexOf(":")>-1&&t.headers.host.split(":")[0]||t.headers.host;return!(["localhost","127.0.0.1"].indexOf(r)>-1||r.endsWith(".local"))}function y0(t,r){var e,s,a;return g0(t.name,t.value,{maxAge:t.maxAge,expires:new Date(Date.now()+t.maxAge*1e3),httpOnly:!0,secure:r,path:(e=t.path)!==null&&e!==void 0?e:"/",domain:(s=t.domain)!==null&&s!==void 0?s:"",sameSite:(a=t.sameSite)!==null&&a!==void 0?a:"lax"})}function da(t,r,e){const s=e.map(i=>y0(i,v0(t))),a=r.getHeader("Set-Cookie");return a&&(a instanceof Array?Array.prototype.push.apply(s,a):typeof a=="string"&&s.push(a)),s}function Ws(t,r,e){r.setHeader("Set-Cookie",da(t,r,e))}const b0="modulepreload",w0=function(t){return"/"+t},ci={},Cn=function(r,e,s){let a=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");a=Promise.allSettled(e.map(c=>{if(c=w0(c),c in ci)return;ci[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":b0,d||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((u,m)=>{f.addEventListener("load",u),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return r().catch(i)})};var kn=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};function lr(t){return Math.round(Date.now()/1e3)+t}function _0(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const r=Math.random()*16|0;return(t=="x"?r:r&3|8).toString(16)})}const Zt=()=>typeof window<"u";function Qt(t,r){var e;r||(r=((e=window?.location)===null||e===void 0?void 0:e.href)||""),t=t.replace(/[\[\]]/g,"\\$&");const s=new RegExp("[?&#]"+t+"(=([^&#]*)|&|#|$)"),a=s.exec(r);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}const S0=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>kn(void 0,void 0,void 0,function*(){return yield(yield Cn(()=>import("./browser-ponyfill-DIMAIuBD.js").then(s=>s.b),__vite__mapDeps([0,1]))).fetch(...e)}):r=fetch,(...e)=>r(...e)},N0=(t,r,e)=>kn(void 0,void 0,void 0,function*(){Zt()&&(yield t?.setItem(r,JSON.stringify(e)))}),j0=(t,r)=>kn(void 0,void 0,void 0,function*(){const e=Zt()&&(yield t?.getItem(r));if(!e)return null;try{return JSON.parse(e)}catch{return e}}),E0=(t,r)=>{const e=Zt()&&t?.getItem(r);if(!e||typeof e!="string")return null;try{return JSON.parse(e)}catch{return e}},T0=(t,r)=>kn(void 0,void 0,void 0,function*(){Zt()&&(yield t?.removeItem(r))});var Ge=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};class C0{constructor({url:r="",headers:e={},cookieOptions:s,fetch:a}){this.url=r,this.headers=e,this.cookieOptions=Object.assign(Object.assign({},f0),s),this.fetch=S0(a)}_createRequestHeaders(r){const e=Object.assign({},this.headers);return e.Authorization=`Bearer ${r}`,e}cookieName(){var r;return(r=this.cookieOptions.name)!==null&&r!==void 0?r:""}getUrlForProvider(r,e){const s=[`provider=${encodeURIComponent(r)}`];if(e?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(e.redirectTo)}`),e?.scopes&&s.push(`scopes=${encodeURIComponent(e.scopes)}`),e?.queryParams){const a=new URLSearchParams(e.queryParams);s.push(`${a}`)}return`${this.url}/authorize?${s.join("&")}`}signUpWithEmail(r,e,s={}){return Ge(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers);let i="";s.redirectTo&&(i="?redirect_to="+encodeURIComponent(s.redirectTo));const o=yield pt(this.fetch,`${this.url}/signup${i}`,{email:r,password:e,data:s.data,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:a}),l=Object.assign({},o);return l.expires_in&&(l.expires_at=lr(o.expires_in)),{data:l,error:null}}catch(a){return{data:null,error:a}}})}signInWithEmail(r,e,s={}){return Ge(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers);let i="?grant_type=password";s.redirectTo&&(i+="&redirect_to="+encodeURIComponent(s.redirectTo));const o=yield pt(this.fetch,`${this.url}/token${i}`,{email:r,password:e,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:a}),l=Object.assign({},o);return l.expires_in&&(l.expires_at=lr(o.expires_in)),{data:l,error:null}}catch(a){return{data:null,error:a}}})}signUpWithPhone(r,e,s={}){return Ge(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers),i=yield pt(this.fetch,`${this.url}/signup`,{phone:r,password:e,data:s.data,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:a}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=lr(i.expires_in)),{data:o,error:null}}catch(a){return{data:null,error:a}}})}signInWithPhone(r,e,s={}){return Ge(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers),o=yield pt(this.fetch,`${this.url}/token?grant_type=password`,{phone:r,password:e,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:a}),l=Object.assign({},o);return l.expires_in&&(l.expires_at=lr(o.expires_in)),{data:l,error:null}}catch(a){return{data:null,error:a}}})}signInWithOpenIDConnect({id_token:r,nonce:e,client_id:s,issuer:a,provider:i}){return Ge(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),c=yield pt(this.fetch,`${this.url}/token?grant_type=id_token`,{id_token:r,nonce:e,client_id:s,issuer:a,provider:i},{headers:o}),d=Object.assign({},c);return d.expires_in&&(d.expires_at=lr(c.expires_in)),{data:d,error:null}}catch(o){return{data:null,error:o}}})}sendMagicLinkEmail(r,e={}){var s;return Ge(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers);let i="";e.redirectTo&&(i+="?redirect_to="+encodeURIComponent(e.redirectTo));const o=(s=e.shouldCreateUser)!==null&&s!==void 0?s:!0;return{data:yield pt(this.fetch,`${this.url}/otp${i}`,{email:r,create_user:o,gotrue_meta_security:{captcha_token:e.captchaToken}},{headers:a}),error:null}}catch(a){return{data:null,error:a}}})}sendMobileOTP(r,e={}){var s;return Ge(this,void 0,void 0,function*(){try{const a=(s=e.shouldCreateUser)!==null&&s!==void 0?s:!0,i=Object.assign({},this.headers);return{data:yield pt(this.fetch,`${this.url}/otp`,{phone:r,create_user:a,gotrue_meta_security:{captcha_token:e.captchaToken}},{headers:i}),error:null}}catch(a){return{data:null,error:a}}})}signOut(r){return Ge(this,void 0,void 0,function*(){try{return yield pt(this.fetch,`${this.url}/logout`,{},{headers:this._createRequestHeaders(r),noResolveJson:!0}),{error:null}}catch(e){return{error:e}}})}verifyMobileOTP(r,e,s={}){return Ge(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers),i=yield pt(this.fetch,`${this.url}/verify`,{phone:r,token:e,type:"sms",redirect_to:s.redirectTo},{headers:a}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=lr(i.expires_in)),{data:o,error:null}}catch(a){return{data:null,error:a}}})}verifyOTP({email:r,phone:e,token:s,type:a="sms"},i={}){return Ge(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),l=yield pt(this.fetch,`${this.url}/verify`,{email:r,phone:e,token:s,type:a,redirect_to:i.redirectTo},{headers:o}),c=Object.assign({},l);return c.expires_in&&(c.expires_at=lr(l.expires_in)),{data:c,error:null}}catch(o){return{data:null,error:o}}})}inviteUserByEmail(r,e={}){return Ge(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let a="";return e.redirectTo&&(a+="?redirect_to="+encodeURIComponent(e.redirectTo)),{data:yield pt(this.fetch,`${this.url}/invite${a}`,{email:r,data:e.data},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}resetPasswordForEmail(r,e={}){return Ge(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let a="";return e.redirectTo&&(a+="?redirect_to="+encodeURIComponent(e.redirectTo)),{data:yield pt(this.fetch,`${this.url}/recover${a}`,{email:r,gotrue_meta_security:{captcha_token:e.captchaToken}},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}refreshAccessToken(r){return Ge(this,void 0,void 0,function*(){try{const e=yield pt(this.fetch,`${this.url}/token?grant_type=refresh_token`,{refresh_token:r},{headers:this.headers}),s=Object.assign({},e);return s.expires_in&&(s.expires_at=lr(e.expires_in)),{data:s,error:null}}catch(e){return{data:null,error:e}}})}setAuthCookie(r,e){r.method!=="POST"&&(e.setHeader("Allow","POST"),e.status(405).end("Method Not Allowed"));const{event:s,session:a}=r.body;if(!s)throw new Error("Auth event missing!");if(s==="SIGNED_IN"){if(!a)throw new Error("Auth session missing!");Ws(r,e,[{key:"access-token",value:a.access_token},{key:"refresh-token",value:a.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}s==="SIGNED_OUT"&&Ws(r,e,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))),e.status(200).json({})}deleteAuthCookie(r,e,{redirectTo:s="/"}){return Ws(r,e,["access-token","refresh-token"].map(a=>({name:`${this.cookieName()}-${a}`,value:"",maxAge:-1}))),e.redirect(307,s)}getAuthCookieString(r,e){r.method!=="POST"&&(e.setHeader("Allow","POST"),e.status(405).end("Method Not Allowed"));const{event:s,session:a}=r.body;if(!s)throw new Error("Auth event missing!");if(s==="SIGNED_IN"){if(!a)throw new Error("Auth session missing!");return da(r,e,[{key:"access-token",value:a.access_token},{key:"refresh-token",value:a.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}return s==="SIGNED_OUT"?da(r,e,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))):e.getHeader("Set-Cookie")}generateLink(r,e,s={}){return Ge(this,void 0,void 0,function*(){try{return{data:yield pt(this.fetch,`${this.url}/admin/generate_link`,{type:r,email:e,password:s.password,data:s.data,redirect_to:s.redirectTo},{headers:this.headers}),error:null}}catch(a){return{data:null,error:a}}})}createUser(r){return Ge(this,void 0,void 0,function*(){try{const e=yield pt(this.fetch,`${this.url}/admin/users`,r,{headers:this.headers});return{user:e,data:e,error:null}}catch(e){return{user:null,data:null,error:e}}})}listUsers(){return Ge(this,void 0,void 0,function*(){try{return{data:(yield Gn(this.fetch,`${this.url}/admin/users`,{headers:this.headers})).users,error:null}}catch(r){return{data:null,error:r}}})}getUserById(r){return Ge(this,void 0,void 0,function*(){try{return{data:yield Gn(this.fetch,`${this.url}/admin/users/${r}`,{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}getUserByCookie(r,e){return Ge(this,void 0,void 0,function*(){try{if(!r.cookies)throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");const s=r.cookies[`${this.cookieName()}-access-token`],a=r.cookies[`${this.cookieName()}-refresh-token`];if(!s)throw new Error("No cookie found!");const{user:i,error:o}=yield this.getUser(s);if(o){if(!a)throw new Error("No refresh_token cookie found!");if(!e)throw new Error("You need to pass the res object to automatically refresh the session!");const{data:l,error:c}=yield this.refreshAccessToken(a);if(c)throw c;if(l)return Ws(r,e,[{key:"access-token",value:l.access_token},{key:"refresh-token",value:l.refresh_token}].map(d=>{var h;return{name:`${this.cookieName()}-${d.key}`,value:d.value,domain:this.cookieOptions.domain,maxAge:(h=this.cookieOptions.lifetime)!==null&&h!==void 0?h:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}})),{token:l.access_token,user:l.user,data:l.user,error:null}}return{token:s,user:i,data:i,error:null}}catch(s){return{token:null,user:null,data:null,error:s}}})}updateUserById(r,e){return Ge(this,void 0,void 0,function*(){try{const s=yield li(this.fetch,`${this.url}/admin/users/${r}`,e,{headers:this.headers});return{user:s,data:s,error:null}}catch(s){return{user:null,data:null,error:s}}})}deleteUser(r){return Ge(this,void 0,void 0,function*(){try{const e=yield p0(this.fetch,`${this.url}/admin/users/${r}`,{},{headers:this.headers});return{user:e,data:e,error:null}}catch(e){return{user:null,data:null,error:e}}})}getUser(r){return Ge(this,void 0,void 0,function*(){try{const e=yield Gn(this.fetch,`${this.url}/user`,{headers:this._createRequestHeaders(r)});return{user:e,data:e,error:null}}catch(e){return{user:null,data:null,error:e}}})}updateUser(r,e){return Ge(this,void 0,void 0,function*(){try{const s=yield li(this.fetch,`${this.url}/user`,e,{headers:this._createRequestHeaders(r)});return{user:s,data:s,error:null}}catch(s){return{user:null,data:null,error:s}}})}}function k0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var gt=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};k0();const A0={url:d0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:h0},R0=t=>{try{return atob(t.replace(/[-]/g,"+").replace(/[_]/g,"/"))}catch(r){if(r instanceof ReferenceError)return Buffer.from(t,"base64").toString("utf-8");throw r}};class F0{constructor(r){this.stateChangeEmitters=new Map,this.networkRetries=0;const e=Object.assign(Object.assign({},A0),r);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=e.autoRefreshToken,this.persistSession=e.persistSession,this.multiTab=e.multiTab,this.localStorage=e.localStorage||globalThis.localStorage,this.api=new C0({url:e.url,headers:e.headers,cookieOptions:e.cookieOptions,fetch:e.fetch}),this._recoverSession(),this._recoverAndRefresh(),this._listenForMultiTabEvents(),this._handleVisibilityChange(),e.detectSessionInUrl&&Zt()&&Qt("access_token")&&this.getSessionFromUrl({storeSession:!0}).then(({error:s})=>{if(s)throw new Error("Error getting session from URL.")})}signUp({email:r,password:e,phone:s},a={}){return gt(this,void 0,void 0,function*(){try{this._removeSession();const{data:i,error:o}=s&&e?yield this.api.signUpWithPhone(s,e,{data:a.data,captchaToken:a.captchaToken}):yield this.api.signUpWithEmail(r,e,{redirectTo:a.redirectTo,data:a.data,captchaToken:a.captchaToken});if(o)throw o;if(!i)throw"An error occurred on sign up.";let l=null,c=null;return i.access_token&&(l=i,c=l.user,this._saveSession(l),this._notifyAllSubscribers("SIGNED_IN")),i.id&&(c=i),{user:c,session:l,error:null}}catch(i){return{user:null,session:null,error:i}}})}signIn({email:r,phone:e,password:s,refreshToken:a,provider:i,oidc:o},l={}){return gt(this,void 0,void 0,function*(){try{if(this._removeSession(),r&&!s){const{error:c}=yield this.api.sendMagicLinkEmail(r,{redirectTo:l.redirectTo,shouldCreateUser:l.shouldCreateUser,captchaToken:l.captchaToken});return{user:null,session:null,error:c}}if(r&&s)return this._handleEmailSignIn(r,s,{redirectTo:l.redirectTo,captchaToken:l.captchaToken});if(e&&!s){const{error:c}=yield this.api.sendMobileOTP(e,{shouldCreateUser:l.shouldCreateUser,captchaToken:l.captchaToken});return{user:null,session:null,error:c}}if(e&&s)return this._handlePhoneSignIn(e,s);if(a){const{error:c}=yield this._callRefreshToken(a);if(c)throw c;return{user:this.currentUser,session:this.currentSession,error:null}}if(i)return this._handleProviderSignIn(i,{redirectTo:l.redirectTo,scopes:l.scopes,queryParams:l.queryParams});if(o)return this._handleOpenIDConnectSignIn(o);throw new Error("You must provide either an email, phone number, a third-party provider or OpenID Connect.")}catch(c){return{user:null,session:null,error:c}}})}verifyOTP(r,e={}){return gt(this,void 0,void 0,function*(){try{this._removeSession();const{data:s,error:a}=yield this.api.verifyOTP(r,e);if(a)throw a;if(!s)throw"An error occurred on token verification.";let i=null,o=null;return s.access_token&&(i=s,o=i.user,this._saveSession(i),this._notifyAllSubscribers("SIGNED_IN")),s.id&&(o=s),{user:o,session:i,error:null}}catch(s){return{user:null,session:null,error:s}}})}user(){return this.currentUser}session(){return this.currentSession}refreshSession(){var r;return gt(this,void 0,void 0,function*(){try{if(!(!((r=this.currentSession)===null||r===void 0)&&r.access_token))throw new Error("Not logged in.");const{error:e}=yield this._callRefreshToken();if(e)throw e;return{data:this.currentSession,user:this.currentUser,error:null}}catch(e){return{data:null,user:null,error:e}}})}update(r){var e;return gt(this,void 0,void 0,function*(){try{if(!(!((e=this.currentSession)===null||e===void 0)&&e.access_token))throw new Error("Not logged in.");const{user:s,error:a}=yield this.api.updateUser(this.currentSession.access_token,r);if(a)throw a;if(!s)throw Error("Invalid user data.");const i=Object.assign(Object.assign({},this.currentSession),{user:s});return this._saveSession(i),this._notifyAllSubscribers("USER_UPDATED"),{data:s,user:s,error:null}}catch(s){return{data:null,user:null,error:s}}})}setSession(r){return gt(this,void 0,void 0,function*(){let e;if(typeof r=="string"){const s=r,{data:a,error:i}=yield this.api.refreshAccessToken(s);if(i)return{session:null,error:i};e=a}else{const s=Math.round(Date.now()/1e3);let{refresh_token:a,access_token:i}=r,o=0,l=0;const c=i.split(".");if(c.length!==3)throw new Error("access_token is not a proper JWT");const d=R0(c[1]);let h;try{h=JSON.parse(d)}catch{throw new Error("access_token is not a proper JWT, invalid JSON in body")}if(typeof h=="object"&&h&&typeof h.exp=="number")o=h.exp,l=s-h.exp;else throw new Error("access_token is not a proper JWT, missing exp claim");if(s>o){const{data:f,error:u}=yield this.api.refreshAccessToken(a);if(u)return{session:null,error:u};e=f}else{const{user:f,error:u}=yield this.api.getUser(i);if(u)throw u;e={access_token:i,expires_in:l,expires_at:o,refresh_token:a,token_type:"bearer",user:f}}}try{return this._saveSession(e),this._notifyAllSubscribers("SIGNED_IN"),{session:e,error:null}}catch(s){return{error:s,session:null}}})}setAuth(r){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:r,token_type:"bearer",user:this.user()}),this._notifyAllSubscribers("TOKEN_REFRESHED"),this.currentSession}getSessionFromUrl(r){return gt(this,void 0,void 0,function*(){try{if(!Zt())throw new Error("No browser detected.");const e=Qt("error_description");if(e)throw new Error(e);const s=Qt("provider_token"),a=Qt("provider_refresh_token"),i=Qt("access_token");if(!i)throw new Error("No access_token detected.");const o=Qt("expires_in");if(!o)throw new Error("No expires_in detected.");const l=Qt("refresh_token");if(!l)throw new Error("No refresh_token detected.");const c=Qt("token_type");if(!c)throw new Error("No token_type detected.");const h=Math.round(Date.now()/1e3)+parseInt(o),{user:f,error:u}=yield this.api.getUser(i);if(u)throw u;const m={provider_token:s,provider_refresh_token:a,access_token:i,expires_in:parseInt(o),expires_at:h,refresh_token:l,token_type:c,user:f};if(r?.storeSession){this._saveSession(m);const p=Qt("type");this._notifyAllSubscribers("SIGNED_IN"),p==="recovery"&&this._notifyAllSubscribers("PASSWORD_RECOVERY")}return window.location.hash="",{data:m,error:null}}catch(e){return{data:null,error:e}}})}signOut(){var r;return gt(this,void 0,void 0,function*(){const e=(r=this.currentSession)===null||r===void 0?void 0:r.access_token;if(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),e){const{error:s}=yield this.api.signOut(e);if(s)return{error:s}}return{error:null}})}onAuthStateChange(r){try{const e=_0(),s={id:e,callback:r,unsubscribe:()=>{this.stateChangeEmitters.delete(e)}};return this.stateChangeEmitters.set(e,s),{data:s,error:null}}catch(e){return{data:null,error:e}}}_handleEmailSignIn(r,e,s={}){var a,i;return gt(this,void 0,void 0,function*(){try{const{data:o,error:l}=yield this.api.signInWithEmail(r,e,{redirectTo:s.redirectTo,captchaToken:s.captchaToken});return l||!o?{data:null,user:null,session:null,error:l}:((!((a=o?.user)===null||a===void 0)&&a.confirmed_at||!((i=o?.user)===null||i===void 0)&&i.email_confirmed_at)&&(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN")),{data:o,user:o.user,session:o,error:null})}catch(o){return{data:null,user:null,session:null,error:o}}})}_handlePhoneSignIn(r,e,s={}){var a;return gt(this,void 0,void 0,function*(){try{const{data:i,error:o}=yield this.api.signInWithPhone(r,e,s);return o||!i?{data:null,user:null,session:null,error:o}:(!((a=i?.user)===null||a===void 0)&&a.phone_confirmed_at&&(this._saveSession(i),this._notifyAllSubscribers("SIGNED_IN")),{data:i,user:i.user,session:i,error:null})}catch(i){return{data:null,user:null,session:null,error:i}}})}_handleProviderSignIn(r,e={}){const s=this.api.getUrlForProvider(r,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});try{return Zt()&&(window.location.href=s),{provider:r,url:s,data:null,session:null,user:null,error:null}}catch(a){return s?{provider:r,url:s,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:a}}}_handleOpenIDConnectSignIn({id_token:r,nonce:e,client_id:s,issuer:a,provider:i}){return gt(this,void 0,void 0,function*(){if(r&&e&&(s&&a||i))try{const{data:o,error:l}=yield this.api.signInWithOpenIDConnect({id_token:r,nonce:e,client_id:s,issuer:a,provider:i});return l||!o?{user:null,session:null,error:l}:(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN"),{user:o.user,session:o,error:null})}catch(o){return{user:null,session:null,error:o}}throw new Error("You must provide a OpenID Connect provider with your id token and nonce.")})}_recoverSession(){try{const r=E0(this.localStorage,hs);if(!r)return null;const{currentSession:e,expiresAt:s}=r,a=Math.round(Date.now()/1e3);s>=a+Hs&&e?.user&&(this._saveSession(e),this._notifyAllSubscribers("SIGNED_IN"))}catch(r){console.log("error",r)}}_recoverAndRefresh(){return gt(this,void 0,void 0,function*(){try{const r=yield j0(this.localStorage,hs);if(!r)return null;const{currentSession:e,expiresAt:s}=r,a=Math.round(Date.now()/1e3);if(s<a+Hs)if(this.autoRefreshToken&&e.refresh_token){this.networkRetries++;const{error:i}=yield this._callRefreshToken(e.refresh_token);if(i){if(console.log(i.message),i.message===br.ERROR_MESSAGE&&this.networkRetries<br.MAX_RETRIES){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),this.refreshTokenTimer=setTimeout(()=>this._recoverAndRefresh(),Math.pow(br.RETRY_INTERVAL,this.networkRetries)*100);return}yield this._removeSession()}this.networkRetries=0}else this._removeSession();else e?(this._saveSession(e),this._notifyAllSubscribers("SIGNED_IN")):(console.log("Current session is missing data."),this._removeSession())}catch(r){return console.error(r),null}})}_callRefreshToken(r){var e;return r===void 0&&(r=(e=this.currentSession)===null||e===void 0?void 0:e.refresh_token),gt(this,void 0,void 0,function*(){try{if(!r)throw new Error("No current session.");const{data:s,error:a}=yield this.api.refreshAccessToken(r);if(a)throw a;if(!s)throw Error("Invalid session data.");return this._saveSession(s),this._notifyAllSubscribers("TOKEN_REFRESHED"),this._notifyAllSubscribers("SIGNED_IN"),{data:s,error:null}}catch(s){return{data:null,error:s}}})}_notifyAllSubscribers(r){this.stateChangeEmitters.forEach(e=>e.callback(r,this.currentSession))}_saveSession(r){this.currentSession=r,this.currentUser=r.user;const e=r.expires_at;if(e){const s=Math.round(Date.now()/1e3),a=e-s,i=a>Hs?Hs:.5;this._startAutoRefreshToken((a-i)*1e3)}this.persistSession&&r.expires_at&&this._persistSession(this.currentSession)}_persistSession(r){const e={currentSession:r,expiresAt:r.expires_at};N0(this.localStorage,hs,e)}_removeSession(){return gt(this,void 0,void 0,function*(){this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),T0(this.localStorage,hs)})}_startAutoRefreshToken(r){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),!(r<=0||!this.autoRefreshToken)&&(this.refreshTokenTimer=setTimeout(()=>gt(this,void 0,void 0,function*(){this.networkRetries++;const{error:e}=yield this._callRefreshToken();e||(this.networkRetries=0),e?.message===br.ERROR_MESSAGE&&this.networkRetries<br.MAX_RETRIES&&this._startAutoRefreshToken(Math.pow(br.RETRY_INTERVAL,this.networkRetries)*100)}),r),typeof this.refreshTokenTimer.unref=="function"&&this.refreshTokenTimer.unref())}_listenForMultiTabEvents(){if(!this.multiTab||!Zt()||!window?.addEventListener)return!1;try{window?.addEventListener("storage",r=>{var e;if(r.key===hs){const s=JSON.parse(String(r.newValue));!((e=s?.currentSession)===null||e===void 0)&&e.access_token?(this._saveSession(s.currentSession),this._notifyAllSubscribers("SIGNED_IN")):(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"))}})}catch(r){console.error("_listenForMultiTabEvents",r)}}_handleVisibilityChange(){if(!this.multiTab||!Zt()||!window?.addEventListener)return!1;try{window?.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this._recoverAndRefresh()})}catch(r){console.error("_handleVisibilityChange",r)}}}class D0 extends F0{constructor(r){super(r)}}var di=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};class ka{constructor(r){Object.assign(this,r);let e;r.fetch?e=r.fetch:typeof fetch>"u"?e=(...s)=>di(this,void 0,void 0,function*(){return yield(yield Cn(()=>import("./browser-ponyfill-DIMAIuBD.js").then(a=>a.b),__vite__mapDeps([0,1]))).fetch(...s)}):e=fetch,this.fetch=(...s)=>e(...s),this.shouldThrowOnError=r.shouldThrowOnError||!1,this.allowEmpty=r.allowEmpty||!1}throwOnError(r){return r==null&&(r=!0),this.shouldThrowOnError=r,this}then(r,e){typeof this.schema>"u"||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let s=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(a=>di(this,void 0,void 0,function*(){var i,o,l,c;let d=null,h=null,f=null,u=a.status,m=a.statusText;if(a.ok){const x=(i=this.headers.Prefer)===null||i===void 0?void 0:i.split(",").includes("return=minimal");if(this.method!=="HEAD"&&!x){const w=yield a.text();w&&(this.headers.Accept==="text/csv"?h=w:h=JSON.parse(w))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),j=(l=a.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");g&&j&&j.length>1&&(f=parseInt(j[1]))}else{const x=yield a.text();try{d=JSON.parse(x)}catch{d={message:x}}if(d&&this.allowEmpty&&(!((c=d?.details)===null||c===void 0)&&c.includes("Results contain 0 rows"))&&(d=null,u=200,m="OK"),d&&this.shouldThrowOnError)throw d}return{error:d,data:h,count:f,status:u,statusText:m,body:h}}));return this.shouldThrowOnError||(s=s.catch(a=>({error:{message:`FetchError: ${a.message}`,details:"",hint:"",code:a.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}))),s.then(r,e)}}class O0 extends ka{select(r="*"){let e=!1;const s=r.split("").map(a=>/\s/.test(a)&&!e?"":(a==='"'&&(e=!e),a)).join("");return this.url.searchParams.set("select",s),this}order(r,{ascending:e=!0,nullsFirst:s=!1,foreignTable:a}={}){const i=typeof a>"u"?"order":`${a}.order`,o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${r}.${e?"asc":"desc"}.${s?"nullsfirst":"nullslast"}`),this}limit(r,{foreignTable:e}={}){const s=typeof e>"u"?"limit":`${e}.limit`;return this.url.searchParams.set(s,`${r}`),this}range(r,e,{foreignTable:s}={}){const a=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${r}`),this.url.searchParams.set(i,`${e-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers.Accept="application/vnd.pgrst.object+json",this.allowEmpty=!0,this}csv(){return this.headers.Accept="text/csv",this}}class Ur extends O0{constructor(){super(...arguments),this.cs=this.contains,this.cd=this.containedBy,this.sl=this.rangeLt,this.sr=this.rangeGt,this.nxl=this.rangeGte,this.nxr=this.rangeLte,this.adj=this.rangeAdjacent,this.ov=this.overlaps}not(r,e,s){return this.url.searchParams.append(`${r}`,`not.${e}.${s}`),this}or(r,{foreignTable:e}={}){const s=typeof e>"u"?"or":`${e}.or`;return this.url.searchParams.append(s,`(${r})`),this}eq(r,e){return this.url.searchParams.append(`${r}`,`eq.${e}`),this}neq(r,e){return this.url.searchParams.append(`${r}`,`neq.${e}`),this}gt(r,e){return this.url.searchParams.append(`${r}`,`gt.${e}`),this}gte(r,e){return this.url.searchParams.append(`${r}`,`gte.${e}`),this}lt(r,e){return this.url.searchParams.append(`${r}`,`lt.${e}`),this}lte(r,e){return this.url.searchParams.append(`${r}`,`lte.${e}`),this}like(r,e){return this.url.searchParams.append(`${r}`,`like.${e}`),this}ilike(r,e){return this.url.searchParams.append(`${r}`,`ilike.${e}`),this}is(r,e){return this.url.searchParams.append(`${r}`,`is.${e}`),this}in(r,e){const s=e.map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(`${r}`,`in.(${s})`),this}contains(r,e){return typeof e=="string"?this.url.searchParams.append(`${r}`,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(`${r}`,`cs.{${e.join(",")}}`):this.url.searchParams.append(`${r}`,`cs.${JSON.stringify(e)}`),this}containedBy(r,e){return typeof e=="string"?this.url.searchParams.append(`${r}`,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(`${r}`,`cd.{${e.join(",")}}`):this.url.searchParams.append(`${r}`,`cd.${JSON.stringify(e)}`),this}rangeLt(r,e){return this.url.searchParams.append(`${r}`,`sl.${e}`),this}rangeGt(r,e){return this.url.searchParams.append(`${r}`,`sr.${e}`),this}rangeGte(r,e){return this.url.searchParams.append(`${r}`,`nxl.${e}`),this}rangeLte(r,e){return this.url.searchParams.append(`${r}`,`nxr.${e}`),this}rangeAdjacent(r,e){return this.url.searchParams.append(`${r}`,`adj.${e}`),this}overlaps(r,e){return typeof e=="string"?this.url.searchParams.append(`${r}`,`ov.${e}`):this.url.searchParams.append(`${r}`,`ov.{${e.join(",")}}`),this}textSearch(r,e,{config:s,type:a=null}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(`${r}`,`${i}fts${o}.${e}`),this}fts(r,e,{config:s}={}){const a=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`fts${a}.${e}`),this}plfts(r,e,{config:s}={}){const a=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`plfts${a}.${e}`),this}phfts(r,e,{config:s}={}){const a=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`phfts${a}.${e}`),this}wfts(r,e,{config:s}={}){const a=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`wfts${a}.${e}`),this}filter(r,e,s){return this.url.searchParams.append(`${r}`,`${e}.${s}`),this}match(r){return Object.keys(r).forEach(e=>{this.url.searchParams.append(`${e}`,`eq.${r[e]}`)}),this}}class xo extends ka{constructor(r,{headers:e={},schema:s,fetch:a,shouldThrowOnError:i}={}){super({fetch:a,shouldThrowOnError:i}),this.url=new URL(r),this.headers=Object.assign({},e),this.schema=s}select(r="*",{head:e=!1,count:s=null}={}){this.method="GET";let a=!1;const i=r.split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),s&&(this.headers.Prefer=`count=${s}`),e&&(this.method="HEAD"),new Ur(this)}insert(r,{upsert:e=!1,onConflict:s,returning:a="representation",count:i=null}={}){this.method="POST";const o=[`return=${a}`];if(e&&o.push("resolution=merge-duplicates"),e&&s!==void 0&&this.url.searchParams.set("on_conflict",s),this.body=r,i&&o.push(`count=${i}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),Array.isArray(r)){const l=r.reduce((c,d)=>c.concat(Object.keys(d)),[]);if(l.length>0){const c=[...new Set(l)].map(d=>`"${d}"`);this.url.searchParams.set("columns",c.join(","))}}return new Ur(this)}upsert(r,{onConflict:e,returning:s="representation",count:a=null,ignoreDuplicates:i=!1}={}){this.method="POST";const o=[`resolution=${i?"ignore":"merge"}-duplicates`,`return=${s}`];return e!==void 0&&this.url.searchParams.set("on_conflict",e),this.body=r,a&&o.push(`count=${a}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new Ur(this)}update(r,{returning:e="representation",count:s=null}={}){this.method="PATCH";const a=[`return=${e}`];return this.body=r,s&&a.push(`count=${s}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new Ur(this)}delete({returning:r="representation",count:e=null}={}){this.method="DELETE";const s=[`return=${r}`];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Ur(this)}}class I0 extends ka{constructor(r,{headers:e={},schema:s,fetch:a,shouldThrowOnError:i}={}){super({fetch:a,shouldThrowOnError:i}),this.url=new URL(r),this.headers=Object.assign({},e),this.schema=s}rpc(r,{head:e=!1,count:s=null}={}){return e?(this.method="HEAD",r&&Object.entries(r).forEach(([a,i])=>{this.url.searchParams.append(a,i)})):(this.method="POST",this.body=r),s&&(this.headers.Prefer!==void 0?this.headers.Prefer+=`,count=${s}`:this.headers.Prefer=`count=${s}`),new Ur(this)}}const P0="0.37.4",L0={"X-Client-Info":`postgrest-js/${P0}`};class B0{constructor(r,{headers:e={},schema:s,fetch:a,throwOnError:i}={}){this.url=r,this.headers=Object.assign(Object.assign({},L0),e),this.schema=s,this.fetch=a,this.shouldThrowOnError=i}auth(r){return this.headers.Authorization=`Bearer ${r}`,this}from(r){const e=`${this.url}/${r}`;return new xo(e,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(r,e,{head:s=!1,count:a=null}={}){const i=`${this.url}/rpc/${r}`;return new I0(i,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError}).rpc(e,{head:s,count:a})}}var Me;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Me||(Me={}));const hi=(t,r,e={})=>{var s;const a=(s=e.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(r).reduce((i,o)=>(i[o]=M0(o,t,r,a),i),{})},M0=(t,r,e,s)=>{const a=r.find(l=>l.name===t),i=a?.type,o=e[t];return i&&!s.includes(i)?mo(i,o):ha(o)},mo=(t,r)=>{if(t.charAt(0)==="_"){const e=t.slice(1,t.length);return H0(r,e)}switch(t){case Me.bool:return z0(r);case Me.float4:case Me.float8:case Me.int2:case Me.int4:case Me.int8:case Me.numeric:case Me.oid:return U0(r);case Me.json:case Me.jsonb:return $0(r);case Me.timestamp:return W0(r);case Me.abstime:case Me.date:case Me.daterange:case Me.int4range:case Me.int8range:case Me.money:case Me.reltime:case Me.text:case Me.time:case Me.timestamptz:case Me.timetz:case Me.tsrange:case Me.tstzrange:return ha(r);default:return ha(r)}},ha=t=>t,z0=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},U0=t=>{if(typeof t=="string"){const r=parseFloat(t);if(!Number.isNaN(r))return r}return t},$0=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(r){return console.log(`JSON parse error: ${r}`),t}return t},H0=(t,r)=>{if(typeof t!="string")return t;const e=t.length-1,s=t[e];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,e);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>mo(r,l))}return t},W0=t=>typeof t=="string"?t.replace(" ","T"):t;var Vn,fi;function G0(){if(fi)return Vn;fi=1;var t=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return Vn=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}(),Vn}const V0="1.0.35",X0={version:V0};var K0=X0.version,wr;if(typeof globalThis=="object")wr=globalThis;else try{wr=G0()}catch{}finally{if(!wr&&typeof window<"u"&&(wr=window),!wr)throw new Error("Could not determine global this")}var Ss=wr.WebSocket||wr.MozWebSocket,Y0=K0;function po(t,r){var e;return r?e=new Ss(t,r):e=new Ss(t),e}Ss&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(t){Object.defineProperty(po,t,{get:function(){return Ss[t]}})});var q0={w3cwebsocket:Ss?po:null,version:Y0};const J0="1.7.5",Q0={"X-Client-Info":`realtime-js/${J0}`},Z0="1.0.0",go=1e4,ed=1e3;var ms;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ms||(ms={}));var _t;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(_t||(_t={}));var Bt;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(Bt||(Bt={}));var fa;(function(t){t.websocket="websocket"})(fa||(fa={}));var _r;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(_r||(_r={}));class vo{constructor(r,e){this.callback=r,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class td{constructor(){this.HEADER_LENGTH=1}decode(r,e){return r.constructor===ArrayBuffer?e(this._binaryDecode(r)):e(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const e=new DataView(r),s=new TextDecoder;return this._decodeBroadcast(r,e,s)}_decodeBroadcast(r,e,s){const a=e.getUint8(1),i=e.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(r.slice(o,o+a));o=o+a;const c=s.decode(r.slice(o,o+i));o=o+i;const d=JSON.parse(s.decode(r.slice(o,r.byteLength)));return{ref:null,topic:l,event:c,payload:d}}}class Xn{constructor(r,e,s={},a=go){this.channel=r,this.event=e,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel.joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,e){var s;return this._hasReceived(r)&&e((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:r,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref);const r=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel.on(this.refEvent,r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,e){this.refEvent&&this.channel.trigger(this.refEvent,{status:r,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:e}){this.recHooks.filter(s=>s.status===r).forEach(s=>s.callback(e))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}class rd{constructor(r,e={},s){this.topic=r,this.params=e,this.socket=s,this.bindings=[],this.state=_t.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new Xn(this,Bt.join,this.params,this.timeout),this.rejoinTimer=new vo(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=_t.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=_t.closed,this.socket.remove(this)}),this.onError(a=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this.isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=_t.errored,this.rejoinTimer.scheduleTimeout())}),this.on(Bt.reply,(a,i)=>{this.trigger(this.replyEventName(i),a)})}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(r=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(r),this.joinPush}onClose(r){this.on(Bt.close,r)}onError(r){this.on(Bt.error,e=>r(e))}on(r,e){this.bindings.push({event:r,callback:e})}off(r){this.bindings=this.bindings.filter(e=>e.event!==r)}canPush(){return this.socket.isConnected()&&this.isJoined()}push(r,e,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new Xn(this,r,e,s);return this.canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=_t.leaving;let e=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger(Bt.close,"leave",this.joinRef())};this.joinPush.destroy();let s=new Xn(this,Bt.leave,{},r);return s.receive("ok",()=>e()).receive("timeout",()=>e()),s.send(),this.canPush()||s.trigger("ok",{}),s}onMessage(r,e,s){return e}isMember(r){return this.topic===r}joinRef(){return this.joinPush.ref}rejoin(r=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=_t.joining,this.joinPush.resend(r))}trigger(r,e,s){let{close:a,error:i,leave:o,join:l}=Bt;if(s&&[a,i,o,l].indexOf(r)>=0&&s!==this.joinRef())return;let d=this.onMessage(r,e,s);if(e&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(h=>h.event==="*"?r===e?.type:h.event===r).map(h=>h.callback(d,s))}replyEventName(r){return`chan_reply_${r}`}isClosed(){return this.state===_t.closed}isErrored(){return this.state===_t.errored}isJoined(){return this.state===_t.joined}isJoining(){return this.state===_t.joining}isLeaving(){return this.state===_t.leaving}}var sd=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};const nd=()=>{};class ad{constructor(r,e){this.accessToken=null,this.channels=[],this.endPoint="",this.headers=Q0,this.params={},this.timeout=go,this.transport=q0.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=nd,this.conn=null,this.sendBuffer=[],this.serializer=new td,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.endPoint=`${r}/${fa.websocket}`,e?.params&&(this.params=e.params),e?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e?.timeout&&(this.timeout=e.timeout),e?.logger&&(this.logger=e.logger),e?.transport&&(this.transport=e.transport),e?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs),e?.longpollerTimeout&&(this.longpollerTimeout=e.longpollerTimeout),this.reconnectAfterMs=e?.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e?.encode?e.encode:(s,a)=>a(JSON.stringify(s)),this.decode=e?.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new vo(()=>sd(this,void 0,void 0,function*(){yield this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this.onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r)))}disconnect(r,e){return new Promise((s,a)=>{try{this.conn&&(this.conn.onclose=function(){},r?this.conn.close(r,e||""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset()),s({error:null,data:!0})}catch(i){s({error:i,data:!1})}})}log(r,e,s){this.logger(r,e,s)}onOpen(r){this.stateChangeCallbacks.open.push(r)}onClose(r){this.stateChangeCallbacks.close.push(r)}onError(r){this.stateChangeCallbacks.error.push(r)}onMessage(r){this.stateChangeCallbacks.message.push(r)}connectionState(){switch(this.conn&&this.conn.readyState){case ms.connecting:return _r.Connecting;case ms.open:return _r.Open;case ms.closing:return _r.Closing;default:return _r.Closed}}isConnected(){return this.connectionState()===_r.Open}remove(r){this.channels=this.channels.filter(e=>e.joinRef()!==r.joinRef())}channel(r,e={}){const s=new rd(r,e,this);return this.channels.push(s),s}push(r){const{topic:e,event:s,payload:a,ref:i}=r;let o=()=>{this.encode(r,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${e} ${s} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}onConnMessage(r){this.decode(r.data,e=>{let{topic:s,event:a,payload:i,ref:o}=e;(o&&o===this.pendingHeartbeatRef||a===i?.type)&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${a} ${o&&"("+o+")"||""}`,i),this.channels.filter(l=>l.isMember(s)).forEach(l=>l.trigger(a,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(e))})}endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:Z0}))}makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}setAuth(r){this.accessToken=r,this.channels.forEach(e=>{r&&e.updateJoinPayload({user_token:r}),e.joinedOnce&&e.isJoined()&&e.push(Bt.access_token,{access_token:r})})}leaveOpenTopic(r){let e=this.channels.find(s=>s.topic===r&&(s.isJoined()||s.isJoining()));e&&(this.log("transport",`leaving duplicate topic "${r}"`),e.unsubscribe())}_onConnOpen(){this.log("transport",`connected to ${this.endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(r=>r())}_onConnClose(r){this.log("transport","close",r),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(r))}_onConnError(r){this.log("transport",r.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(r))}_triggerChanError(){this.channels.forEach(r=>r.trigger(Bt.error))}_appendParams(r,e){if(Object.keys(e).length===0)return r;const s=r.match(/\?/)?"&":"?",a=new URLSearchParams(e);return`${r}${s}${a}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_sendHeartbeat(){var r;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(r=this.conn)===null||r===void 0||r.close(ed,"hearbeat timeout");return}this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class id{constructor(r,e,s,a){const i={},o=a==="*"?`realtime:${s}`:`realtime:${s}:${a}`,l=e.Authorization.split(" ")[1];l&&(i.user_token=l),this.subscription=r.channel(o,i)}getPayloadRecords(r){const e={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(e.new=hi(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(e.old=hi(r.columns,r.old_record)),e}on(r,e){return this.subscription.on(r,s=>{let a={schema:s.schema,table:s.table,commit_timestamp:s.commit_timestamp,eventType:s.type,new:{},old:{},errors:s.errors};a=Object.assign(Object.assign({},a),this.getPayloadRecords(s)),e(a)}),this}subscribe(r=()=>{}){return this.subscription.onError(e=>r("SUBSCRIPTION_ERROR",e)),this.subscription.onClose(()=>r("CLOSED")),this.subscription.subscribe().receive("ok",()=>r("SUBSCRIBED")).receive("error",e=>r("SUBSCRIPTION_ERROR",e)).receive("timeout",()=>r("RETRYING_AFTER_TIMEOUT")),this.subscription}}class od extends xo{constructor(r,{headers:e={},schema:s,realtime:a,table:i,fetch:o,shouldThrowOnError:l}){super(r,{headers:e,schema:s,fetch:o,shouldThrowOnError:l}),this._subscription=null,this._realtime=a,this._headers=e,this._schema=s,this._table=i}on(r,e){return this._realtime.isConnected()||this._realtime.connect(),this._subscription||(this._subscription=new id(this._realtime,this._headers,this._schema,this._table)),this._subscription.on(r,e)}}const ld="1.7.3",cd={"X-Client-Info":`storage-js/${ld}`};var Ds=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};const dd=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),hd=(t,r)=>{if(typeof t.json!="function")return r(t);t.json().then(e=>r({message:dd(e),status:t?.status||500}))},fd=(t,r,e,s)=>{const a={method:t,headers:r?.headers||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},r?.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),e))};function An(t,r,e,s,a,i){return Ds(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(e,fd(r,s,a,i)).then(c=>{if(!c.ok)throw c;return s?.noResolveJson?o(c):c.json()}).then(c=>o(c)).catch(c=>hd(c,l))})})}function ua(t,r,e,s){return Ds(this,void 0,void 0,function*(){return An(t,"GET",r,e,s)})}function Sr(t,r,e,s,a){return Ds(this,void 0,void 0,function*(){return An(t,"POST",r,s,a,e)})}function ud(t,r,e,s,a){return Ds(this,void 0,void 0,function*(){return An(t,"PUT",r,s,a,e)})}function yo(t,r,e,s,a){return Ds(this,void 0,void 0,function*(){return An(t,"DELETE",r,s,a,e)})}var xd=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};const bo=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>xd(void 0,void 0,void 0,function*(){return yield(yield Cn(()=>import("./browser-ponyfill-DIMAIuBD.js").then(s=>s.b),__vite__mapDeps([0,1]))).fetch(...e)}):r=fetch,(...e)=>r(...e)};var Lr=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};class md{constructor(r,e={},s){this.url=r,this.headers=Object.assign(Object.assign({},cd),e),this.fetch=bo(s)}listBuckets(){return Lr(this,void 0,void 0,function*(){try{return{data:yield ua(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}getBucket(r){return Lr(this,void 0,void 0,function*(){try{return{data:yield ua(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}createBucket(r,e={public:!1}){return Lr(this,void 0,void 0,function*(){try{return{data:(yield Sr(this.fetch,`${this.url}/bucket`,{id:r,name:r,public:e.public},{headers:this.headers})).name,error:null}}catch(s){return{data:null,error:s}}})}updateBucket(r,e){return Lr(this,void 0,void 0,function*(){try{return{data:yield ud(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:e.public},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}emptyBucket(r){return Lr(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}deleteBucket(r){return Lr(this,void 0,void 0,function*(){try{return{data:yield yo(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}}var Gt=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};const pd={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},gd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class vd{constructor(r,e={},s,a){this.url=r,this.headers=e,this.bucketId=s,this.fetch=bo(a)}uploadOrUpdate(r,e,s,a){return Gt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},gd),a),l=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl)):(i=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType);const c=this._removeEmptyFolders(e),d=this._getFinalPath(c),h=yield this.fetch(`${this.url}/object/${d}`,{method:r,body:i,headers:l});return h.ok?{data:{Key:d},error:null}:{data:null,error:yield h.json()}}catch(i){return{data:null,error:i}}})}upload(r,e,s){return Gt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,e,s)})}update(r,e,s){return Gt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,e,s)})}move(r,e){return Gt(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}copy(r,e){return Gt(this,void 0,void 0,function*(){try{return{data:yield Sr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}createSignedUrl(r,e){return Gt(this,void 0,void 0,function*(){try{const s=this._getFinalPath(r);let a=yield Sr(this.fetch,`${this.url}/object/sign/${s}`,{expiresIn:e},{headers:this.headers});const i=`${this.url}${a.signedURL}`;return a={signedURL:i},{data:a,error:null,signedURL:i}}catch(s){return{data:null,error:s,signedURL:null}}})}createSignedUrls(r,e){return Gt(this,void 0,void 0,function*(){try{return{data:(yield Sr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:r},{headers:this.headers})).map(a=>Object.assign(Object.assign({},a),{signedURL:a.signedURL?`${this.url}${a.signedURL}`:null})),error:null}}catch(s){return{data:null,error:s}}})}download(r){return Gt(this,void 0,void 0,function*(){try{const e=this._getFinalPath(r);return{data:yield(yield ua(this.fetch,`${this.url}/object/${e}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(e){return{data:null,error:e}}})}getPublicUrl(r){try{const e=this._getFinalPath(r),s=`${this.url}/object/public/${e}`;return{data:{publicURL:s},error:null,publicURL:s}}catch(e){return{data:null,error:e,publicURL:null}}}remove(r){return Gt(this,void 0,void 0,function*(){try{return{data:yield yo(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}list(r,e,s){return Gt(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},pd),e),{prefix:r||""});return{data:yield Sr(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){return{data:null,error:a}}})}_getFinalPath(r){return`${this.bucketId}/${r}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}}class yd extends md{constructor(r,e={},s){super(r,e,s)}from(r){return new vd(this.url,this.headers,r,this.fetch)}}var bd=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};const wd=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>bd(void 0,void 0,void 0,function*(){return yield(yield Cn(()=>import("./browser-ponyfill-DIMAIuBD.js").then(s=>s.b),__vite__mapDeps([0,1]))).fetch(...e)}):r=fetch,(...e)=>r(...e)};var _d=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};class Sd{constructor(r,{headers:e={},customFetch:s}={}){this.url=r,this.headers=e,this.fetch=wd(s)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,e){return _d(this,void 0,void 0,function*(){try{const{headers:s,body:a}=e??{},i=yield this.fetch(`${this.url}/${r}`,{method:"POST",headers:Object.assign({},this.headers,s),body:a}),o=i.headers.get("x-relay-error");if(o&&o==="true")return{data:null,error:new Error(yield i.text())};let l;const{responseType:c}=e??{};return!c||c==="json"?l=yield i.json():c==="arrayBuffer"?l=yield i.arrayBuffer():c==="blob"?l=yield i.blob():l=yield i.text(),{data:l,error:null}}catch(s){return{data:null,error:s}}})}}var Kn=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):a(h.value).then(l,c)}d((s=s.apply(t,r||[])).next())})};const Nd={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:uo};class jd{constructor(r,e,s){if(this.supabaseUrl=r,this.supabaseKey=e,!r)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const a=o0(r),i=Object.assign(Object.assign({},Nd),s);if(this.restUrl=`${a}/rest/v1`,this.realtimeUrl=`${a}/realtime/v1`.replace("http","ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,a.match(/(supabase\.co)|(supabase\.in)/)){const l=a.split(".");this.functionsUrl=`${l[0]}.functions.${l[1]}.${l[2]}`}else this.functionsUrl=`${a}/functions/v1`;this.schema=i.schema,this.multiTab=i.multiTab,this.fetch=i.fetch,this.headers=Object.assign(Object.assign({},uo),s?.headers),this.shouldThrowOnError=i.shouldThrowOnError||!1,this.auth=this._initSupabaseAuthClient(i),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},i.realtime)),this._listenForAuthEvents(),this._listenForMultiTabEvents()}get functions(){return new Sd(this.functionsUrl,{headers:this._getAuthHeaders(),customFetch:this.fetch})}get storage(){return new yd(this.storageUrl,this._getAuthHeaders(),this.fetch)}from(r){const e=`${this.restUrl}/${r}`;return new od(e,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:r,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(r,e,{head:s=!1,count:a=null}={}){return this._initPostgRESTClient().rpc(r,e,{head:s,count:a})}removeAllSubscriptions(){return Kn(this,void 0,void 0,function*(){const r=this.getSubscriptions().slice(),e=r.map(a=>this.removeSubscription(a));return(yield Promise.all(e)).map(({error:a},i)=>({data:{subscription:r[i]},error:a}))})}removeSubscription(r){return Kn(this,void 0,void 0,function*(){const{error:e}=yield this._closeSubscription(r),s=this.getSubscriptions(),a=s.filter(i=>i.isJoined()).length;return s.length===0&&(yield this.realtime.disconnect()),{data:{openSubscriptions:a},error:e}})}_closeSubscription(r){return Kn(this,void 0,void 0,function*(){let e=null;if(!r.isClosed()){const{error:s}=yield this._unsubscribeSubscription(r);e=s}return this.realtime.remove(r),{error:e}})}_unsubscribeSubscription(r){return new Promise(e=>{r.unsubscribe().receive("ok",()=>e({error:null})).receive("error",s=>e({error:s})).receive("timeout",()=>e({error:new Error("timed out")}))})}getSubscriptions(){return this.realtime.channels}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:e,detectSessionInUrl:s,localStorage:a,headers:i,fetch:o,cookieOptions:l,multiTab:c}){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new D0({url:this.authUrl,headers:Object.assign(Object.assign({},i),d),autoRefreshToken:r,persistSession:e,detectSessionInUrl:s,localStorage:a,fetch:o,cookieOptions:l,multiTab:c})}_initRealtimeClient(r){return new ad(this.realtimeUrl,Object.assign(Object.assign({},r),{params:Object.assign(Object.assign({},r?.params),{apikey:this.supabaseKey})}))}_initPostgRESTClient(){return new B0(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch,throwOnError:this.shouldThrowOnError})}_getAuthHeaders(){var r,e;const s=Object.assign({},this.headers),a=(e=(r=this.auth.session())===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:this.supabaseKey;return s.apikey=this.supabaseKey,s.Authorization=s.Authorization||`Bearer ${a}`,s}_listenForMultiTabEvents(){if(!this.multiTab||!l0()||!window?.addEventListener)return null;try{return window?.addEventListener("storage",r=>{var e,s,a;if(r.key===i0){const i=JSON.parse(String(r.newValue)),o=(s=(e=i?.currentSession)===null||e===void 0?void 0:e.access_token)!==null&&s!==void 0?s:void 0,l=(a=this.auth.session())===null||a===void 0?void 0:a.access_token;o?!l&&o?this._handleTokenChanged("SIGNED_IN",o,"STORAGE"):l!==o&&this._handleTokenChanged("TOKEN_REFRESHED",o,"STORAGE"):this._handleTokenChanged("SIGNED_OUT",o,"STORAGE")}})}catch(r){return console.error("_listenForMultiTabEvents",r),null}}_listenForAuthEvents(){let{data:r}=this.auth.onAuthStateChange((e,s)=>{this._handleTokenChanged(e,s?.access_token,"CLIENT")});return r}_handleTokenChanged(r,e,s){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==e?(this.realtime.setAuth(e),s=="STORAGE"&&this.auth.setAuth(e),this.changedAccessToken=e):(r==="SIGNED_OUT"||r==="USER_DELETED")&&(this.realtime.setAuth(this.supabaseKey),s=="STORAGE"&&this.auth.signOut())}}const Ed=(t,r,e)=>new jd(t,r,e),Td="https://sgxnxbhbyvrmgrzhosyh.supabase.co",Cd="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNneG54YmhieXZybWdyemhvc3loIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5MDAzMzMsImV4cCI6MjA3MzQ3NjMzM30.1qS_3Qr-zv7woSyPbkdiLkhuXp2pVHJHGiF3iKWEBkc",ue=Ed(Td,Cd),xa={getUsers:()=>JSON.parse(localStorage.getItem("las_users")||"[]"),setUsers:t=>localStorage.setItem("las_users",JSON.stringify(t)),getWorkDiaries:()=>JSON.parse(localStorage.getItem("las_work_diaries")||"[]"),setWorkDiaries:t=>localStorage.setItem("las_work_diaries",JSON.stringify(t)),getSales:()=>JSON.parse(localStorage.getItem("las_sales")||"[]"),setSales:t=>localStorage.setItem("las_sales",JSON.stringify(t)),getCurrentUser:()=>JSON.parse(localStorage.getItem("las_current_user")||"null"),setCurrentUser:t=>localStorage.setItem("las_current_user",JSON.stringify(t)),clearCurrentUser:()=>localStorage.removeItem("las_current_user"),initAdmin:()=>{if(xa.getUsers().length===0){const r={id:"1",email:"admin@las.com",password:"admin123",name:"시스템관리자",branch:"본사",phone:"010-0000-0000",userType:"관리자",status:"approved",createdAt:new Date().toISOString(),approvedAt:new Date().toISOString()};xa.setUsers([r]),console.log("✅ 초기 관리자 계정 생성됨: admin@las.com / admin123")}}};xa.initAdmin();const on={EMPLOYEE:"employee",MANAGER:"manager"},er={MONITORING_AGENT:"모니터링요원",CONTRACT_WORKER:"계약근무",STORE_MANAGER:"점장",BRANCH_MANAGER:"지점관리자",SYSTEM_ADMIN:"시스템관리자"},kd=t=>t?t.user_type===er.MONITORING_AGENT:!1,Ad=t=>t?t.user_type===er.CONTRACT_WORKER:!1,fs=t=>t?t.user_type===er.STORE_MANAGER||t.user_type===er.BRANCH_MANAGER||t.user_type===er.SYSTEM_ADMIN:!1,qr=t=>t?t.user_type===er.SYSTEM_ADMIN:!1,Rd=t=>t?t.user_type===er.STORE_MANAGER||t.user_type===er.BRANCH_MANAGER||t.user_type===er.SYSTEM_ADMIN:!1,Fd=t=>{if(!t||typeof t!="string")return{isValid:!1,error:"고유번호를 입력해주세요"};const r=t.trim().toUpperCase();if(!/^LAS\d{4}$/.test(r))return{isValid:!1,error:"올바른 고유번호 형식이 아닙니다 (예: LAS1000)"};const s=parseInt(r.replace("LAS",""));return s>=1e3&&s<=2999||s>=3e3&&s<=4999||s>=5e3&&s<=6999?{isValid:!0,error:""}:{isValid:!1,error:"허용되지 않은 고유번호 범위입니다"}};function Dd({onNavigate:t,onAutoLogin:r}){const[e,s]=B.useState(!0);B.useEffect(()=>{a()},[]);const a=async()=>{try{const{data:{session:i},error:o}=await ue.auth.getSession();if(o){console.error("세션 확인 오류:",o),s(!1);return}if(i&&i.user){const{data:l,error:c}=await ue.from("users").select("*").eq("id",i.user.id).single();if(c){console.error("사용자 정보 조회 오류:",c),s(!1);return}l&&l.status==="approved"?(console.log("자동 로그인:",l.name,"/",l.user_type),r&&r(l)):(console.log("승인 대기 중인 사용자:",l?.name),s(!1))}else s(!1)}catch(i){console.error("자동 로그인 체크 오류:",i),s(!1)}};return e?n.jsx("div",{className:"min-h-screen bg-gray-100 flex justify-center items-center",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:"#249689"}}),n.jsx("p",{className:"text-gray-600",children:"로그인 확인 중..."})]})}):n.jsx("div",{className:"min-h-screen bg-gray-100 flex justify-center items-start pt-8 pb-8",children:n.jsxs("div",{className:"bg-white flex flex-col w-full max-w-md rounded-lg shadow-lg overflow-hidden",children:[n.jsx("div",{className:"flex items-center justify-between p-2 border-b",children:n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:i=>i.target.style.display="none"}),n.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:"LAS 근무관리시스템"})]})}),n.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("img",{src:"/images/hero-cell.jpg",alt:"The Rise of Life Forms with a Nucleus",className:"w-full max-w-xs rounded-lg shadow-lg",onError:i=>{i.target.style.display="none",i.target.nextElementSibling.style.display="block"}}),n.jsx("div",{className:"hidden w-full max-w-xs h-64 bg-gradient-to-br from-teal-400 to-blue-500 rounded-lg shadow-lg flex items-center justify-center",children:n.jsx("p",{className:"text-white text-xl font-bold",children:"The Rise of Life Forms with a Nucleus"})})]}),n.jsxs("div",{className:"flex flex-col gap-2 w-full px-10",children:[n.jsx("button",{onClick:()=>t("login"),className:"px-8 py-3.5 text-white font-bold rounded-lg shadow-md hover:opacity-90 transition-opacity w-full",style:{backgroundColor:"#249689",fontSize:"15px"},children:"로그인"}),n.jsx("button",{onClick:()=>t("signup"),className:"px-8 py-3.5 font-bold rounded-lg shadow-md hover:bg-gray-50 transition-colors w-full",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",fontSize:"15px"},children:"직원등록"})]})]})]})})}function Od({onNavigate:t,onLogin:r}){const[e,s]=B.useState(""),[a,i]=B.useState(""),[o,l]=B.useState(!1),c=async d=>{d.preventDefault(),l(!0);try{const{data:h,error:f}=await ue.from("users").select("*").eq("email",e).eq("password",a).single();if(f||!h){alert("이메일 또는 비밀번호가 올바르지 않습니다.");return}if(h.status!=="approved"){alert("관리자 승인 대기 중입니다. 승인 후 로그인이 가능합니다.");return}r(h)}catch(h){console.error("로그인 오류:",h),alert("로그인에 실패했습니다: "+h.message)}finally{l(!1)}};return n.jsx("div",{className:"min-h-screen flex items-start justify-center p-4 pt-4",style:{backgroundColor:"#f5f5f5"},children:n.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("p",{className:"text-sm mb-4",style:{color:"#249689"},children:"LAS 매장관리 시스템에 오신것을 환영합니다."}),n.jsxs("div",{className:"flex items-center justify-center gap-3",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Book Logo",className:"h-16"}),n.jsx("h1",{className:"text-3xl font-bold",style:{color:"#249689"},children:"로그인"})]})]}),n.jsxs("form",{onSubmit:c,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:"📧"}),n.jsx("span",{children:"이메일"})]}),n.jsx("input",{type:"email",value:e,onChange:d=>s(d.target.value),placeholder:"이메일을 입력하세요",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:"🔒"}),n.jsx("span",{children:"비밀번호"})]}),n.jsx("input",{type:"password",value:a,onChange:d=>i(d.target.value),placeholder:"비밀번호를 입력하세요",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsx("button",{type:"submit",disabled:o,className:"w-full py-3 rounded-lg font-bold text-white hover:opacity-90 mt-6",style:{backgroundColor:"#249689",fontSize:"16px"},children:o?"로그인 중...":"로그인"}),n.jsx("button",{type:"button",onClick:()=>t("hero"),className:"w-full py-3 rounded-lg font-bold border-2 hover:bg-gray-50",style:{borderColor:"#cccccc",fontSize:"16px"},children:"취소"})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs("p",{style:{color:"#666666",fontSize:"13px"},children:["아직 직원등록 전 이신가요?"," ",n.jsx("button",{onClick:()=>t("signup"),className:"font-bold hover:underline",style:{color:"#249689"},children:"직원등록 가기"})]})})]})})}function Id({onNavigate:t}){const[r,e]=B.useState(""),[s,a]=B.useState(""),[i,o]=B.useState(""),[l,c]=B.useState(""),[d,h]=B.useState(""),[f,u]=B.useState(""),[m,p]=B.useState("점주"),[x,g]=B.useState(!1),[j,w]=B.useState([]),[_,T]=B.useState(!1),[R,z]=B.useState(""),[E,I]=B.useState(""),[D,P]=B.useState(""),[U,H]=B.useState("");B.useEffect(()=>{ee()},[]);const ee=async()=>{try{const{data:de,error:me}=await ue.from("branches").select("name").order("name",{ascending:!0});if(me)throw me;w(de||[])}catch(de){console.error("지점 목록 로드 오류:",de)}},pe=de=>{const me=de.replace(/[^\d]/g,"");return me.length<=3?me:me.length<=7?`${me.slice(0,3)}-${me.slice(3)}`:`${me.slice(0,3)}-${me.slice(3,7)}-${me.slice(7,11)}`},ge=de=>{const me=pe(de.target.value);u(me)},je=de=>{const me=de.replace(/[^\d]/g,"");return me.length<=6?me:`${me.slice(0,6)}-${me.slice(6,13)}`},_e=de=>{const me=je(de.target.value);z(me),me.replace(/-/g,"").length===13||me.replace(/-/g,"").length>0},ke=async de=>{if(de.preventDefault(),s!==i){alert("비밀번호가 일치하지 않습니다.");return}if(s.length<6){alert("비밀번호는 최소 6자 이상이어야 합니다.");return}if(R&&R.replace(/-/g,"").length!==13){alert("주민등록번호는 13자리여야 합니다.");return}g(!0);try{const{data:me}=await ue.from("users").select("referral_code").not("referral_code","is",null).order("referral_code",{ascending:!1});let Se="LAS001";if(me&&me.length>0){const W=me[0].referral_code,Z=parseInt(W.replace("LAS",""))+1;Se=`LAS${String(Z).padStart(3,"0")}`}const y=crypto.randomUUID(),F=f.replace(/-/g,""),O=R?R.replace(/-/g,""):null,{error:b}=await ue.from("users").insert([{id:y,email:r,password:s,name:l,branch:d,phone:F,user_type:m,status:"pending",referral_code:Se,ssn:O,bank_name:E||null,account_holder:D||null,account_number:U||null}]);if(b)throw b;alert("직원등록이 완료되었습니다. 관리자 승인 후 로그인할 수 있습니다."),t("login")}catch(me){console.error("직원등록 오류:",me),alert("직원등록 중 오류가 발생했습니다: "+me.message)}finally{g(!1)}};return n.jsx("div",{className:"min-h-screen flex items-start justify-center p-4 pt-4",style:{backgroundColor:"#f5f5f5"},children:n.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-6",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("p",{className:"text-sm mb-3",style:{color:"#249689"},children:"LAS 매장관리 시스템에 오신것을 환영합니다."}),n.jsxs("div",{className:"flex items-center justify-center gap-3",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Book Logo",className:"h-12"}),n.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:"직원등록"})]})]}),n.jsxs("form",{onSubmit:ke,className:"space-y-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:"📧"}),n.jsx("span",{children:"이메일"})]}),n.jsx("input",{type:"email",value:r,onChange:de=>e(de.target.value),placeholder:"이메일을 입력하세요",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:"🔒"}),n.jsx("span",{children:"비밀번호"})]}),n.jsx("input",{type:"password",value:s,onChange:de=>a(de.target.value),placeholder:"비밀번호",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:"🔒"}),n.jsx("span",{children:"비밀번호 확인"})]}),n.jsx("input",{type:"password",value:i,onChange:de=>o(de.target.value),placeholder:"비밀번호 확인",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:"👤"}),n.jsx("span",{children:"이름"})]}),n.jsx("input",{type:"text",value:l,onChange:de=>c(de.target.value),placeholder:"이름",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:"📱"}),n.jsx("span",{children:"핸드폰 번호"})]}),n.jsx("input",{type:"tel",value:f,onChange:ge,placeholder:"000-0000-0000",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:"🏢"}),n.jsx("span",{children:"지정명"})]}),n.jsxs("select",{value:d,onChange:de=>h(de.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:"지정명을 선택하세요"}),j.map(de=>n.jsx("option",{value:de.name,children:de.name},de.name))]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:"🏷️"}),n.jsx("span",{children:"구분"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",value:"모니터링요원",checked:m==="모니터링요원",onChange:de=>p(de.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),n.jsx("span",{style:{fontSize:"15px"},children:"모니터링요원"})]}),n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",value:"계약근무",checked:m==="계약근무",onChange:de=>p(de.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),n.jsx("span",{style:{fontSize:"15px"},children:"계약근무"})]}),n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",value:"점주",checked:m==="점주",onChange:de=>p(de.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),n.jsx("span",{style:{fontSize:"15px"},children:"점주"})]}),n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",value:"점장",checked:m==="점장",onChange:de=>p(de.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),n.jsx("span",{style:{fontSize:"15px"},children:"점장"})]})]})]}),n.jsxs("div",{className:"border-t pt-3 mt-4",children:[n.jsxs("button",{type:"button",onClick:()=>T(!_),className:"w-full flex items-center justify-between p-3 rounded-lg border-2 hover:bg-gray-50",style:{borderColor:"#249689",fontSize:"15px"},children:[n.jsx("span",{className:"font-bold",style:{color:"#249689"},children:"💰 급여 정보 (선택)"}),n.jsx("span",{style:{color:"#249689"},children:_?"▲":"▼"})]}),_&&n.jsxs("div",{className:"mt-3 space-y-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[n.jsx("span",{children:"🆔"}),n.jsx("span",{children:"주민등록번호 (선택)"})]}),n.jsx("input",{type:"text",value:R,onChange:_e,placeholder:"000000-0000000",maxLength:"14",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}}),R&&R.replace(/-/g,"").length>0&&R.replace(/-/g,"").length!==13&&n.jsx("p",{className:"text-sm mt-1",style:{color:"#e74c3c"},children:"⚠️ 주민등록번호는 13자리여야 합니다."})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[n.jsx("span",{children:"👤"}),n.jsx("span",{children:"예금주 (선택)"})]}),n.jsx("input",{type:"text",value:D,onChange:de=>P(de.target.value),placeholder:"예금주",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[n.jsx("span",{children:"🏦"}),n.jsx("span",{children:"기관명 (선택)"})]}),n.jsx("input",{type:"text",value:E,onChange:de=>I(de.target.value),placeholder:"기관명",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[n.jsx("span",{children:"💳"}),n.jsx("span",{children:"계좌번호 (선택)"})]}),n.jsx("input",{type:"text",value:U,onChange:de=>H(de.target.value),placeholder:"계좌번호",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[n.jsxs("button",{type:"button",onClick:()=>t("login"),className:"py-3 rounded-lg font-bold border-2 hover:bg-gray-50 flex items-center justify-center gap-2",style:{borderColor:"#cccccc",fontSize:"16px"},children:[n.jsx(Ot,{size:18}),"나가기"]}),n.jsx("button",{type:"submit",disabled:x,className:"py-3 rounded-lg font-bold text-white hover:opacity-90",style:{backgroundColor:"#249689",fontSize:"16px"},children:x?"등록 중...":"직원등록"})]})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs("p",{style:{color:"#666666",fontSize:"13px"},children:["직원등록을 하셨나요?"," ",n.jsx("button",{onClick:()=>t("login"),className:"font-bold hover:underline",style:{color:"#249689"},children:"로그인하기"})]})})]})})}function Pd({user:t,onNavigate:r,onLogout:e}){const s=kd(t),a=Ad(t),i=s,o=a;return n.jsx("div",{className:"min-h-screen bg-white",children:n.jsx("div",{className:"max-w-md mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:l=>l.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"일반업무"})]}),!i&&!o&&n.jsx("div",{className:"mb-6",children:n.jsx("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"#f0f9ff",borderColor:"#0284c7"},children:n.jsxs("div",{className:"flex items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-left gap-2 flex-1",children:[n.jsx(Mc,{size:20,style:{color:"#0284c7"}}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold",style:{color:"#075985",fontSize:"14px"},children:"🛡️ 매장관리로 이동"}),n.jsx("p",{className:"text-xs",style:{color:"#075985"},children:"직원 관리, 근무일지 관리, 고객 관리 등을 수행하세요"})]})]}),n.jsx("button",{onClick:()=>r("AdminDashboard"),className:"px-4 py-2 bg-white border-2 rounded-lg hover:bg-gray-50 font-bold transition-colors text-sm whitespace-nowrap",style:{borderColor:"#0284c7",color:"#075985",borderRadius:"10px"},children:"🛡️ 매장관리"})]})})}),n.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"🏢 지점명"}),n.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"👤 이름"}),n.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-4",children:[o&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>r("WorkDiary"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(rn,{size:20}),"근무일지"]}),n.jsxs("button",{onClick:()=>r("CustomerManagement"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(sn,{size:20}),"판매관리"]})]}),!i&&!o&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>r("WorkDiary"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(rn,{size:20}),"근무일지"]}),n.jsxs("button",{onClick:()=>r("CustomerManagement"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(sn,{size:20}),"판매관리"]}),n.jsxs("button",{onClick:()=>r("ShippingList"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(no,{size:20}),"주문목록관리"]}),n.jsxs("button",{onClick:()=>r("PurchaseHistory"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(ao,{size:20}),"구매이력조회"]})]}),n.jsxs("button",{onClick:()=>r("AdminEventDashboard"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#dc2626",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Sa,{size:20}),"내 이벤트관리"]}),n.jsxs("button",{onClick:()=>r("MyInfo"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#7f95eb",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(nn,{size:20}),"내정보관리"]}),n.jsxs("button",{onClick:e,className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Na,{size:20}),"LogOut"]})]})]})})})}function Ld({user:t,onNavigate:r,onLogout:e,onSwitchMode:s}){console.log("🎨 AdminDashboard 렌더링"),console.log("👤 user:",t),console.log("📦 onSwitchMode:",s);const a=()=>{if(console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),console.log("👤 일반업무 버튼 클릭됨"),console.log("📦 onSwitchMode 존재:",!!s),console.log("📦 LOGIN_MODES.EMPLOYEE:",on.EMPLOYEE),!s){console.error("❌ onSwitchMode가 undefined입니다!"),alert("모드 전환 기능이 연결되지 않았습니다.");return}if(typeof s!="function"){console.error("❌ onSwitchMode가 함수가 아닙니다!"),alert("모드 전환 기능에 문제가 있습니다.");return}try{console.log("✅ onSwitchMode 호출 시작 (EMPLOYEE 모드)"),s(on.EMPLOYEE),console.log("✅ onSwitchMode 호출 완료"),console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")}catch(o){console.error("❌ onSwitchMode 호출 중 에러:",o),alert("모드 전환 중 오류가 발생했습니다: "+o.message)}},i=Rd(t);return n.jsx("div",{className:"min-h-screen bg-white",children:n.jsx("div",{className:"max-w-md mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:o=>o.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"매장관리"})]}),n.jsx("div",{className:"mb-6",children:n.jsx("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"#f0f9ff",borderColor:"#0284c7"},children:n.jsxs("div",{className:"flex items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-left gap-2 flex-1",children:[n.jsx(zc,{size:20,style:{color:"#0284c7"}}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold",style:{color:"#075985",fontSize:"14px"},children:"💼 일반업무로 돌아가기"}),n.jsx("p",{className:"text-xs",style:{color:"#075985"},children:"근무일지, 판매관리 등 일상 업무를 수행하세요"})]})]}),n.jsx("button",{onClick:a,className:"px-4 py-2 bg-white border-2 rounded-lg hover:bg-gray-50 font-bold transition-colors text-sm whitespace-nowrap",style:{borderColor:"#0284c7",color:"#075985",borderRadius:"10px"},children:"👤 일반업무"})]})})}),n.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"🏢 지점명"}),n.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"👤 이름"}),n.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminWorkDiary"),r("AdminWorkDiary")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(rn,{size:20}),"근무일지관리"]}),n.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminUsers"),r("AdminUsers")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(ja,{size:20}),"직원정보관리"]}),n.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminCustomers"),r("AdminCustomers")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(sn,{size:20}),"구매고객조회"]}),i&&n.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminEventDashboard"),r("AdminEventDashboard")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#dc2626",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(an,{size:20}),"매장 이벤트관리"]}),n.jsxs("button",{onClick:e,className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Na,{size:20}),"LogOut"]})]})]})})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ln={};ln.version="0.18.5";var wo=1252,Bd=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],_o=function(t){Bd.indexOf(t)!=-1&&(wo=t)};function Md(){_o(1252)}var Ns=function(t){_o(t)};function zd(){Ns(1200),Md()}var Gs=function(r){return String.fromCharCode(r)},ui=function(r){return String.fromCharCode(r)},cn,dr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function js(t){for(var r="",e=0,s=0,a=0,i=0,o=0,l=0,c=0,d=0;d<t.length;)e=t.charCodeAt(d++),i=e>>2,s=t.charCodeAt(d++),o=(e&3)<<4|s>>4,a=t.charCodeAt(d++),l=(s&15)<<2|a>>6,c=a&63,isNaN(s)?l=c=64:isNaN(a)&&(c=64),r+=dr.charAt(i)+dr.charAt(o)+dr.charAt(l)+dr.charAt(c);return r}function nr(t){var r="",e=0,s=0,a=0,i=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var d=0;d<t.length;)i=dr.indexOf(t.charAt(d++)),o=dr.indexOf(t.charAt(d++)),e=i<<2|o>>4,r+=String.fromCharCode(e),l=dr.indexOf(t.charAt(d++)),s=(o&15)<<4|l>>2,l!==64&&(r+=String.fromCharCode(s)),c=dr.indexOf(t.charAt(d++)),a=(l&3)<<6|c,c!==64&&(r+=String.fromCharCode(a));return r}var Ce=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ir=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function Tr(t){return Ce?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function xi(t){return Ce?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Mt=function(r){return Ce?ir(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function Rn(t){if(typeof ArrayBuffer>"u")return Mt(t);for(var r=new ArrayBuffer(t.length),e=new Uint8Array(r),s=0;s!=t.length;++s)e[s]=t.charCodeAt(s)&255;return r}function Os(t){if(Array.isArray(t))return t.map(function(s){return String.fromCharCode(s)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function Ud(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var ot=Ce?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:ir(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var s=new Uint8Array(e),a=0;for(r=0,e=0;r<t.length;e+=a,++r)if(a=t[r].length,t[r]instanceof Uint8Array)s.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";s.set(new Uint8Array(t[r]),e)}return s}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function $d(t){for(var r=[],e=0,s=t.length+250,a=Tr(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)a[e++]=o;else if(o<2048)a[e++]=192|o>>6&31,a[e++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++i)&1023;a[e++]=240|o>>8&7,a[e++]=128|o>>2&63,a[e++]=128|l>>6&15|(o&3)<<4,a[e++]=128|l&63}else a[e++]=224|o>>12&15,a[e++]=128|o>>6&63,a[e++]=128|o&63;e>s&&(r.push(a.slice(0,e)),e=0,a=Tr(65535),s=65530)}return r.push(a.slice(0,e)),ot(r)}var ps=/\u0000/g,Vs=/[\u0001-\u0006]/g;function Wr(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function zt(t,r){var e=""+t;return e.length>=r?e:Ve("0",r-e.length)+e}function Aa(t,r){var e=""+t;return e.length>=r?e:Ve(" ",r-e.length)+e}function dn(t,r){var e=""+t;return e.length>=r?e:e+Ve(" ",r-e.length)}function Hd(t,r){var e=""+Math.round(t);return e.length>=r?e:Ve("0",r-e.length)+e}function Wd(t,r){var e=""+t;return e.length>=r?e:Ve("0",r-e.length)+e}var mi=Math.pow(2,32);function Br(t,r){if(t>mi||t<-mi)return Hd(t,r);var e=Math.round(t);return Wd(e,r)}function hn(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var pi=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Yn=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Gd(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',t}var Xe={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},gi={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Vd={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function fn(t,r,e){for(var s=t<0?-1:1,a=t*s,i=0,o=1,l=0,c=1,d=0,h=0,f=Math.floor(a);d<r&&(f=Math.floor(a),l=f*o+i,h=f*d+c,!(a-f<5e-8));)a=1/(a-f),i=o,o=l,c=d,d=h;if(h>r&&(d>r?(h=c,l=i):(h=d,l=o)),!e)return[0,s*l,h];var u=Math.floor(s*l/h);return[u,s*l-u*h,h]}function Xs(t,r,e){if(t>2958465||t<0)return null;var s=t|0,a=Math.floor(86400*(t-s)),i=0,o=[],l={D:s,T:a,u:86400*(t-s)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++s,++l.D)),s===60)o=e?[1317,10,29]:[1900,2,29],i=3;else if(s===0)o=e?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),s<60&&(i=(i+6)%7),e&&(i=Zd(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var So=new Date(1899,11,31,0,0,0),Xd=So.getTime(),Kd=new Date(1900,2,1,0,0,0);function No(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=Kd&&(e+=24*60*60*1e3),(e-(Xd+(t.getTimezoneOffset()-So.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ra(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Yd(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function qd(t){var r=t<0?12:11,e=Ra(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function Jd(t){var r=Ra(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function Qd(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=qd(t):r===10?e=t.toFixed(10).substr(0,12):e=Jd(t),Ra(Yd(e.toUpperCase()))}function ma(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):Qd(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return ur(14,No(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function Zd(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function eh(t,r,e,s){var a="",i=0,o=0,l=e.y,c,d=0;switch(t){case 98:l=e.y+543;case 121:switch(r.length){case 1:case 2:c=l%100,d=2;break;default:c=l%1e4,d=4;break}break;case 109:switch(r.length){case 1:case 2:c=e.m,d=r.length;break;case 3:return Yn[e.m-1][1];case 5:return Yn[e.m-1][0];default:return Yn[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=e.d,d=r.length;break;case 3:return pi[e.q][0];default:return pi[e.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(e.H+11)%12,d=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=e.H,d=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=e.M,d=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?zt(e.S,r.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,i=Math.round(o*(e.S+e.u)),i>=60*o&&(i=0),r==="s"?i===0?"0":""+i/o:(a=zt(i,2+s),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}d=r.length===3?1:2;break;case 101:c=l,d=1;break}var h=d>0?zt(c,d):"";return h}function hr(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,s=t.substr(0,e);e!=t.length;e+=r)s+=(s.length>0?",":"")+t.substr(e,r);return s}var jo=/%/g;function th(t,r,e){var s=r.replace(jo,""),a=r.length-s.length;return tr(t,s,e*Math.pow(10,2*a))+Ve("%",a)}function rh(t,r,e){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return tr(t,r.substr(0,s),e/Math.pow(10,3*(r.length-s)))}function Eo(t,r){var e,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Eo(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),e=(r/Math.pow(10,i)).toPrecision(s+1+(a+i)%a),e.indexOf("e")===-1){var o=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+i):e+="E+"+(o-i);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,a)+"."+e.substr(2+a),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,h){return c+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else e=r.toExponential(s);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var To=/# (\?+)( ?)\/( ?)(\d+)/;function sh(t,r,e){var s=parseInt(t[4],10),a=Math.round(r*s),i=Math.floor(a/s),o=a-i*s,l=s;return e+(i===0?"":""+i)+" "+(o===0?Ve(" ",t[1].length+1+t[4].length):Aa(o,t[1].length)+t[2]+"/"+t[3]+zt(l,t[4].length))}function nh(t,r,e){return e+(r===0?"":""+r)+Ve(" ",t[1].length+2+t[4].length)}var Co=/^#*0*\.([0#]+)/,ko=/\).*[0#]/,Ao=/\(###\) ###\\?-####/;function vt(t){for(var r="",e,s=0;s!=t.length;++s)switch(e=t.charCodeAt(s)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function vi(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function yi(t,r){var e=t-Math.floor(t),s=Math.pow(10,r);return r<(""+Math.round(e*s)).length?0:Math.round(e*s)}function ah(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function ih(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Ft(t,r,e){if(t.charCodeAt(0)===40&&!r.match(ko)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Ft("n",s,e):"("+Ft("n",s,-e)+")"}if(r.charCodeAt(r.length-1)===44)return rh(t,r,e);if(r.indexOf("%")!==-1)return th(t,r,e);if(r.indexOf("E")!==-1)return Eo(r,e);if(r.charCodeAt(0)===36)return"$"+Ft(t,r.substr(r.charAt(1)==" "?2:1),e);var a,i,o,l,c=Math.abs(e),d=e<0?"-":"";if(r.match(/^00+$/))return d+Br(c,r.length);if(r.match(/^[#?]+$/))return a=Br(e,0),a==="0"&&(a=""),a.length>r.length?a:vt(r.substr(0,r.length-a.length))+a;if(i=r.match(To))return sh(i,c,d);if(r.match(/^#+0+$/))return d+Br(c,r.length-r.indexOf("0"));if(i=r.match(Co))return a=vi(e,i[1].length).replace(/^([^\.]+)$/,"$1."+vt(i[1])).replace(/\.$/,"."+vt(i[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+Ve("0",vt(i[1]).length-x.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return d+vi(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return d+hr(Br(c,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Ft(t,r,-e):hr(""+(Math.floor(e)+ah(e,i[1].length)))+"."+zt(yi(e,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return Ft(t,r.replace(/^#,#*,/,""),e);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Wr(Ft(t,r.replace(/[\\-]/g,""),e)),o=0,Wr(Wr(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<a.length?a.charAt(o++):p==="0"?"0":""}));if(r.match(Ao))return a=Ft(t,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=fn(c,Math.pow(10,o)-1,!1),a=""+d,h=tr("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=dn(l[2],o),h.length<i[4].length&&(h=vt(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=fn(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Aa(l[1],o)+i[2]+"/"+i[3]+dn(l[2],o):Ve(" ",2*o+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=Br(e,0),r.length<=a.length?a:vt(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=r.indexOf(".")-o,u=r.length-a.length-f;return vt(r.substr(0,f)+a+r.substr(r.length-u))}if(i=r.match(/^00,000\.([#0]*0)$/))return o=yi(e,i[1].length),e<0?"-"+Ft(t,r,-e):hr(ih(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?zt(0,3-p.length):"")+p})+"."+zt(o,i[1].length);switch(r){case"###,##0.00":return Ft(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var m=hr(Br(c,0));return m!=="0"?d+m:"";case"###,###.00":return Ft(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Ft(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function oh(t,r,e){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return tr(t,r.substr(0,s),e/Math.pow(10,3*(r.length-s)))}function lh(t,r,e){var s=r.replace(jo,""),a=r.length-s.length;return tr(t,s,e*Math.pow(10,2*a))+Ve("%",a)}function Ro(t,r){var e,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Ro(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),e=(r/Math.pow(10,i)).toPrecision(s+1+(a+i)%a),!e.match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+i):e+="E+"+(o-i),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,d,h){return c+d+h.substr(0,(a+i)%a)+"."+h.substr(i)+"E"})}else e=r.toExponential(s);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Vt(t,r,e){if(t.charCodeAt(0)===40&&!r.match(ko)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Vt("n",s,e):"("+Vt("n",s,-e)+")"}if(r.charCodeAt(r.length-1)===44)return oh(t,r,e);if(r.indexOf("%")!==-1)return lh(t,r,e);if(r.indexOf("E")!==-1)return Ro(r,e);if(r.charCodeAt(0)===36)return"$"+Vt(t,r.substr(r.charAt(1)==" "?2:1),e);var a,i,o,l,c=Math.abs(e),d=e<0?"-":"";if(r.match(/^00+$/))return d+zt(c,r.length);if(r.match(/^[#?]+$/))return a=""+e,e===0&&(a=""),a.length>r.length?a:vt(r.substr(0,r.length-a.length))+a;if(i=r.match(To))return nh(i,c,d);if(r.match(/^#+0+$/))return d+zt(c,r.length-r.indexOf("0"));if(i=r.match(Co))return a=(""+e).replace(/^([^\.]+)$/,"$1."+vt(i[1])).replace(/\.$/,"."+vt(i[1])),a=a.replace(/\.(\d*)$/,function(p,x){return"."+x+Ve("0",vt(i[1]).length-x.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return d+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return d+hr(""+c);if(i=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Vt(t,r,-e):hr(""+e)+"."+Ve("0",i[1].length);if(i=r.match(/^#,#*,#0/))return Vt(t,r.replace(/^#,#*,/,""),e);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Wr(Vt(t,r.replace(/[\\-]/g,""),e)),o=0,Wr(Wr(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<a.length?a.charAt(o++):p==="0"?"0":""}));if(r.match(Ao))return a=Vt(t,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var h="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=fn(c,Math.pow(10,o)-1,!1),a=""+d,h=tr("n",i[1],l[1]),h.charAt(h.length-1)==" "&&(h=h.substr(0,h.length-1)+"0"),a+=h+i[2]+"/"+i[3],h=dn(l[2],o),h.length<i[4].length&&(h=vt(i[4].substr(i[4].length-h.length))+h),a+=h,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=fn(c,Math.pow(10,o)-1,!0),d+(l[0]||(l[1]?"":"0"))+" "+(l[1]?Aa(l[1],o)+i[2]+"/"+i[3]+dn(l[2],o):Ve(" ",2*o+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=""+e,r.length<=a.length?a:vt(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=r.indexOf(".")-o,u=r.length-a.length-f;return vt(r.substr(0,f)+a+r.substr(r.length-u))}if(i=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Vt(t,r,-e):hr(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?zt(0,3-p.length):"")+p})+"."+zt(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var m=hr(""+c);return m!=="0"?d+m:"";default:if(r.match(/\.[0#?]*$/))return Vt(t,r.slice(0,r.lastIndexOf(".")),e)+vt(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function tr(t,r,e){return(e|0)===e?Vt(t,r,e):Ft(t,r,e)}function ch(t){for(var r=[],e=!1,s=0,a=0;s<t.length;++s)switch(t.charCodeAt(s)){case 34:e=!e;break;case 95:case 42:case 92:++s;break;case 59:r[r.length]=t.substr(a,s-a),a=s+1}if(r[r.length]=t.substr(a),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var Fo=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Do(t){for(var r=0,e="",s="";r<t.length;)switch(e=t.charAt(r)){case"G":hn(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="上午/下午")return!0;++r;break;case"[":for(s=e;t.charAt(r++)!=="]"&&r<t.length;)s+=t.charAt(r);if(s.match(Fo))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function dh(t,r,e,s){for(var a=[],i="",o=0,l="",c="t",d,h,f,u="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!hn(t,o))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++o;break;case"\\":var m=t.charAt(++o),p=m==="("||m===")"?m:"t";a[a.length]={t:p,v:m},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:r},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(d==null&&(d=Xs(r,e,t.charAt(o+1)==="2"),d==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||d==null&&(d=Xs(r,e),d==null))return"";for(i=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=u),a[a.length]={t:l,v:i},c=l;break;case"A":case"a":case"上":var x={t:l,v:l};if(d==null&&(d=Xs(r,e)),t.substr(o,3).toUpperCase()==="A/P"?(d!=null&&(x.v=d.H>=12?"P":"A"),x.t="T",u="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(d!=null&&(x.v=d.H>=12?"PM":"AM"),x.t="T",o+=5,u="h"):t.substr(o,5).toUpperCase()==="上午/下午"?(d!=null&&(x.v=d.H>=12?"下午":"上午"),x.t="T",o+=5,u="h"):(x.t="t",++o),d==null&&x.t==="T")return"";a[a.length]=x,c=l;break;case"[":for(i=l;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Fo)){if(d==null&&(d=Xs(r,e),d==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Do(t)||(a[a.length]={t:"t",v:i}));break;case".":if(d!=null){for(i=l;++o<t.length&&(l=t.charAt(o))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;t.charAt(++o)===l;)i+=l;a[a.length]={t:l,v:i},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:s===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"t",v:l},++o;break}var g=0,j=0,w;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=u,c="h",g<1&&(g=1);break;case"s":(w=a[o].v.match(/\.0+$/))&&(j=Math.max(j,w[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[o].v.match(/[Hh]/)&&(g=1),g<2&&a[o].v.match(/[Mm]/)&&(g=2),g<3&&a[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M),d.M>=60&&(d.M=0,++d.H);break;case 2:d.u>=.5&&(d.u=0,++d.S),d.S>=60&&(d.S=0,++d.M);break}var _="",T;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=eh(a[o].t.charCodeAt(0),a[o].v,d,j),a[o].t="t";break;case"n":case"?":for(T=o+1;a[T]!=null&&((l=a[T].t)==="?"||l==="D"||(l===" "||l==="t")&&a[T+1]!=null&&(a[T+1].t==="?"||a[T+1].t==="t"&&a[T+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[T].v==="/"||a[T].v===" "&&a[T+1]!=null&&a[T+1].t=="?"));)a[o].v+=a[T].v,a[T]={v:"",t:";"},++T;_+=a[o].v,o=T-1;break;case"G":a[o].t="t",a[o].v=ma(r,e);break}var R="",z,E;if(_.length>0){_.charCodeAt(0)==40?(z=r<0&&_.charCodeAt(0)===45?-r:r,E=tr("n",_,z)):(z=r<0&&s>1?-r:r,E=tr("n",_,z),z<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),T=E.length-1;var I=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){I=o;break}var D=a.length;if(I===a.length&&E.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(T>=a[o].v.length-1?(T-=a[o].v.length,a[o].v=E.substr(T+1,a[o].v.length)):T<0?a[o].v="":(a[o].v=E.substr(0,T+1),T=-1),a[o].t="t",D=o);T>=0&&D<a.length&&(a[D].v=E.substr(0,T+1)+a[D].v)}else if(I!==a.length&&E.indexOf("E")===-1){for(T=E.indexOf(".")-1,o=I;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(h=a[o].v.indexOf(".")>-1&&o===I?a[o].v.indexOf(".")-1:a[o].v.length-1,R=a[o].v.substr(h+1);h>=0;--h)T>=0&&(a[o].v.charAt(h)==="0"||a[o].v.charAt(h)==="#")&&(R=E.charAt(T--)+R);a[o].v=R,a[o].t="t",D=o}for(T>=0&&D<a.length&&(a[D].v=E.substr(0,T+1)+a[D].v),T=E.indexOf(".")+1,o=I;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==I)){for(h=a[o].v.indexOf(".")>-1&&o===I?a[o].v.indexOf(".")+1:0,R=a[o].v.substr(0,h);h<a[o].v.length;++h)T<E.length&&(R+=E.charAt(T++));a[o].v=R,a[o].t="t",D=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(z=s>1&&r<0&&o>0&&a[o-1].v==="-"?-r:r,a[o].v=tr(a[o].t,a[o].v,z),a[o].t="t");var P="";for(o=0;o!==a.length;++o)a[o]!=null&&(P+=a[o].v);return P}var bi=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function wi(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function hh(t,r){var e=ch(t),s=e.length,a=e[s-1].indexOf("@");if(s<4&&a>-1&&--s,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||a>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=a>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=a>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=a>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var i=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[s,i];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var o=e[0].match(bi),l=e[1].match(bi);return wi(r,o)?[s,e[0]]:wi(r,l)?[s,e[1]]:[s,e[o!=null&&l!=null?2:1]]}return[s,i]}function ur(t,r,e){e==null&&(e={});var s="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?s=e.dateNF:s=t;break;case"number":t==14&&e.dateNF?s=e.dateNF:s=(e.table!=null?e.table:Xe)[t],s==null&&(s=e.table&&e.table[gi[t]]||Xe[gi[t]]),s==null&&(s=Vd[t]||"General");break}if(hn(s,0))return ma(r,e);r instanceof Date&&(r=No(r,e.date1904));var a=hh(s,r);if(hn(a[1]))return ma(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return dh(a[1],r,e,a[0])}function Oo(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(Xe[e]==null){r<0&&(r=e);continue}if(Xe[e]==t){r=e;break}}r<0&&(r=391)}return Xe[r]=t,r}function Fn(t){for(var r=0;r!=392;++r)t[r]!==void 0&&Oo(t[r],r)}function Dn(){Xe=Gd()}var Io=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function fh(t){var r=typeof t=="number"?Xe[t]:t;return r=r.replace(Io,"(\\d+)"),new RegExp("^"+r+"$")}function uh(t,r,e){var s=-1,a=-1,i=-1,o=-1,l=-1,c=-1;(r.match(Io)||[]).forEach(function(f,u){var m=parseInt(e[u+1],10);switch(f.toLowerCase().charAt(0)){case"y":s=m;break;case"d":i=m;break;case"h":o=m;break;case"s":c=m;break;case"m":o>=0?l=m:a=m;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var d=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);d.length==7&&(d="0"+d),d.length==8&&(d="20"+d);var h=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?d:s==-1&&a==-1&&i==-1?h:d+"T"+h}var xh=function(){var t={};t.version="1.2.0";function r(){for(var E=0,I=new Array(256),D=0;D!=256;++D)E=D,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,I[D]=E;return typeof Int32Array<"u"?new Int32Array(I):I}var e=r();function s(E){var I=0,D=0,P=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(P=0;P!=256;++P)U[P]=E[P];for(P=0;P!=256;++P)for(D=E[P],I=256+P;I<4096;I+=256)D=U[I]=D>>>8^E[D&255];var H=[];for(P=1;P!=16;++P)H[P-1]=typeof Int32Array<"u"?U.subarray(P*256,P*256+256):U.slice(P*256,P*256+256);return H}var a=s(e),i=a[0],o=a[1],l=a[2],c=a[3],d=a[4],h=a[5],f=a[6],u=a[7],m=a[8],p=a[9],x=a[10],g=a[11],j=a[12],w=a[13],_=a[14];function T(E,I){for(var D=I^-1,P=0,U=E.length;P<U;)D=D>>>8^e[(D^E.charCodeAt(P++))&255];return~D}function R(E,I){for(var D=I^-1,P=E.length-15,U=0;U<P;)D=_[E[U++]^D&255]^w[E[U++]^D>>8&255]^j[E[U++]^D>>16&255]^g[E[U++]^D>>>24]^x[E[U++]]^p[E[U++]]^m[E[U++]]^u[E[U++]]^f[E[U++]]^h[E[U++]]^d[E[U++]]^c[E[U++]]^l[E[U++]]^o[E[U++]]^i[E[U++]]^e[E[U++]];for(P+=15;U<P;)D=D>>>8^e[(D^E[U++])&255];return~D}function z(E,I){for(var D=I^-1,P=0,U=E.length,H=0,ee=0;P<U;)H=E.charCodeAt(P++),H<128?D=D>>>8^e[(D^H)&255]:H<2048?(D=D>>>8^e[(D^(192|H>>6&31))&255],D=D>>>8^e[(D^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,ee=E.charCodeAt(P++)&1023,D=D>>>8^e[(D^(240|H>>8&7))&255],D=D>>>8^e[(D^(128|H>>2&63))&255],D=D>>>8^e[(D^(128|ee>>6&15|(H&3)<<4))&255],D=D>>>8^e[(D^(128|ee&63))&255]):(D=D>>>8^e[(D^(224|H>>12&15))&255],D=D>>>8^e[(D^(128|H>>6&63))&255],D=D>>>8^e[(D^(128|H&63))&255]);return~D}return t.table=e,t.bstr=T,t.buf=R,t.str=z,t}(),Pe=function(){var r={};r.version="1.2.1";function e(v,C){for(var S=v.split("/"),N=C.split("/"),k=0,A=0,X=Math.min(S.length,N.length);k<X;++k){if(A=S[k].length-N[k].length)return A;if(S[k]!=N[k])return S[k]<N[k]?-1:1}return S.length-N.length}function s(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:s(v.slice(0,-1));var C=v.lastIndexOf("/");return C===-1?v:v.slice(0,C+1)}function a(v){if(v.charAt(v.length-1)=="/")return a(v.slice(0,-1));var C=v.lastIndexOf("/");return C===-1?v:v.slice(C+1)}function i(v,C){typeof C=="string"&&(C=new Date(C));var S=C.getHours();S=S<<6|C.getMinutes(),S=S<<5|C.getSeconds()>>>1,v.write_shift(2,S);var N=C.getFullYear()-1980;N=N<<4|C.getMonth()+1,N=N<<5|C.getDate(),v.write_shift(2,N)}function o(v){var C=v.read_shift(2)&65535,S=v.read_shift(2)&65535,N=new Date,k=S&31;S>>>=5;var A=S&15;S>>>=4,N.setMilliseconds(0),N.setFullYear(S+1980),N.setMonth(A-1),N.setDate(k);var X=C&31;C>>>=5;var J=C&63;return C>>>=6,N.setHours(C),N.setMinutes(J),N.setSeconds(X<<1),N}function l(v){Tt(v,0);for(var C={},S=0;v.l<=v.length-4;){var N=v.read_shift(2),k=v.read_shift(2),A=v.l+k,X={};switch(N){case 21589:S=v.read_shift(1),S&1&&(X.mtime=v.read_shift(4)),k>5&&(S&2&&(X.atime=v.read_shift(4)),S&4&&(X.ctime=v.read_shift(4))),X.mtime&&(X.mt=new Date(X.mtime*1e3));break}v.l=A,C[N]=X}return C}var c;function d(){return c||(c={})}function h(v,C){if(v[0]==80&&v[1]==75)return si(v,C);if((v[0]|32)==109&&(v[1]|32)==105)return Cc(v,C);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var S=3,N=512,k=0,A=0,X=0,J=0,V=0,K=[],Y=v.slice(0,512);Tt(Y,0);var ne=f(Y);switch(S=ne[0],S){case 3:N=512;break;case 4:N=4096;break;case 0:if(ne[1]==0)return si(v,C);default:throw new Error("Major Version: Expected 3 or 4 saw "+S)}N!==512&&(Y=v.slice(0,N),Tt(Y,28));var ce=v.slice(0,N);u(Y,S);var xe=Y.read_shift(4,"i");if(S===3&&xe!==0)throw new Error("# Directory Sectors: Expected 0 saw "+xe);Y.l+=4,X=Y.read_shift(4,"i"),Y.l+=4,Y.chk("00100000","Mini Stream Cutoff Size: "),J=Y.read_shift(4,"i"),k=Y.read_shift(4,"i"),V=Y.read_shift(4,"i"),A=Y.read_shift(4,"i");for(var ie=-1,fe=0;fe<109&&(ie=Y.read_shift(4,"i"),!(ie<0));++fe)K[fe]=ie;var we=m(v,N);g(V,A,we,N,K);var $e=w(we,X,K,N);$e[X].name="!Directory",k>0&&J!==ee&&($e[J].name="!MiniFAT"),$e[K[0]].name="!FAT",$e.fat_addrs=K,$e.ssz=N;var He={},ft=[],ls=[],cs=[];_(X,$e,we,ft,k,He,ls,J),p(ls,cs,ft),ft.shift();var ds={FileIndex:ls,FullPaths:cs};return C&&C.raw&&(ds.raw={header:ce,sectors:we}),ds}function f(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(pe,"Header Signature: "),v.l+=16;var C=v.read_shift(2,"u");return[v.read_shift(2,"u"),C]}function u(v,C){var S=9;switch(v.l+=2,S=v.read_shift(2)){case 9:if(C!=3)throw new Error("Sector Shift: Expected 9 saw "+S);break;case 12:if(C!=4)throw new Error("Sector Shift: Expected 12 saw "+S);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+S)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function m(v,C){for(var S=Math.ceil(v.length/C)-1,N=[],k=1;k<S;++k)N[k-1]=v.slice(k*C,(k+1)*C);return N[S-1]=v.slice(S*C),N}function p(v,C,S){for(var N=0,k=0,A=0,X=0,J=0,V=S.length,K=[],Y=[];N<V;++N)K[N]=Y[N]=N,C[N]=S[N];for(;J<Y.length;++J)N=Y[J],k=v[N].L,A=v[N].R,X=v[N].C,K[N]===N&&(k!==-1&&K[k]!==k&&(K[N]=K[k]),A!==-1&&K[A]!==A&&(K[N]=K[A])),X!==-1&&(K[X]=N),k!==-1&&N!=K[N]&&(K[k]=K[N],Y.lastIndexOf(k)<J&&Y.push(k)),A!==-1&&N!=K[N]&&(K[A]=K[N],Y.lastIndexOf(A)<J&&Y.push(A));for(N=1;N<V;++N)K[N]===N&&(A!==-1&&K[A]!==A?K[N]=K[A]:k!==-1&&K[k]!==k&&(K[N]=K[k]));for(N=1;N<V;++N)if(v[N].type!==0){if(J=N,J!=K[J])do J=K[J],C[N]=C[J]+"/"+C[N];while(J!==0&&K[J]!==-1&&J!=K[J]);K[N]=-1}for(C[0]+="/",N=1;N<V;++N)v[N].type!==2&&(C[N]+="/")}function x(v,C,S){for(var N=v.start,k=v.size,A=[],X=N;S&&k>0&&X>=0;)A.push(C.slice(X*H,X*H+H)),k-=H,X=Nr(S,X*4);return A.length===0?q(0):ot(A).slice(0,v.size)}function g(v,C,S,N,k){var A=ee;if(v===ee){if(C!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var X=S[v],J=(N>>>2)-1;if(!X)return;for(var V=0;V<J&&(A=Nr(X,V*4))!==ee;++V)k.push(A);g(Nr(X,N-4),C-1,S,N,k)}}function j(v,C,S,N,k){var A=[],X=[];k||(k=[]);var J=N-1,V=0,K=0;for(V=C;V>=0;){k[V]=!0,A[A.length]=V,X.push(v[V]);var Y=S[Math.floor(V*4/N)];if(K=V*4&J,N<4+K)throw new Error("FAT boundary crossed: "+V+" 4 "+N);if(!v[Y])break;V=Nr(v[Y],K)}return{nodes:A,data:ki([X])}}function w(v,C,S,N){var k=v.length,A=[],X=[],J=[],V=[],K=N-1,Y=0,ne=0,ce=0,xe=0;for(Y=0;Y<k;++Y)if(J=[],ce=Y+C,ce>=k&&(ce-=k),!X[ce]){V=[];var ie=[];for(ne=ce;ne>=0;){ie[ne]=!0,X[ne]=!0,J[J.length]=ne,V.push(v[ne]);var fe=S[Math.floor(ne*4/N)];if(xe=ne*4&K,N<4+xe)throw new Error("FAT boundary crossed: "+ne+" 4 "+N);if(!v[fe]||(ne=Nr(v[fe],xe),ie[ne]))break}A[ce]={nodes:J,data:ki([V])}}return A}function _(v,C,S,N,k,A,X,J){for(var V=0,K=N.length?2:0,Y=C[v].data,ne=0,ce=0,xe;ne<Y.length;ne+=128){var ie=Y.slice(ne,ne+128);Tt(ie,64),ce=ie.read_shift(2),xe=Pa(ie,0,ce-K),N.push(xe);var fe={name:xe,type:ie.read_shift(1),color:ie.read_shift(1),L:ie.read_shift(4,"i"),R:ie.read_shift(4,"i"),C:ie.read_shift(4,"i"),clsid:ie.read_shift(16),state:ie.read_shift(4,"i"),start:0,size:0},we=ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2);we!==0&&(fe.ct=T(ie,ie.l-8));var $e=ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2)+ie.read_shift(2);$e!==0&&(fe.mt=T(ie,ie.l-8)),fe.start=ie.read_shift(4,"i"),fe.size=ie.read_shift(4,"i"),fe.size<0&&fe.start<0&&(fe.size=fe.type=0,fe.start=ee,fe.name=""),fe.type===5?(V=fe.start,k>0&&V!==ee&&(C[V].name="!StreamData")):fe.size>=4096?(fe.storage="fat",C[fe.start]===void 0&&(C[fe.start]=j(S,fe.start,C.fat_addrs,C.ssz)),C[fe.start].name=fe.name,fe.content=C[fe.start].data.slice(0,fe.size)):(fe.storage="minifat",fe.size<0?fe.size=0:V!==ee&&fe.start!==ee&&C[V]&&(fe.content=x(fe,C[V].data,(C[J]||{}).data))),fe.content&&Tt(fe.content,0),A[xe]=fe,X.push(fe)}}function T(v,C){return new Date((kt(v,C+4)/1e7*Math.pow(2,32)+kt(v,C)/1e7-11644473600)*1e3)}function R(v,C){return d(),h(c.readFileSync(v),C)}function z(v,C){var S=C&&C.type;switch(S||Ce&&Buffer.isBuffer(v)&&(S="buffer"),S||"base64"){case"file":return R(v,C);case"base64":return h(Mt(nr(v)),C);case"binary":return h(Mt(v),C)}return h(v,C)}function E(v,C){var S=C||{},N=S.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=N+"/",v.FileIndex[0]={name:N,type:5}),S.CLSID&&(v.FileIndex[0].clsid=S.CLSID),I(v)}function I(v){var C="Sh33tJ5";if(!Pe.find(v,"/"+C)){var S=q(4);S[0]=55,S[1]=S[3]=50,S[2]=54,v.FileIndex.push({name:C,type:2,content:S,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+C),D(v)}}function D(v,C){E(v);for(var S=!1,N=!1,k=v.FullPaths.length-1;k>=0;--k){var A=v.FileIndex[k];switch(A.type){case 0:N?S=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(A.R*A.L*A.C)&&(S=!0),A.R>-1&&A.L>-1&&A.R==A.L&&(S=!0);break;default:S=!0;break}}if(!(!S&&!C)){var X=new Date(1987,1,19),J=0,V=Object.create?Object.create(null):{},K=[];for(k=0;k<v.FullPaths.length;++k)V[v.FullPaths[k]]=!0,v.FileIndex[k].type!==0&&K.push([v.FullPaths[k],v.FileIndex[k]]);for(k=0;k<K.length;++k){var Y=s(K[k][0]);N=V[Y],N||(K.push([Y,{name:a(Y).replace("/",""),type:1,clsid:je,ct:X,mt:X,content:null}]),V[Y]=!0)}for(K.sort(function(xe,ie){return e(xe[0],ie[0])}),v.FullPaths=[],v.FileIndex=[],k=0;k<K.length;++k)v.FullPaths[k]=K[k][0],v.FileIndex[k]=K[k][1];for(k=0;k<K.length;++k){var ne=v.FileIndex[k],ce=v.FullPaths[k];if(ne.name=a(ce).replace("/",""),ne.L=ne.R=ne.C=-(ne.color=1),ne.size=ne.content?ne.content.length:0,ne.start=0,ne.clsid=ne.clsid||je,k===0)ne.C=K.length>1?1:-1,ne.size=0,ne.type=5;else if(ce.slice(-1)=="/"){for(J=k+1;J<K.length&&s(v.FullPaths[J])!=ce;++J);for(ne.C=J>=K.length?-1:J,J=k+1;J<K.length&&s(v.FullPaths[J])!=s(ce);++J);ne.R=J>=K.length?-1:J,ne.type=1}else s(v.FullPaths[k+1]||"")==s(ce)&&(ne.R=k+1),ne.type=2}}}function P(v,C){var S=C||{};if(S.fileType=="mad")return kc(v,S);switch(D(v),S.fileType){case"zip":return _c(v,S)}var N=function(xe){for(var ie=0,fe=0,we=0;we<xe.FileIndex.length;++we){var $e=xe.FileIndex[we];if($e.content){var He=$e.content.length;He>0&&(He<4096?ie+=He+63>>6:fe+=He+511>>9)}}for(var ft=xe.FullPaths.length+3>>2,ls=ie+7>>3,cs=ie+127>>7,ds=ls+fe+ft+cs,yr=ds+127>>7,Wn=yr<=109?0:Math.ceil((yr-109)/127);ds+yr+Wn+127>>7>yr;)Wn=++yr<=109?0:Math.ceil((yr-109)/127);var Jt=[1,Wn,yr,cs,ft,fe,ie,0];return xe.FileIndex[0].size=ie<<6,Jt[7]=(xe.FileIndex[0].start=Jt[0]+Jt[1]+Jt[2]+Jt[3]+Jt[4]+Jt[5])+(Jt[6]+7>>3),Jt}(v),k=q(N[7]<<9),A=0,X=0;{for(A=0;A<8;++A)k.write_shift(1,ge[A]);for(A=0;A<8;++A)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),A=0;A<3;++A)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,N[2]),k.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:ee),k.write_shift(4,N[3]),k.write_shift(-4,N[1]?N[0]-1:ee),k.write_shift(4,N[1]),A=0;A<109;++A)k.write_shift(-4,A<N[2]?N[1]+A:-1)}if(N[1])for(X=0;X<N[1];++X){for(;A<236+X*127;++A)k.write_shift(-4,A<N[2]?N[1]+A:-1);k.write_shift(-4,X===N[1]-1?ee:X+1)}var J=function(xe){for(X+=xe;A<X-1;++A)k.write_shift(-4,A+1);xe&&(++A,k.write_shift(-4,ee))};for(X=A=0,X+=N[1];A<X;++A)k.write_shift(-4,_e.DIFSECT);for(X+=N[2];A<X;++A)k.write_shift(-4,_e.FATSECT);J(N[3]),J(N[4]);for(var V=0,K=0,Y=v.FileIndex[0];V<v.FileIndex.length;++V)Y=v.FileIndex[V],Y.content&&(K=Y.content.length,!(K<4096)&&(Y.start=X,J(K+511>>9)));for(J(N[6]+7>>3);k.l&511;)k.write_shift(-4,_e.ENDOFCHAIN);for(X=A=0,V=0;V<v.FileIndex.length;++V)Y=v.FileIndex[V],Y.content&&(K=Y.content.length,!(!K||K>=4096)&&(Y.start=X,J(K+63>>6)));for(;k.l&511;)k.write_shift(-4,_e.ENDOFCHAIN);for(A=0;A<N[4]<<2;++A){var ne=v.FullPaths[A];if(!ne||ne.length===0){for(V=0;V<17;++V)k.write_shift(4,0);for(V=0;V<3;++V)k.write_shift(4,-1);for(V=0;V<12;++V)k.write_shift(4,0);continue}Y=v.FileIndex[A],A===0&&(Y.start=Y.size?Y.start-1:ee);var ce=A===0&&S.root||Y.name;if(K=2*(ce.length+1),k.write_shift(64,ce,"utf16le"),k.write_shift(2,K),k.write_shift(1,Y.type),k.write_shift(1,Y.color),k.write_shift(-4,Y.L),k.write_shift(-4,Y.R),k.write_shift(-4,Y.C),Y.clsid)k.write_shift(16,Y.clsid,"hex");else for(V=0;V<4;++V)k.write_shift(4,0);k.write_shift(4,Y.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,Y.start),k.write_shift(4,Y.size),k.write_shift(4,0)}for(A=1;A<v.FileIndex.length;++A)if(Y=v.FileIndex[A],Y.size>=4096)if(k.l=Y.start+1<<9,Ce&&Buffer.isBuffer(Y.content))Y.content.copy(k,k.l,0,Y.size),k.l+=Y.size+511&-512;else{for(V=0;V<Y.size;++V)k.write_shift(1,Y.content[V]);for(;V&511;++V)k.write_shift(1,0)}for(A=1;A<v.FileIndex.length;++A)if(Y=v.FileIndex[A],Y.size>0&&Y.size<4096)if(Ce&&Buffer.isBuffer(Y.content))Y.content.copy(k,k.l,0,Y.size),k.l+=Y.size+63&-64;else{for(V=0;V<Y.size;++V)k.write_shift(1,Y.content[V]);for(;V&63;++V)k.write_shift(1,0)}if(Ce)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function U(v,C){var S=v.FullPaths.map(function(V){return V.toUpperCase()}),N=S.map(function(V){var K=V.split("/");return K[K.length-(V.slice(-1)=="/"?2:1)]}),k=!1;C.charCodeAt(0)===47?(k=!0,C=S[0].slice(0,-1)+C):k=C.indexOf("/")!==-1;var A=C.toUpperCase(),X=k===!0?S.indexOf(A):N.indexOf(A);if(X!==-1)return v.FileIndex[X];var J=!A.match(Vs);for(A=A.replace(ps,""),J&&(A=A.replace(Vs,"!")),X=0;X<S.length;++X)if((J?S[X].replace(Vs,"!"):S[X]).replace(ps,"")==A||(J?N[X].replace(Vs,"!"):N[X]).replace(ps,"")==A)return v.FileIndex[X];return null}var H=64,ee=-2,pe="d0cf11e0a1b11ae1",ge=[208,207,17,224,161,177,26,225],je="00000000000000000000000000000000",_e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ee,FREESECT:-1,HEADER_SIGNATURE:pe,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:je,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ke(v,C,S){d();var N=P(v,S);c.writeFileSync(C,N)}function de(v){for(var C=new Array(v.length),S=0;S<v.length;++S)C[S]=String.fromCharCode(v[S]);return C.join("")}function me(v,C){var S=P(v,C);switch(C&&C.type||"buffer"){case"file":return d(),c.writeFileSync(C.filename,S),S;case"binary":return typeof S=="string"?S:de(S);case"base64":return js(typeof S=="string"?S:de(S));case"buffer":if(Ce)return Buffer.isBuffer(S)?S:ir(S);case"array":return typeof S=="string"?Mt(S):S}return S}var Se;function y(v){try{var C=v.InflateRaw,S=new C;if(S._processChunk(new Uint8Array([3,0]),S._finishFlushFlag),S.bytesRead)Se=v;else throw new Error("zlib does not expose bytesRead")}catch(N){console.error("cannot use native zlib: "+(N.message||N))}}function F(v,C){if(!Se)return Pr(v,C);var S=Se.InflateRaw,N=new S,k=N._processChunk(v.slice(v.l),N._finishFlushFlag);return v.l+=N.bytesRead,k}function O(v){return Se?Se.deflateRawSync(v):Ke(v)}var b=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],L=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Z(v){var C=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(C>>16|C>>8|C)&255}for(var se=typeof Uint8Array<"u",ae=se?new Uint8Array(256):[],ye=0;ye<256;++ye)ae[ye]=Z(ye);function G(v,C){var S=ae[v&255];return C<=8?S>>>8-C:(S=S<<8|ae[v>>8&255],C<=16?S>>>16-C:(S=S<<8|ae[v>>16&255],S>>>24-C))}function ve(v,C){var S=C&7,N=C>>>3;return(v[N]|(S<=6?0:v[N+1]<<8))>>>S&3}function M(v,C){var S=C&7,N=C>>>3;return(v[N]|(S<=5?0:v[N+1]<<8))>>>S&7}function Q(v,C){var S=C&7,N=C>>>3;return(v[N]|(S<=4?0:v[N+1]<<8))>>>S&15}function he(v,C){var S=C&7,N=C>>>3;return(v[N]|(S<=3?0:v[N+1]<<8))>>>S&31}function re(v,C){var S=C&7,N=C>>>3;return(v[N]|(S<=1?0:v[N+1]<<8))>>>S&127}function be(v,C,S){var N=C&7,k=C>>>3,A=(1<<S)-1,X=v[k]>>>N;return S<8-N||(X|=v[k+1]<<8-N,S<16-N)||(X|=v[k+2]<<16-N,S<24-N)||(X|=v[k+3]<<24-N),X&A}function Re(v,C,S){var N=C&7,k=C>>>3;return N<=5?v[k]|=(S&7)<<N:(v[k]|=S<<N&255,v[k+1]=(S&7)>>8-N),C+3}function Ue(v,C,S){var N=C&7,k=C>>>3;return S=(S&1)<<N,v[k]|=S,C+1}function Le(v,C,S){var N=C&7,k=C>>>3;return S<<=N,v[k]|=S&255,S>>>=8,v[k+1]=S,C+8}function wt(v,C,S){var N=C&7,k=C>>>3;return S<<=N,v[k]|=S&255,S>>>=8,v[k+1]=S&255,v[k+2]=S>>>8,C+16}function Ee(v,C){var S=v.length,N=2*S>C?2*S:C+5,k=0;if(S>=C)return v;if(Ce){var A=xi(N);if(v.copy)v.copy(A);else for(;k<v.length;++k)A[k]=v[k];return A}else if(se){var X=new Uint8Array(N);if(X.set)X.set(v);else for(;k<S;++k)X[k]=v[k];return X}return v.length=N,v}function Ae(v){for(var C=new Array(v),S=0;S<v;++S)C[S]=0;return C}function st(v,C,S){var N=1,k=0,A=0,X=0,J=0,V=v.length,K=se?new Uint16Array(32):Ae(32);for(A=0;A<32;++A)K[A]=0;for(A=V;A<S;++A)v[A]=0;V=v.length;var Y=se?new Uint16Array(V):Ae(V);for(A=0;A<V;++A)K[k=v[A]]++,N<k&&(N=k),Y[A]=0;for(K[0]=0,A=1;A<=N;++A)K[A+16]=J=J+K[A-1]<<1;for(A=0;A<V;++A)J=v[A],J!=0&&(Y[A]=K[J+16]++);var ne=0;for(A=0;A<V;++A)if(ne=v[A],ne!=0)for(J=G(Y[A],N)>>N-ne,X=(1<<N+4-ne)-1;X>=0;--X)C[J|X<<ne]=ne&15|A<<4;return N}var mt=se?new Uint16Array(512):Ae(512),qt=se?new Uint16Array(32):Ae(32);if(!se){for(var $t=0;$t<512;++$t)mt[$t]=0;for($t=0;$t<32;++$t)qt[$t]=0}(function(){for(var v=[],C=0;C<32;C++)v.push(5);st(v,qt,32);var S=[];for(C=0;C<=143;C++)S.push(8);for(;C<=255;C++)S.push(9);for(;C<=279;C++)S.push(7);for(;C<=287;C++)S.push(8);st(S,mt,288)})();var Qe=function(){for(var C=se?new Uint8Array(32768):[],S=0,N=0;S<L.length-1;++S)for(;N<L[S+1];++N)C[N]=S;for(;N<32768;++N)C[N]=29;var k=se?new Uint8Array(259):[];for(S=0,N=0;S<W.length-1;++S)for(;N<W[S+1];++N)k[N]=S;function A(J,V){for(var K=0;K<J.length;){var Y=Math.min(65535,J.length-K),ne=K+Y==J.length;for(V.write_shift(1,+ne),V.write_shift(2,Y),V.write_shift(2,~Y&65535);Y-- >0;)V[V.l++]=J[K++]}return V.l}function X(J,V){for(var K=0,Y=0,ne=se?new Uint16Array(32768):[];Y<J.length;){var ce=Math.min(65535,J.length-Y);if(ce<10){for(K=Re(V,K,+(Y+ce==J.length)),K&7&&(K+=8-(K&7)),V.l=K/8|0,V.write_shift(2,ce),V.write_shift(2,~ce&65535);ce-- >0;)V[V.l++]=J[Y++];K=V.l*8;continue}K=Re(V,K,+(Y+ce==J.length)+2);for(var xe=0;ce-- >0;){var ie=J[Y];xe=(xe<<5^ie)&32767;var fe=-1,we=0;if((fe=ne[xe])&&(fe|=Y&-32768,fe>Y&&(fe-=32768),fe<Y))for(;J[fe+we]==J[Y+we]&&we<250;)++we;if(we>2){ie=k[we],ie<=22?K=Le(V,K,ae[ie+1]>>1)-1:(Le(V,K,3),K+=5,Le(V,K,ae[ie-23]>>5),K+=3);var $e=ie<8?0:ie-4>>2;$e>0&&(wt(V,K,we-W[ie]),K+=$e),ie=C[Y-fe],K=Le(V,K,ae[ie]>>3),K-=3;var He=ie<4?0:ie-2>>1;He>0&&(wt(V,K,Y-fe-L[ie]),K+=He);for(var ft=0;ft<we;++ft)ne[xe]=Y&32767,xe=(xe<<5^J[Y])&32767,++Y;ce-=we-1}else ie<=143?ie=ie+48:K=Ue(V,K,1),K=Le(V,K,ae[ie]),ne[xe]=Y&32767,++Y}K=Le(V,K,0)-1}return V.l=(K+7)/8|0,V.l}return function(V,K){return V.length<8?A(V,K):X(V,K)}}();function Ke(v){var C=q(50+Math.floor(v.length*1.1)),S=Qe(v,C);return C.slice(0,S)}var ht=se?new Uint16Array(32768):Ae(32768),or=se?new Uint16Array(32768):Ae(32768),vr=se?new Uint16Array(128):Ae(128),os=1,nt=1;function Ht(v,C){var S=he(v,C)+257;C+=5;var N=he(v,C)+1;C+=5;var k=Q(v,C)+4;C+=4;for(var A=0,X=se?new Uint8Array(19):Ae(19),J=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],V=1,K=se?new Uint8Array(8):Ae(8),Y=se?new Uint8Array(8):Ae(8),ne=X.length,ce=0;ce<k;++ce)X[b[ce]]=A=M(v,C),V<A&&(V=A),K[A]++,C+=3;var xe=0;for(K[0]=0,ce=1;ce<=V;++ce)Y[ce]=xe=xe+K[ce-1]<<1;for(ce=0;ce<ne;++ce)(xe=X[ce])!=0&&(J[ce]=Y[xe]++);var ie=0;for(ce=0;ce<ne;++ce)if(ie=X[ce],ie!=0){xe=ae[J[ce]]>>8-ie;for(var fe=(1<<7-ie)-1;fe>=0;--fe)vr[xe|fe<<ie]=ie&7|ce<<3}var we=[];for(V=1;we.length<S+N;)switch(xe=vr[re(v,C)],C+=xe&7,xe>>>=3){case 16:for(A=3+ve(v,C),C+=2,xe=we[we.length-1];A-- >0;)we.push(xe);break;case 17:for(A=3+M(v,C),C+=3;A-- >0;)we.push(0);break;case 18:for(A=11+re(v,C),C+=7;A-- >0;)we.push(0);break;default:we.push(xe),V<xe&&(V=xe);break}var $e=we.slice(0,S),He=we.slice(S);for(ce=S;ce<286;++ce)$e[ce]=0;for(ce=N;ce<30;++ce)He[ce]=0;return os=st($e,ht,286),nt=st(He,or,30),C}function Wt(v,C){if(v[0]==3&&!(v[1]&3))return[Tr(C),2];for(var S=0,N=0,k=xi(C||1<<18),A=0,X=k.length>>>0,J=0,V=0;!(N&1);){if(N=M(v,S),S+=3,N>>>1)N>>1==1?(J=9,V=5):(S=Ht(v,S),J=os,V=nt);else{S&7&&(S+=8-(S&7));var K=v[S>>>3]|v[(S>>>3)+1]<<8;if(S+=32,K>0)for(!C&&X<A+K&&(k=Ee(k,A+K),X=k.length);K-- >0;)k[A++]=v[S>>>3],S+=8;continue}for(;;){!C&&X<A+32767&&(k=Ee(k,A+32767),X=k.length);var Y=be(v,S,J),ne=N>>>1==1?mt[Y]:ht[Y];if(S+=ne&15,ne>>>=4,!(ne>>>8&255))k[A++]=ne;else{if(ne==256)break;ne-=257;var ce=ne<8?0:ne-4>>2;ce>5&&(ce=0);var xe=A+W[ne];ce>0&&(xe+=be(v,S,ce),S+=ce),Y=be(v,S,V),ne=N>>>1==1?qt[Y]:or[Y],S+=ne&15,ne>>>=4;var ie=ne<4?0:ne-2>>1,fe=L[ne];for(ie>0&&(fe+=be(v,S,ie),S+=ie),!C&&X<xe&&(k=Ee(k,xe+100),X=k.length);A<xe;)k[A]=k[A-fe],++A}}}return C?[k,S+7>>>3]:[k.slice(0,A),S+7>>>3]}function Pr(v,C){var S=v.slice(v.l||0),N=Wt(S,C);return v.l+=N[1],N[0]}function ri(v,C){if(v)typeof console<"u"&&console.error(C);else throw new Error(C)}function si(v,C){var S=v;Tt(S,0);var N=[],k=[],A={FileIndex:N,FullPaths:k};E(A,{root:C.root});for(var X=S.length-4;(S[X]!=80||S[X+1]!=75||S[X+2]!=5||S[X+3]!=6)&&X>=0;)--X;S.l=X+4,S.l+=4;var J=S.read_shift(2);S.l+=6;var V=S.read_shift(4);for(S.l=V,X=0;X<J;++X){S.l+=20;var K=S.read_shift(4),Y=S.read_shift(4),ne=S.read_shift(2),ce=S.read_shift(2),xe=S.read_shift(2);S.l+=8;var ie=S.read_shift(4),fe=l(S.slice(S.l+ne,S.l+ne+ce));S.l+=ne+ce+xe;var we=S.l;S.l=ie+4,wc(S,K,Y,A,fe),S.l=we}return A}function wc(v,C,S,N,k){v.l+=2;var A=v.read_shift(2),X=v.read_shift(2),J=o(v);if(A&8257)throw new Error("Unsupported ZIP encryption");for(var V=v.read_shift(4),K=v.read_shift(4),Y=v.read_shift(4),ne=v.read_shift(2),ce=v.read_shift(2),xe="",ie=0;ie<ne;++ie)xe+=String.fromCharCode(v[v.l++]);if(ce){var fe=l(v.slice(v.l,v.l+ce));(fe[21589]||{}).mt&&(J=fe[21589].mt),((k||{})[21589]||{}).mt&&(J=k[21589].mt)}v.l+=ce;var we=v.slice(v.l,v.l+K);switch(X){case 8:we=F(v,Y);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+X)}var $e=!1;A&8&&(V=v.read_shift(4),V==134695760&&(V=v.read_shift(4),$e=!0),K=v.read_shift(4),Y=v.read_shift(4)),K!=C&&ri($e,"Bad compressed size: "+C+" != "+K),Y!=S&&ri($e,"Bad uncompressed size: "+S+" != "+Y),Hn(N,xe,we,{unsafe:!0,mt:J})}function _c(v,C){var S=C||{},N=[],k=[],A=q(1),X=S.compression?8:0,J=0,V=0,K=0,Y=0,ne=0,ce=v.FullPaths[0],xe=ce,ie=v.FileIndex[0],fe=[],we=0;for(V=1;V<v.FullPaths.length;++V)if(xe=v.FullPaths[V].slice(ce.length),ie=v.FileIndex[V],!(!ie.size||!ie.content||xe=="Sh33tJ5")){var $e=Y,He=q(xe.length);for(K=0;K<xe.length;++K)He.write_shift(1,xe.charCodeAt(K)&127);He=He.slice(0,He.l),fe[ne]=xh.buf(ie.content,0);var ft=ie.content;X==8&&(ft=O(ft)),A=q(30),A.write_shift(4,67324752),A.write_shift(2,20),A.write_shift(2,J),A.write_shift(2,X),ie.mt?i(A,ie.mt):A.write_shift(4,0),A.write_shift(-4,fe[ne]),A.write_shift(4,ft.length),A.write_shift(4,ie.content.length),A.write_shift(2,He.length),A.write_shift(2,0),Y+=A.length,N.push(A),Y+=He.length,N.push(He),Y+=ft.length,N.push(ft),A=q(46),A.write_shift(4,33639248),A.write_shift(2,0),A.write_shift(2,20),A.write_shift(2,J),A.write_shift(2,X),A.write_shift(4,0),A.write_shift(-4,fe[ne]),A.write_shift(4,ft.length),A.write_shift(4,ie.content.length),A.write_shift(2,He.length),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(4,0),A.write_shift(4,$e),we+=A.l,k.push(A),we+=He.length,k.push(He),++ne}return A=q(22),A.write_shift(4,101010256),A.write_shift(2,0),A.write_shift(2,0),A.write_shift(2,ne),A.write_shift(2,ne),A.write_shift(4,we),A.write_shift(4,Y),A.write_shift(2,0),ot([ot(N),ot(k),A])}var $s={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Sc(v,C){if(v.ctype)return v.ctype;var S=v.name||"",N=S.match(/\.([^\.]+)$/);return N&&$s[N[1]]||C&&(N=(S=C).match(/[\.\\]([^\.\\])+$/),N&&$s[N[1]])?$s[N[1]]:"application/octet-stream"}function Nc(v){for(var C=js(v),S=[],N=0;N<C.length;N+=76)S.push(C.slice(N,N+76));return S.join(`\r
`)+`\r
`}function jc(v){var C=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(K){var Y=K.charCodeAt(0).toString(16).toUpperCase();return"="+(Y.length==1?"0"+Y:Y)});C=C.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),C.charAt(0)==`
`&&(C="=0D"+C.slice(1)),C=C.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var S=[],N=C.split(`\r
`),k=0;k<N.length;++k){var A=N[k];if(A.length==0){S.push("");continue}for(var X=0;X<A.length;){var J=76,V=A.slice(X,X+J);V.charAt(J-1)=="="?J--:V.charAt(J-2)=="="?J-=2:V.charAt(J-3)=="="&&(J-=3),V=A.slice(X,X+J),X+=J,X<A.length&&(V+="="),S.push(V)}}return S.join(`\r
`)}function Ec(v){for(var C=[],S=0;S<v.length;++S){for(var N=v[S];S<=v.length&&N.charAt(N.length-1)=="=";)N=N.slice(0,N.length-1)+v[++S];C.push(N)}for(var k=0;k<C.length;++k)C[k]=C[k].replace(/[=][0-9A-Fa-f]{2}/g,function(A){return String.fromCharCode(parseInt(A.slice(1),16))});return Mt(C.join(`\r
`))}function Tc(v,C,S){for(var N="",k="",A="",X,J=0;J<10;++J){var V=C[J];if(!V||V.match(/^\s*$/))break;var K=V.match(/^(.*?):\s*([^\s].*)$/);if(K)switch(K[1].toLowerCase()){case"content-location":N=K[2].trim();break;case"content-type":A=K[2].trim();break;case"content-transfer-encoding":k=K[2].trim();break}}switch(++J,k.toLowerCase()){case"base64":X=Mt(nr(C.slice(J).join("")));break;case"quoted-printable":X=Ec(C.slice(J));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var Y=Hn(v,N.slice(S.length),X,{unsafe:!0});A&&(Y.ctype=A)}function Cc(v,C){if(de(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var S=C&&C.root||"",N=(Ce&&Buffer.isBuffer(v)?v.toString("binary"):de(v)).split(`\r
`),k=0,A="";for(k=0;k<N.length;++k)if(A=N[k],!!/^Content-Location:/i.test(A)&&(A=A.slice(A.indexOf("file")),S||(S=A.slice(0,A.lastIndexOf("/")+1)),A.slice(0,S.length)!=S))for(;S.length>0&&(S=S.slice(0,S.length-1),S=S.slice(0,S.lastIndexOf("/")+1),A.slice(0,S.length)!=S););var X=(N[1]||"").match(/boundary="(.*?)"/);if(!X)throw new Error("MAD cannot find boundary");var J="--"+(X[1]||""),V=[],K=[],Y={FileIndex:V,FullPaths:K};E(Y);var ne,ce=0;for(k=0;k<N.length;++k){var xe=N[k];xe!==J&&xe!==J+"--"||(ce++&&Tc(Y,N.slice(ne,k),S),ne=k)}return Y}function kc(v,C){var S=C||{},N=S.boundary||"SheetJS";N="------="+N;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+N.slice(2)+'"',"","",""],A=v.FullPaths[0],X=A,J=v.FileIndex[0],V=1;V<v.FullPaths.length;++V)if(X=v.FullPaths[V].slice(A.length),J=v.FileIndex[V],!(!J.size||!J.content||X=="Sh33tJ5")){X=X.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(we){return"_x"+we.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(we){return"_u"+we.charCodeAt(0).toString(16)+"_"});for(var K=J.content,Y=Ce&&Buffer.isBuffer(K)?K.toString("binary"):de(K),ne=0,ce=Math.min(1024,Y.length),xe=0,ie=0;ie<=ce;++ie)(xe=Y.charCodeAt(ie))>=32&&xe<128&&++ne;var fe=ne>=ce*4/5;k.push(N),k.push("Content-Location: "+(S.root||"file:///C:/SheetJS/")+X),k.push("Content-Transfer-Encoding: "+(fe?"quoted-printable":"base64")),k.push("Content-Type: "+Sc(J,X)),k.push(""),k.push(fe?jc(Y):Nc(Y))}return k.push(N+`--\r
`),k.join(`\r
`)}function Ac(v){var C={};return E(C,v),C}function Hn(v,C,S,N){var k=N&&N.unsafe;k||E(v);var A=!k&&Pe.find(v,C);if(!A){var X=v.FullPaths[0];C.slice(0,X.length)==X?X=C:(X.slice(-1)!="/"&&(X+="/"),X=(X+C).replace("//","/")),A={name:a(C),type:2},v.FileIndex.push(A),v.FullPaths.push(X),k||Pe.utils.cfb_gc(v)}return A.content=S,A.size=S?S.length:0,N&&(N.CLSID&&(A.clsid=N.CLSID),N.mt&&(A.mt=N.mt),N.ct&&(A.ct=N.ct)),A}function Rc(v,C){E(v);var S=Pe.find(v,C);if(S){for(var N=0;N<v.FileIndex.length;++N)if(v.FileIndex[N]==S)return v.FileIndex.splice(N,1),v.FullPaths.splice(N,1),!0}return!1}function Fc(v,C,S){E(v);var N=Pe.find(v,C);if(N){for(var k=0;k<v.FileIndex.length;++k)if(v.FileIndex[k]==N)return v.FileIndex[k].name=a(S),v.FullPaths[k]=S,!0}return!1}function Dc(v){D(v,!0)}return r.find=U,r.read=z,r.parse=h,r.write=me,r.writeFile=ke,r.utils={cfb_new:Ac,cfb_add:Hn,cfb_del:Rc,cfb_mov:Fc,cfb_gc:Dc,ReadShift:vs,CheckField:Zo,prep_blob:Tt,bconcat:ot,use_zlib:y,_deflateRaw:Ke,_inflateRaw:Pr,consts:_e},r}();function mh(t){return typeof t=="string"?Rn(t):Array.isArray(t)?Ud(t):t}function Is(t,r,e){if(typeof Deno<"u"){if(e&&typeof r=="string")switch(e){case"utf8":r=new TextEncoder(e).encode(r);break;case"binary":r=Rn(r);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(t,r)}var s=e=="utf8"?Ts(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,t);if(typeof Blob<"u"){var a=new Blob([mh(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(r)&&(r=Os(r)),l.write(r),l.close(),r}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function dt(t){for(var r=Object.keys(t),e=[],s=0;s<r.length;++s)Object.prototype.hasOwnProperty.call(t,r[s])&&e.push(r[s]);return e}function _i(t,r){for(var e=[],s=dt(t),a=0;a!==s.length;++a)e[t[s[a]][r]]==null&&(e[t[s[a]][r]]=s[a]);return e}function Fa(t){for(var r=[],e=dt(t),s=0;s!==e.length;++s)r[t[e[s]]]=e[s];return r}function On(t){for(var r=[],e=dt(t),s=0;s!==e.length;++s)r[t[e[s]]]=parseInt(e[s],10);return r}function ph(t){for(var r=[],e=dt(t),s=0;s!==e.length;++s)r[t[e[s]]]==null&&(r[t[e[s]]]=[]),r[t[e[s]]].push(e[s]);return r}var un=new Date(1899,11,30,0,0,0);function Nt(t,r){var e=t.getTime(),s=un.getTime()+(t.getTimezoneOffset()-un.getTimezoneOffset())*6e4;return(e-s)/(24*60*60*1e3)}var Po=new Date,gh=un.getTime()+(Po.getTimezoneOffset()-un.getTimezoneOffset())*6e4,Si=Po.getTimezoneOffset();function Lo(t){var r=new Date;return r.setTime(t*24*60*60*1e3+gh),r.getTimezoneOffset()!==Si&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Si)*6e4),r}var Ni=new Date("2017-02-19T19:06:09.000Z"),Bo=isNaN(Ni.getFullYear())?new Date("2/19/17"):Ni,vh=Bo.getFullYear()==2017;function bt(t,r){var e=new Date(t);if(vh)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if(Bo.getFullYear()==1917&&!isNaN(e.getFullYear())){var s=e.getFullYear();return t.indexOf(""+s)>-1||e.setFullYear(e.getFullYear()+100),e}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function In(t,r){if(Ce&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var e={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(i){return e[i]||i})}catch{}for(var s=[],a=0;a!=t.length;++a)s.push(String.fromCharCode(t[a]));return s.join("")}function jt(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=jt(t[e]));return r}function Ve(t,r){for(var e="";e.length<r;)e+=t;return e}function rr(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,s=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(s))||(s=s.replace(/[(](.*)[)]/,function(a,i){return e=-e,i}),!isNaN(r=Number(s)))?r/e:r}var yh=["january","february","march","april","may","june","july","august","september","october","november","december"];function Es(t){var r=new Date(t),e=new Date(NaN),s=r.getYear(),a=r.getMonth(),i=r.getDate();if(isNaN(i))return e;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&yh.indexOf(o)==-1)return e}else if(o.match(/[a-z]/))return e;return s<0||s>8099?e:(a>0||i>1)&&s!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}function Ne(t,r,e){if(t.FullPaths){if(typeof e=="string"){var s;return Ce?s=ir(e):s=$d(e),Pe.utils.cfb_add(t,r,s)}Pe.utils.cfb_add(t,r,e)}else t.file(r,e)}function Da(){return Pe.utils.cfb_new()}var Je=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,bh={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Oa=Fa(bh),Ia=/[&<>'"]/g,wh=/[\u0000-\u0008\u000b-\u001f]/g;function Oe(t){var r=t+"";return r.replace(Ia,function(e){return Oa[e]}).replace(wh,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function ji(t){return Oe(t).replace(/ /g,"_x0020_")}var Mo=/[\u0000-\u001f]/g;function _h(t){var r=t+"";return r.replace(Ia,function(e){return Oa[e]}).replace(/\n/g,"<br/>").replace(Mo,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function Sh(t){var r=t+"";return r.replace(Ia,function(e){return Oa[e]}).replace(Mo,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function Nh(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function jh(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function qn(t){for(var r="",e=0,s=0,a=0,i=0,o=0,l=0;e<t.length;){if(s=t.charCodeAt(e++),s<128){r+=String.fromCharCode(s);continue}if(a=t.charCodeAt(e++),s>191&&s<224){o=(s&31)<<6,o|=a&63,r+=String.fromCharCode(o);continue}if(i=t.charCodeAt(e++),s<240){r+=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63);continue}o=t.charCodeAt(e++),l=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(l&1023))}return r}function Ei(t){var r=Tr(2*t.length),e,s,a=1,i=0,o=0,l;for(s=0;s<t.length;s+=a)a=1,(l=t.charCodeAt(s))<128?e=l:l<224?(e=(l&31)*64+(t.charCodeAt(s+1)&63),a=2):l<240?(e=(l&15)*4096+(t.charCodeAt(s+1)&63)*64+(t.charCodeAt(s+2)&63),a=3):(a=4,e=(l&7)*262144+(t.charCodeAt(s+1)&63)*4096+(t.charCodeAt(s+2)&63)*64+(t.charCodeAt(s+3)&63),e-=65536,o=55296+(e>>>10&1023),e=56320+(e&1023)),o!==0&&(r[i++]=o&255,r[i++]=o>>>8,o=0),r[i++]=e%256,r[i++]=e>>>8;return r.slice(0,i).toString("ucs2")}function Ti(t){return ir(t,"binary").toString("utf8")}var Ks="foo bar bazâð£",gs=Ce&&(Ti(Ks)==qn(Ks)&&Ti||Ei(Ks)==qn(Ks)&&Ei)||qn,Ts=Ce?function(t){return ir(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,s=0,a=0;e<t.length;)switch(s=t.charCodeAt(e++),!0){case s<128:r.push(String.fromCharCode(s));break;case s<2048:r.push(String.fromCharCode(192+(s>>6))),r.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,a=t.charCodeAt(e++)-56320+(s<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(s>>12))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)))}return r.join("")},Eh=function(){var t=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var s=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)s=s.replace(t[a][0],t[a][1]);return s}}(),zo=/(^\s|\s$|\n)/;function lt(t,r){return"<"+t+(r.match(zo)?' xml:space="preserve"':"")+">"+r+"</"+t+">"}function Cs(t){return dt(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function oe(t,r,e){return"<"+t+(e!=null?Cs(e):"")+(r!=null?(r.match(zo)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function pa(t,r){try{return t.toISOString().replace(/\.\d*/,"")}catch(e){if(r)throw e}return""}function Th(t,r){switch(typeof t){case"string":var e=oe("vt:lpwstr",Oe(t));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return oe((t|0)==t?"vt:i4":"vt:r8",Oe(String(t)));case"boolean":return oe("vt:bool",t?"true":"false")}if(t instanceof Date)return oe("vt:filetime",pa(t));throw new Error("Unable to serialize "+t)}var et={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},ss=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],Ct={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Ch(t,r){for(var e=1-2*(t[r+7]>>>7),s=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),a=t[r+6]&15,i=5;i>=0;--i)a=a*256+t[r+i];return s==2047?a==0?e*(1/0):NaN:(s==0?s=-1022:(s-=1023,a+=Math.pow(2,52)),e*Math.pow(2,s-52)*a)}function kh(t,r,e){var s=(r<0||1/r==-1/0?1:0)<<7,a=0,i=0,o=s?-r:r;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(r)?26985:0);for(var l=0;l<=5;++l,i/=256)t[e+l]=i&255;t[e+6]=(a&15)<<4|i&15,t[e+7]=a>>4|s}var Ci=function(t){for(var r=[],e=10240,s=0;s<t[0].length;++s)if(t[0][s])for(var a=0,i=t[0][s].length;a<i;a+=e)r.push.apply(r,t[0][s].slice(a,a+e));return r},ki=Ce?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:ir(r)})):Ci(t)}:Ci,Ai=function(t,r,e){for(var s=[],a=r;a<e;a+=2)s.push(String.fromCharCode(xs(t,a)));return s.join("").replace(ps,"")},Pa=Ce?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(ps,""):Ai(t,r,e)}:Ai,Ri=function(t,r,e){for(var s=[],a=r;a<r+e;++a)s.push(("0"+t[a].toString(16)).slice(-2));return s.join("")},Uo=Ce?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):Ri(t,r,e)}:Ri,Fi=function(t,r,e){for(var s=[],a=r;a<e;a++)s.push(String.fromCharCode($r(t,a)));return s.join("")},Ps=Ce?function(r,e,s){return Buffer.isBuffer(r)?r.toString("utf8",e,s):Fi(r,e,s)}:Fi,$o=function(t,r){var e=kt(t,r);return e>0?Ps(t,r+4,r+4+e-1):""},Ho=$o,Wo=function(t,r){var e=kt(t,r);return e>0?Ps(t,r+4,r+4+e-1):""},Go=Wo,Vo=function(t,r){var e=2*kt(t,r);return e>0?Ps(t,r+4,r+4+e-1):""},Xo=Vo,Ko=function(r,e){var s=kt(r,e);return s>0?Pa(r,e+4,e+4+s):""},Yo=Ko,qo=function(t,r){var e=kt(t,r);return e>0?Ps(t,r+4,r+4+e):""},Jo=qo,Qo=function(t,r){return Ch(t,r)},xn=Qo,La=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Ce&&(Ho=function(r,e){if(!Buffer.isBuffer(r))return $o(r,e);var s=r.readUInt32LE(e);return s>0?r.toString("utf8",e+4,e+4+s-1):""},Go=function(r,e){if(!Buffer.isBuffer(r))return Wo(r,e);var s=r.readUInt32LE(e);return s>0?r.toString("utf8",e+4,e+4+s-1):""},Xo=function(r,e){if(!Buffer.isBuffer(r))return Vo(r,e);var s=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+s-1)},Yo=function(r,e){if(!Buffer.isBuffer(r))return Ko(r,e);var s=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+s)},Jo=function(r,e){if(!Buffer.isBuffer(r))return qo(r,e);var s=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+s)},xn=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):Qo(r,e)},La=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var $r=function(t,r){return t[r]},xs=function(t,r){return t[r+1]*256+t[r]},Ah=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},kt=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},Nr=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},Rh=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function vs(t,r){var e="",s,a,i=[],o,l,c,d;switch(r){case"dbcs":if(d=this.l,Ce&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)e+=String.fromCharCode(xs(this,d)),d+=2;t*=2;break;case"utf8":e=Ps(this,this.l,this.l+t);break;case"utf16le":t*=2,e=Pa(this,this.l,this.l+t);break;case"wstr":return vs.call(this,t,"dbcs");case"lpstr-ansi":e=Ho(this,this.l),t=4+kt(this,this.l);break;case"lpstr-cp":e=Go(this,this.l),t=4+kt(this,this.l);break;case"lpwstr":e=Xo(this,this.l),t=4+2*kt(this,this.l);break;case"lpp4":t=4+kt(this,this.l),e=Yo(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+kt(this,this.l),e=Jo(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(o=$r(this,this.l+t++))!==0;)i.push(Gs(o));e=i.join("");break;case"_wstr":for(t=0,e="";(o=xs(this,this.l+t))!==0;)i.push(Gs(o)),t+=2;t+=2,e=i.join("");break;case"dbcs-cont":for(e="",d=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=$r(this,d),this.l=d+1,l=vs.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Gs(xs(this,d))),d+=2}e=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(e="",d=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(d)!==-1)return o=$r(this,d),this.l=d+1,l=vs.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Gs($r(this,d))),d+=1}e=i.join("");break;default:switch(t){case 1:return s=$r(this,this.l),this.l++,s;case 2:return s=(r==="i"?Ah:xs)(this,this.l),this.l+=2,s;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(s=(t>0?Nr:Rh)(this,this.l),this.l+=4,s):(a=kt(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return t==8?a=xn(this,this.l):a=xn([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:e=Uo(this,this.l,t);break}}return this.l+=t,e}var Fh=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},Dh=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},Oh=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function Ih(t,r,e){var s=0,a=0;if(e==="dbcs"){for(a=0;a!=r.length;++a)Oh(this,r.charCodeAt(a),this.l+2*a);s=2*r.length}else if(e==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;s=r.length}else if(e==="hex"){for(;a<t;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(e==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(r.length,t);++a){var o=r.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:s=1,this[this.l]=r&255;break;case 2:s=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:s=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:s=4,Fh(this,r,this.l);break;case 8:if(s=8,e==="f"){kh(this,r,this.l);break}case 16:break;case-4:s=4,Dh(this,r,this.l);break}return this.l+=s,this}function Zo(t,r){var e=Uo(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function Tt(t,r){t.l=r,t.read_shift=vs,t.chk=Zo,t.write_shift=Ih}function Kt(t,r){t.l+=r}function q(t){var r=Tr(t);return Tt(r,0),r}function St(){var t=[],r=Ce?256:2048,e=function(d){var h=q(d);return Tt(h,0),h},s=e(r),a=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&t.push(s),s=null)},i=function(d){return s&&d<s.length-s.l?s:(a(),s=e(Math.max(d+1,r)))},o=function(){return a(),ot(t)},l=function(d){a(),s=d,s.l==null&&(s.l=s.length),i(r)};return{next:i,push:l,end:o,_bufs:t}}function te(t,r,e,s){var a=+r,i;if(!isNaN(a)){s||(s=k1[a].p||(e||[]).length||0),i=1+(a>=128?1:0)+1,s>=128&&++i,s>=16384&&++i,s>=2097152&&++i;var o=t.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&La(e)&&t.push(e)}}function ys(t,r,e){var s=jt(t);if(r.s?(s.cRel&&(s.c+=r.s.c),s.rRel&&(s.r+=r.s.r)):(s.cRel&&(s.c+=r.c),s.rRel&&(s.r+=r.r)),!e||e.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Di(t,r,e){var s=jt(t);return s.s=ys(s.s,r.s,e),s.e=ys(s.e,r.s,e),s}function bs(t,r){if(t.cRel&&t.c<0)for(t=jt(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=jt(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=Ie(t);return!t.cRel&&t.cRel!=null&&(e=Bh(e)),!t.rRel&&t.rRel!=null&&(e=Ph(e)),e}function Jn(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ut(t.s.c)+":"+(t.e.cRel?"":"$")+ut(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ct(t.s.r)+":"+(t.e.rRel?"":"$")+ct(t.e.r):bs(t.s,r.biff)+":"+bs(t.e,r.biff)}function Ba(t){return parseInt(Lh(t),10)-1}function ct(t){return""+(t+1)}function Ph(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Lh(t){return t.replace(/\$(\d+)$/,"$1")}function Ma(t){for(var r=Mh(t),e=0,s=0;s!==r.length;++s)e=26*e+r.charCodeAt(s)-64;return e-1}function ut(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function Bh(t){return t.replace(/^([A-Z])/,"$$$1")}function Mh(t){return t.replace(/^\$([A-Z])/,"$1")}function zh(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function tt(t){for(var r=0,e=0,s=0;s<t.length;++s){var a=t.charCodeAt(s);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(e=26*e+(a-64))}return{c:e-1,r:r-1}}function Ie(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function At(t){var r=t.indexOf(":");return r==-1?{s:tt(t),e:tt(t)}:{s:tt(t.slice(0,r)),e:tt(t.slice(r+1))}}function qe(t,r){return typeof r>"u"||typeof r=="number"?qe(t.s,t.e):(typeof t!="string"&&(t=Ie(t)),typeof r!="string"&&(r=Ie(r)),t==r?t:t+":"+r)}function ze(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,s=0,a=0,i=t.length;for(e=0;s<i&&!((a=t.charCodeAt(s)-64)<1||a>26);++s)e=26*e+a;for(r.s.c=--e,e=0;s<i&&!((a=t.charCodeAt(s)-48)<0||a>9);++s)e=10*e+a;if(r.s.r=--e,s===i||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++s,e=0;s!=i&&!((a=t.charCodeAt(s)-64)<1||a>26);++s)e=26*e+a;for(r.e.c=--e,e=0;s!=i&&!((a=t.charCodeAt(s)-48)<0||a>9);++s)e=10*e+a;return r.e.r=--e,r}function Oi(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=ur(t.z,e?Nt(r):r)}catch{}try{return t.w=ur((t.XF||{}).numFmtId||(e?14:0),e?Nt(r):r)}catch{return""+r}}function ar(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?Ls[t.v]||t.v:r==null?Oi(t,t.v):Oi(t,r))}function Rr(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",s={};return s[e]=t,{SheetNames:[e],Sheets:s}}function el(t,r,e){var s=e||{},a=t?Array.isArray(t):s.dense,i=t||(a?[]:{}),o=0,l=0;if(i&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?tt(s.origin):s.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var d={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var h=ze(i["!ref"]);d.s.c=h.s.c,d.s.r=h.s.r,d.e.c=Math.max(d.e.c,h.e.c),d.e.r=Math.max(d.e.r,h.e.r),o==-1&&(d.e.r=o=h.e.r+1)}for(var f=0;f!=r.length;++f)if(r[f]){if(!Array.isArray(r[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=r[f].length;++u)if(!(typeof r[f][u]>"u")){var m={v:r[f][u]},p=o+f,x=l+u;if(d.s.r>p&&(d.s.r=p),d.s.c>x&&(d.s.c=x),d.e.r<p&&(d.e.r=p),d.e.c<x&&(d.e.c=x),r[f][u]&&typeof r[f][u]=="object"&&!Array.isArray(r[f][u])&&!(r[f][u]instanceof Date))m=r[f][u];else if(Array.isArray(m.v)&&(m.f=r[f][u][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(s.nullError)m.t="e",m.v=0;else if(s.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=s.dateNF||Xe[14],s.cellDates?(m.t="d",m.w=ur(m.z,Nt(m.v))):(m.t="n",m.v=Nt(m.v),m.w=ur(m.z,m.v))):m.t="s";if(a)i[p]||(i[p]=[]),i[p][x]&&i[p][x].z&&(m.z=i[p][x].z),i[p][x]=m;else{var g=Ie({c:x,r:p});i[g]&&i[g].z&&(m.z=i[g].z),i[g]=m}}}return d.s.c<1e7&&(i["!ref"]=qe(d)),i}function ns(t,r){return el(null,t,r)}function Uh(t){return t.read_shift(4,"i")}function Ut(t,r){return r||(r=q(4)),r.write_shift(4,t),r}function xt(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function rt(t,r){var e=!1;return r==null&&(e=!0,r=q(4+2*t.length)),r.write_shift(4,t.length),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}function $h(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Hh(t,r){return r||(r=q(4)),r.write_shift(2,0),r.write_shift(2,0),r}function za(t,r){var e=t.l,s=t.read_shift(1),a=xt(t),i=[],o={t:a,h:a};if(s&1){for(var l=t.read_shift(4),c=0;c!=l;++c)i.push($h(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=e+r,o}function Wh(t,r){var e=!1;return r==null&&(e=!0,r=q(15+4*t.t.length)),r.write_shift(1,0),rt(t.t,r),e?r.slice(0,r.l):r}var Gh=za;function Vh(t,r){var e=!1;return r==null&&(e=!0,r=q(23+4*t.t.length)),r.write_shift(1,1),rt(t.t,r),r.write_shift(4,1),Hh({},r),e?r.slice(0,r.l):r}function It(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function Fr(t,r){return r==null&&(r=q(8)),r.write_shift(-4,t.c),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}function Dr(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}function Or(t,r){return r==null&&(r=q(4)),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}var Xh=xt,tl=rt;function Ua(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}function mn(t,r){var e=!1;return r==null&&(e=!0,r=q(127)),r.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}var Kh=xt,ga=Ua,$a=mn;function rl(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,s=r[0]&2;t.l+=4;var a=s===0?xn([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):Nr(r,0)>>2;return e?a/100:a}function sl(t,r){r==null&&(r=q(4));var e=0,s=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?s=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(s=1,e=1),s)r.write_shift(-4,((e?a:t)<<2)+(e+2));else throw new Error("unsupported RkNumber "+t)}function nl(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}function Yh(t,r){return r||(r=q(16)),r.write_shift(4,t.s.r),r.write_shift(4,t.e.r),r.write_shift(4,t.s.c),r.write_shift(4,t.e.c),r}var Ir=nl,as=Yh;function is(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Cr(t,r){return(r||q(8)).write_shift(8,t,"f")}function qh(t){var r={},e=t.read_shift(1),s=e>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,s){case 0:r.auto=1;break;case 1:r.index=a;var d=af[a];d&&(r.rgb=Gi(d));break;case 2:r.rgb=Gi([o,l,c]);break;case 3:r.theme=a;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function pn(t,r){if(r||(r=q(8)),!t||t.auto)return r.write_shift(4,0),r.write_shift(4,0),r;t.index!=null?(r.write_shift(1,2),r.write_shift(1,t.index)):t.theme!=null?(r.write_shift(1,6),r.write_shift(1,t.theme)):(r.write_shift(1,5),r.write_shift(1,0));var e=t.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),r.write_shift(2,e),!t.rgb||t.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var s=t.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),r.write_shift(1,parseInt(s.slice(0,2),16)),r.write_shift(1,parseInt(s.slice(2,4),16)),r.write_shift(1,parseInt(s.slice(4,6),16)),r.write_shift(1,255)}return r}function Jh(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function Qh(t,r){r||(r=q(2));var e=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return r.write_shift(1,e),r.write_shift(1,0),r}var al=2,Et=3,Ys=11,gn=19,qs=64,Zh=65,ef=71,tf=4108,rf=4126,it=80,Ii={1:{n:"CodePage",t:al},2:{n:"Category",t:it},3:{n:"PresentationFormat",t:it},4:{n:"ByteCount",t:Et},5:{n:"LineCount",t:Et},6:{n:"ParagraphCount",t:Et},7:{n:"SlideCount",t:Et},8:{n:"NoteCount",t:Et},9:{n:"HiddenCount",t:Et},10:{n:"MultimediaClipCount",t:Et},11:{n:"ScaleCrop",t:Ys},12:{n:"HeadingPairs",t:tf},13:{n:"TitlesOfParts",t:rf},14:{n:"Manager",t:it},15:{n:"Company",t:it},16:{n:"LinksUpToDate",t:Ys},17:{n:"CharacterCount",t:Et},19:{n:"SharedDoc",t:Ys},22:{n:"HyperlinksChanged",t:Ys},23:{n:"AppVersion",t:Et,p:"version"},24:{n:"DigSig",t:Zh},26:{n:"ContentType",t:it},27:{n:"ContentStatus",t:it},28:{n:"Language",t:it},29:{n:"Version",t:it},255:{},2147483648:{n:"Locale",t:gn},2147483651:{n:"Behavior",t:gn},1919054434:{}},Pi={1:{n:"CodePage",t:al},2:{n:"Title",t:it},3:{n:"Subject",t:it},4:{n:"Author",t:it},5:{n:"Keywords",t:it},6:{n:"Comments",t:it},7:{n:"Template",t:it},8:{n:"LastAuthor",t:it},9:{n:"RevNumber",t:it},10:{n:"EditTime",t:qs},11:{n:"LastPrinted",t:qs},12:{n:"CreatedDate",t:qs},13:{n:"ModifiedDate",t:qs},14:{n:"PageCount",t:Et},15:{n:"WordCount",t:Et},16:{n:"CharCount",t:Et},17:{n:"Thumbnail",t:ef},18:{n:"Application",t:it},19:{n:"DocSecurity",t:Et},255:{},2147483648:{n:"Locale",t:gn},2147483651:{n:"Behavior",t:gn},1919054434:{}};function sf(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var nf=sf([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),af=jt(nf),Ls={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},of={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Js={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function il(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function ol(t,r){var e=ph(of),s=[],a;s[s.length]=Je,s[s.length]=oe("Types",null,{xmlns:et.CT,"xmlns:xsd":et.xsd,"xmlns:xsi":et.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return oe("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){t[c]&&t[c].length>0&&(a=t[c][0],s[s.length]=oe("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:Js[c][r.bookType]||Js[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(d){s[s.length]=oe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:Js[c][r.bookType]||Js[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(d){s[s.length]=oe("Override",null,{PartName:(d[0]=="/"?"":"/")+d,ContentType:e[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var Te={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function ll(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function Gr(t){var r=[Je,oe("Relationships",null,{xmlns:et.RELS})];return dt(t["!id"]).forEach(function(e){r[r.length]=oe("Relationship",null,t["!id"][e])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function De(t,r,e,s,a,i){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),r<0)for(r=t["!idx"];t["!id"]["rId"+r];++r);if(t["!idx"]=r+1,a.Id="rId"+r,a.Type=s,a.Target=e,[Te.HLINK,Te.XPATH,Te.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+r);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,r}function lf(t){var r=[Je];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<t.length;++e)r.push('  <manifest:file-entry manifest:full-path="'+t[e][0]+'" manifest:media-type="'+t[e][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function Li(t,r,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function cf(t,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function df(t){var r=[Je];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=t.length;++e)r.push(Li(t[e][0],t[e][1])),r.push(cf("",t[e][0]));return r.push(Li("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function cl(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ln.version+"</meta:generator></office:meta></office:document-meta>"}var jr=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function Qn(t,r,e,s,a){a[t]!=null||r==null||r===""||(a[t]=r,r=Oe(r),s[s.length]=e?oe(t,r,e):lt(t,r))}function dl(t,r){var e=r||{},s=[Je,oe("cp:coreProperties",null,{"xmlns:cp":et.CORE_PROPS,"xmlns:dc":et.dc,"xmlns:dcterms":et.dcterms,"xmlns:dcmitype":et.dcmitype,"xmlns:xsi":et.xsi})],a={};if(!t&&!e.Props)return s.join("");t&&(t.CreatedDate!=null&&Qn("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:pa(t.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a),t.ModifiedDate!=null&&Qn("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:pa(t.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a));for(var i=0;i!=jr.length;++i){var o=jr[i],l=e.Props&&e.Props[o[1]]!=null?e.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&Qn(o[0],l,null,s,a)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Vr=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],hl=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function fl(t){var r=[],e=oe;return t||(t={}),t.Application="SheetJS",r[r.length]=Je,r[r.length]=oe("Properties",null,{xmlns:et.EXT_PROPS,"xmlns:vt":et.vt}),Vr.forEach(function(s){if(t[s[1]]!==void 0){var a;switch(s[2]){case"string":a=Oe(String(t[s[1]]));break;case"bool":a=t[s[1]]?"true":"false";break}a!==void 0&&(r[r.length]=e(s[0],a))}}),r[r.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=e("TitlesOfParts",e("vt:vector",t.SheetNames.map(function(s){return"<vt:lpstr>"+Oe(s)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function ul(t){var r=[Je,oe("Properties",null,{xmlns:et.CUST_PROPS,"xmlns:vt":et.vt})];if(!t)return r.join("");var e=1;return dt(t).forEach(function(a){++e,r[r.length]=oe("property",Th(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Oe(a)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Bi={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function hf(t,r){var e=[];return dt(Bi).map(function(s){for(var a=0;a<jr.length;++a)if(jr[a][1]==s)return jr[a];for(a=0;a<Vr.length;++a)if(Vr[a][1]==s)return Vr[a];throw s}).forEach(function(s){if(t[s[1]]!=null){var a=r&&r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:t[s[1]];switch(s[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),e.push(lt(Bi[s[1]]||s[1],a))}}),oe("DocumentProperties",e.join(""),{xmlns:Ct.o})}function ff(t,r){var e=["Worksheets","SheetNames"],s="CustomDocumentProperties",a=[];return t&&dt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<jr.length;++o)if(i==jr[o][1])return;for(o=0;o<Vr.length;++o)if(i==Vr[o][1])return;for(o=0;o<e.length;++o)if(i==e[o])return;var l=t[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(oe(ji(i),l,{"dt:dt":c}))}}),r&&dt(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=r[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(oe(ji(i),o,{"dt:dt":l}))}}),"<"+s+' xmlns="'+Ct.o+'">'+a.join("")+"</"+s+">"}function uf(t){var r=typeof t=="string"?new Date(Date.parse(t)):t,e=r.getTime()/1e3+11644473600,s=e%Math.pow(2,32),a=(e-s)/Math.pow(2,32);s*=1e7,a*=1e7;var i=s/Math.pow(2,32)|0;i>0&&(s=s%Math.pow(2,32),a+=i);var o=q(8);return o.write_shift(4,s),o.write_shift(4,a),o}function Mi(t,r){var e=q(4),s=q(4);switch(e.write_shift(4,t==80?31:t),t){case 3:s.write_shift(-4,r);break;case 5:s=q(8),s.write_shift(8,r,"f");break;case 11:s.write_shift(4,r?1:0);break;case 64:s=uf(r);break;case 31:case 80:for(s=q(4+2*(r.length+1)+(r.length%2?0:2)),s.write_shift(4,r.length+1),s.write_shift(0,r,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}return ot([e,s])}var xl=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function xf(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function zi(t,r,e){var s=q(8),a=[],i=[],o=8,l=0,c=q(8),d=q(8);if(c.write_shift(4,2),c.write_shift(4,1200),d.write_shift(4,1),i.push(c),a.push(d),o+=8+c.length,!r){d=q(8),d.write_shift(4,0),a.unshift(d);var h=[q(4)];for(h[0].write_shift(4,t.length),l=0;l<t.length;++l){var f=t[l][0];for(c=q(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);h.push(c)}c=ot(h),i.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(r&&!r[t[l][0]])&&!(xl.indexOf(t[l][0])>-1||hl.indexOf(t[l][0])>-1)&&t[l][1]!=null){var u=t[l][1],m=0;if(r){m=+r[t[l][0]];var p=e[m];if(p.p=="version"&&typeof u=="string"){var x=u.split(".");u=(+x[0]<<16)+(+x[1]||0)}c=Mi(p.t,u)}else{var g=xf(u);g==-1&&(g=31,u=String(u)),c=Mi(g,u)}i.push(c),d=q(8),d.write_shift(4,r?m:2+l),a.push(d),o+=8+c.length}var j=8*(i.length+1);for(l=0;l<i.length;++l)a[l].write_shift(4,j),j+=i[l].length;return s.write_shift(4,o),s.write_shift(4,i.length),ot([s].concat(a).concat(i))}function Ui(t,r,e,s,a,i){var o=q(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Pe.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,r,"hex"),o.write_shift(4,a?68:48);var c=zi(t,e,s);if(l.push(c),a){var d=zi(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(d)}return ot(l)}function mf(t,r){r||(r=q(t));for(var e=0;e<t;++e)r.write_shift(1,0);return r}function pf(t,r){return t.read_shift(r)===1}function yt(t,r){return r||(r=q(2)),r.write_shift(2,+!!t),r}function ml(t){return t.read_shift(2,"u")}function Dt(t,r){return r||(r=q(2)),r.write_shift(2,t),r}function pl(t,r,e){return e||(e=q(2)),e.write_shift(1,r=="e"?+t:+!!t),e.write_shift(1,r=="e"?1:0),e}function gl(t,r,e){var s=t.read_shift(e&&e.biff>=12?2:1),a="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else e.biff==12&&(a="wstr");e.biff>=2&&e.biff<=5&&(a="cpstr");var o=s?t.read_shift(s,a):"";return o}function gf(t){var r=t.t||"",e=q(3);e.write_shift(2,r.length),e.write_shift(1,1);var s=q(2*r.length);s.write_shift(2*r.length,r,"utf16le");var a=[e,s];return ot(a)}function vf(t,r,e){var s;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var a=t.read_shift(1);return a===0?s=t.read_shift(r,"sbcs-cont"):s=t.read_shift(r,"dbcs-cont"),s}function yf(t,r,e){var s=t.read_shift(e&&e.biff==2?1:2);return s===0?(t.l++,""):vf(t,s,e)}function bf(t,r,e){if(e.biff>5)return yf(t,r,e);var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function vl(t,r,e){return e||(e=q(3+2*t.length)),e.write_shift(2,t.length),e.write_shift(1,1),e.write_shift(31,t,"utf16le"),e}function $i(t,r){r||(r=q(6+t.length*2)),r.write_shift(4,1+t.length);for(var e=0;e<t.length;++e)r.write_shift(2,t.charCodeAt(e));return r.write_shift(2,0),r}function wf(t){var r=q(512),e=0,s=t.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var a=s.indexOf("#"),i=a>-1?31:23;switch(s.charAt(0)){case"#":i=28;break;case".":i&=-3;break}r.write_shift(4,2),r.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(e=0;e<o.length;++e)r.write_shift(4,o[e]);if(i==28)s=s.slice(1),$i(s,r);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<o.length;++e)r.write_shift(1,parseInt(o[e],16));var l=a>-1?s.slice(0,a):s;for(r.write_shift(4,2*(l.length+1)),e=0;e<l.length;++e)r.write_shift(2,l.charCodeAt(e));r.write_shift(2,0),i&8&&$i(a>-1?s.slice(a+1):"",r)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<o.length;++e)r.write_shift(1,parseInt(o[e],16));for(var c=0;s.slice(c*3,c*3+3)=="../"||s.slice(c*3,c*3+3)=="..\\";)++c;for(r.write_shift(2,c),r.write_shift(4,s.length-3*c+1),e=0;e<s.length-3*c;++e)r.write_shift(1,s.charCodeAt(e+3*c)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),e=0;e<6;++e)r.write_shift(4,0)}return r.slice(0,r.l)}function kr(t,r,e,s){return s||(s=q(6)),s.write_shift(2,t),s.write_shift(2,r),s.write_shift(2,e||0),s}function _f(t,r,e){var s=e.biff>8?4:2,a=t.read_shift(s),i=t.read_shift(s,"i"),o=t.read_shift(s,"i");return[a,i,o]}function Sf(t){var r=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);return{s:{c:s,r},e:{c:a,r:e}}}function yl(t,r){return r||(r=q(8)),r.write_shift(2,t.s.r),r.write_shift(2,t.e.r),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c),r}function Ha(t,r,e){var s=1536,a=16;switch(e.bookType){case"biff8":break;case"biff5":s=1280,a=8;break;case"biff4":s=4,a=6;break;case"biff3":s=3,a=6;break;case"biff2":s=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=q(a);return i.write_shift(2,s),i.write_shift(2,r),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Nf(t,r){var e=!r||r.biff==8,s=q(e?112:54);for(s.write_shift(r.biff==8?2:1,7),e&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(e?0:536870912));s.l<s.length;)s.write_shift(1,e?0:32);return s}function jf(t,r){var e=!r||r.biff>=8?2:1,s=q(8+e*t.name.length);s.write_shift(4,t.pos),s.write_shift(1,t.hs||0),s.write_shift(1,t.dt),s.write_shift(1,t.name.length),r.biff>=8&&s.write_shift(1,1),s.write_shift(e*t.name.length,t.name,r.biff<8?"sbcs":"utf16le");var a=s.slice(0,s.l);return a.l=s.l,a}function Ef(t,r){var e=q(8);e.write_shift(4,t.Count),e.write_shift(4,t.Unique);for(var s=[],a=0;a<t.length;++a)s[a]=gf(t[a]);var i=ot([e].concat(s));return i.parts=[e.length].concat(s.map(function(o){return o.length})),i}function Tf(){var t=q(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Cf(t){var r=q(18),e=1718;return t&&t.RTL&&(e|=64),r.write_shift(2,e),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function kf(t,r){var e=t.name||"Arial",s=r&&r.biff==5,a=s?15+e.length:16+2*e.length,i=q(a);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,e.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le"),i}function Af(t,r,e,s){var a=q(10);return kr(t,r,s,a),a.write_shift(4,e),a}function Rf(t,r,e,s,a){var i=!a||a.biff==8,o=q(8+ +i+(1+i)*e.length);return kr(t,r,s,o),o.write_shift(2,e.length),i&&o.write_shift(1,1),o.write_shift((1+i)*e.length,e,i?"utf16le":"sbcs"),o}function Ff(t,r,e,s){var a=e&&e.biff==5;s||(s=q(a?3+r.length:5+2*r.length)),s.write_shift(2,t),s.write_shift(a?1:2,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le");var i=s.length>s.l?s.slice(0,s.l):s;return i.l==null&&(i.l=i.length),i}function Df(t,r){var e=r.biff==8||!r.biff?4:2,s=q(2*e+6);return s.write_shift(e,t.s.r),s.write_shift(e,t.e.r+1),s.write_shift(2,t.s.c),s.write_shift(2,t.e.c+1),s.write_shift(2,0),s}function Hi(t,r,e,s){var a=e&&e.biff==5;s||(s=q(a?16:20)),s.write_shift(2,0),t.style?(s.write_shift(2,t.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,t.numFmtId||0),s.write_shift(2,r<<4));var i=0;return t.numFmtId>0&&a&&(i|=1024),s.write_shift(4,i),s.write_shift(4,0),a||s.write_shift(4,0),s.write_shift(2,0),s}function Of(t){var r=q(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function If(t,r,e,s,a,i){var o=q(8);return kr(t,r,s,o),pl(e,i,o),o}function Pf(t,r,e,s){var a=q(14);return kr(t,r,s,a),Cr(e,a),a}function Lf(t,r,e){if(e.biff<8)return Bf(t,r,e);for(var s=[],a=t.l+r,i=t.read_shift(e.biff>8?4:2);i--!==0;)s.push(_f(t,e.biff>8?12:6,e));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return s}function Bf(t,r,e){t[t.l+1]==3&&t[t.l]++;var s=gl(t,r,e);return s.charCodeAt(0)==3?s.slice(1):s}function Mf(t){var r=q(2+t.length*8);r.write_shift(2,t.length);for(var e=0;e<t.length;++e)yl(t[e],r);return r}function zf(t){var r=q(24),e=tt(t[0]);r.write_shift(2,e.r),r.write_shift(2,e.r),r.write_shift(2,e.c),r.write_shift(2,e.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)r.write_shift(1,parseInt(s[a],16));return ot([r,wf(t[1])])}function Uf(t){var r=t[1].Tooltip,e=q(10+2*(r.length+1));e.write_shift(2,2048);var s=tt(t[0]);e.write_shift(2,s.r),e.write_shift(2,s.r),e.write_shift(2,s.c),e.write_shift(2,s.c);for(var a=0;a<r.length;++a)e.write_shift(2,r.charCodeAt(a));return e.write_shift(2,0),e}function $f(t){return t||(t=q(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Hf(t,r,e){if(!e.cellStyles)return Kt(t,r);var s=e&&e.biff>=12?4:2,a=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(s),l=t.read_shift(s),c=t.read_shift(2);s==2&&(t.l+=2);var d={s:a,e:i,w:o,ixfe:l,flags:c};return(e.biff>=5||!e.biff)&&(d.level=c>>8&7),d}function Wf(t,r){var e=q(12);e.write_shift(2,r),e.write_shift(2,r),e.write_shift(2,t.width*256),e.write_shift(2,0);var s=0;return t.hidden&&(s|=1),e.write_shift(1,s),s=t.level||0,e.write_shift(1,s),e.write_shift(2,0),e}function Gf(t){for(var r=q(2*t),e=0;e<t;++e)r.write_shift(2,e+1);return r}function Vf(t,r,e){var s=q(15);return Ms(s,t,r),s.write_shift(8,e,"f"),s}function Xf(t,r,e){var s=q(9);return Ms(s,t,r),s.write_shift(2,e),s}var Kf=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Fa({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,c){var d=[],h=Tr(1);switch(c.type){case"base64":h=Mt(nr(l));break;case"binary":h=Mt(l);break;case"buffer":case"array":h=l;break}Tt(h,0);var f=h.read_shift(1),u=!!(f&136),m=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,u=!0;break;case 49:m=!0,u=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,g=521;f==2&&(x=h.read_shift(2)),h.l+=3,f!=2&&(x=h.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(g=h.read_shift(2));var j=h.read_shift(2),w=c.codepage||1252;f!=2&&(h.l+=16,h.read_shift(1),h[h.l]!==0&&(w=t[h[h.l]]),h.l+=1,h.l+=2),p&&(h.l+=36);for(var _=[],T={},R=Math.min(h.length,f==2?521:g-10-(m?264:0)),z=p?32:11;h.l<R&&h[h.l]!=13;)switch(T={},T.name=cn.utils.decode(w,h.slice(h.l,h.l+z)).replace(/[\u0000\r\n].*$/g,""),h.l+=z,T.type=String.fromCharCode(h.read_shift(1)),f!=2&&!p&&(T.offset=h.read_shift(4)),T.len=h.read_shift(1),f==2&&(T.offset=h.read_shift(2)),T.dec=h.read_shift(1),T.name.length&&_.push(T),f!=2&&(h.l+=p?13:14),T.type){case"B":(!m||T.len!=8)&&c.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+T.name+":"+T.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+T.type)}if(h[h.l]!==13&&(h.l=g-1),h.read_shift(1)!==13)throw new Error("DBF Terminator not found "+h.l+" "+h[h.l]);h.l=g;var E=0,I=0;for(d[0]=[],I=0;I!=_.length;++I)d[0][I]=_[I].name;for(;x-- >0;){if(h[h.l]===42){h.l+=j;continue}for(++h.l,d[++E]=[],I=0,I=0;I!=_.length;++I){var D=h.slice(h.l,h.l+_[I].len);h.l+=_[I].len,Tt(D,0);var P=cn.utils.decode(w,D);switch(_[I].type){case"C":P.trim().length&&(d[E][I]=P.replace(/\s+$/,""));break;case"D":P.length===8?d[E][I]=new Date(+P.slice(0,4),+P.slice(4,6)-1,+P.slice(6,8)):d[E][I]=P;break;case"F":d[E][I]=parseFloat(P.trim());break;case"+":case"I":d[E][I]=p?D.read_shift(-4,"i")^2147483648:D.read_shift(4,"i");break;case"L":switch(P.trim().toUpperCase()){case"Y":case"T":d[E][I]=!0;break;case"N":case"F":d[E][I]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+P+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));d[E][I]="##MEMO##"+(p?parseInt(P.trim(),10):D.read_shift(4));break;case"N":P=P.replace(/\u0000/g,"").trim(),P&&P!="."&&(d[E][I]=+P||0);break;case"@":d[E][I]=new Date(D.read_shift(-8,"f")-621356832e5);break;case"T":d[E][I]=new Date((D.read_shift(4)-2440588)*864e5+D.read_shift(4));break;case"Y":d[E][I]=D.read_shift(4,"i")/1e4+D.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":d[E][I]=-D.read_shift(-8,"f");break;case"B":if(m&&_[I].len==8){d[E][I]=D.read_shift(8,"f");break}case"G":case"P":D.l+=_[I].len;break;case"0":if(_[I].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+_[I].type)}}}if(f!=2&&h.l<h.length&&h[h.l++]!=26)throw new Error("DBF EOF Marker missing "+(h.l-1)+" of "+h.length+" "+h[h.l-1].toString(16));return c&&c.sheetRows&&(d=d.slice(0,c.sheetRows)),c.DBF=_,d}function s(l,c){var d=c||{};d.dateNF||(d.dateNF="yyyymmdd");var h=ns(e(l,d),d);return h["!cols"]=d.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete d.DBF,h}function a(l,c){try{return Rr(s(l,c),c)}catch(d){if(c&&c.WTF)throw d}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var d=c||{};if(+d.codepage>=0&&Ns(+d.codepage),d.type=="string")throw new Error("Cannot write DBF to JS string");var h=St(),f=_n(l,{header:1,raw:!0,cellDates:!0}),u=f[0],m=f.slice(1),p=l["!cols"]||[],x=0,g=0,j=0,w=1;for(x=0;x<u.length;++x){if(((p[x]||{}).DBF||{}).name){u[x]=p[x].DBF.name,++j;continue}if(u[x]!=null){if(++j,typeof u[x]=="number"&&(u[x]=u[x].toString(10)),typeof u[x]!="string")throw new Error("DBF Invalid column name "+u[x]+" |"+typeof u[x]+"|");if(u.indexOf(u[x])!==x){for(g=0;g<1024;++g)if(u.indexOf(u[x]+"_"+g)==-1){u[x]+="_"+g;break}}}}var _=ze(l["!ref"]),T=[],R=[],z=[];for(x=0;x<=_.e.c-_.s.c;++x){var E="",I="",D=0,P=[];for(g=0;g<m.length;++g)m[g][x]!=null&&P.push(m[g][x]);if(P.length==0||u[x]==null){T[x]="?";continue}for(g=0;g<P.length;++g){switch(typeof P[g]){case"number":I="B";break;case"string":I="C";break;case"boolean":I="L";break;case"object":I=P[g]instanceof Date?"D":"C";break;default:I="C"}D=Math.max(D,String(P[g]).length),E=E&&E!=I?"C":I}D>250&&(D=250),I=((p[x]||{}).DBF||{}).type,I=="C"&&p[x].DBF.len>D&&(D=p[x].DBF.len),E=="B"&&I=="N"&&(E="N",z[x]=p[x].DBF.dec,D=p[x].DBF.len),R[x]=E=="C"||I=="N"?D:i[E]||0,w+=R[x],T[x]=E}var U=h.next(32);for(U.write_shift(4,318902576),U.write_shift(4,m.length),U.write_shift(2,296+32*j),U.write_shift(2,w),x=0;x<4;++x)U.write_shift(4,0);for(U.write_shift(4,0|(+r[wo]||3)<<8),x=0,g=0;x<u.length;++x)if(u[x]!=null){var H=h.next(32),ee=(u[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,ee,"sbcs"),H.write_shift(1,T[x]=="?"?"C":T[x],"sbcs"),H.write_shift(4,g),H.write_shift(1,R[x]||i[T[x]]||0),H.write_shift(1,z[x]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),g+=R[x]||i[T[x]]||0}var pe=h.next(264);for(pe.write_shift(4,13),x=0;x<65;++x)pe.write_shift(4,0);for(x=0;x<m.length;++x){var ge=h.next(w);for(ge.write_shift(1,0),g=0;g<u.length;++g)if(u[g]!=null)switch(T[g]){case"L":ge.write_shift(1,m[x][g]==null?63:m[x][g]?84:70);break;case"B":ge.write_shift(8,m[x][g]||0,"f");break;case"N":var je="0";for(typeof m[x][g]=="number"&&(je=m[x][g].toFixed(z[g]||0)),j=0;j<R[g]-je.length;++j)ge.write_shift(1,32);ge.write_shift(1,je,"sbcs");break;case"D":m[x][g]?(ge.write_shift(4,("0000"+m[x][g].getFullYear()).slice(-4),"sbcs"),ge.write_shift(2,("00"+(m[x][g].getMonth()+1)).slice(-2),"sbcs"),ge.write_shift(2,("00"+m[x][g].getDate()).slice(-2),"sbcs")):ge.write_shift(8,"00000000","sbcs");break;case"C":var _e=String(m[x][g]!=null?m[x][g]:"").slice(0,R[g]);for(ge.write_shift(1,_e,"sbcs"),j=0;j<R[g]-_e.length;++j)ge.write_shift(1,32);break}}return h.next(1).write_shift(1,26),h.end()}return{to_workbook:a,to_sheet:s,from_sheet:o}}(),Yf=function(){var t={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+dt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(u,m){var p=t[m];return typeof p=="number"?ui(p):p},s=function(u,m,p){var x=m.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?u:ui(x)};t["|"]=254;function a(u,m){switch(m.type){case"base64":return i(nr(u),m);case"binary":return i(u,m);case"buffer":return i(Ce&&Buffer.isBuffer(u)?u.toString("binary"):Os(u),m);case"array":return i(In(u),m)}throw new Error("Unrecognized type "+m.type)}function i(u,m){var p=u.split(/[\n\r]+/),x=-1,g=-1,j=0,w=0,_=[],T=[],R=null,z={},E=[],I=[],D=[],P=0,U;for(+m.codepage>=0&&Ns(+m.codepage);j!==p.length;++j){P=0;var H=p[j].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(r,e),ee=H.replace(/;;/g,"\0").split(";").map(function(b){return b.replace(/\u0000/g,";")}),pe=ee[0],ge;if(H.length>0)switch(pe){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ee[1].charAt(0)=="P"&&T.push(H.slice(3).replace(/;;/g,";"));break;case"C":var je=!1,_e=!1,ke=!1,de=!1,me=-1,Se=-1;for(w=1;w<ee.length;++w)switch(ee[w].charAt(0)){case"A":break;case"X":g=parseInt(ee[w].slice(1))-1,_e=!0;break;case"Y":for(x=parseInt(ee[w].slice(1))-1,_e||(g=0),U=_.length;U<=x;++U)_[U]=[];break;case"K":ge=ee[w].slice(1),ge.charAt(0)==='"'?ge=ge.slice(1,ge.length-1):ge==="TRUE"?ge=!0:ge==="FALSE"?ge=!1:isNaN(rr(ge))?isNaN(Es(ge).getDate())||(ge=bt(ge)):(ge=rr(ge),R!==null&&Do(R)&&(ge=Lo(ge))),je=!0;break;case"E":de=!0;var y=Xu(ee[w].slice(1),{r:x,c:g});_[x][g]=[_[x][g],y];break;case"S":ke=!0,_[x][g]=[_[x][g],"S5S"];break;case"G":break;case"R":me=parseInt(ee[w].slice(1))-1;break;case"C":Se=parseInt(ee[w].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+H)}if(je&&(_[x][g]&&_[x][g].length==2?_[x][g][0]=ge:_[x][g]=ge,R=null),ke){if(de)throw new Error("SYLK shared formula cannot have own formula");var F=me>-1&&_[me][Se];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");_[x][g][1]=Ku(F[1],{r:x-me,c:g-Se})}break;case"F":var O=0;for(w=1;w<ee.length;++w)switch(ee[w].charAt(0)){case"X":g=parseInt(ee[w].slice(1))-1,++O;break;case"Y":for(x=parseInt(ee[w].slice(1))-1,U=_.length;U<=x;++U)_[U]=[];break;case"M":P=parseInt(ee[w].slice(1))/20;break;case"F":break;case"G":break;case"P":R=T[parseInt(ee[w].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(D=ee[w].slice(1).split(" "),U=parseInt(D[0],10);U<=parseInt(D[1],10);++U)P=parseInt(D[2],10),I[U-1]=P===0?{hidden:!0}:{wch:P},Wa(I[U-1]);break;case"C":g=parseInt(ee[w].slice(1))-1,I[g]||(I[g]={});break;case"R":x=parseInt(ee[w].slice(1))-1,E[x]||(E[x]={}),P>0?(E[x].hpt=P,E[x].hpx=Nl(P)):P===0&&(E[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+H)}O<1&&(R=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+H)}}return E.length>0&&(z["!rows"]=E),I.length>0&&(z["!cols"]=I),m&&m.sheetRows&&(_=_.slice(0,m.sheetRows)),[_,z]}function o(u,m){var p=a(u,m),x=p[0],g=p[1],j=ns(x,m);return dt(g).forEach(function(w){j[w]=g[w]}),j}function l(u,m){return Rr(o(u,m),m)}function c(u,m,p,x){var g="C;Y"+(p+1)+";X"+(x+1)+";K";switch(u.t){case"n":g+=u.v||0,u.f&&!u.F&&(g+=";E"+Va(u.f,{r:p,c:x}));break;case"b":g+=u.v?"TRUE":"FALSE";break;case"e":g+=u.w||u.v;break;case"d":g+='"'+(u.w||u.v)+'"';break;case"s":g+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function d(u,m){m.forEach(function(p,x){var g="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=vn(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=yn(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&u.push(g)})}function h(u,m){m.forEach(function(p,x){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*bn(p.hpx)+";"),g.length>2&&u.push(g+"R"+(x+1))})}function f(u,m){var p=["ID;PWXL;N;E"],x=[],g=ze(u["!ref"]),j,w=Array.isArray(u),_=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),u["!cols"]&&d(p,u["!cols"]),u["!rows"]&&h(p,u["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var T=g.s.r;T<=g.e.r;++T)for(var R=g.s.c;R<=g.e.c;++R){var z=Ie({r:T,c:R});j=w?(u[T]||[])[R]:u[z],!(!j||j.v==null&&(!j.f||j.F))&&x.push(c(j,u,T,R))}return p.join(_)+_+x.join(_)+_+"E"+_}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),qf=function(){function t(i,o){switch(o.type){case"base64":return r(nr(i),o);case"binary":return r(i,o);case"buffer":return r(Ce&&Buffer.isBuffer(i)?i.toString("binary"):Os(i),o);case"array":return r(In(i),o)}throw new Error("Unrecognized type "+o.type)}function r(i,o){for(var l=i.split(`
`),c=-1,d=-1,h=0,f=[];h!==l.length;++h){if(l[h].trim()==="BOT"){f[++c]=[],d=0;continue}if(!(c<0)){var u=l[h].trim().split(","),m=u[0],p=u[1];++h;for(var x=l[h]||"";(x.match(/["]/g)||[]).length&1&&h<l.length-1;)x+=`
`+l[++h];switch(x=x.trim(),+m){case-1:if(x==="BOT"){f[++c]=[],d=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][d]=!0:x==="FALSE"?f[c][d]=!1:isNaN(rr(p))?isNaN(Es(p).getDate())?f[c][d]=p:f[c][d]=bt(p):f[c][d]=rr(p),++d;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][d++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function e(i,o){return ns(t(i,o),o)}function s(i,o){return Rr(e(i,o),o)}var a=function(){var i=function(c,d,h,f,u){c.push(d),c.push(h+","+f),c.push('"'+u.replace(/"/g,'""')+'"')},o=function(c,d,h,f){c.push(d+","+h),c.push(d==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var d=[],h=ze(c["!ref"]),f,u=Array.isArray(c);i(d,"TABLE",0,1,"sheetjs"),i(d,"VECTORS",0,h.e.r-h.s.r+1,""),i(d,"TUPLES",0,h.e.c-h.s.c+1,""),i(d,"DATA",0,0,"");for(var m=h.s.r;m<=h.e.r;++m){o(d,-1,0,"BOT");for(var p=h.s.c;p<=h.e.c;++p){var x=Ie({r:m,c:p});if(f=u?(c[m]||[])[p]:c[x],!f){o(d,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?o(d,1,0,"="+f.f):o(d,1,0,""):o(d,0,g,"V");break;case"b":o(d,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(d,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=ur(f.z||Xe[14],Nt(bt(f.v)))),o(d,0,f.w,"V");break;default:o(d,1,0,"")}}}o(d,-1,0,"EOD");var j=`\r
`,w=d.join(j);return w}}();return{to_workbook:s,to_sheet:e,from_sheet:a}}(),bl=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(f,u){for(var m=f.split(`
`),p=-1,x=-1,g=0,j=[];g!==m.length;++g){var w=m[g].trim().split(":");if(w[0]==="cell"){var _=tt(w[1]);if(j.length<=_.r)for(p=j.length;p<=_.r;++p)j[p]||(j[p]=[]);switch(p=_.r,x=_.c,w[2]){case"t":j[p][x]=t(w[3]);break;case"v":j[p][x]=+w[3];break;case"vtf":var T=w[w.length-1];case"vtc":switch(w[3]){case"nl":j[p][x]=!!+w[4];break;default:j[p][x]=+w[4];break}w[2]=="vtf"&&(j[p][x]=[j[p][x],T])}}}return u&&u.sheetRows&&(j=j.slice(0,u.sheetRows)),j}function s(f,u){return ns(e(f,u),u)}function a(f,u){return Rr(s(f,u),u)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function d(f){if(!f||!f["!ref"])return"";for(var u=[],m=[],p,x="",g=At(f["!ref"]),j=Array.isArray(f),w=g.s.r;w<=g.e.r;++w)for(var _=g.s.c;_<=g.e.c;++_)if(x=Ie({r:w,c:_}),p=j?(f[w]||[])[_]:f[x],!(!p||p.v==null||p.t==="z")){switch(m=["cell",x,"t"],p.t){case"s":case"str":m.push(r(p.v));break;case"n":p.f?(m[2]="vtf",m[3]="n",m[4]=p.v,m[5]=r(p.f)):(m[2]="v",m[3]=p.v);break;case"b":m[2]="vt"+(p.f?"f":"c"),m[3]="nl",m[4]=p.v?"1":"0",m[5]=r(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var T=Nt(bt(p.v));m[2]="vtc",m[3]="nd",m[4]=""+T,m[5]=p.w||ur(p.z||Xe[14],T);break;case"e":continue}u.push(m.join(":"))}return u.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function h(f){return[i,o,l,o,d(f),c].join(`
`)}return{to_workbook:a,to_sheet:s,from_sheet:h}}(),Jf=function(){function t(h,f,u,m,p){p.raw?f[u][m]=h:h===""||(h==="TRUE"?f[u][m]=!0:h==="FALSE"?f[u][m]=!1:isNaN(rr(h))?isNaN(Es(h).getDate())?f[u][m]=h:f[u][m]=bt(h):f[u][m]=rr(h))}function r(h,f){var u=f||{},m=[];if(!h||h.length===0)return m;for(var p=h.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var g=10,j=0,w=0;w<=x;++w)j=p[w].indexOf(" "),j==-1?j=p[w].length:j++,g=Math.max(g,j);for(w=0;w<=x;++w){m[w]=[];var _=0;for(t(p[w].slice(0,g).trim(),m,w,_,u),_=1;_<=(p[w].length-g)/10+1;++_)t(p[w].slice(g+(_-1)*10,g+_*10).trim(),m,w,_,u)}return u.sheetRows&&(m=m.slice(0,u.sheetRows)),m}var e={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function a(h){for(var f={},u=!1,m=0,p=0;m<h.length;++m)(p=h.charCodeAt(m))==34?u=!u:!u&&p in e&&(f[p]=(f[p]||0)+1);p=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m]);if(!p.length){f=s;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m])}return p.sort(function(x,g){return x[0]-g[0]||s[x[1]]-s[g[1]]}),e[p.pop()[1]]||44}function i(h,f){var u=f||{},m="",p=u.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};h.slice(0,4)=="sep="?h.charCodeAt(5)==13&&h.charCodeAt(6)==10?(m=h.charAt(4),h=h.slice(7)):h.charCodeAt(5)==13||h.charCodeAt(5)==10?(m=h.charAt(4),h=h.slice(6)):m=a(h.slice(0,1024)):u&&u.FS?m=u.FS:m=a(h.slice(0,1024));var g=0,j=0,w=0,_=0,T=0,R=m.charCodeAt(0),z=!1,E=0,I=h.charCodeAt(0);h=h.replace(/\r\n/mg,`
`);var D=u.dateNF!=null?fh(u.dateNF):null;function P(){var U=h.slice(_,T),H={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)H.t="z";else if(u.raw)H.t="s",H.v=U;else if(U.trim().length===0)H.t="s",H.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(H.t="s",H.v=U.slice(2,-1).replace(/""/g,'"')):Yu(U)?(H.t="n",H.f=U.slice(1)):(H.t="s",H.v=U);else if(U=="TRUE")H.t="b",H.v=!0;else if(U=="FALSE")H.t="b",H.v=!1;else if(!isNaN(w=rr(U)))H.t="n",u.cellText!==!1&&(H.w=U),H.v=w;else if(!isNaN(Es(U).getDate())||D&&U.match(D)){H.z=u.dateNF||Xe[14];var ee=0;D&&U.match(D)&&(U=uh(U,u.dateNF,U.match(D)||[]),ee=1),u.cellDates?(H.t="d",H.v=bt(U,ee)):(H.t="n",H.v=Nt(bt(U,ee))),u.cellText!==!1&&(H.w=ur(H.z,H.v instanceof Date?Nt(H.v):H.v)),u.cellNF||delete H.z}else H.t="s",H.v=U;if(H.t=="z"||(u.dense?(p[g]||(p[g]=[]),p[g][j]=H):p[Ie({c:j,r:g})]=H),_=T+1,I=h.charCodeAt(_),x.e.c<j&&(x.e.c=j),x.e.r<g&&(x.e.r=g),E==R)++j;else if(j=0,++g,u.sheetRows&&u.sheetRows<=g)return!0}e:for(;T<h.length;++T)switch(E=h.charCodeAt(T)){case 34:I===34&&(z=!z);break;case R:case 10:case 13:if(!z&&P())break e;break}return T-_>0&&P(),p["!ref"]=qe(x),p}function o(h,f){return!(f&&f.PRN)||f.FS||h.slice(0,4)=="sep="||h.indexOf("	")>=0||h.indexOf(",")>=0||h.indexOf(";")>=0?i(h,f):ns(r(h,f),f)}function l(h,f){var u="",m=f.type=="string"?[0,0,0,0]:cg(h,f);switch(f.type){case"base64":u=nr(h);break;case"binary":u=h;break;case"buffer":f.codepage==65001?u=h.toString("utf8"):f.codepage&&typeof cn<"u"||(u=Ce&&Buffer.isBuffer(h)?h.toString("binary"):Os(h));break;case"array":u=In(h);break;case"string":u=h;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?u=gs(u.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?u=gs(u):f.type=="binary"&&typeof cn<"u",u.slice(0,19)=="socialcalc:version:"?bl.to_sheet(f.type=="string"?u:gs(u),f):o(u,f)}function c(h,f){return Rr(l(h,f),f)}function d(h){for(var f=[],u=ze(h["!ref"]),m,p=Array.isArray(h),x=u.s.r;x<=u.e.r;++x){for(var g=[],j=u.s.c;j<=u.e.c;++j){var w=Ie({r:x,c:j});if(m=p?(h[x]||[])[j]:h[w],!m||m.v==null){g.push("          ");continue}for(var _=(m.w||(ar(m),m.w)||"").slice(0,10);_.length<10;)_+=" ";g.push(_+(j===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:d}}(),Wi=function(){function t(y,F,O){if(y){Tt(y,y.l||0);for(var b=O.Enum||me;y.l<y.length;){var W=y.read_shift(2),L=b[W]||b[65535],Z=y.read_shift(2),se=y.l+Z,ae=L.f&&L.f(y,Z,O);if(y.l=se,F(ae,L,W))return}}}function r(y,F){switch(F.type){case"base64":return e(Mt(nr(y)),F);case"binary":return e(Mt(y),F);case"buffer":case"array":return e(y,F)}throw"Unsupported type "+F.type}function e(y,F){if(!y)return y;var O=F||{},b=O.dense?[]:{},W="Sheet1",L="",Z=0,se={},ae=[],ye=[],G={s:{r:0,c:0},e:{r:0,c:0}},ve=O.sheetRows||0;if(y[2]==0&&(y[3]==8||y[3]==9)&&y.length>=16&&y[14]==5&&y[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(y[2]==2)O.Enum=me,t(y,function(re,be,Re){switch(Re){case 0:O.vers=re,re>=4096&&(O.qpro=!0);break;case 6:G=re;break;case 204:re&&(L=re);break;case 222:L=re;break;case 15:case 51:O.qpro||(re[1].v=re[1].v.slice(1));case 13:case 14:case 16:Re==14&&(re[2]&112)==112&&(re[2]&15)>1&&(re[2]&15)<15&&(re[1].z=O.dateNF||Xe[14],O.cellDates&&(re[1].t="d",re[1].v=Lo(re[1].v))),O.qpro&&re[3]>Z&&(b["!ref"]=qe(G),se[W]=b,ae.push(W),b=O.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Z=re[3],W=L||"Sheet"+(Z+1),L="");var Ue=O.dense?(b[re[0].r]||[])[re[0].c]:b[Ie(re[0])];if(Ue){Ue.t=re[1].t,Ue.v=re[1].v,re[1].z!=null&&(Ue.z=re[1].z),re[1].f!=null&&(Ue.f=re[1].f);break}O.dense?(b[re[0].r]||(b[re[0].r]=[]),b[re[0].r][re[0].c]=re[1]):b[Ie(re[0])]=re[1];break}},O);else if(y[2]==26||y[2]==14)O.Enum=Se,y[2]==14&&(O.qpro=!0,y.l=0),t(y,function(re,be,Re){switch(Re){case 204:W=re;break;case 22:re[1].v=re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(re[3]>Z&&(b["!ref"]=qe(G),se[W]=b,ae.push(W),b=O.dense?[]:{},G={s:{r:0,c:0},e:{r:0,c:0}},Z=re[3],W="Sheet"+(Z+1)),ve>0&&re[0].r>=ve)break;O.dense?(b[re[0].r]||(b[re[0].r]=[]),b[re[0].r][re[0].c]=re[1]):b[Ie(re[0])]=re[1],G.e.c<re[0].c&&(G.e.c=re[0].c),G.e.r<re[0].r&&(G.e.r=re[0].r);break;case 27:re[14e3]&&(ye[re[14e3][0]]=re[14e3][1]);break;case 1537:ye[re[0]]=re[1],re[0]==Z&&(W=re[1]);break}},O);else throw new Error("Unrecognized LOTUS BOF "+y[2]);if(b["!ref"]=qe(G),se[L||W]=b,ae.push(L||W),!ye.length)return{SheetNames:ae,Sheets:se};for(var M={},Q=[],he=0;he<ye.length;++he)se[ae[he]]?(Q.push(ye[he]||ae[he]),M[ye[he]]=se[ye[he]]||se[ae[he]]):(Q.push(ye[he]),M[ye[he]]={"!ref":"A1"});return{SheetNames:Q,Sheets:M}}function s(y,F){var O=F||{};if(+O.codepage>=0&&Ns(+O.codepage),O.type=="string")throw new Error("Cannot write WK1 to JS string");var b=St(),W=ze(y["!ref"]),L=Array.isArray(y),Z=[];le(b,0,i(1030)),le(b,6,c(W));for(var se=Math.min(W.e.r,8191),ae=W.s.r;ae<=se;++ae)for(var ye=ct(ae),G=W.s.c;G<=W.e.c;++G){ae===W.s.r&&(Z[G]=ut(G));var ve=Z[G]+ye,M=L?(y[ae]||[])[G]:y[ve];if(!(!M||M.t=="z"))if(M.t=="n")(M.v|0)==M.v&&M.v>=-32768&&M.v<=32767?le(b,13,m(ae,G,M.v)):le(b,14,x(ae,G,M.v));else{var Q=ar(M);le(b,15,f(ae,G,Q.slice(0,239)))}}return le(b,1),b.end()}function a(y,F){var O=F||{};if(+O.codepage>=0&&Ns(+O.codepage),O.type=="string")throw new Error("Cannot write WK3 to JS string");var b=St();le(b,0,o(y));for(var W=0,L=0;W<y.SheetNames.length;++W)(y.Sheets[y.SheetNames[W]]||{})["!ref"]&&le(b,27,de(y.SheetNames[W],L++));var Z=0;for(W=0;W<y.SheetNames.length;++W){var se=y.Sheets[y.SheetNames[W]];if(!(!se||!se["!ref"])){for(var ae=ze(se["!ref"]),ye=Array.isArray(se),G=[],ve=Math.min(ae.e.r,8191),M=ae.s.r;M<=ve;++M)for(var Q=ct(M),he=ae.s.c;he<=ae.e.c;++he){M===ae.s.r&&(G[he]=ut(he));var re=G[he]+Q,be=ye?(se[M]||[])[he]:se[re];if(!(!be||be.t=="z"))if(be.t=="n")le(b,23,P(M,he,Z,be.v));else{var Re=ar(be);le(b,22,E(M,he,Z,Re.slice(0,239)))}}++Z}}return le(b,1),b.end()}function i(y){var F=q(2);return F.write_shift(2,y),F}function o(y){var F=q(26);F.write_shift(2,4096),F.write_shift(2,4),F.write_shift(4,0);for(var O=0,b=0,W=0,L=0;L<y.SheetNames.length;++L){var Z=y.SheetNames[L],se=y.Sheets[Z];if(!(!se||!se["!ref"])){++W;var ae=At(se["!ref"]);O<ae.e.r&&(O=ae.e.r),b<ae.e.c&&(b=ae.e.c)}}return O>8191&&(O=8191),F.write_shift(2,O),F.write_shift(1,W),F.write_shift(1,b),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(1,1),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(4,0),F}function l(y,F,O){var b={s:{c:0,r:0},e:{c:0,r:0}};return F==8&&O.qpro?(b.s.c=y.read_shift(1),y.l++,b.s.r=y.read_shift(2),b.e.c=y.read_shift(1),y.l++,b.e.r=y.read_shift(2),b):(b.s.c=y.read_shift(2),b.s.r=y.read_shift(2),F==12&&O.qpro&&(y.l+=2),b.e.c=y.read_shift(2),b.e.r=y.read_shift(2),F==12&&O.qpro&&(y.l+=2),b.s.c==65535&&(b.s.c=b.e.c=b.s.r=b.e.r=0),b)}function c(y){var F=q(8);return F.write_shift(2,y.s.c),F.write_shift(2,y.s.r),F.write_shift(2,y.e.c),F.write_shift(2,y.e.r),F}function d(y,F,O){var b=[{c:0,r:0},{t:"n",v:0},0,0];return O.qpro&&O.vers!=20768?(b[0].c=y.read_shift(1),b[3]=y.read_shift(1),b[0].r=y.read_shift(2),y.l+=2):(b[2]=y.read_shift(1),b[0].c=y.read_shift(2),b[0].r=y.read_shift(2)),b}function h(y,F,O){var b=y.l+F,W=d(y,F,O);if(W[1].t="s",O.vers==20768){y.l++;var L=y.read_shift(1);return W[1].v=y.read_shift(L,"utf8"),W}return O.qpro&&y.l++,W[1].v=y.read_shift(b-y.l,"cstr"),W}function f(y,F,O){var b=q(7+O.length);b.write_shift(1,255),b.write_shift(2,F),b.write_shift(2,y),b.write_shift(1,39);for(var W=0;W<b.length;++W){var L=O.charCodeAt(W);b.write_shift(1,L>=128?95:L)}return b.write_shift(1,0),b}function u(y,F,O){var b=d(y,F,O);return b[1].v=y.read_shift(2,"i"),b}function m(y,F,O){var b=q(7);return b.write_shift(1,255),b.write_shift(2,F),b.write_shift(2,y),b.write_shift(2,O,"i"),b}function p(y,F,O){var b=d(y,F,O);return b[1].v=y.read_shift(8,"f"),b}function x(y,F,O){var b=q(13);return b.write_shift(1,255),b.write_shift(2,F),b.write_shift(2,y),b.write_shift(8,O,"f"),b}function g(y,F,O){var b=y.l+F,W=d(y,F,O);if(W[1].v=y.read_shift(8,"f"),O.qpro)y.l=b;else{var L=y.read_shift(2);T(y.slice(y.l,y.l+L),W),y.l+=L}return W}function j(y,F,O){var b=F&32768;return F&=-32769,F=(b?y:0)+(F>=8192?F-16384:F),(b?"":"$")+(O?ut(F):ct(F))}var w={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},_=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function T(y,F){Tt(y,0);for(var O=[],b=0,W="",L="",Z="",se="";y.l<y.length;){var ae=y[y.l++];switch(ae){case 0:O.push(y.read_shift(8,"f"));break;case 1:L=j(F[0].c,y.read_shift(2),!0),W=j(F[0].r,y.read_shift(2),!1),O.push(L+W);break;case 2:{var ye=j(F[0].c,y.read_shift(2),!0),G=j(F[0].r,y.read_shift(2),!1);L=j(F[0].c,y.read_shift(2),!0),W=j(F[0].r,y.read_shift(2),!1),O.push(ye+G+":"+L+W)}break;case 3:if(y.l<y.length){console.error("WK1 premature formula end");return}break;case 4:O.push("("+O.pop()+")");break;case 5:O.push(y.read_shift(2));break;case 6:{for(var ve="";ae=y[y.l++];)ve+=String.fromCharCode(ae);O.push('"'+ve.replace(/"/g,'""')+'"')}break;case 8:O.push("-"+O.pop());break;case 23:O.push("+"+O.pop());break;case 22:O.push("NOT("+O.pop()+")");break;case 20:case 21:se=O.pop(),Z=O.pop(),O.push(["AND","OR"][ae-20]+"("+Z+","+se+")");break;default:if(ae<32&&_[ae])se=O.pop(),Z=O.pop(),O.push(Z+_[ae]+se);else if(w[ae]){if(b=w[ae][1],b==69&&(b=y[y.l++]),b>O.length){console.error("WK1 bad formula parse 0x"+ae.toString(16)+":|"+O.join("|")+"|");return}var M=O.slice(-b);O.length-=b,O.push(w[ae][0]+"("+M.join(",")+")")}else return ae<=7?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=24?console.error("WK1 unsupported op "+ae.toString(16)):ae<=30?console.error("WK1 invalid opcode "+ae.toString(16)):ae<=115?console.error("WK1 unsupported function opcode "+ae.toString(16)):console.error("WK1 unrecognized opcode "+ae.toString(16))}}O.length==1?F[1].f=""+O[0]:console.error("WK1 bad formula parse |"+O.join("|")+"|")}function R(y){var F=[{c:0,r:0},{t:"n",v:0},0];return F[0].r=y.read_shift(2),F[3]=y[y.l++],F[0].c=y[y.l++],F}function z(y,F){var O=R(y);return O[1].t="s",O[1].v=y.read_shift(F-4,"cstr"),O}function E(y,F,O,b){var W=q(6+b.length);W.write_shift(2,y),W.write_shift(1,O),W.write_shift(1,F),W.write_shift(1,39);for(var L=0;L<b.length;++L){var Z=b.charCodeAt(L);W.write_shift(1,Z>=128?95:Z)}return W.write_shift(1,0),W}function I(y,F){var O=R(y);O[1].v=y.read_shift(2);var b=O[1].v>>1;if(O[1].v&1)switch(b&7){case 0:b=(b>>3)*5e3;break;case 1:b=(b>>3)*500;break;case 2:b=(b>>3)/20;break;case 3:b=(b>>3)/200;break;case 4:b=(b>>3)/2e3;break;case 5:b=(b>>3)/2e4;break;case 6:b=(b>>3)/16;break;case 7:b=(b>>3)/64;break}return O[1].v=b,O}function D(y,F){var O=R(y),b=y.read_shift(4),W=y.read_shift(4),L=y.read_shift(2);if(L==65535)return b===0&&W===3221225472?(O[1].t="e",O[1].v=15):b===0&&W===3489660928?(O[1].t="e",O[1].v=42):O[1].v=0,O;var Z=L&32768;return L=(L&32767)-16446,O[1].v=(1-Z*2)*(W*Math.pow(2,L+32)+b*Math.pow(2,L)),O}function P(y,F,O,b){var W=q(14);if(W.write_shift(2,y),W.write_shift(1,O),W.write_shift(1,F),b==0)return W.write_shift(4,0),W.write_shift(4,0),W.write_shift(2,65535),W;var L=0,Z=0,se=0,ae=0;return b<0&&(L=1,b=-b),Z=Math.log2(b)|0,b/=Math.pow(2,Z-31),ae=b>>>0,ae&2147483648||(b/=2,++Z,ae=b>>>0),b-=ae,ae|=2147483648,ae>>>=0,b*=Math.pow(2,32),se=b>>>0,W.write_shift(4,se),W.write_shift(4,ae),Z+=16383+(L?32768:0),W.write_shift(2,Z),W}function U(y,F){var O=D(y);return y.l+=F-14,O}function H(y,F){var O=R(y),b=y.read_shift(4);return O[1].v=b>>6,O}function ee(y,F){var O=R(y),b=y.read_shift(8,"f");return O[1].v=b,O}function pe(y,F){var O=ee(y);return y.l+=F-10,O}function ge(y,F){return y[y.l+F-1]==0?y.read_shift(F,"cstr"):""}function je(y,F){var O=y[y.l++];O>F-1&&(O=F-1);for(var b="";b.length<O;)b+=String.fromCharCode(y[y.l++]);return b}function _e(y,F,O){if(!(!O.qpro||F<21)){var b=y.read_shift(1);y.l+=17,y.l+=1,y.l+=2;var W=y.read_shift(F-21,"cstr");return[b,W]}}function ke(y,F){for(var O={},b=y.l+F;y.l<b;){var W=y.read_shift(2);if(W==14e3){for(O[W]=[0,""],O[W][0]=y.read_shift(2);y[y.l];)O[W][1]+=String.fromCharCode(y[y.l]),y.l++;y.l++}}return O}function de(y,F){var O=q(5+y.length);O.write_shift(2,14e3),O.write_shift(2,F);for(var b=0;b<y.length;++b){var W=y.charCodeAt(b);O[O.l++]=W>127?95:W}return O[O.l++]=0,O}var me={0:{n:"BOF",f:ml},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:h},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:h},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ge},222:{n:"SHEETNAMELP",f:je},65535:{n:""}},Se={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:z},23:{n:"NUMBER17",f:D},24:{n:"NUMBER18",f:I},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ke},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:ee},40:{n:"FORMULA28",f:pe},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ge},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_e},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:a,to_workbook:r}}(),Qf=/^\s|\s$|[\t\n\r]/;function wl(t,r){if(!r.bookSST)return"";var e=[Je];e[e.length]=oe("sst",null,{xmlns:ss[0],count:t.Count,uniqueCount:t.Unique});for(var s=0;s!=t.length;++s)if(t[s]!=null){var a=t[s],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(Qf)&&(i+=' xml:space="preserve"'),i+=">"+Oe(a.t)+"</t>"),i+="</si>",e[e.length]=i}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function Zf(t){return[t.read_shift(4),t.read_shift(4)]}function eu(t,r){return r||(r=q(8)),r.write_shift(4,t.Count),r.write_shift(4,t.Unique),r}var tu=Wh;function ru(t){var r=St();te(r,159,eu(t));for(var e=0;e<t.length;++e)te(r,19,tu(t[e]));return te(r,160),r.end()}function su(t){for(var r=[],e=t.split(""),s=0;s<e.length;++s)r[s]=e[s].charCodeAt(0);return r}function _l(t){var r=0,e,s=su(t),a=s.length+1,i,o,l,c,d;for(e=Tr(a),e[0]=s.length,i=1;i!=a;++i)e[i]=s[i-1];for(i=a-1;i>=0;--i)o=e[i],l=r&16384?1:0,c=r<<1&32767,d=l|c,r=d^o;return r^52811}var nu=function(){function t(a,i){switch(i.type){case"base64":return r(nr(a),i);case"binary":return r(a,i);case"buffer":return r(Ce&&Buffer.isBuffer(a)?a.toString("binary"):Os(a),i);case"array":return r(In(a),i)}throw new Error("Unrecognized type "+i.type)}function r(a,i){var o=i||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var d={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(h,f){Array.isArray(l)&&(l[f]=[]);for(var u=/\\\w+\b/g,m=0,p,x=-1;p=u.exec(h);){switch(p[0]){case"\\cell":var g=h.slice(m,u.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++x,g.length){var j={v:g,t:"s"};Array.isArray(l)?l[f][x]=j:l[Ie({r:f,c:x})]=j}break}m=u.lastIndex}x>d.e.c&&(d.e.c=x)}),l["!ref"]=qe(d),l}function e(a,i){return Rr(t(a,i),i)}function s(a){for(var i=["{\\rtf1\\ansi"],o=ze(a["!ref"]),l,c=Array.isArray(a),d=o.s.r;d<=o.e.r;++d){i.push("\\trowd\\trautofit1");for(var h=o.s.c;h<=o.e.c;++h)i.push("\\cellx"+(h+1));for(i.push("\\pard\\intbl"),h=o.s.c;h<=o.e.c;++h){var f=Ie({r:d,c:h});l=c?(a[d]||[])[h]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(ar(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:s}}();function Gi(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}var au=6,sr=au;function vn(t){return Math.floor((t+Math.round(128/sr)/256)*sr)}function yn(t){return Math.floor((t-5)/sr*100+.5)/100}function va(t){return Math.round((t*sr+5)/sr*256)/256}function Wa(t){t.width?(t.wpx=vn(t.width),t.wch=yn(t.wpx),t.MDW=sr):t.wpx?(t.wch=yn(t.wpx),t.width=va(t.wch),t.MDW=sr):typeof t.wch=="number"&&(t.width=va(t.wch),t.wpx=vn(t.width),t.MDW=sr),t.customWidth&&delete t.customWidth}var iu=96,Sl=iu;function bn(t){return t*96/Sl}function Nl(t){return t*Sl/96}function ou(t){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var s=e[0];s<=e[1];++s)t[s]!=null&&(r[r.length]=oe("numFmt",null,{numFmtId:s,formatCode:Oe(t[s])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=oe("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function lu(t){var r=[];return r[r.length]=oe("cellXfs",null),t.forEach(function(e){r[r.length]=oe("xf",null,e)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=oe("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function jl(t,r){var e=[Je,oe("styleSheet",null,{xmlns:ss[0],"xmlns:vt":et.vt})],s;return t.SSF&&(s=ou(t.SSF))!=null&&(e[e.length]=s),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=lu(r.cellXfs))&&(e[e.length]=s),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function cu(t,r){var e=t.read_shift(2),s=xt(t);return[e,s]}function du(t,r,e){e||(e=q(6+4*r.length)),e.write_shift(2,t),rt(r,e);var s=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),s}function hu(t,r,e){var s={};s.sz=t.read_shift(2)/20;var a=Jh(t);a.fItalic&&(s.italic=1),a.fCondense&&(s.condense=1),a.fExtend&&(s.extend=1),a.fShadow&&(s.shadow=1),a.fOutline&&(s.outline=1),a.fStrikeout&&(s.strike=1);var i=t.read_shift(2);switch(i===700&&(s.bold=1),t.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(s.underline=o);var l=t.read_shift(1);l>0&&(s.family=l);var c=t.read_shift(1);switch(c>0&&(s.charset=c),t.l++,s.color=qh(t),t.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=xt(t),s}function fu(t,r){r||(r=q(25+4*32)),r.write_shift(2,t.sz*20),Qh(t,r),r.write_shift(2,t.bold?700:400);var e=0;t.vertAlign=="superscript"?e=1:t.vertAlign=="subscript"&&(e=2),r.write_shift(2,e),r.write_shift(1,t.underline||0),r.write_shift(1,t.family||0),r.write_shift(1,t.charset||0),r.write_shift(1,0),pn(t.color,r);var s=0;return s=2,r.write_shift(1,s),rt(t.name,r),r.length>r.l?r.slice(0,r.l):r}var uu=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],Zn,xu=Kt;function Vi(t,r){r||(r=q(4*3+8*7+16*1)),Zn||(Zn=Fa(uu));var e=Zn[t.patternType];e==null&&(e=40),r.write_shift(4,e);var s=0;if(e!=40)for(pn({auto:1},r),pn({auto:1},r);s<12;++s)r.write_shift(4,0);else{for(;s<4;++s)r.write_shift(4,0);for(;s<12;++s)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function mu(t,r){var e=t.l+r,s=t.read_shift(2),a=t.read_shift(2);return t.l=e,{ixfe:s,numFmtId:a}}function El(t,r,e){e||(e=q(16)),e.write_shift(2,r||0),e.write_shift(2,t.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var s=0;return e.write_shift(1,s),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function us(t,r){return r||(r=q(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var pu=Kt;function gu(t,r){return r||(r=q(51)),r.write_shift(1,0),us(null,r),us(null,r),us(null,r),us(null,r),us(null,r),r.length>r.l?r.slice(0,r.l):r}function vu(t,r){return r||(r=q(12+4*10)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),mn(t.name||"",r),r.length>r.l?r.slice(0,r.l):r}function yu(t,r,e){var s=q(2052);return s.write_shift(4,t),mn(r,s),mn(e,s),s.length>s.l?s.slice(0,s.l):s}function bu(t,r){if(r){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&++e}),e!=0&&(te(t,615,Ut(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&te(t,44,du(a,r[a]))}),te(t,616))}}function wu(t){var r=1;te(t,611,Ut(r)),te(t,43,fu({sz:12,color:{theme:1},name:"Calibri",family:2})),te(t,612)}function _u(t){var r=2;te(t,603,Ut(r)),te(t,45,Vi({patternType:"none"})),te(t,45,Vi({patternType:"gray125"})),te(t,604)}function Su(t){var r=1;te(t,613,Ut(r)),te(t,46,gu()),te(t,614)}function Nu(t){var r=1;te(t,626,Ut(r)),te(t,47,El({numFmtId:0},65535)),te(t,627)}function ju(t,r){te(t,617,Ut(r.length)),r.forEach(function(e){te(t,47,El(e,0))}),te(t,618)}function Eu(t){var r=1;te(t,619,Ut(r)),te(t,48,vu({xfId:0,name:"Normal"})),te(t,620)}function Tu(t){var r=0;te(t,505,Ut(r)),te(t,506)}function Cu(t){var r=0;te(t,508,yu(r,"TableStyleMedium9","PivotStyleMedium4")),te(t,509)}function ku(t,r){var e=St();return te(e,278),bu(e,t.SSF),wu(e),_u(e),Su(e),Nu(e),ju(e,r.cellXfs),Eu(e),Tu(e),Cu(e),te(e,279),e.end()}function Tl(t,r){if(r&&r.themeXLSX)return r.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var e=[Je];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',e[e.length]='<a:font script="Hang" typeface="맑은 고딕"/>',e[e.length]='<a:font script="Hans" typeface="宋体"/>',e[e.length]='<a:font script="Hant" typeface="新細明體"/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function Au(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:xt(t)}}function Ru(t){var r=q(12+2*t.name.length);return r.write_shift(4,t.flags),r.write_shift(4,t.version),rt(t.name,r),r.slice(0,r.l)}function Fu(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function Du(t){var r=q(4+8*t.length);r.write_shift(4,t.length);for(var e=0;e<t.length;++e)r.write_shift(4,t[e][0]),r.write_shift(4,t[e][1]);return r}function Ou(t,r){var e=q(8+2*r.length);return e.write_shift(4,t),rt(r,e),e.slice(0,e.l)}function Iu(t){return t.l+=4,t.read_shift(4)!=0}function Pu(t,r){var e=q(8);return e.write_shift(4,t),e.write_shift(4,1),e}function Lu(){var t=St();return te(t,332),te(t,334,Ut(1)),te(t,335,Ru({name:"XLDAPR",version:12e4,flags:3496657072})),te(t,336),te(t,339,Ou(1,"XLDAPR")),te(t,52),te(t,35,Ut(514)),te(t,4096,Ut(0)),te(t,4097,Dt(1)),te(t,36),te(t,53),te(t,340),te(t,337,Pu(1)),te(t,51,Du([[1,0]])),te(t,338),te(t,333),t.end()}function Cl(){var t=[Je];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function Bu(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=Ie(e);var s=t.read_shift(1);return s&2&&(r.l="1"),s&8&&(r.a="1"),r}var Hr=1024;function kl(t,r){for(var e=[21600,21600],s=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),a=[oe("xml",null,{"xmlns:v":Ct.v,"xmlns:o":Ct.o,"xmlns:x":Ct.x,"xmlns:mv":Ct.mv}).replace(/\/>/,">"),oe("o:shapelayout",oe("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),oe("v:shapetype",[oe("v:stroke",null,{joinstyle:"miter"}),oe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:s})];Hr<t*1e3;)Hr+=1e3;return r.forEach(function(i){var o=tt(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?oe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,d=oe("v:fill",c,l),h={on:"t",obscured:"t"};++Hr,a=a.concat(["<v:shape"+Cs({id:"_x0000_s"+Hr,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",d,oe("v:shadow",null,h),oe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",lt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),lt("x:AutoFill","False"),lt("x:Row",String(o.r)),lt("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Al(t){var r=[Je,oe("comments",null,{xmlns:ss[0]})],e=[];return r.push("<authors>"),t.forEach(function(s){s[1].forEach(function(a){var i=Oe(a.a);e.indexOf(i)==-1&&(e.push(i),r.push("<author>"+i+"</author>")),a.T&&a.ID&&e.indexOf("tc="+a.ID)==-1&&(e.push("tc="+a.ID),r.push("<author>tc="+a.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),t.forEach(function(s){var a=0,i=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?a=e.indexOf("tc="+s[1][0].ID):s[1].forEach(function(c){c.a&&(a=e.indexOf(Oe(c.a))),i.push(c.t||"")}),r.push('<comment ref="'+s[0]+'" authorId="'+a+'"><text>'),i.length<=1)r.push(lt("t",Oe(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;r.push(lt("t",Oe(o)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Mu(t,r,e){var s=[Je,oe("ThreadedComments",null,{xmlns:et.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&r.indexOf(o.a)==-1&&r.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(o.a)).slice(-12)+"}"),s.push(oe("threadedComment",lt("text",o.t||""),c))})}),s.push("</ThreadedComments>"),s.join("")}function zu(t){var r=[Je,oe("personList",null,{xmlns:et.TCMNT,"xmlns:x":ss[0]}).replace(/[\/]>/,">")];return t.forEach(function(e,s){r.push(oe("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join("")}function Uu(t){var r={};r.iauthor=t.read_shift(4);var e=Ir(t);return r.rfx=e.s,r.ref=Ie(e.s),t.l+=16,r}function $u(t,r){return r==null&&(r=q(36)),r.write_shift(4,t[1].iauthor),as(t[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var Hu=xt;function Wu(t){return rt(t.slice(0,54))}function Gu(t){var r=St(),e=[];return te(r,628),te(r,630),t.forEach(function(s){s[1].forEach(function(a){e.indexOf(a.a)>-1||(e.push(a.a.slice(0,54)),te(r,632,Wu(a.a)))})}),te(r,631),te(r,633),t.forEach(function(s){s[1].forEach(function(a){a.iauthor=e.indexOf(a.a);var i={s:tt(s[0]),e:tt(s[0])};te(r,635,$u([i,a])),a.t&&a.t.length>0&&te(r,637,Vh(a)),te(r,636),delete a.iauthor})}),te(r,634),te(r,629),r.end()}function Vu(t,r){r.FullPaths.forEach(function(e,s){if(s!=0){var a=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Pe.utils.cfb_add(t,a,r.FileIndex[s].content)}})}var Rl=["xlsb","xlsm","xlam","biff8","xla"],Xu=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(s,a,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var d=i.length>0?parseInt(i,10)|0:0,h=o.length>0?parseInt(o,10)|0:0;return l?h+=r.c:--h,c?d+=r.r:--d,a+(l?"":"$")+ut(h)+(c?"":"$")+ct(d)}return function(a,i){return r=i,a.replace(t,e)}}(),Ga=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Va=function(){return function(r,e){return r.replace(Ga,function(s,a,i,o,l,c){var d=Ma(o)-(i?0:e.c),h=Ba(c)-(l?0:e.r),f=h==0?"":l?h+1:"["+h+"]",u=d==0?"":i?d+1:"["+d+"]";return a+"R"+f+"C"+u})}}();function Ku(t,r){return t.replace(Ga,function(e,s,a,i,o,l){return s+(a=="$"?a+i:ut(Ma(i)+r.c))+(o=="$"?o+l:ct(Ba(l)+r.r))})}function Yu(t){return t.length!=1}function Ye(t){t.l+=1}function xr(t,r){var e=t.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function Fl(t,r,e){var s=2;if(e){if(e.biff>=2&&e.biff<=5)return Dl(t);e.biff==12&&(s=4)}var a=t.read_shift(s),i=t.read_shift(s),o=xr(t),l=xr(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Dl(t){var r=xr(t),e=xr(t),s=t.read_shift(1),a=t.read_shift(1);return{s:{r:r[0],c:s,cRel:r[1],rRel:r[2]},e:{r:e[0],c:a,cRel:e[1],rRel:e[2]}}}function qu(t,r,e){if(e.biff<8)return Dl(t);var s=t.read_shift(e.biff==12?4:2),a=t.read_shift(e.biff==12?4:2),i=xr(t),o=xr(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Ol(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return Ju(t);var s=t.read_shift(e&&e.biff==12?4:2),a=xr(t);return{r:s,c:a[0],cRel:a[1],rRel:a[2]}}function Ju(t){var r=xr(t),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function Qu(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function Zu(t,r,e){var s=e&&e.biff?e.biff:8;if(s>=2&&s<=5)return ex(t);var a=t.read_shift(s>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:l}}function ex(t){var r=t.read_shift(2),e=t.read_shift(1),s=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,s==1&&r>=8192&&(r=r-16384),a==1&&e>=128&&(e=e-256),{r,c:e,cRel:a,rRel:s}}function tx(t,r,e){var s=(t[t.l++]&96)>>5,a=Fl(t,e.biff>=2&&e.biff<=5?6:8,e);return[s,a]}function rx(t,r,e){var s=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(e)switch(e.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=Fl(t,i,e);return[s,a,o]}function sx(t,r,e){var s=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[s]}function nx(t,r,e){var s=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(e)switch(e.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[s,a]}function ax(t,r,e){var s=(t[t.l++]&96)>>5,a=qu(t,r-1,e);return[s,a]}function ix(t,r,e){var s=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[s]}function Xi(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function ox(t,r,e){t.l+=2;for(var s=t.read_shift(e&&e.biff==2?1:2),a=[],i=0;i<=s;++i)a.push(t.read_shift(e&&e.biff==2?1:2));return a}function lx(t,r,e){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(e&&e.biff==2?1:2)]}function cx(t,r,e){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(e&&e.biff==2?1:2)]}function dx(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function hx(t,r,e){var s=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[s]}function Il(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function fx(t){return t.read_shift(2),Il(t)}function ux(t){return t.read_shift(2),Il(t)}function xx(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var a=Ol(t,0,e);return[s,a]}function mx(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var a=Zu(t,0,e);return[s,a]}function px(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var i=Ol(t,0,e);return[s,a,i]}function gx(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(e&&e.biff<=3?1:2);return[gm[a],Bl[a],s]}function vx(t,r,e){var s=t[t.l++],a=t.read_shift(1),i=e&&e.biff<=3?[s==88?-1:0,t.read_shift(1)]:yx(t);return[a,(i[0]===0?Bl:pm)[i[1]]]}function yx(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function bx(t,r,e){t.l+=e&&e.biff==2?3:4}function wx(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var s=t.read_shift(2),a=t.read_shift(e&&e.biff==2?1:2);return[s,a]}function _x(t){return t.l++,Ls[t.read_shift(1)]}function Sx(t){return t.l++,t.read_shift(2)}function Nx(t){return t.l++,t.read_shift(1)!==0}function jx(t){return t.l++,is(t)}function Ex(t,r,e){return t.l++,gl(t,r-1,e)}function Tx(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=pf(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=Ls[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=is(t);break;case 2:e[1]=bf(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function Cx(t,r,e){for(var s=t.read_shift(e.biff==12?4:2),a=[],i=0;i!=s;++i)a.push((e.biff==12?Ir:Sf)(t));return a}function kx(t,r,e){var s=0,a=0;e.biff==12?(s=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),s=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--s,--a==0&&(a=256));for(var i=0,o=[];i!=s&&(o[i]=[]);++i)for(var l=0;l!=a;++l)o[i][l]=Tx(t,e.biff);return o}function Ax(t,r,e){var s=t.read_shift(1)>>>5&3,a=!e||e.biff>=8?4:2,i=t.read_shift(a);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[s,0,i]}function Rx(t,r,e){if(e.biff==5)return Fx(t);var s=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[s,a,i]}function Fx(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var s=t.read_shift(2);return t.l+=12,[r,e,s]}function Dx(t,r,e){var s=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var a=t.read_shift(e&&e.biff==2?1:2);return[s,a]}function Ox(t,r,e){var s=t.read_shift(1)>>>5&3,a=t.read_shift(e&&e.biff==2?1:2);return[s,a]}function Ix(t,r,e){var s=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[s]}function Px(t,r,e){var s=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(e)switch(e.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[s,a]}var Lx=Kt,Bx=Kt,Mx=Kt;function Bs(t,r,e){return t.l+=2,[Qu(t)]}function Xa(t){return t.l+=6,[]}var zx=Bs,Ux=Xa,$x=Xa,Hx=Bs;function Pl(t){return t.l+=2,[ml(t),t.read_shift(2)&1]}var Wx=Bs,Gx=Pl,Vx=Xa,Xx=Bs,Kx=Bs,Yx=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function qx(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),o=Yx[e>>2&31];return{ixti:r,coltype:e&3,rt:o,idx:s,c:a,C:i}}function Jx(t){return t.l+=2,[t.read_shift(4)]}function Qx(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function Zx(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function em(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function tm(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function rm(t){return t.l+=4,[0,0]}var Ki={1:{n:"PtgExp",f:wx},2:{n:"PtgTbl",f:Mx},3:{n:"PtgAdd",f:Ye},4:{n:"PtgSub",f:Ye},5:{n:"PtgMul",f:Ye},6:{n:"PtgDiv",f:Ye},7:{n:"PtgPower",f:Ye},8:{n:"PtgConcat",f:Ye},9:{n:"PtgLt",f:Ye},10:{n:"PtgLe",f:Ye},11:{n:"PtgEq",f:Ye},12:{n:"PtgGe",f:Ye},13:{n:"PtgGt",f:Ye},14:{n:"PtgNe",f:Ye},15:{n:"PtgIsect",f:Ye},16:{n:"PtgUnion",f:Ye},17:{n:"PtgRange",f:Ye},18:{n:"PtgUplus",f:Ye},19:{n:"PtgUminus",f:Ye},20:{n:"PtgPercent",f:Ye},21:{n:"PtgParen",f:Ye},22:{n:"PtgMissArg",f:Ye},23:{n:"PtgStr",f:Ex},26:{n:"PtgSheet",f:Qx},27:{n:"PtgEndSheet",f:Zx},28:{n:"PtgErr",f:_x},29:{n:"PtgBool",f:Nx},30:{n:"PtgInt",f:Sx},31:{n:"PtgNum",f:jx},32:{n:"PtgArray",f:ix},33:{n:"PtgFunc",f:gx},34:{n:"PtgFuncVar",f:vx},35:{n:"PtgName",f:Ax},36:{n:"PtgRef",f:xx},37:{n:"PtgArea",f:tx},38:{n:"PtgMemArea",f:Dx},39:{n:"PtgMemErr",f:Lx},40:{n:"PtgMemNoMem",f:Bx},41:{n:"PtgMemFunc",f:Ox},42:{n:"PtgRefErr",f:Ix},43:{n:"PtgAreaErr",f:sx},44:{n:"PtgRefN",f:mx},45:{n:"PtgAreaN",f:ax},46:{n:"PtgMemAreaN",f:em},47:{n:"PtgMemNoMemN",f:tm},57:{n:"PtgNameX",f:Rx},58:{n:"PtgRef3d",f:px},59:{n:"PtgArea3d",f:rx},60:{n:"PtgRefErr3d",f:Px},61:{n:"PtgAreaErr3d",f:nx},255:{}},sm={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},nm={1:{n:"PtgElfLel",f:Pl},2:{n:"PtgElfRw",f:Xx},3:{n:"PtgElfCol",f:zx},6:{n:"PtgElfRwV",f:Kx},7:{n:"PtgElfColV",f:Hx},10:{n:"PtgElfRadical",f:Wx},11:{n:"PtgElfRadicalS",f:Vx},13:{n:"PtgElfColS",f:Ux},15:{n:"PtgElfColSV",f:$x},16:{n:"PtgElfRadicalLel",f:Gx},25:{n:"PtgList",f:qx},29:{n:"PtgSxName",f:Jx},255:{}},am={0:{n:"PtgAttrNoop",f:rm},1:{n:"PtgAttrSemi",f:hx},2:{n:"PtgAttrIf",f:cx},4:{n:"PtgAttrChoose",f:ox},8:{n:"PtgAttrGoto",f:lx},16:{n:"PtgAttrSum",f:bx},32:{n:"PtgAttrBaxcel",f:Xi},33:{n:"PtgAttrBaxcel",f:Xi},64:{n:"PtgAttrSpace",f:fx},65:{n:"PtgAttrSpaceSemi",f:ux},128:{n:"PtgAttrIfError",f:dx},255:{}};function im(t,r,e,s){if(s.biff<8)return Kt(t,r);for(var a=t.l+r,i=[],o=0;o!==e.length;++o)switch(e[o][0]){case"PtgArray":e[o][1]=kx(t,0,s),i.push(e[o][1]);break;case"PtgMemArea":e[o][2]=Cx(t,e[o][1],s),i.push(e[o][2]);break;case"PtgExp":s&&s.biff==12&&(e[o][1][1]=t.read_shift(4),i.push(e[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[o][0]}return r=a-t.l,r!==0&&i.push(Kt(t,r)),i}function om(t,r,e){for(var s=t.l+r,a,i,o=[];s!=t.l;)r=s-t.l,i=t[t.l],a=Ki[i]||Ki[sm[i]],(i===24||i===25)&&(a=(i===24?nm:am)[t[t.l+1]]),!a||!a.f?Kt(t,r):o.push([a.n,a.f(t,r,e)]);return o}function lm(t){for(var r=[],e=0;e<t.length;++e){for(var s=t[e],a=[],i=0;i<s.length;++i){var o=s[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var cm={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function dm(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Ll(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var s=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!s)return"SH33TJSERR1";var a="";if(e.biff>8)switch(t[s[0]][0]){case 357:return a=s[1]==-1?"#REF":t.SheetNames[s[1]],s[1]==s[2]?a:a+":"+t.SheetNames[s[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[s[0]][0];case 355:default:return"SH33TJSSRC"+t[s[0]][0]}switch(t[s[0]][0][0]){case 1025:return a=s[1]==-1?"#REF":t.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?a:a+":"+t.SheetNames[s[2]];case 14849:return t[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[s[0]][0][3]?(a=s[1]==-1?"#REF":t[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?a:a+":"+t[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function Yi(t,r,e){var s=Ll(t,r,e);return s=="#REF"?s:dm(s,e)}function Jr(t,r,e,s,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,d,h,f=0,u=0,m,p="";if(!t[0]||!t[0][0])return"";for(var x=-1,g="",j=0,w=t[0].length;j<w;++j){var _=t[0][j];switch(_[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),d=l.pop(),x>=0){switch(t[0][x][1][0]){case 0:g=Ve(" ",t[0][x][1][1]);break;case 1:g=Ve("\r",t[0][x][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}d=d+g,x=-1}l.push(d+cm[_[0]]+c);break;case"PtgIsect":c=l.pop(),d=l.pop(),l.push(d+" "+c);break;case"PtgUnion":c=l.pop(),d=l.pop(),l.push(d+","+c);break;case"PtgRange":c=l.pop(),d=l.pop(),l.push(d+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":h=ys(_[1][1],o,a),l.push(bs(h,i));break;case"PtgRefN":h=e?ys(_[1][1],e,a):_[1][1],l.push(bs(h,i));break;case"PtgRef3d":f=_[1][1],h=ys(_[1][2],o,a),p=Yi(s,f,a),l.push(p+"!"+bs(h,i));break;case"PtgFunc":case"PtgFuncVar":var T=_[1][0],R=_[1][1];T||(T=0),T&=127;var z=T==0?[]:l.slice(-T);l.length-=T,R==="User"&&(R=z.shift()),l.push(R+"("+z.join(",")+")");break;case"PtgBool":l.push(_[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(_[1]);break;case"PtgNum":l.push(String(_[1]));break;case"PtgStr":l.push('"'+_[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(_[1]);break;case"PtgAreaN":m=Di(_[1][1],e?{s:e}:o,a),l.push(Jn(m,a));break;case"PtgArea":m=Di(_[1][1],o,a),l.push(Jn(m,a));break;case"PtgArea3d":f=_[1][1],m=_[1][2],p=Yi(s,f,a),l.push(p+"!"+Jn(m,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=_[1][2];var E=(s.names||[])[u-1]||(s[0]||[])[u],I=E?E.Name:"SH33TJSNAME"+String(u);I&&I.slice(0,6)=="_xlfn."&&!a.xlfn&&(I=I.slice(6)),l.push(I);break;case"PtgNameX":var D=_[1][1];u=_[1][2];var P;if(a.biff<=5)D<0&&(D=-D),s[D]&&(P=s[D][u]);else{var U="";if(((s[D]||[])[0]||[])[0]==14849||(((s[D]||[])[0]||[])[0]==1025?s[D][u]&&s[D][u].itab>0&&(U=s.SheetNames[s[D][u].itab-1]+"!"):U=s.SheetNames[u-1]+"!"),s[D]&&s[D][u])U+=s[D][u].Name;else if(s[0]&&s[0][u])U+=s[0][u].Name;else{var H=(Ll(s,D,a)||"").split(";;");H[u-1]?U=H[u-1]:U+="SH33TJSERRX"}l.push(U);break}P||(P={Name:"SH33TJSERRY"}),l.push(P.Name);break;case"PtgParen":var ee="(",pe=")";if(x>=0){switch(g="",t[0][x][1][0]){case 2:ee=Ve(" ",t[0][x][1][1])+ee;break;case 3:ee=Ve("\r",t[0][x][1][1])+ee;break;case 4:pe=Ve(" ",t[0][x][1][1])+pe;break;case 5:pe=Ve("\r",t[0][x][1][1])+pe;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}l.push(ee+l.pop()+pe);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":h={c:_[1][1],r:_[1][0]};var ge={c:e.c,r:e.r};if(s.sharedf[Ie(h)]){var je=s.sharedf[Ie(h)];l.push(Jr(je,o,ge,s,a))}else{var _e=!1;for(c=0;c!=s.arrayf.length;++c)if(d=s.arrayf[c],!(h.c<d[0].s.c||h.c>d[0].e.c)&&!(h.r<d[0].s.r||h.r>d[0].e.r)){l.push(Jr(d[1],o,ge,s,a)),_e=!0;break}_e||l.push(_[1])}break;case"PtgArray":l.push("{"+lm(_[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=j;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+_[1].idx+"[#"+_[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(_));default:throw new Error("Unrecognized Formula Token: "+String(_))}var ke=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&ke.indexOf(t[0][j][0])==-1){_=t[0][x];var de=!0;switch(_[1][0]){case 4:de=!1;case 0:g=Ve(" ",_[1][1]);break;case 5:de=!1;case 1:g=Ve("\r",_[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+_[1][0])}l.push((de?g:"")+l.pop()+(de?"":g)),x=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function hm(t){if(t==null){var r=q(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof t=="number")return Cr(t);return Cr(0)}function fm(t,r,e,s,a){var i=kr(r,e,a),o=hm(t.v),l=q(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var d=q(t.bf.length),h=0;h<t.bf.length;++h)d[h]=t.bf[h];var f=ot([i,o,l,d]);return f}function Pn(t,r,e){var s=t.read_shift(4),a=om(t,s,e),i=t.read_shift(4),o=i>0?im(t,i,a,e):null;return[a,o]}var um=Pn,Ln=Pn,xm=Pn,mm=Pn,pm={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},Bl={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},gm={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function vm(t){var r="of:="+t.replace(Ga,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function ym(t){return t.replace(/\./,"!")}var ws=typeof Map<"u";function Ka(t,r,e){var s=0,a=t.length;if(e){if(ws?e.has(r):Object.prototype.hasOwnProperty.call(e,r)){for(var i=ws?e.get(r):e[r];s<i.length;++s)if(t[i[s]].t===r)return t.Count++,i[s]}}else for(;s<a;++s)if(t[s].t===r)return t.Count++,s;return t[a]={t:r},t.Count++,t.Unique++,e&&(ws?(e.has(r)||e.set(r,[]),e.get(r).push(a)):(Object.prototype.hasOwnProperty.call(e,r)||(e[r]=[]),e[r].push(a))),a}function Bn(t,r){var e={min:t+1,max:t+1},s=-1;return r.MDW&&(sr=r.MDW),r.width!=null?e.customWidth=1:r.wpx!=null?s=yn(r.wpx):r.wch!=null&&(s=r.wch),s>-1?(e.width=va(s),e.customWidth=1):r.width!=null&&(e.width=r.width),r.hidden&&(e.hidden=!0),r.level!=null&&(e.outlineLevel=e.level=r.level),e}function Ml(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function pr(t,r,e){var s=e.revssf[r.z!=null?r.z:"General"],a=60,i=t.length;if(s==null&&e.ssf){for(;a<392;++a)if(e.ssf[a]==null){Oo(r.z,a),e.ssf[a]=r.z,e.revssf[r.z]=s=a;break}}for(a=0;a!=i;++a)if(t[a].numFmtId===s)return a;return t[i]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function bm(t,r,e){if(t&&t["!ref"]){var s=ze(t["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+e+"): "+t["!ref"])}}function wm(t){if(t.length===0)return"";for(var r='<mergeCells count="'+t.length+'">',e=0;e!=t.length;++e)r+='<mergeCell ref="'+qe(t[e])+'"/>';return r+"</mergeCells>"}function _m(t,r,e,s,a){var i=!1,o={},l=null;if(s.bookType!=="xlsx"&&r.vbaraw){var c=r.SheetNames[e];try{r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}i=!0,o.codeName=Ts(Oe(c))}if(t&&t["!outline"]){var d={summaryBelow:1,summaryRight:1};t["!outline"].above&&(d.summaryBelow=0),t["!outline"].left&&(d.summaryRight=0),l=(l||"")+oe("outlinePr",null,d)}!i&&!l||(a[a.length]=oe("sheetPr",l,o))}var Sm=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Nm=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function jm(t){var r={sheet:1};return Sm.forEach(function(e){t[e]!=null&&t[e]&&(r[e]="1")}),Nm.forEach(function(e){t[e]!=null&&!t[e]&&(r[e]="0")}),t.password&&(r.password=_l(t.password).toString(16).toUpperCase()),oe("sheetProtection",null,r)}function Em(t){return Ml(t),oe("pageMargins",null,t)}function Tm(t,r){for(var e=["<cols>"],s,a=0;a!=r.length;++a)(s=r[a])&&(e[e.length]=oe("col",null,Bn(a,s)));return e[e.length]="</cols>",e.join("")}function Cm(t,r,e,s){var a=typeof t.ref=="string"?t.ref:qe(t.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var i=e.Workbook.Names,o=At(a);o.s.r==o.e.r&&(o.e.r=At(r["!ref"]).e.r,a=qe(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+e.SheetNames[s]+"'!"+a;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+e.SheetNames[s]+"'!"+a}),oe("autoFilter",null,{ref:a})}function km(t,r,e,s){var a={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),oe("sheetViews",oe("sheetView",null,a),{})}function Am(t,r,e,s){if(t.c&&e["!comments"].push([r,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Ls[t.v];break;case"d":s&&s.cellDates?a=bt(t.v,-1).toISOString():(t=jt(t),t.t="n",a=""+(t.v=Nt(bt(t.v)))),typeof t.z>"u"&&(t.z=Xe[14]);break;default:a=t.v;break}var l=lt("v",Oe(a)),c={r},d=pr(s.cellXfs,t,s);switch(d!==0&&(c.s=d),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=lt("v",""+Ka(s.Strings,t.v,s.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var h=t.F&&t.F.slice(0,r.length)==r?{t:"array",ref:t.F}:null;l=oe("f",Oe(t.f),h)+(t.v!=null?l:"")}return t.l&&e["!links"].push([r,t.l]),t.D&&(c.cm=1),oe("c",l,c)}function Rm(t,r,e,s){var a=[],i=[],o=ze(t["!ref"]),l="",c,d="",h=[],f=0,u=0,m=t["!rows"],p=Array.isArray(t),x={r:d},g,j=-1;for(u=o.s.c;u<=o.e.c;++u)h[u]=ut(u);for(f=o.s.r;f<=o.e.r;++f){for(i=[],d=ct(f),u=o.s.c;u<=o.e.c;++u){c=h[u]+d;var w=p?(t[f]||[])[u]:t[c];w!==void 0&&(l=Am(w,c,t,r))!=null&&i.push(l)}(i.length>0||m&&m[f])&&(x={r:d},m&&m[f]&&(g=m[f],g.hidden&&(x.hidden=1),j=-1,g.hpx?j=bn(g.hpx):g.hpt&&(j=g.hpt),j>-1&&(x.ht=j,x.customHeight=1),g.level&&(x.outlineLevel=g.level)),a[a.length]=oe("row",i.join(""),x))}if(m)for(;f<m.length;++f)m&&m[f]&&(x={r:f+1},g=m[f],g.hidden&&(x.hidden=1),j=-1,g.hpx?j=bn(g.hpx):g.hpt&&(j=g.hpt),j>-1&&(x.ht=j,x.customHeight=1),g.level&&(x.outlineLevel=g.level),a[a.length]=oe("row","",x));return a.join("")}function zl(t,r,e,s){var a=[Je,oe("worksheet",null,{xmlns:ss[0],"xmlns:r":et.r})],i=e.SheetNames[t],o=0,l="",c=e.Sheets[i];c==null&&(c={});var d=c["!ref"]||"A1",h=ze(d);if(h.e.c>16383||h.e.r>1048575){if(r.WTF)throw new Error("Range "+d+" exceeds format limit A1:XFD1048576");h.e.c=Math.min(h.e.c,16383),h.e.r=Math.min(h.e.c,1048575),d=qe(h)}s||(s={}),c["!comments"]=[];var f=[];_m(c,e,t,r,a),a[a.length]=oe("dimension",null,{ref:d}),a[a.length]=km(c,r,t,e),r.sheetFormat&&(a[a.length]=oe("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=Tm(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Rm(c,r),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=jm(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=Cm(c["!autofilter"],c,e,t)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=wm(c["!merges"]));var u=-1,m,p=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(p=De(s,-1,Oe(x[1].Target).replace(/#.*$/,""),Te.HLINK),m["r:id"]="rId"+p),(u=x[1].Target.indexOf("#"))>-1&&(m.location=Oe(x[1].Target.slice(u+1))),x[1].Tooltip&&(m.tooltip=Oe(x[1].Tooltip)),a[a.length]=oe("hyperlink",null,m))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=Em(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(a[a.length]=lt("ignoredErrors",oe("ignoredError",null,{numberStoredAsText:1,sqref:d}))),f.length>0&&(p=De(s,-1,"../drawings/drawing"+(t+1)+".xml",Te.DRAW),a[a.length]=oe("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=f),c["!comments"].length>0&&(p=De(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Te.VML),a[a.length]=oe("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Fm(t,r){var e={},s=t.l+r;e.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=s,i&7&&(e.level=i&7),i&16&&(e.hidden=!0),i&32&&(e.hpt=a/20),e}function Dm(t,r,e){var s=q(145),a=(e["!rows"]||[])[t]||{};s.write_shift(4,t),s.write_shift(4,0);var i=320;a.hpx?i=bn(a.hpx)*20:a.hpt&&(i=a.hpt*20),s.write_shift(2,i),s.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var l=0,c=s.l;s.l+=4;for(var d={r:t,c:0},h=0;h<16;++h)if(!(r.s.c>h+1<<10||r.e.c<h<<10)){for(var f=-1,u=-1,m=h<<10;m<h+1<<10;++m){d.c=m;var p=Array.isArray(e)?(e[d.r]||[])[d.c]:e[Ie(d)];p&&(f<0&&(f=m),u=m)}f<0||(++l,s.write_shift(4,f),s.write_shift(4,u))}var x=s.l;return s.l=c,s.write_shift(4,l),s.l=x,s.length>s.l?s.slice(0,s.l):s}function Om(t,r,e,s){var a=Dm(s,e,r);(a.length>17||(r["!rows"]||[])[s])&&te(t,0,a)}var Im=Ir,Pm=as;function Lm(){}function Bm(t,r){var e={},s=t[t.l];return++t.l,e.above=!(s&64),e.left=!(s&128),t.l+=18,e.name=Xh(t),e}function Mm(t,r,e){e==null&&(e=q(84+4*t.length));var s=192;r&&(r.above&&(s&=-65),r.left&&(s&=-129)),e.write_shift(1,s);for(var a=1;a<3;++a)e.write_shift(1,0);return pn({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),tl(t,e),e.slice(0,e.l)}function zm(t){var r=It(t);return[r]}function Um(t,r,e){return e==null&&(e=q(8)),Fr(r,e)}function $m(t){var r=Dr(t);return[r]}function Hm(t,r,e){return e==null&&(e=q(4)),Or(r,e)}function Wm(t){var r=It(t),e=t.read_shift(1);return[r,e,"b"]}function Gm(t,r,e){return e==null&&(e=q(9)),Fr(r,e),e.write_shift(1,t.v?1:0),e}function Vm(t){var r=Dr(t),e=t.read_shift(1);return[r,e,"b"]}function Xm(t,r,e){return e==null&&(e=q(5)),Or(r,e),e.write_shift(1,t.v?1:0),e}function Km(t){var r=It(t),e=t.read_shift(1);return[r,e,"e"]}function Ym(t,r,e){return e==null&&(e=q(9)),Fr(r,e),e.write_shift(1,t.v),e}function qm(t){var r=Dr(t),e=t.read_shift(1);return[r,e,"e"]}function Jm(t,r,e){return e==null&&(e=q(8)),Or(r,e),e.write_shift(1,t.v),e.write_shift(2,0),e.write_shift(1,0),e}function Qm(t){var r=It(t),e=t.read_shift(4);return[r,e,"s"]}function Zm(t,r,e){return e==null&&(e=q(12)),Fr(r,e),e.write_shift(4,r.v),e}function ep(t){var r=Dr(t),e=t.read_shift(4);return[r,e,"s"]}function tp(t,r,e){return e==null&&(e=q(8)),Or(r,e),e.write_shift(4,r.v),e}function rp(t){var r=It(t),e=is(t);return[r,e,"n"]}function sp(t,r,e){return e==null&&(e=q(16)),Fr(r,e),Cr(t.v,e),e}function np(t){var r=Dr(t),e=is(t);return[r,e,"n"]}function ap(t,r,e){return e==null&&(e=q(12)),Or(r,e),Cr(t.v,e),e}function ip(t){var r=It(t),e=rl(t);return[r,e,"n"]}function op(t,r,e){return e==null&&(e=q(12)),Fr(r,e),sl(t.v,e),e}function lp(t){var r=Dr(t),e=rl(t);return[r,e,"n"]}function cp(t,r,e){return e==null&&(e=q(8)),Or(r,e),sl(t.v,e),e}function dp(t){var r=It(t),e=za(t);return[r,e,"is"]}function hp(t){var r=It(t),e=xt(t);return[r,e,"str"]}function fp(t,r,e){return e==null&&(e=q(12+4*t.v.length)),Fr(r,e),rt(t.v,e),e.length>e.l?e.slice(0,e.l):e}function up(t){var r=Dr(t),e=xt(t);return[r,e,"str"]}function xp(t,r,e){return e==null&&(e=q(8+4*t.v.length)),Or(r,e),rt(t.v,e),e.length>e.l?e.slice(0,e.l):e}function mp(t,r,e){var s=t.l+r,a=It(t);a.r=e["!row"];var i=t.read_shift(1),o=[a,i,"b"];if(e.cellFormula){t.l+=2;var l=Ln(t,s-t.l,e);o[3]=Jr(l,null,a,e.supbooks,e)}else t.l=s;return o}function pp(t,r,e){var s=t.l+r,a=It(t);a.r=e["!row"];var i=t.read_shift(1),o=[a,i,"e"];if(e.cellFormula){t.l+=2;var l=Ln(t,s-t.l,e);o[3]=Jr(l,null,a,e.supbooks,e)}else t.l=s;return o}function gp(t,r,e){var s=t.l+r,a=It(t);a.r=e["!row"];var i=is(t),o=[a,i,"n"];if(e.cellFormula){t.l+=2;var l=Ln(t,s-t.l,e);o[3]=Jr(l,null,a,e.supbooks,e)}else t.l=s;return o}function vp(t,r,e){var s=t.l+r,a=It(t);a.r=e["!row"];var i=xt(t),o=[a,i,"str"];if(e.cellFormula){t.l+=2;var l=Ln(t,s-t.l,e);o[3]=Jr(l,null,a,e.supbooks,e)}else t.l=s;return o}var yp=Ir,bp=as;function wp(t,r){return r==null&&(r=q(4)),r.write_shift(4,t),r}function _p(t,r){var e=t.l+r,s=Ir(t),a=Ua(t),i=xt(t),o=xt(t),l=xt(t);t.l=e;var c={rfx:s,relId:a,loc:i,display:l};return o&&(c.Tooltip=o),c}function Sp(t,r){var e=q(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));as({s:tt(t[0]),e:tt(t[0])},e),$a("rId"+r,e);var s=t[1].Target.indexOf("#"),a=s==-1?"":t[1].Target.slice(s+1);return rt(a||"",e),rt(t[1].Tooltip||"",e),rt("",e),e.slice(0,e.l)}function Np(){}function jp(t,r,e){var s=t.l+r,a=nl(t),i=t.read_shift(1),o=[a];if(o[2]=i,e.cellFormula){var l=um(t,s-t.l,e);o[1]=l}else t.l=s;return o}function Ep(t,r,e){var s=t.l+r,a=Ir(t),i=[a];if(e.cellFormula){var o=mm(t,s-t.l,e);i[1]=o,t.l=s}else t.l=s;return i}function Tp(t,r,e){e==null&&(e=q(18));var s=Bn(t,r);e.write_shift(-4,t),e.write_shift(-4,t),e.write_shift(4,(s.width||10)*256),e.write_shift(4,0);var a=0;return r.hidden&&(a|=1),typeof s.width=="number"&&(a|=2),r.level&&(a|=r.level<<8),e.write_shift(2,a),e}var Ul=["left","right","top","bottom","header","footer"];function Cp(t){var r={};return Ul.forEach(function(e){r[e]=is(t)}),r}function kp(t,r){return r==null&&(r=q(6*8)),Ml(t),Ul.forEach(function(e){Cr(t[e],r)}),r}function Ap(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function Rp(t,r,e){e==null&&(e=q(30));var s=924;return(((r||{}).Views||[])[0]||{}).RTL&&(s|=32),e.write_shift(2,s),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function Fp(t){var r=q(24);return r.write_shift(4,4),r.write_shift(4,1),as(t,r),r}function Dp(t,r){return r==null&&(r=q(16*4+2)),r.write_shift(2,t.password?_l(t.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,t[e[0]]!=null&&!t[e[0]]?1:0):r.write_shift(4,t[e[0]]!=null&&t[e[0]]?0:1)}),r}function Op(){}function Ip(){}function Pp(t,r,e,s,a,i,o){if(r.v===void 0)return!1;var l="";switch(r.t){case"b":l=r.v?"1":"0";break;case"d":r=jt(r),r.z=r.z||Xe[14],r.v=Nt(bt(r.v)),r.t="n";break;case"n":case"e":l=""+r.v;break;default:l=r.v;break}var c={r:e,c:s};switch(c.s=pr(a.cellXfs,r,a),r.l&&i["!links"].push([Ie(c),r.l]),r.c&&i["!comments"].push([Ie(c),r.c]),r.t){case"s":case"str":return a.bookSST?(l=Ka(a.Strings,r.v,a.revStrings),c.t="s",c.v=l,o?te(t,18,tp(r,c)):te(t,7,Zm(r,c))):(c.t="str",o?te(t,17,xp(r,c)):te(t,6,fp(r,c))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?o?te(t,13,cp(r,c)):te(t,2,op(r,c)):o?te(t,16,ap(r,c)):te(t,5,sp(r,c)),!0;case"b":return c.t="b",o?te(t,15,Xm(r,c)):te(t,4,Gm(r,c)),!0;case"e":return c.t="e",o?te(t,14,Jm(r,c)):te(t,3,Ym(r,c)),!0}return o?te(t,12,Hm(r,c)):te(t,1,Um(r,c)),!0}function Lp(t,r,e,s){var a=ze(r["!ref"]||"A1"),i,o="",l=[];te(t,145);var c=Array.isArray(r),d=a.e.r;r["!rows"]&&(d=Math.max(a.e.r,r["!rows"].length-1));for(var h=a.s.r;h<=d;++h){o=ct(h),Om(t,r,a,h);var f=!1;if(h<=a.e.r)for(var u=a.s.c;u<=a.e.c;++u){h===a.s.r&&(l[u]=ut(u)),i=l[u]+o;var m=c?(r[h]||[])[u]:r[i];if(!m){f=!1;continue}f=Pp(t,m,h,u,s,r,f)}}te(t,146)}function Bp(t,r){!r||!r["!merges"]||(te(t,177,wp(r["!merges"].length)),r["!merges"].forEach(function(e){te(t,176,bp(e))}),te(t,178))}function Mp(t,r){!r||!r["!cols"]||(te(t,390),r["!cols"].forEach(function(e,s){e&&te(t,60,Tp(s,e))}),te(t,391))}function zp(t,r){!r||!r["!ref"]||(te(t,648),te(t,649,Fp(ze(r["!ref"]))),te(t,650))}function Up(t,r,e){r["!links"].forEach(function(s){if(s[1].Target){var a=De(e,-1,s[1].Target.replace(/#.*$/,""),Te.HLINK);te(t,494,Sp(s,a))}}),delete r["!links"]}function $p(t,r,e,s){if(r["!comments"].length>0){var a=De(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Te.VML);te(t,551,$a("rId"+a)),r["!legacy"]=a}}function Hp(t,r,e,s){if(r["!autofilter"]){var a=r["!autofilter"],i=typeof a.ref=="string"?a.ref:qe(a.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var o=e.Workbook.Names,l=At(i);l.s.r==l.e.r&&(l.e.r=At(r["!ref"]).e.r,i=qe(l));for(var c=0;c<o.length;++c){var d=o[c];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==s){d.Ref="'"+e.SheetNames[s]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+e.SheetNames[s]+"'!"+i}),te(t,161,as(ze(i))),te(t,162)}}function Wp(t,r,e){te(t,133),te(t,137,Rp(r,e)),te(t,138),te(t,134)}function Gp(t,r){r["!protect"]&&te(t,535,Dp(r["!protect"]))}function Vp(t,r,e,s){var a=St(),i=e.SheetNames[t],o=e.Sheets[i]||{},l=i;try{e&&e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}var c=ze(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],te(a,129),(e.vbaraw||o["!outline"])&&te(a,147,Mm(l,o["!outline"])),te(a,148,Pm(c)),Wp(a,o,e.Workbook),Mp(a,o),Lp(a,o,t,r),Gp(a,o),Hp(a,o,e,t),Bp(a,o),Up(a,o,s),o["!margins"]&&te(a,476,kp(o["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&zp(a,o),$p(a,o,t,s),te(a,130),a.end()}function Xp(t,r){t.l+=10;var e=xt(t);return{name:e}}var Kp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Yp(t){return!t.Workbook||!t.Workbook.WBProps?"false":jh(t.Workbook.WBProps.date1904)?"true":"false"}var qp="][*?/\\".split("");function $l(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return qp.forEach(function(s){if(t.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}function Jp(t,r,e){t.forEach(function(s,a){$l(s);for(var i=0;i<a;++i)if(s==t[i])throw new Error("Duplicate Sheet Name: "+s);if(e){var o=r&&r[a]&&r[a].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function Qp(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var r=t.Workbook&&t.Workbook.Sheets||[];Jp(t.SheetNames,r,!!t.vbaraw);for(var e=0;e<t.SheetNames.length;++e)bm(t.Sheets[t.SheetNames[e]],t.SheetNames[e],e)}function Hl(t){var r=[Je];r[r.length]=oe("workbook",null,{xmlns:ss[0],"xmlns:r":et.r});var e=t.Workbook&&(t.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(Kp.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(s.codeName=t.Workbook.WBProps.CodeName,delete s.CodeName)),r[r.length]=oe("workbookPr",null,s);var a=t.Workbook&&t.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(r[r.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==t.SheetNames.length&&(i=0),r[r.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:Oe(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}r[r.length]=oe("sheet",null,o)}return r[r.length]="</sheets>",e&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(r[r.length]=oe("definedName",Oe(l.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function Zp(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=ga(t),e.name=xt(t),e}function e1(t,r){return r||(r=q(127)),r.write_shift(4,t.Hidden),r.write_shift(4,t.iTabID),$a(t.strRelID,r),rt(t.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function t1(t,r){var e={},s=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var a=r>8?xt(t):"";return a.length>0&&(e.CodeName=a),e.autoCompressPictures=!!(s&65536),e.backupFile=!!(s&64),e.checkCompatibility=!!(s&4096),e.date1904=!!(s&1),e.filterPrivacy=!!(s&8),e.hidePivotFieldList=!!(s&1024),e.promptedSolutions=!!(s&16),e.publishItems=!!(s&2048),e.refreshAllConnections=!!(s&262144),e.saveExternalLinkValues=!!(s&128),e.showBorderUnselectedTables=!!(s&4),e.showInkAnnotation=!!(s&32),e.showObjects=["all","placeholders","none"][s>>13&3],e.showPivotChartFilter=!!(s&32768),e.updateLinks=["userSet","never","always"][s>>8&3],e}function r1(t,r){r||(r=q(72));var e=0;return t&&t.filterPrivacy&&(e|=8),r.write_shift(4,e),r.write_shift(4,0),tl(t&&t.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function s1(t,r,e){var s=t.l+r;t.l+=4,t.l+=1;var a=t.read_shift(4),i=Kh(t),o=xm(t,0,e),l=Ua(t);t.l=s;var c={Name:i,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function n1(t,r){te(t,143);for(var e=0;e!=r.SheetNames.length;++e){var s=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e]&&r.Workbook.Sheets[e].Hidden||0,a={Hidden:s,iTabID:e+1,strRelID:"rId"+(e+1),name:r.SheetNames[e]};te(t,156,e1(a))}te(t,144)}function a1(t,r){r||(r=q(127));for(var e=0;e!=4;++e)r.write_shift(4,0);return rt("SheetJS",r),rt(ln.version,r),rt(ln.version,r),rt("7262",r),r.length>r.l?r.slice(0,r.l):r}function i1(t,r){r||(r=q(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,t),r.write_shift(4,t);var e=120;return r.write_shift(1,e),r.length>r.l?r.slice(0,r.l):r}function o1(t,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var e=r.Workbook.Sheets,s=0,a=-1,i=-1;s<e.length;++s)!e[s]||!e[s].Hidden&&a==-1?a=s:e[s].Hidden==1&&i==-1&&(i=s);i>a||(te(t,135),te(t,158,i1(a)),te(t,136))}}function l1(t,r){var e=St();return te(e,131),te(e,128,a1()),te(e,153,r1(t.Workbook&&t.Workbook.WBProps||null)),o1(e,t),n1(e,t),te(e,132),e.end()}function c1(t,r,e){return(r.slice(-4)===".bin"?l1:Hl)(t)}function d1(t,r,e,s,a){return(r.slice(-4)===".bin"?Vp:zl)(t,e,s,a)}function h1(t,r,e){return(r.slice(-4)===".bin"?ku:jl)(t,e)}function f1(t,r,e){return(r.slice(-4)===".bin"?ru:wl)(t,e)}function u1(t,r,e){return(r.slice(-4)===".bin"?Gu:Al)(t)}function x1(t){return(t.slice(-4)===".bin"?Lu:Cl)()}function m1(t,r){var e=[];return t.Props&&e.push(hf(t.Props,r)),t.Custprops&&e.push(ff(t.Props,t.Custprops)),e.join("")}function p1(){return""}function g1(t,r){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(s,a){var i=[];i.push(oe("NumberFormat",null,{"ss:Format":Oe(Xe[s.numFmtId])}));var o={"ss:ID":"s"+(21+a)};e.push(oe("Style",i.join(""),o))}),oe("Styles",e.join(""))}function Wl(t){return oe("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Va(t.Ref,{r:0,c:0})})}function v1(t){if(!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,e=[],s=0;s<r.length;++s){var a=r[s];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||e.push(Wl(a)))}return oe("Names",e.join(""))}function y1(t,r,e,s){if(!t||!((s||{}).Workbook||{}).Names)return"";for(var a=s.Workbook.Names,i=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==e&&(l.Name.match(/^_xlfn\./)||i.push(Wl(l)))}return i.join("")}function b1(t,r,e,s){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(oe("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(oe("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(oe("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[e])if(s.Workbook.Sheets[e].Hidden)a.push(oe("Visible",s.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<e&&!(s.Workbook.Sheets[i]&&!s.Workbook.Sheets[i].Hidden);++i);i==e&&a.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(lt("ProtectContents","True")),t["!protect"].objects&&a.push(lt("ProtectObjects","True")),t["!protect"].scenarios&&a.push(lt("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(lt("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(lt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":oe("WorksheetOptions",a.join(""),{xmlns:Ct.x})}function w1(t){return t.map(function(r){var e=Nh(r.t||""),s=oe("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return oe("Comment",s,{"ss:Author":r.a})}).join("")}function _1(t,r,e,s,a,i,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+Oe(Va(t.f,o))),t.F&&t.F.slice(0,r.length)==r){var c=tt(t.F.slice(r.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=Oe(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=Oe(t.l.Tooltip))),e["!merges"])for(var d=e["!merges"],h=0;h!=d.length;++h)d[h].s.c!=o.c||d[h].s.r!=o.r||(d[h].e.c>d[h].s.c&&(l["ss:MergeAcross"]=d[h].e.c-d[h].s.c),d[h].e.r>d[h].s.r&&(l["ss:MergeDown"]=d[h].e.r-d[h].s.r));var f="",u="";switch(t.t){case"z":if(!s.sheetStubs)return"";break;case"n":f="Number",u=String(t.v);break;case"b":f="Boolean",u=t.v?"1":"0";break;case"e":f="Error",u=Ls[t.v];break;case"d":f="DateTime",u=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Xe[14]);break;case"s":f="String",u=Sh(t.v||"");break}var m=pr(s.cellXfs,t,s);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=o.c+1;var p=t.v!=null?u:"",x=t.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(t.c||[]).length>0&&(x+=w1(t.c)),oe("Cell",x,l)}function S1(t,r){var e='<Row ss:Index="'+(t+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Nl(r.hpt)),r.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(e+=' ss:Hidden="1"')),e+">"}function N1(t,r,e,s){if(!t["!ref"])return"";var a=ze(t["!ref"]),i=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(g,j){Wa(g);var w=!!g.width,_=Bn(j,g),T={"ss:Index":j+1};w&&(T["ss:Width"]=vn(_.width)),g.hidden&&(T["ss:Hidden"]="1"),l.push(oe("Column",null,T))});for(var c=Array.isArray(t),d=a.s.r;d<=a.e.r;++d){for(var h=[S1(d,(t["!rows"]||[])[d])],f=a.s.c;f<=a.e.c;++f){var u=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>d)&&!(i[o].e.c<f)&&!(i[o].e.r<d)){(i[o].s.c!=f||i[o].s.r!=d)&&(u=!0);break}if(!u){var m={r:d,c:f},p=Ie(m),x=c?(t[d]||[])[f]:t[p];h.push(_1(x,p,t,r,e,s,m))}}h.push("</Row>"),h.length>2&&l.push(h.join(""))}return l.join("")}function j1(t,r,e){var s=[],a=e.SheetNames[t],i=e.Sheets[a],o=i?y1(i,r,t,e):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=i?N1(i,r,t,e):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(b1(i,r,t,e)),s.join("")}function E1(t,r){r||(r={}),t.SSF||(t.SSF=jt(Xe)),t.SSF&&(Dn(),Fn(t.SSF),r.revssf=On(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF,r.cellXfs=[],pr(r.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(m1(t,r)),e.push(p1()),e.push(""),e.push("");for(var s=0;s<t.SheetNames.length;++s)e.push(oe("Worksheet",j1(s,r,t),{"ss:Name":Oe(t.SheetNames[s])}));return e[2]=g1(t,r),e[3]=v1(t),Je+oe("Workbook",e.join(""),{xmlns:Ct.ss,"xmlns:o":Ct.o,"xmlns:x":Ct.x,"xmlns:ss":Ct.ss,"xmlns:dt":Ct.dt,"xmlns:html":Ct.html})}var ea={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function T1(t,r){var e=[],s=[],a=[],i=0,o,l=_i(Ii,"n"),c=_i(Pi,"n");if(t.Props)for(o=dt(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?e:Object.prototype.hasOwnProperty.call(c,o[i])?s:a).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=dt(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?e:Object.prototype.hasOwnProperty.call(c,o[i])?s:a).push([o[i],t.Custprops[o[i]]]);var d=[];for(i=0;i<a.length;++i)xl.indexOf(a[i][0])>-1||hl.indexOf(a[i][0])>-1||a[i][1]!=null&&d.push(a[i]);s.length&&Pe.utils.cfb_add(r,"/SummaryInformation",Ui(s,ea.SI,c,Pi)),(e.length||d.length)&&Pe.utils.cfb_add(r,"/DocumentSummaryInformation",Ui(e,ea.DSI,l,Ii,d.length?d:null,ea.UDI))}function C1(t,r){var e=r||{},s=Pe.utils.cfb_new({root:"R"}),a="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":a="/Workbook",e.biff=8;break;case"biff5":a="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Pe.utils.cfb_add(s,a,Gl(t,e)),e.biff==8&&(t.Props||t.Custprops)&&T1(t,s),e.biff==8&&t.vbaraw&&Vu(s,Pe.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),s}var k1={0:{f:Fm},1:{f:zm},2:{f:ip},3:{f:Km},4:{f:Wm},5:{f:rp},6:{f:hp},7:{f:Qm},8:{f:vp},9:{f:gp},10:{f:mp},11:{f:pp},12:{f:$m},13:{f:lp},14:{f:qm},15:{f:Vm},16:{f:np},17:{f:up},18:{f:ep},19:{f:za},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:s1},40:{},42:{},43:{f:hu},44:{f:cu},45:{f:xu},46:{f:pu},47:{f:mu},48:{},49:{f:Uh},50:{},51:{f:Fu},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Hf},62:{f:dp},63:{f:Bu},64:{f:Op},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Kt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Ap},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:Bm},148:{f:Im,p:16},151:{f:Np},152:{},153:{f:t1},154:{},155:{},156:{f:Zp},157:{},158:{},159:{T:1,f:Zf},160:{T:-1},161:{T:1,f:Ir},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:yp},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Au},336:{T:-1},337:{f:Iu,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ga},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Lf},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:jp},427:{f:Ep},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Cp},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Lm},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:_p},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ga},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Hu},633:{T:1},634:{T:-1},635:{T:1,f:Uu},636:{T:-1},637:{f:Gh},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Xp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Ip},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function le(t,r,e,s){var a=r;if(!isNaN(a)){var i=s||(e||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&La(e)&&t.push(e)}}function A1(t,r,e,s){var a=(e||[]).length||0;if(a<=8224)return le(t,r,e,a);var i=r;if(!isNaN(i)){for(var o=e.parts||[],l=0,c=0,d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;var h=t.next(4);for(h.write_shift(2,i),h.write_shift(2,d),t.push(e.slice(c,c+d)),c+=d;c<a;){for(h=t.next(4),h.write_shift(2,60),d=0;d+(o[l]||8224)<=8224;)d+=o[l]||8224,l++;h.write_shift(2,d),t.push(e.slice(c,c+d)),c+=d}}}function Ms(t,r,e){return t||(t=q(7)),t.write_shift(2,r),t.write_shift(2,e),t.write_shift(2,0),t.write_shift(1,0),t}function R1(t,r,e,s){var a=q(9);return Ms(a,t,r),pl(e,s||"b",a),a}function F1(t,r,e){var s=q(8+2*e.length);return Ms(s,t,r),s.write_shift(1,e.length),s.write_shift(e.length,e,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function D1(t,r,e,s){if(r.v!=null)switch(r.t){case"d":case"n":var a=r.t=="d"?Nt(bt(r.v)):r.v;a==(a|0)&&a>=0&&a<65536?le(t,2,Xf(e,s,a)):le(t,3,Vf(e,s,a));return;case"b":case"e":le(t,5,R1(e,s,r.v,r.t));return;case"s":case"str":le(t,4,F1(e,s,(r.v||"").slice(0,255)));return}le(t,1,Ms(null,e,s))}function O1(t,r,e,s){var a=Array.isArray(r),i=ze(r["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(s.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=qe(i)}for(var d=i.s.r;d<=i.e.r;++d){l=ct(d);for(var h=i.s.c;h<=i.e.c;++h){d===i.s.r&&(c[h]=ut(h)),o=c[h]+l;var f=a?(r[d]||[])[h]:r[o];f&&D1(t,f,d,h)}}}function I1(t,r){for(var e=r||{},s=St(),a=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==e.sheet&&(a=i);if(a==0&&e.sheet&&t.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return le(s,e.biff==4?1033:e.biff==3?521:9,Ha(t,16,e)),O1(s,t.Sheets[t.SheetNames[a]],a,e),le(s,10),s.end()}function P1(t,r,e){le(t,49,kf({sz:12,name:"Arial"},e))}function L1(t,r,e){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&le(t,1054,Ff(a,r[a],e))})}function B1(t,r){var e=q(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),le(t,2151,e),e=q(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),yl(ze(r["!ref"]||"A1"),e),e.write_shift(4,4),le(t,2152,e)}function M1(t,r){for(var e=0;e<16;++e)le(t,224,Hi({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(s){le(t,224,Hi(s,0,r))})}function z1(t,r){for(var e=0;e<r["!links"].length;++e){var s=r["!links"][e];le(t,440,zf(s)),s[1].Tooltip&&le(t,2048,Uf(s))}delete r["!links"]}function U1(t,r){if(r){var e=0;r.forEach(function(s,a){++e<=256&&s&&le(t,125,Wf(Bn(a,s),a))})}}function $1(t,r,e,s,a){var i=16+pr(a.cellXfs,r,a);if(r.v==null&&!r.bf){le(t,513,kr(e,s,i));return}if(r.bf)le(t,6,fm(r,e,s,a,i));else switch(r.t){case"d":case"n":var o=r.t=="d"?Nt(bt(r.v)):r.v;le(t,515,Pf(e,s,o,i));break;case"b":case"e":le(t,517,If(e,s,r.v,i,a,r.t));break;case"s":case"str":if(a.bookSST){var l=Ka(a.Strings,r.v,a.revStrings);le(t,253,Af(e,s,l,i))}else le(t,516,Rf(e,s,(r.v||"").slice(0,255),i,a));break;default:le(t,513,kr(e,s,i))}}function H1(t,r,e){var s=St(),a=e.SheetNames[t],i=e.Sheets[a]||{},o=(e||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(i),d=r.biff==8,h,f="",u=[],m=ze(i["!ref"]||"A1"),p=d?65536:16384;if(m.e.c>255||m.e.r>=p){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,p-1)}le(s,2057,Ha(e,16,r)),le(s,13,Dt(1)),le(s,12,Dt(100)),le(s,15,yt(!0)),le(s,17,yt(!1)),le(s,16,Cr(.001)),le(s,95,yt(!0)),le(s,42,yt(!1)),le(s,43,yt(!1)),le(s,130,Dt(1)),le(s,128,Of()),le(s,131,yt(!1)),le(s,132,yt(!1)),d&&U1(s,i["!cols"]),le(s,512,Df(m,r)),d&&(i["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){f=ct(x);for(var g=m.s.c;g<=m.e.c;++g){x===m.s.r&&(u[g]=ut(g)),h=u[g]+f;var j=c?(i[x]||[])[g]:i[h];j&&($1(s,j,x,g,r),d&&j.l&&i["!links"].push([h,j.l]))}}var w=l.CodeName||l.name||a;return d&&le(s,574,Cf((o.Views||[])[0])),d&&(i["!merges"]||[]).length&&le(s,229,Mf(i["!merges"])),d&&z1(s,i),le(s,442,vl(w)),d&&B1(s,i),le(s,10),s.end()}function W1(t,r,e){var s=St(),a=(t||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},l=e.biff==8,c=e.biff==5;if(le(s,2057,Ha(t,5,e)),e.bookType=="xla"&&le(s,135),le(s,225,l?Dt(1200):null),le(s,193,mf(2)),c&&le(s,191),c&&le(s,192),le(s,226),le(s,92,Nf("SheetJS",e)),le(s,66,Dt(l?1200:1252)),l&&le(s,353,Dt(0)),l&&le(s,448),le(s,317,Gf(t.SheetNames.length)),l&&t.vbaraw&&le(s,211),l&&t.vbaraw){var d=o.CodeName||"ThisWorkbook";le(s,442,vl(d))}le(s,156,Dt(17)),le(s,25,yt(!1)),le(s,18,yt(!1)),le(s,19,Dt(0)),l&&le(s,431,yt(!1)),l&&le(s,444,Dt(0)),le(s,61,Tf()),le(s,64,yt(!1)),le(s,141,Dt(0)),le(s,34,yt(Yp(t)=="true")),le(s,14,yt(!0)),l&&le(s,439,yt(!1)),le(s,218,Dt(0)),P1(s,t,e),L1(s,t.SSF,e),M1(s,e),l&&le(s,352,yt(!1));var h=s.end(),f=St();l&&le(f,140,$f()),l&&e.Strings&&A1(f,252,Ef(e.Strings)),le(f,10);var u=f.end(),m=St(),p=0,x=0;for(x=0;x<t.SheetNames.length;++x)p+=(l?12:11)+(l?2:1)*t.SheetNames[x].length;var g=h.length+p+u.length;for(x=0;x<t.SheetNames.length;++x){var j=i[x]||{};le(m,133,jf({pos:g,hs:j.Hidden||0,dt:0,name:t.SheetNames[x]},e)),g+=r[x].length}var w=m.end();if(p!=w.length)throw new Error("BS8 "+p+" != "+w.length);var _=[];return h.length&&_.push(h),w.length&&_.push(w),u.length&&_.push(u),ot(_)}function G1(t,r){var e=r||{},s=[];t&&!t.SSF&&(t.SSF=jt(Xe)),t&&t.SSF&&(Dn(),Fn(t.SSF),e.revssf=On(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Ya(e),e.cellXfs=[],pr(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)s[s.length]=H1(a,e,t);return s.unshift(W1(t,s,e)),ot(s)}function Gl(t,r){for(var e=0;e<=t.SheetNames.length;++e){var s=t.Sheets[t.SheetNames[e]];if(!(!s||!s["!ref"])){var a=At(s["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var i=r||{};switch(i.biff||2){case 8:case 5:return G1(t,r);case 4:case 3:case 2:return I1(t,r)}throw new Error("invalid type "+i.bookType+" for BIFF")}function V1(t,r,e,s){for(var a=t["!merges"]||[],i=[],o=r.s.c;o<=r.e.c;++o){for(var l=0,c=0,d=0;d<a.length;++d)if(!(a[d].s.r>e||a[d].s.c>o)&&!(a[d].e.r<e||a[d].e.c<o)){if(a[d].s.r<e||a[d].s.c<o){l=-1;break}l=a[d].e.r-a[d].s.r+1,c=a[d].e.c-a[d].s.c+1;break}if(!(l<0)){var h=Ie({r:e,c:o}),f=s.dense?(t[e]||[])[o]:t[h],u=f&&f.v!=null&&(f.h||_h(f.w||(ar(f),f.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),s.editable?u='<span contenteditable="true">'+u+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+f.l.Target+'">'+u+"</a>")),m.id=(s.id||"sjs")+"-"+h,i.push(oe("td",u,m))}}var p="<tr>";return p+i.join("")+"</tr>"}var X1='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',K1="</body></html>";function Y1(t,r,e){var s=[];return s.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function Vl(t,r){var e=r||{},s=e.header!=null?e.header:X1,a=e.footer!=null?e.footer:K1,i=[s],o=At(t["!ref"]);e.dense=Array.isArray(t),i.push(Y1(t,o,e));for(var l=o.s.r;l<=o.e.r;++l)i.push(V1(t,o,l,e));return i.push("</table>"+a),i.join("")}function Xl(t,r,e){var s=e||{},a=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")a=s.origin;else{var o=typeof s.origin=="string"?tt(s.origin):s.origin;a=o.r,i=o.c}var l=r.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,l.length),d={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var h=At(t["!ref"]);d.s.r=Math.min(d.s.r,h.s.r),d.s.c=Math.min(d.s.c,h.s.c),d.e.r=Math.max(d.e.r,h.e.r),d.e.c=Math.max(d.e.c,h.e.c),a==-1&&(d.e.r=a=h.e.r+1)}var f=[],u=0,m=t["!rows"]||(t["!rows"]=[]),p=0,x=0,g=0,j=0,w=0,_=0;for(t["!cols"]||(t["!cols"]=[]);p<l.length&&x<c;++p){var T=l[p];if(qi(T)){if(s.display)continue;m[x]={hidden:!0}}var R=T.children;for(g=j=0;g<R.length;++g){var z=R[g];if(!(s.display&&qi(z))){var E=z.hasAttribute("data-v")?z.getAttribute("data-v"):z.hasAttribute("v")?z.getAttribute("v"):Eh(z.innerHTML),I=z.getAttribute("data-z")||z.getAttribute("z");for(u=0;u<f.length;++u){var D=f[u];D.s.c==j+i&&D.s.r<x+a&&x+a<=D.e.r&&(j=D.e.c+1-i,u=-1)}_=+z.getAttribute("colspan")||1,((w=+z.getAttribute("rowspan")||1)>1||_>1)&&f.push({s:{r:x+a,c:j+i},e:{r:x+a+(w||1)-1,c:j+i+(_||1)-1}});var P={t:"s",v:E},U=z.getAttribute("data-t")||z.getAttribute("t")||"";E!=null&&(E.length==0?P.t=U||"z":s.raw||E.trim().length==0||U=="s"||(E==="TRUE"?P={t:"b",v:!0}:E==="FALSE"?P={t:"b",v:!1}:isNaN(rr(E))?isNaN(Es(E).getDate())||(P={t:"d",v:bt(E)},s.cellDates||(P={t:"n",v:Nt(P.v)}),P.z=s.dateNF||Xe[14]):P={t:"n",v:rr(E)})),P.z===void 0&&I!=null&&(P.z=I);var H="",ee=z.getElementsByTagName("A");if(ee&&ee.length)for(var pe=0;pe<ee.length&&!(ee[pe].hasAttribute("href")&&(H=ee[pe].getAttribute("href"),H.charAt(0)!="#"));++pe);H&&H.charAt(0)!="#"&&(P.l={Target:H}),s.dense?(t[x+a]||(t[x+a]=[]),t[x+a][j+i]=P):t[Ie({c:j+i,r:x+a})]=P,d.e.c<j+i&&(d.e.c=j+i),j+=_}}++x}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),d.e.r=Math.max(d.e.r,x-1+a),t["!ref"]=qe(d),x>=c&&(t["!fullref"]=qe((d.e.r=l.length-p+x-1+a,d))),t}function Kl(t,r){var e=r||{},s=e.dense?[]:{};return Xl(s,t,r)}function q1(t,r){return Rr(Kl(t,r),r)}function qi(t){var r="",e=J1(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function J1(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var Q1=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Cs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Je+r}}(),Ji=function(){var t=function(i){return Oe(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,s=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Oe(o.SheetNames[l])+`" table:style-name="ta1">
`);var d=0,h=0,f=At(i["!ref"]||"A1"),u=i["!merges"]||[],m=0,p=Array.isArray(i);if(i["!cols"])for(h=0;h<=f.e.c;++h)c.push("        <table:table-column"+(i["!cols"][h]?' table:style-name="co'+i["!cols"][h].ods+'"':"")+`></table:table-column>
`);var x="",g=i["!rows"]||[];for(d=0;d<f.s.r;++d)x=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;d<=f.e.r;++d){for(x=g[d]?' table:style-name="ro'+g[d].ods+'"':"",c.push("        <table:table-row"+x+`>
`),h=0;h<f.s.c;++h)c.push(r);for(;h<=f.e.c;++h){var j=!1,w={},_="";for(m=0;m!=u.length;++m)if(!(u[m].s.c>h)&&!(u[m].s.r>d)&&!(u[m].e.c<h)&&!(u[m].e.r<d)){(u[m].s.c!=h||u[m].s.r!=d)&&(j=!0),w["table:number-columns-spanned"]=u[m].e.c-u[m].s.c+1,w["table:number-rows-spanned"]=u[m].e.r-u[m].s.r+1;break}if(j){c.push(e);continue}var T=Ie({r:d,c:h}),R=p?(i[d]||[])[h]:i[T];if(R&&R.f&&(w["table:formula"]=Oe(vm(R.f)),R.F&&R.F.slice(0,T.length)==T)){var z=At(R.F);w["table:number-matrix-columns-spanned"]=z.e.c-z.s.c+1,w["table:number-matrix-rows-spanned"]=z.e.r-z.s.r+1}if(!R){c.push(r);continue}switch(R.t){case"b":_=R.v?"TRUE":"FALSE",w["office:value-type"]="boolean",w["office:boolean-value"]=R.v?"true":"false";break;case"n":_=R.w||String(R.v||0),w["office:value-type"]="float",w["office:value"]=R.v||0;break;case"s":case"str":_=R.v==null?"":R.v,w["office:value-type"]="string";break;case"d":_=R.w||bt(R.v).toISOString(),w["office:value-type"]="date",w["office:date-value"]=bt(R.v).toISOString(),w["table:style-name"]="ce1";break;default:c.push(r);continue}var E=t(_);if(R.l&&R.l.Target){var I=R.l.Target;I=I.charAt(0)=="#"?"#"+ym(I.slice(1)):I,I.charAt(0)!="#"&&!I.match(/^\w+:/)&&(I="../"+I),E=oe("text:a",E,{"xlink:href":I.replace(/&/g,"&amp;")})}c.push("          "+oe("table:table-cell",oe("text:p",E,{}),w)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!cols"]){for(var h=0;h<d["!cols"].length;++h)if(d["!cols"][h]){var f=d["!cols"][h];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Wa(f),f.ods=l;var u=d["!cols"][h].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(d){return o.Sheets[d]}).forEach(function(d){if(d&&d["!rows"]){for(var h=0;h<d["!rows"].length;++h)if(d["!rows"][h]){d["!rows"][h].ods=c;var f=d["!rows"][h].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Je],d=Cs({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),h=Cs({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+d+h+`>
`),c.push(cl().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+d+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(s(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Yl(t,r){if(r.bookType=="fods")return Ji(t,r);var e=Da(),s="",a=[],i=[];return s="mimetype",Ne(e,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Ne(e,s,Ji(t,r)),a.push([s,"text/xml"]),i.push([s,"ContentFile"]),s="styles.xml",Ne(e,s,Q1(t,r)),a.push([s,"text/xml"]),i.push([s,"StylesFile"]),s="meta.xml",Ne(e,s,Je+cl()),a.push([s,"text/xml"]),i.push([s,"MetadataFile"]),s="manifest.rdf",Ne(e,s,df(i)),a.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Ne(e,s,lf(a)),e}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function wn(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function Z1(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Mt(Ts(t))}function eg(t,r){e:for(var e=0;e<=t.length-r.length;++e){for(var s=0;s<r.length;++s)if(t[e+s]!=r[s])continue e;return!0}return!1}function mr(t){var r=t.reduce(function(a,i){return a+i.length},0),e=new Uint8Array(r),s=0;return t.forEach(function(a){e.set(a,s),s+=a.length}),e}function tg(t,r,e){var s=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,a=e/Math.pow(10,s-6176);t[r+15]|=s>>7,t[r+14]|=(s&127)<<1;for(var i=0;a>=1;++i,a/=256)t[r+i]=a&255;t[r+15]|=e>=0?0:128}function ks(t,r){var e=r?r[0]:0,s=t[e]&127;e:if(t[e++]>=128&&(s|=(t[e]&127)<<7,t[e++]<128||(s|=(t[e]&127)<<14,t[e++]<128)||(s|=(t[e]&127)<<21,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),s}function Fe(t){var r=new Uint8Array(7);r[0]=t&127;var e=1;e:if(t>127){if(r[e-1]|=128,r[e]=t>>7&127,++e,t<=16383||(r[e-1]|=128,r[e]=t>>14&127,++e,t<=2097151)||(r[e-1]|=128,r[e]=t>>21&127,++e,t<=268435455)||(r[e-1]|=128,r[e]=t/256>>>21&127,++e,t<=34359738367)||(r[e-1]|=128,r[e]=t/65536>>>21&127,++e,t<=4398046511103))break e;r[e-1]|=128,r[e]=t/16777216>>>21&127,++e}return r.slice(0,e)}function Xr(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function Ze(t){for(var r=[],e=[0];e[0]<t.length;){var s=e[0],a=ks(t,e),i=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(i){case 0:{for(var c=e[0];t[e[0]++]>=128;);l=t.slice(c,e[0])}break;case 5:o=4,l=t.slice(e[0],e[0]+o),e[0]+=o;break;case 1:o=8,l=t.slice(e[0],e[0]+o),e[0]+=o;break;case 2:o=ks(t,e),l=t.slice(e[0],e[0]+o),e[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(s))}var d={data:l,type:i};r[a]==null?r[a]=[d]:r[a].push(d)}return r}function at(t){var r=[];return t.forEach(function(e,s){e.forEach(function(a){a.data&&(r.push(Fe(s*8+a.type)),a.type==2&&r.push(Fe(a.data.length)),r.push(a.data))})}),mr(r)}function Pt(t){for(var r,e=[],s=[0];s[0]<t.length;){var a=ks(t,s),i=Ze(t.slice(s[0],s[0]+a));s[0]+=a;var o={id:Xr(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Ze(l.data),d=Xr(c[3][0].data);o.messages.push({meta:c,data:t.slice(s[0],s[0]+d)}),s[0]+=d}),(r=i[3])!=null&&r[0]&&(o.merge=Xr(i[3][0].data)>>>0>0),e.push(o)}return e}function Mr(t){var r=[];return t.forEach(function(e){var s=[];s[1]=[{data:Fe(e.id),type:0}],s[2]=[],e.merge!=null&&(s[3]=[{data:Fe(+!!e.merge),type:0}]);var a=[];e.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Fe(o.data.length)}],s[2].push({data:at(o.meta),type:2})});var i=at(s);r.push(Fe(i.length)),r.push(i),a.forEach(function(o){return r.push(o)})}),mr(r)}function rg(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],s=ks(r,e),a=[];e[0]<r.length;){var i=r[e[0]]&3;if(i==0){var o=r[e[0]++]>>2;if(o<60)++o;else{var l=o-59;o=r[e[0]],l>1&&(o|=r[e[0]+1]<<8),l>2&&(o|=r[e[0]+2]<<16),l>3&&(o|=r[e[0]+3]<<24),o>>>=0,o++,e[0]+=l}a.push(r.slice(e[0],e[0]+o)),e[0]+=o;continue}else{var c=0,d=0;if(i==1?(d=(r[e[0]]>>2&7)+4,c=(r[e[0]++]&224)<<3,c|=r[e[0]++]):(d=(r[e[0]++]>>2)+1,i==2?(c=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(c=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),a=[mr(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(d>=c)for(a.push(a[0].slice(-c)),d-=c;d>=a[a.length-1].length;)a.push(a[a.length-1]),d-=a[a.length-1].length;a.push(a[0].slice(-c,-c+d))}}var h=mr(a);if(h.length!=s)throw new Error("Unexpected length: ".concat(h.length," != ").concat(s));return h}function Lt(t){for(var r=[],e=0;e<t.length;){var s=t[e++],a=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(rg(s,t.slice(e,e+a))),e+=a}if(e!==t.length)throw new Error("data is not a valid framed stream!");return mr(r)}function zr(t){for(var r=[],e=0;e<t.length;){var s=Math.min(t.length-e,268435455),a=new Uint8Array(4);r.push(a);var i=Fe(s),o=i.length;r.push(i),s<=60?(o++,r.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,r.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,r.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,r.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,r.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),r.push(t.slice(e,e+s)),o+=s,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,e+=s}return mr(r)}function ta(t,r){var e=new Uint8Array(32),s=wn(e),a=12,i=0;switch(e[0]=5,t.t){case"n":e[1]=2,tg(e,a,t.v),i|=1,a+=16;break;case"b":e[1]=6,s.setFloat64(a,t.v?1:0,!0),i|=2,a+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[1]=3,s.setUint32(a,r.indexOf(t.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(8,i,!0),e.slice(0,a)}function ra(t,r){var e=new Uint8Array(32),s=wn(e),a=12,i=0;switch(e[0]=3,t.t){case"n":e[2]=2,s.setFloat64(a,t.v,!0),i|=32,a+=8;break;case"b":e[2]=6,s.setFloat64(a,t.v?1:0,!0),i|=32,a+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[2]=3,s.setUint32(a,r.indexOf(t.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(4,i,!0),e.slice(0,a)}function cr(t){var r=Ze(t);return ks(r[1][0].data)}function sg(t,r,e){var s,a,i,o;if(!((s=t[6])!=null&&s[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&Xr(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,d=wn(t[7][0].data),h=0,f=[],u=wn(t[4][0].data),m=0,p=[],x=0;x<r.length;++x){if(r[x]==null){d.setUint16(x*2,65535,!0),u.setUint16(x*2,65535);continue}d.setUint16(x*2,h,!0),u.setUint16(x*2,m,!0);var g,j;switch(typeof r[x]){case"string":g=ta({t:"s",v:r[x]},e),j=ra({t:"s",v:r[x]},e);break;case"number":g=ta({t:"n",v:r[x]},e),j=ra({t:"n",v:r[x]},e);break;case"boolean":g=ta({t:"b",v:r[x]},e),j=ra({t:"b",v:r[x]},e);break;default:throw new Error("Unsupported value "+r[x])}f.push(g),h+=g.length,p.push(j),m+=j.length,++c}for(t[2][0].data=Fe(c);x<t[7][0].data.length/2;++x)d.setUint16(x*2,65535,!0),u.setUint16(x*2,65535,!0);return t[6][0].data=mr(f),t[3][0].data=mr(p),c}function ng(t,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=At(e["!ref"]);s.s.r=s.s.c=0;var a=!1;s.e.c>9&&(a=!0,s.e.c=9),s.e.r>49&&(a=!0,s.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(qe(s)));var i=_n(e,{range:s,header:1}),o=["~Sh33tJ5~"];i.forEach(function(F){return F.forEach(function(O){typeof O=="string"&&o.push(O)})});var l={},c=[],d=Pe.read(r.numbers,{type:"base64"});d.FileIndex.map(function(F,O){return[F,d.FullPaths[O]]}).forEach(function(F){var O=F[0],b=F[1];if(O.type==2&&O.name.match(/\.iwa/)){var W=O.content,L=Lt(W),Z=Pt(L);Z.forEach(function(se){c.push(se.id),l[se.id]={deps:[],location:b,type:Xr(se.messages[0].meta[1][0].data)}})}}),c.sort(function(F,O){return F-O});var h=c.filter(function(F){return F>1}).map(function(F){return[F,Fe(F)]});d.FileIndex.map(function(F,O){return[F,d.FullPaths[O]]}).forEach(function(F){var O=F[0];if(F[1],!!O.name.match(/\.iwa/)){var b=Pt(Lt(O.content));b.forEach(function(W){W.messages.forEach(function(L){h.forEach(function(Z){W.messages.some(function(se){return Xr(se.meta[1][0].data)!=11006&&eg(se.data,Z[1])})&&l[Z[0]].deps.push(W.id)})})})}});for(var f=Pe.find(d,l[1].location),u=Pt(Lt(f.content)),m,p=0;p<u.length;++p){var x=u[p];x.id==1&&(m=x)}var g=cr(Ze(m.messages[0].data)[1][0].data);for(f=Pe.find(d,l[g].location),u=Pt(Lt(f.content)),p=0;p<u.length;++p)x=u[p],x.id==g&&(m=x);for(g=cr(Ze(m.messages[0].data)[2][0].data),f=Pe.find(d,l[g].location),u=Pt(Lt(f.content)),p=0;p<u.length;++p)x=u[p],x.id==g&&(m=x);for(g=cr(Ze(m.messages[0].data)[2][0].data),f=Pe.find(d,l[g].location),u=Pt(Lt(f.content)),p=0;p<u.length;++p)x=u[p],x.id==g&&(m=x);var j=Ze(m.messages[0].data);{j[6][0].data=Fe(s.e.r+1),j[7][0].data=Fe(s.e.c+1);var w=cr(j[46][0].data),_=Pe.find(d,l[w].location),T=Pt(Lt(_.content));{for(var R=0;R<T.length&&T[R].id!=w;++R);if(T[R].id!=w)throw"Bad ColumnRowUIDMapArchive";var z=Ze(T[R].messages[0].data);z[1]=[],z[2]=[],z[3]=[];for(var E=0;E<=s.e.c;++E){var I=[];I[1]=I[2]=[{type:0,data:Fe(E+420690)}],z[1].push({type:2,data:at(I)}),z[2].push({type:0,data:Fe(E)}),z[3].push({type:0,data:Fe(E)})}z[4]=[],z[5]=[],z[6]=[];for(var D=0;D<=s.e.r;++D)I=[],I[1]=I[2]=[{type:0,data:Fe(D+726270)}],z[4].push({type:2,data:at(I)}),z[5].push({type:0,data:Fe(D)}),z[6].push({type:0,data:Fe(D)});T[R].messages[0].data=at(z)}_.content=zr(Mr(T)),_.size=_.content.length,delete j[46];var P=Ze(j[4][0].data);{P[7][0].data=Fe(s.e.r+1);var U=Ze(P[1][0].data),H=cr(U[2][0].data);_=Pe.find(d,l[H].location),T=Pt(Lt(_.content));{if(T[0].id!=H)throw"Bad HeaderStorageBucket";var ee=Ze(T[0].messages[0].data);for(D=0;D<i.length;++D){var pe=Ze(ee[2][0].data);pe[1][0].data=Fe(D),pe[4][0].data=Fe(i[D].length),ee[2][D]={type:ee[2][0].type,data:at(pe)}}T[0].messages[0].data=at(ee)}_.content=zr(Mr(T)),_.size=_.content.length;var ge=cr(P[2][0].data);_=Pe.find(d,l[ge].location),T=Pt(Lt(_.content));{if(T[0].id!=ge)throw"Bad HeaderStorageBucket";for(ee=Ze(T[0].messages[0].data),E=0;E<=s.e.c;++E)pe=Ze(ee[2][0].data),pe[1][0].data=Fe(E),pe[4][0].data=Fe(s.e.r+1),ee[2][E]={type:ee[2][0].type,data:at(pe)};T[0].messages[0].data=at(ee)}_.content=zr(Mr(T)),_.size=_.content.length;var je=cr(P[4][0].data);(function(){for(var F=Pe.find(d,l[je].location),O=Pt(Lt(F.content)),b,W=0;W<O.length;++W){var L=O[W];L.id==je&&(b=L)}var Z=Ze(b.messages[0].data);{Z[3]=[];var se=[];o.forEach(function(G,ve){se[1]=[{type:0,data:Fe(ve)}],se[2]=[{type:0,data:Fe(1)}],se[3]=[{type:2,data:Z1(G)}],Z[3].push({type:2,data:at(se)})})}b.messages[0].data=at(Z);var ae=Mr(O),ye=zr(ae);F.content=ye,F.size=F.content.length})();var _e=Ze(P[3][0].data);{var ke=_e[1][0];delete _e[2];var de=Ze(ke.data);{var me=cr(de[2][0].data);(function(){for(var F=Pe.find(d,l[me].location),O=Pt(Lt(F.content)),b,W=0;W<O.length;++W){var L=O[W];L.id==me&&(b=L)}var Z=Ze(b.messages[0].data);{delete Z[6],delete _e[7];var se=new Uint8Array(Z[5][0].data);Z[5]=[];for(var ae=0,ye=0;ye<=s.e.r;++ye){var G=Ze(se);ae+=sg(G,i[ye],o),G[1][0].data=Fe(ye),Z[5].push({data:at(G),type:2})}Z[1]=[{type:0,data:Fe(s.e.c+1)}],Z[2]=[{type:0,data:Fe(s.e.r+1)}],Z[3]=[{type:0,data:Fe(ae)}],Z[4]=[{type:0,data:Fe(s.e.r+1)}]}b.messages[0].data=at(Z);var ve=Mr(O),M=zr(ve);F.content=M,F.size=F.content.length})()}ke.data=at(de)}P[3][0].data=at(_e)}j[4][0].data=at(P)}m.messages[0].data=at(j);var Se=Mr(u),y=zr(Se);return f.content=y,f.size=f.content.length,d}function ag(t){return function(e){for(var s=0;s!=t.length;++s){var a=t[s];e[a[0]]===void 0&&(e[a[0]]=a[1]),a[2]==="n"&&(e[a[0]]=Number(e[a[0]]))}}}function Ya(t){ag([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function ig(t,r){return r.bookType=="ods"?Yl(t,r):r.bookType=="numbers"?ng(t,r):r.bookType=="xlsb"?og(t,r):lg(t,r)}function og(t,r){Hr=1024,t&&!t.SSF&&(t.SSF=jt(Xe)),t&&t.SSF&&(Dn(),Fn(t.SSF),r.revssf=On(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ws?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e=r.bookType=="xlsb"?"bin":"xml",s=Rl.indexOf(r.bookType)>-1,a=il();Ya(r=r||{});var i=Da(),o="",l=0;if(r.cellXfs=[],pr(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Ne(i,o,dl(t.Props,r)),a.coreprops.push(o),De(r.rels,2,o,Te.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(t.SheetNames[d]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Ne(i,o,fl(t.Props)),a.extprops.push(o),De(r.rels,3,o,Te.EXT_PROPS),t.Custprops!==t.Props&&dt(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Ne(i,o,ul(t.Custprops)),a.custprops.push(o),De(r.rels,4,o,Te.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var h={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],u=(f||{})["!type"]||"sheet";switch(u){case"chart":default:o="xl/worksheets/sheet"+l+"."+e,Ne(i,o,d1(l-1,o,r,t,h)),a.sheets.push(o),De(r.wbrels,-1,"worksheets/sheet"+l+"."+e,Te.WS[0])}if(f){var m=f["!comments"],p=!1,x="";m&&m.length>0&&(x="xl/comments"+l+"."+e,Ne(i,x,u1(m,x)),a.comments.push(x),De(h,-1,"../comments"+l+"."+e,Te.CMNT),p=!0),f["!legacy"]&&p&&Ne(i,"xl/drawings/vmlDrawing"+l+".vml",kl(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}h["!id"].rId1&&Ne(i,ll(o),Gr(h))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+e,Ne(i,o,f1(r.Strings,o,r)),a.strs.push(o),De(r.wbrels,-1,"sharedStrings."+e,Te.SST)),o="xl/workbook."+e,Ne(i,o,c1(t,o)),a.workbooks.push(o),De(r.rels,1,o,Te.WB),o="xl/theme/theme1.xml",Ne(i,o,Tl(t.Themes,r)),a.themes.push(o),De(r.wbrels,-1,"theme/theme1.xml",Te.THEME),o="xl/styles."+e,Ne(i,o,h1(t,o,r)),a.styles.push(o),De(r.wbrels,-1,"styles."+e,Te.STY),t.vbaraw&&s&&(o="xl/vbaProject.bin",Ne(i,o,t.vbaraw),a.vba.push(o),De(r.wbrels,-1,"vbaProject.bin",Te.VBA)),o="xl/metadata."+e,Ne(i,o,x1(o)),a.metadata.push(o),De(r.wbrels,-1,"metadata."+e,Te.XLMETA),Ne(i,"[Content_Types].xml",ol(a,r)),Ne(i,"_rels/.rels",Gr(r.rels)),Ne(i,"xl/_rels/workbook."+e+".rels",Gr(r.wbrels)),delete r.revssf,delete r.ssf,i}function lg(t,r){Hr=1024,t&&!t.SSF&&(t.SSF=jt(Xe)),t&&t.SSF&&(Dn(),Fn(t.SSF),r.revssf=On(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,ws?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e="xml",s=Rl.indexOf(r.bookType)>-1,a=il();Ya(r=r||{});var i=Da(),o="",l=0;if(r.cellXfs=[],pr(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Ne(i,o,dl(t.Props,r)),a.coreprops.push(o),De(r.rels,2,o,Te.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],d=0;d<t.SheetNames.length;++d)(t.Workbook.Sheets[d]||{}).Hidden!=2&&c.push(t.SheetNames[d]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Ne(i,o,fl(t.Props)),a.extprops.push(o),De(r.rels,3,o,Te.EXT_PROPS),t.Custprops!==t.Props&&dt(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Ne(i,o,ul(t.Custprops)),a.custprops.push(o),De(r.rels,4,o,Te.CUST_PROPS));var h=["SheetJ5"];for(r.tcid=0,l=1;l<=t.SheetNames.length;++l){var f={"!id":{}},u=t.Sheets[t.SheetNames[l-1]],m=(u||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+e,Ne(i,o,zl(l-1,r,t,f)),a.sheets.push(o),De(r.wbrels,-1,"worksheets/sheet"+l+"."+e,Te.WS[0])}if(u){var p=u["!comments"],x=!1,g="";if(p&&p.length>0){var j=!1;p.forEach(function(w){w[1].forEach(function(_){_.T==!0&&(j=!0)})}),j&&(g="xl/threadedComments/threadedComment"+l+"."+e,Ne(i,g,Mu(p,h,r)),a.threadedcomments.push(g),De(f,-1,"../threadedComments/threadedComment"+l+"."+e,Te.TCMNT)),g="xl/comments"+l+"."+e,Ne(i,g,Al(p)),a.comments.push(g),De(f,-1,"../comments"+l+"."+e,Te.CMNT),x=!0}u["!legacy"]&&x&&Ne(i,"xl/drawings/vmlDrawing"+l+".vml",kl(l,u["!comments"])),delete u["!comments"],delete u["!legacy"]}f["!id"].rId1&&Ne(i,ll(o),Gr(f))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+e,Ne(i,o,wl(r.Strings,r)),a.strs.push(o),De(r.wbrels,-1,"sharedStrings."+e,Te.SST)),o="xl/workbook."+e,Ne(i,o,Hl(t)),a.workbooks.push(o),De(r.rels,1,o,Te.WB),o="xl/theme/theme1.xml",Ne(i,o,Tl(t.Themes,r)),a.themes.push(o),De(r.wbrels,-1,"theme/theme1.xml",Te.THEME),o="xl/styles."+e,Ne(i,o,jl(t,r)),a.styles.push(o),De(r.wbrels,-1,"styles."+e,Te.STY),t.vbaraw&&s&&(o="xl/vbaProject.bin",Ne(i,o,t.vbaraw),a.vba.push(o),De(r.wbrels,-1,"vbaProject.bin",Te.VBA)),o="xl/metadata."+e,Ne(i,o,Cl()),a.metadata.push(o),De(r.wbrels,-1,"metadata."+e,Te.XLMETA),h.length>1&&(o="xl/persons/person.xml",Ne(i,o,zu(h)),a.people.push(o),De(r.wbrels,-1,"persons/person.xml",Te.PEOPLE)),Ne(i,"[Content_Types].xml",ol(a,r)),Ne(i,"_rels/.rels",Gr(r.rels)),Ne(i,"xl/_rels/workbook."+e+".rels",Gr(r.wbrels)),delete r.revssf,delete r.ssf,i}function cg(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=nr(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function ql(t,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Is(r.file,Pe.write(t,{type:Ce?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Pe.write(t,r)}function dg(t,r){var e=jt(r||{}),s=ig(t,e);return hg(s,e)}function hg(t,r){var e={},s=Ce?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(e.compression="DEFLATE"),r.password)e.type=s;else switch(r.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":e.type=s;break;default:throw new Error("Unrecognized type "+r.type)}var a=t.FullPaths?Pe.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!r.compression}):t.generate(e);if(typeof Deno<"u"&&typeof a=="string"){if(r.type=="binary"||r.type=="base64")return a;a=new Uint8Array(Rn(a))}return r.password&&typeof encrypt_agile<"u"?ql(encrypt_agile(a,r.password),r):r.type==="file"?Is(r.file,a):r.type=="string"?gs(a):a}function fg(t,r){var e=r||{},s=C1(t,e);return ql(s,e)}function Xt(t,r,e){e||(e="");var s=e+t;switch(r.type){case"base64":return js(Ts(s));case"binary":return Ts(s);case"string":return t;case"file":return Is(r.file,s,"utf8");case"buffer":return Ce?ir(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):Xt(s,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function ug(t,r){switch(r.type){case"base64":return js(t);case"binary":return t;case"string":return t;case"file":return Is(r.file,t,"binary");case"buffer":return Ce?ir(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function Qs(t,r){switch(r.type){case"string":case"base64":case"binary":for(var e="",s=0;s<t.length;++s)e+=String.fromCharCode(t[s]);return r.type=="base64"?js(e):r.type=="string"?gs(e):e;case"file":return Is(r.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+r.type)}}function Jl(t,r){zd(),Qp(t);var e=jt(r||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var s=Jl(t,e);return e.type="array",Rn(s)}var a=0;if(e.sheet&&(typeof e.sheet=="number"?a=e.sheet:a=t.SheetNames.indexOf(e.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return Xt(E1(t,e),e);case"slk":case"sylk":return Xt(Yf.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"htm":case"html":return Xt(Vl(t.Sheets[t.SheetNames[a]],e),e);case"txt":return ug(Zl(t.Sheets[t.SheetNames[a]],e),e);case"csv":return Xt(qa(t.Sheets[t.SheetNames[a]],e),e,"\uFEFF");case"dif":return Xt(qf.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"dbf":return Qs(Kf.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"prn":return Xt(Jf.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"rtf":return Xt(nu.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"eth":return Xt(bl.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"fods":return Xt(Yl(t,e),e);case"wk1":return Qs(Wi.sheet_to_wk1(t.Sheets[t.SheetNames[a]],e),e);case"wk3":return Qs(Wi.book_to_wk3(t,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),Qs(Gl(t,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),fg(t,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return dg(t,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function xg(t){if(!t.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(t.bookType=e.slice(1)),t.bookType=r[t.bookType]||t.bookType}}function Ql(t,r,e){var s={};return s.type="file",s.file=r,xg(s),Jl(t,s)}function mg(t,r,e,s,a,i,o,l){var c=ct(e),d=l.defval,h=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,u=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:e,enumerable:!1})}catch{u.__rowNum__=e}else u.__rowNum__=e;if(!o||t[e])for(var m=r.s.c;m<=r.e.c;++m){var p=o?t[e][m]:t[s[m]+c];if(p===void 0||p.t===void 0){if(d===void 0)continue;i[m]!=null&&(u[i[m]]=d);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[m]!=null){if(x==null)if(p.t=="e"&&x===null)u[i[m]]=null;else if(d!==void 0)u[i[m]]=d;else if(h&&x===null)u[i[m]]=null;else continue;else u[i[m]]=h&&(p.t!=="n"||p.t==="n"&&l.rawNumbers!==!1)?x:ar(p,x,l);x!=null&&(f=!1)}}return{row:u,isempty:f}}function _n(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},s=0,a=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},d=r||{},h=d.range!=null?d.range:t["!ref"];switch(d.header===1?s=1:d.header==="A"?s=2:Array.isArray(d.header)?s=3:d.header==null&&(s=0),typeof h){case"string":c=ze(h);break;case"number":c=ze(t["!ref"]),c.s.r=h;break;default:c=h}s>0&&(a=0);var f=ct(c.s.r),u=[],m=[],p=0,x=0,g=Array.isArray(t),j=c.s.r,w=0,_={};g&&!t[j]&&(t[j]=[]);var T=d.skipHidden&&t["!cols"]||[],R=d.skipHidden&&t["!rows"]||[];for(w=c.s.c;w<=c.e.c;++w)if(!(T[w]||{}).hidden)switch(u[w]=ut(w),e=g?t[j][w]:t[u[w]+f],s){case 1:i[w]=w-c.s.c;break;case 2:i[w]=u[w];break;case 3:i[w]=d.header[w-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=o=ar(e,null,d),x=_[o]||0,!x)_[o]=1;else{do l=o+"_"+x++;while(_[l]);_[o]=x,_[l]=1}i[w]=l}for(j=c.s.r+a;j<=c.e.r;++j)if(!(R[j]||{}).hidden){var z=mg(t,c,j,u,s,i,g,d);(z.isempty===!1||(s===1?d.blankrows!==!1:d.blankrows))&&(m[p++]=z.row)}return m.length=p,m}var Qi=/"/g;function pg(t,r,e,s,a,i,o,l){for(var c=!0,d=[],h="",f=ct(e),u=r.s.c;u<=r.e.c;++u)if(s[u]){var m=l.dense?(t[e]||[])[u]:t[s[u]+f];if(m==null)h="";else if(m.v!=null){c=!1,h=""+(l.rawNumbers&&m.t=="n"?m.v:ar(m,null,l));for(var p=0,x=0;p!==h.length;++p)if((x=h.charCodeAt(p))===a||x===i||x===34||l.forceQuotes){h='"'+h.replace(Qi,'""')+'"';break}h=="ID"&&(h='"ID"')}else m.f!=null&&!m.F?(c=!1,h="="+m.f,h.indexOf(",")>=0&&(h='"'+h.replace(Qi,'""')+'"')):h="";d.push(h)}return l.blankrows===!1&&c?null:d.join(o)}function qa(t,r){var e=[],s=r??{};if(t==null||t["!ref"]==null)return"";var a=ze(t["!ref"]),i=s.FS!==void 0?s.FS:",",o=i.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,c=l.charCodeAt(0),d=new RegExp((i=="|"?"\\|":i)+"+$"),h="",f=[];s.dense=Array.isArray(t);for(var u=s.skipHidden&&t["!cols"]||[],m=s.skipHidden&&t["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(u[p]||{}).hidden||(f[p]=ut(p));for(var x=0,g=a.s.r;g<=a.e.r;++g)(m[g]||{}).hidden||(h=pg(t,a,g,f,o,c,i,s),h!=null&&(s.strip&&(h=h.replace(d,"")),(h||s.blankrows!==!1)&&e.push((x++?l:"")+h)));return delete s.dense,e.join("")}function Zl(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=qa(t,r);return e}function gg(t){var r="",e,s="";if(t==null||t["!ref"]==null)return[];var a=ze(t["!ref"]),i="",o=[],l,c=[],d=Array.isArray(t);for(l=a.s.c;l<=a.e.c;++l)o[l]=ut(l);for(var h=a.s.r;h<=a.e.r;++h)for(i=ct(h),l=a.s.c;l<=a.e.c;++l)if(r=o[l]+i,e=d?(t[h]||[])[l]:t[r],s="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;s=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)s=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)s=""+e.v;else if(e.t=="b")s=e.v?"TRUE":"FALSE";else if(e.w!==void 0)s="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?s="'"+e.v:s=""+e.v}}c[c.length]=r+"="+s}return c}function ec(t,r,e){var s=e||{},a=+!s.skipHeader,i=t||{},o=0,l=0;if(i&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?tt(s.origin):s.origin;o=c.r,l=c.c}var d,h={s:{c:0,r:0},e:{c:l,r:o+r.length-1+a}};if(i["!ref"]){var f=ze(i["!ref"]);h.e.c=Math.max(h.e.c,f.e.c),h.e.r=Math.max(h.e.r,f.e.r),o==-1&&(o=f.e.r+1,h.e.r=o+r.length-1+a)}else o==-1&&(o=0,h.e.r=r.length-1+a);var u=s.header||[],m=0;r.forEach(function(x,g){dt(x).forEach(function(j){(m=u.indexOf(j))==-1&&(u[m=u.length]=j);var w=x[j],_="z",T="",R=Ie({c:l+m,r:o+g+a});d=As(i,R),w&&typeof w=="object"&&!(w instanceof Date)?i[R]=w:(typeof w=="number"?_="n":typeof w=="boolean"?_="b":typeof w=="string"?_="s":w instanceof Date?(_="d",s.cellDates||(_="n",w=Nt(w)),T=s.dateNF||Xe[14]):w===null&&s.nullError&&(_="e",w=0),d?(d.t=_,d.v=w,delete d.w,delete d.R,T&&(d.z=T)):i[R]=d={t:_,v:w},T&&(d.z=T))})}),h.e.c=Math.max(h.e.c,l+u.length-1);var p=ct(o);if(a)for(m=0;m<u.length;++m)i[ut(m+l)+p]={t:"s",v:u[m]};return i["!ref"]=qe(h),i}function vg(t,r){return ec(null,t,r)}function As(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var s=tt(r);return t[s.r]||(t[s.r]=[]),t[s.r][s.c]||(t[s.r][s.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?As(t,Ie(r)):As(t,Ie({r,c:e||0}))}function yg(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function bg(){return{SheetNames:[],Sheets:{}}}function wg(t,r,e,s){var a=1;if(!e)for(;a<=65535&&t.SheetNames.indexOf(e="Sheet"+a)!=-1;++a,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&t.SheetNames.indexOf(e)>=0){var i=e.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||e;for(++a;a<=65535&&t.SheetNames.indexOf(e=o+a)!=-1;++a);}if($l(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function _g(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var s=yg(t,r);switch(t.Workbook.Sheets[s]||(t.Workbook.Sheets[s]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[s].Hidden=e}function Sg(t,r){return t.z=r,t}function tc(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function Ng(t,r,e){return tc(t,"#"+r,e)}function jg(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function Eg(t,r,e,s){for(var a=typeof r!="string"?r:ze(r),i=typeof r=="string"?r:qe(r),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=As(t,o,l);c.t="n",c.F=i,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=e,s&&(c.D=!0))}return t}var Kr={encode_col:ut,encode_row:ct,encode_cell:Ie,encode_range:qe,decode_col:Ma,decode_row:Ba,split_cell:zh,decode_cell:tt,decode_range:At,format_cell:ar,sheet_add_aoa:el,sheet_add_json:ec,sheet_add_dom:Xl,aoa_to_sheet:ns,json_to_sheet:vg,table_to_sheet:Kl,table_to_book:q1,sheet_to_csv:qa,sheet_to_txt:Zl,sheet_to_json:_n,sheet_to_html:Vl,sheet_to_formulae:gg,sheet_to_row_object_array:_n,sheet_get_cell:As,book_new:bg,book_append_sheet:wg,book_set_sheet_visibility:_g,cell_set_number_format:Sg,cell_set_hyperlink:tc,cell_set_internal_link:Ng,cell_add_comment:jg,sheet_set_array_formula:Eg,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function Tg({user:t,onNavigate:r}){const[e,s]=B.useState([]),[a,i]=B.useState([]),[o,l]=B.useState(!1),[c,d]=B.useState(""),[h,f]=B.useState(""),[u,m]=B.useState("all"),[p,x]=B.useState(""),[g,j]=B.useState(""),[w,_]=B.useState([]),[T,R]=B.useState(!1),[z,E]=B.useState(30),[I,D]=B.useState(1),[P,U]=B.useState({name:"",branch:"",phone:"",user_type:""});B.useEffect(()=>{H(),ee()},[]);const H=async()=>{try{const{data:b,error:W}=await ue.from("branches").select("*").order("name",{ascending:!0});if(W)throw W;i(b||[])}catch(b){console.error("지점 목록 로드 오류:",b)}},ee=async()=>{l(!0);try{let b=ue.from("users").select("*").order("created_at",{ascending:!1});qr(t)||(b=b.eq("branch",t.branch));const{data:W,error:L}=await b;if(L)throw L;s(W||[])}catch(b){console.error("사용자 로드 오류:",b),alert("사용자 목록을 불러오는데 실패했습니다.")}finally{l(!1)}},pe=async(b,W)=>{const L=W?"승인":"거부";if(window.confirm(`이 사용자를 ${L}하시겠습니까?`))try{const Z={status:W?"approved":"rejected"};if(W){const{data:ae}=await ue.from("users").select("referral_code").eq("id",b).single();if(!ae?.referral_code){const{data:ye}=await ue.from("users").select("referral_code").not("referral_code","is",null).order("referral_code",{ascending:!1}).limit(1),G=ye?.[0]?.referral_code||"LAS0000",M=parseInt(G.replace("LAS",""))+1;Z.referral_code=`LAS${String(M).padStart(4,"0")}`}}const{error:se}=await ue.from("users").update(Z).eq("id",b);if(se)throw se;alert(`${L}되었습니다.`),ee()}catch(Z){console.error("승인/거부 오류:",Z),alert(`${L} 처리에 실패했습니다.`)}},ge=async b=>{if(window.confirm("정말로 이 사용자를 삭제하시겠습니까?"))try{const{error:W}=await ue.from("users").delete().eq("id",b);if(W)throw W;alert("삭제되었습니다."),ee()}catch(W){console.error("삭제 오류:",W),alert("삭제에 실패했습니다.")}},je=b=>{U({id:b.id,name:b.name,branch:b.branch,phone:b.phone,user_type:b.user_type}),R(!0)},_e=async()=>{if(P.id&&window.confirm("수정 내용을 저장하시겠습니까?"))try{const{error:b}=await ue.from("users").update({name:P.name,phone:P.phone,branch:P.branch,user_type:P.user_type}).eq("id",P.id);if(b)throw b;alert("수정되었습니다."),R(!1),ee()}catch(b){console.error("수정 오류:",b),alert("수정에 실패했습니다.")}},ke=b=>{_(W=>W.includes(b)?W.filter(L=>L!==b):[...W,b])},de=async()=>{if(w.length===0){alert("다운로드할 직원을 선택해주세요.");return}try{l(!0);const b=e.filter(ye=>w.includes(ye.id)),W=await Promise.all(b.map(async ye=>{const G=p||new Date(ye.created_at).toISOString().split("T")[0],ve=g||new Date().toISOString().split("T")[0],{data:M,error:Q}=await ue.from("work_diaries").select("work_hours").eq("user_id",ye.id).gte("work_date",G).lte("work_date",ve);Q&&console.error(`근무일지 조회 오류 (user_id: ${ye.id}):`,Q);const he=M?.reduce((Re,Ue)=>Re+(parseFloat(Ue.work_hours)||0),0)||0,re=ye.ssn?ye.ssn.substring(0,6)+"-*******":"-",be=ye.account_number?ye.account_number.substring(0,ye.account_number.length-4)+"****":"-";return{지점명:ye.branch||"-",이름:ye.name||"-",전화번호:ye.phone||"-",구분:ye.user_type||"-",근무시작일:new Date(G).toLocaleDateString("ko-KR"),근무종료일:new Date(ve).toLocaleDateString("ko-KR"),총근무시간:`${he.toFixed(1)}시간`,주민번호:re,예금주:ye.account_holder||"-",기관명:ye.bank_name||"-",계좌번호:be}})),L=Kr.json_to_sheet(W),Z=Kr.book_new();Kr.book_append_sheet(Z,L,"직원목록");const ae=`직원목록_${(p&&g?`${p}_${g}`:`전체기간_${new Date().toISOString().split("T")[0]}`).replace(/-/g,"")}.xlsx`;Ql(Z,ae)}catch(b){console.error("엑셀 다운로드 오류:",b),alert("엑셀 파일 생성 중 오류가 발생했습니다.")}finally{l(!1)}},me=e.filter(b=>{const W=b.name?.toLowerCase().includes(c.toLowerCase())||b.email?.toLowerCase().includes(c.toLowerCase()),L=!h||b.branch===h,Z=u==="all"||b.user_type===u;let se=!0;if(p||g){const ae=new Date(b.created_at);p&&(se=se&&ae>=new Date(p)),g&&(se=se&&ae<=new Date(g))}return W&&L&&Z&&se}),Se=Math.ceil(me.length/z),y=(I-1)*z,F=y+z,O=me.slice(y,F);return B.useEffect(()=>{D(1)},[c,h,u,p,g,z]),n.jsxs("div",{className:"min-h-screen bg-white",children:[n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[n.jsx("div",{className:"bg-white border-b pb-4 mb-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("button",{onClick:()=>r("AdminDashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",style:{fontSize:"15px"},children:[n.jsx(Ot,{size:20}),"나가기"]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Book",className:"h-10"}),n.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:"직원정보관리"})]}),n.jsx("div",{className:"w-24"})]})}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"검색"}),n.jsx("input",{type:"text",placeholder:"이름 또는 이메일",value:c,onChange:b=>d(b.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"}})]}),qr(t)&&n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"지점"}),n.jsxs("select",{value:h,onChange:b=>f(b.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"},children:[n.jsx("option",{value:"",children:"전체"}),a.map(b=>n.jsx("option",{value:b.name,children:b.name},b.id))]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"직원구분"}),n.jsxs("select",{value:u,onChange:b=>m(b.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"},children:[n.jsx("option",{value:"all",children:"전체"}),n.jsx("option",{value:"점주",children:"점주"}),n.jsx("option",{value:"점장",children:"점장"}),n.jsx("option",{value:"직원",children:"직원"}),n.jsx("option",{value:"모니터링요원",children:"모니터링요원"}),n.jsx("option",{value:"계약근무",children:"계약근무"}),n.jsx("option",{value:"지점관리자",children:"지점관리자"})]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"근무시작일"}),n.jsx("input",{type:"date",value:p,onChange:b=>x(b.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"}})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"근무종료일"}),n.jsx("input",{type:"date",value:g,onChange:b=>j(b.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"}})]}),n.jsx("div",{className:"flex-1 flex items-end",children:n.jsxs("button",{onClick:de,className:"w-full py-2 flex items-center justify-center gap-2 text-white font-bold rounded-lg hover:opacity-90",style:{backgroundColor:"#5B7FC8",fontSize:"15px",borderRadius:"10px",height:"42px"},children:[n.jsx(Er,{size:18}),"엑셀다운로드(",me.length.toString().padStart(2,"0"),")"]})})]}),n.jsxs("div",{className:"mt-4 flex justify-start items-center gap-4",children:[n.jsxs("div",{className:"text-gray-600",style:{fontSize:"15px"},children:["총 ",n.jsx("strong",{style:{color:"#249689",fontSize:"16px"},children:me.length}),"명"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm text-gray-600",children:"페이지당:"}),n.jsxs("select",{value:z,onChange:b=>E(Number(b.target.value)),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm",style:{fontSize:"14px"},children:[n.jsx("option",{value:30,children:"30개"}),n.jsx("option",{value:50,children:"50개"}),n.jsx("option",{value:100,children:"100개"})]})]})]})]}),o?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"inline-block w-8 h-8 border-4 border-gray-200 border-t-[#249689] rounded-full animate-spin"}),n.jsx("p",{className:"mt-4 text-gray-600",children:"로딩 중..."})]}):me.length===0?n.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm border",children:n.jsx("p",{className:"text-gray-500",style:{fontSize:"15px"},children:"조건에 맞는 직원이 없습니다."})}):n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left",children:n.jsx("input",{type:"checkbox",onChange:b=>{b.target.checked?_(me.map(W=>W.id)):_([])},checked:w.length===me.length&&me.length>0,className:"rounded border-gray-300"})}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"이름"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"이메일"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"전화번호"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"지점"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"직원구분"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"상태"}),n.jsx("th",{className:"px-4 py-3 text-center font-bold",style:{fontSize:"14px"},children:"관리"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:O.map(b=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"checkbox",checked:w.includes(b.id),onChange:()=>ke(b.id),className:"rounded border-gray-300"})}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:b.name}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:b.email}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:b.phone}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:b.branch}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:b.user_type}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold",style:{backgroundColor:b.status==="approved"?"#D1FAE5":b.status==="pending"?"#FEF3C7":"#FEE2E2",color:b.status==="approved"?"#065F46":b.status==="pending"?"#92400E":"#991B1B"},children:b.status==="approved"?"승인됨":b.status==="pending"?"대기중":"거부됨"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[b.status==="pending"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>pe(b.id,!0),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"승인",children:n.jsx(io,{size:18})}),n.jsx("button",{onClick:()=>pe(b.id,!1),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"거부",children:n.jsx(oo,{size:18})})]}),n.jsx("button",{onClick:()=>je(b),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"수정",children:n.jsx(Ea,{size:18})}),n.jsx("button",{onClick:()=>ge(b.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"삭제",children:n.jsx(Ar,{size:18})})]})})]},b.id))})]})}),Se>1&&n.jsxs("div",{className:"mt-4 flex justify-center items-center gap-2",children:[n.jsx("button",{onClick:()=>D(b=>Math.max(1,b-1)),disabled:I===1,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:"이전"}),n.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,Se)},(b,W)=>{let L;return Se<=5||I<=3?L=W+1:I>=Se-2?L=Se-4+W:L=I-2+W,n.jsx("button",{onClick:()=>D(L),className:`px-3 py-1 border rounded ${I===L?"text-white font-bold":"hover:bg-gray-50"}`,style:{fontSize:"14px",backgroundColor:I===L?"#249689":"white",borderColor:I===L?"#249689":"#d1d5db"},children:L},L)})}),n.jsx("button",{onClick:()=>D(b=>Math.min(Se,b+1)),disabled:I===Se,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:"다음"}),n.jsxs("span",{className:"ml-4 text-sm text-gray-600",children:[I," / ",Se," 페이지"]})]})]})]}),T&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:b=>b.target.style.display="none"}),n.jsx("h2",{className:"text-xl font-bold",style:{color:"#249689"},children:"직원정보수정"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:"이름"}),n.jsx("input",{type:"text",value:P.name,onChange:b=>U({...P,name:b.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:"지점"}),n.jsxs("select",{value:P.branch,onChange:b=>U({...P,branch:b.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:"선택"}),a.map(b=>n.jsx("option",{value:b.name,children:b.name},b.name))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:"전화번호"}),n.jsx("input",{type:"text",value:P.phone,onChange:b=>U({...P,phone:b.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:"직원구분"}),n.jsxs("select",{value:P.user_type,onChange:b=>U({...P,user_type:b.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"점주",children:"점주"}),n.jsx("option",{value:"점장",children:"점장"}),n.jsx("option",{value:"직원",children:"직원"}),n.jsx("option",{value:"모니터링요원",children:"모니터링요원"}),n.jsx("option",{value:"계약근무",children:"계약근무"}),n.jsx("option",{value:"지점관리자",children:"지점관리자"})]})]})]}),n.jsxs("div",{className:"flex gap-2 mt-6",children:[n.jsx("button",{onClick:_e,className:"flex-1 py-2 text-white font-bold rounded-lg hover:opacity-90",style:{backgroundColor:"#249689",fontSize:"15px"},children:"저장"}),n.jsx("button",{onClick:()=>R(!1),className:"flex-1 py-2 font-bold rounded-lg hover:bg-gray-50",style:{border:"2px solid #7f95eb",backgroundColor:"white",fontSize:"15px"},children:"취소"})]})]})})]})}function Cg({user:t,onNavigate:r}){const[e,s]=B.useState([]),[a,i]=B.useState(null),[o,l]=B.useState(!1),[c,d]=B.useState("date"),[h,f]=B.useState(""),[u,m]=B.useState(""),[p,x]=B.useState("");B.useEffect(()=>{g()},[]);const g=async()=>{l(!0);try{let I=ue.from("work_diaries").select("*").order("created_at",{ascending:!1});qr(t)||(I=I.eq("branch_name",t.branch));const{data:D,error:P}=await I;if(P)throw P;s(D||[]),D&&D.length>0&&i(D[0])}catch(I){console.error("근무일지 로드 오류:",I),alert("근무일지를 불러오는데 실패했습니다.")}finally{l(!1)}},j=()=>{g()},w=()=>{f(""),m(""),x(""),g()},T=[...e.filter(I=>{const D=!h.trim()||I.user_name?.toLowerCase().includes(h.toLowerCase());let P=!0;if(u||p){const U=new Date(I.work_date);if(u){const H=new Date(u);H.setHours(0,0,0,0),U<H&&(P=!1)}if(p){const H=new Date(p);H.setHours(23,59,59,999),U>H&&(P=!1)}}return D&&P})].sort((I,D)=>{if(c==="date"){const P=new Date(I.created_at);return new Date(D.created_at)-P}else{const P=new Date(I.created_at),U=new Date(D.created_at);return P-U}}),z=(I=>I.reduce((D,P)=>{const U=parseFloat(P.work_hours)||0;return D+U},0))(T),E=I=>I?new Date(I).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}).replace("일일","일"):"-";return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsx("div",{className:"bg-white shadow-md p-6",children:n.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[n.jsxs("button",{onClick:()=>r("AdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[n.jsx(Ot,{size:20}),"나가기"]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:I=>I.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:qr(t)?"근무일지 관리":"우리지점 근무일지"})]}),n.jsx("div",{style:{width:"100px"}})]})}),n.jsx("div",{className:"max-w-7xl mx-auto p-6",children:n.jsxs("div",{className:"flex gap-6",style:{height:"calc(100vh - 200px)"},children:[n.jsxs("div",{className:"w-80 bg-white rounded-lg shadow-lg overflow-hidden flex flex-col",children:[n.jsxs("div",{className:"p-4 border-b bg-gray-50 space-y-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:[n.jsx(nn,{size:12,className:"inline mr-1"}),"이름 검색"]}),n.jsx("input",{type:"text",value:h,onChange:I=>f(I.target.value),placeholder:"이름 입력",className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:[n.jsx(an,{size:12,className:"inline mr-1"}),"근무일자"]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("input",{type:"date",value:u,onChange:I=>m(I.target.value),className:"flex-1 px-2 py-1.5 border border-gray-300 rounded-lg text-xs"}),n.jsx("span",{className:"text-xs",children:"~"}),n.jsx("input",{type:"date",value:p,onChange:I=>x(I.target.value),className:"flex-1 px-2 py-1.5 border border-gray-300 rounded-lg text-xs"})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:j,className:"flex-1 px-3 py-1.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700 text-sm font-bold",children:[n.jsx(rs,{size:14,className:"inline mr-1"}),"검색"]}),n.jsx("button",{onClick:w,className:"px-3 py-1.5 bg-gray-200 rounded-lg hover:bg-gray-300 text-sm",children:"초기화"})]}),n.jsxs("div",{className:"pt-2 border-t",children:[n.jsx("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:"정렬"}),n.jsxs("select",{value:c,onChange:I=>d(I.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg text-sm",children:[n.jsx("option",{value:"date",children:"최근 순"}),n.jsx("option",{value:"old",children:"오래된 순"})]})]}),n.jsxs("div",{className:"text-xs text-gray-600 text-center pt-2 border-t space-y-1",children:[n.jsxs("div",{children:["총 ",n.jsx("strong",{className:"text-teal-600",children:T.length}),"건"]}),n.jsxs("div",{className:"font-bold text-teal-600",children:["총 근무시간: ",z.toFixed(1),"시간"]})]})]}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:o?n.jsx("div",{className:"p-8 text-center text-gray-500",children:"로딩 중..."}):T.length===0?n.jsx("div",{className:"p-8 text-center text-gray-500",children:h||u||p?"검색 결과가 없습니다.":"근무일지가 없습니다."}):T.map(I=>n.jsxs("div",{onClick:()=>i(I),className:`p-4 border-b cursor-pointer hover:bg-gray-50 transition-colors ${a?.id===I.id?"bg-teal-50 border-l-4 border-teal-500":""}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(nn,{size:16,style:{color:"#249689"}}),n.jsx("span",{className:"font-bold",style:{fontSize:"15px"},children:I.branch_name||"-"})]}),n.jsx("div",{className:"text-sm text-gray-600 mb-1",children:I.user_name||"이름 없음"}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[n.jsx(an,{size:12}),I.work_date||"-"]}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-1",children:[n.jsx(Uc,{size:12}),I.start_time," - ",I.end_time," (",I.work_hours,"h)"]})]},I.id))})]}),n.jsx("div",{className:"flex-1 bg-white rounded-lg shadow-lg overflow-hidden",children:a?n.jsx("div",{className:"h-full overflow-y-auto p-6",children:n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx($c,{size:28,style:{color:"#249689"}}),n.jsx("h2",{className:"text-2xl font-bold",style:{color:"#249689"},children:"근무일지 상세"})]}),n.jsxs("div",{className:"text-lg font-bold",style:{color:"#249689"},children:["(총근무시간 ",z.toFixed(1),"시간)"]})]}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:"지점명"}),n.jsx("p",{className:"font-medium",children:a.branch_name||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:"작성자"}),n.jsx("p",{className:"font-medium",children:a.user_name||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:"근무일자"}),n.jsx("p",{className:"font-medium",children:E(a.work_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:"근무시간"}),n.jsxs("p",{className:"font-medium",children:[a.start_time," - ",a.end_time,n.jsxs("span",{className:"ml-2 text-teal-600",children:["(",a.work_hours,"시간)"]})]})]})]})}),(a.daily_check_clean||a.daily_check_training||a.daily_check_list)&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"일일 확인목록"}),n.jsxs("div",{className:"space-y-2 bg-gray-50 rounded-lg p-4",children:[a.daily_check_clean&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-green-600",children:"✓"}),n.jsx("span",{children:"매장 청결점검"})]}),a.daily_check_training&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-green-600",children:"✓"}),n.jsx("span",{children:"직원 업무교육"})]}),a.daily_check_list&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-green-600",children:"✓"}),n.jsx("span",{children:"직원 체크리스트 점검"})]})]})]}),a.out_content&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"외근 시 내용"}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsx("p",{className:"whitespace-pre-wrap",children:a.out_content})})]}),a.exemplary_content&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"주인형 모집내용"}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsx("p",{className:"whitespace-pre-wrap",children:a.exemplary_content})})]}),a.memorable_customer&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"오늘 인상깊은 고객"}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsx("p",{className:"whitespace-pre-wrap",children:a.memorable_customer})})]}),a.suggestions&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"건의사항"}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsx("p",{className:"whitespace-pre-wrap",children:a.suggestions})})]}),n.jsxs("div",{className:"text-sm text-gray-500 text-right mt-8",children:["작성일시: ",new Date(a.created_at).toLocaleString("ko-KR")]})]})}):n.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:"좌측 목록에서 근무일지를 선택해주세요."})})]})})]})}function kg({user:t,onNavigate:r}){const[e,s]=B.useState([]),[a,i]=B.useState(!1),[o,l]=B.useState(""),[c,d]=B.useState(""),[h,f]=B.useState([]);B.useEffect(()=>{u(),m()},[]);const u=async()=>{try{const{data:w,error:_}=await ue.from("branches").select("*").eq("is_active",!0).order("name",{ascending:!0});if(_)throw _;f(w||[])}catch(w){console.error("지점 목록 로드 오류:",w)}},m=async()=>{i(!0);try{console.log("📊 구매자 정보 로딩...");let w=ue.from("sales").select("*").order("created_at",{ascending:!1});qr(t)||(console.log("🔒 자기 지점만 필터링:",t.branch),w=w.eq("branch_name",t.branch));const{data:_,error:T}=await w;if(T)throw console.error("❌ Supabase 오류:",T),T;console.log("✅ 구매자 데이터:",_),s(_||[])}catch(w){console.error("❌ 구매자 정보 로드 오류:",w),alert(`구매자 정보를 불러오는데 실패했습니다.
오류: ${w.message}`)}finally{i(!1)}},p=w=>{if(!w)return"-";const _=w.replace(/[^\d]/g,"");return _.length===11?`${_.slice(0,3)}-${_.slice(3,7)}-${_.slice(7)}`:_.length===10?`${_.slice(0,3)}-${_.slice(3,6)}-${_.slice(6)}`:w},x=w=>w?w.replace(/[^\d]/g,""):"",j=e.filter(w=>{const _=w.customer_name?.toLowerCase().includes(o.toLowerCase())||w.phone?.includes(o)||w.customer_phone?.includes(o)||w.email?.toLowerCase().includes(o.toLowerCase())||w.customer_email?.toLowerCase().includes(o.toLowerCase()),T=!c||w.branch_name===c;return _&&T}).reduce((w,_)=>{const T=x(_.phone||_.customer_phone||""),z=`${_.customer_name||""}-${T}`;return w.some(E=>{const I=x(E.phone||E.customer_phone||"");return`${E.customer_name||""}-${I}`===z})||w.push(_),w},[]);return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsx("div",{className:"bg-white shadow-md p-6",children:n.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[n.jsxs("button",{onClick:()=>r("AdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[n.jsx(Ot,{size:20}),"나가기"]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:w=>w.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"구매고객조회"})]}),n.jsx("div",{style:{width:"100px"}})]})}),n.jsx("div",{className:"max-w-7xl mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"p-4 border-b flex items-center gap-2",children:[n.jsx("div",{className:"flex-1 flex items-center gap-2",children:n.jsx("input",{type:"text",value:o,onChange:w=>l(w.target.value),placeholder:"이름, 전화번호, 이메일",className:"flex-1 px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})}),qr(t)&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("label",{className:"font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(jn,{size:18,className:"inline mr-1"}),"지점"]}),n.jsxs("select",{value:c,onChange:w=>d(w.target.value),className:"px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:"전체"}),h.map(w=>n.jsx("option",{value:w.name,children:w.name},w.id))]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("button",{onClick:m,className:"px-4 py-2 flex items-center gap-2 font-bold text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#249689",fontSize:"15px",borderRadius:"10px",width:"120px",justifyContent:"center"},title:"검색",children:[n.jsx(rs,{size:18}),"검색"]}),n.jsxs("button",{onClick:()=>{l(""),d("")},className:"px-4 py-2 flex items-center gap-2 font-bold hover:bg-gray-50",style:{backgroundColor:"white",border:"2px solid #249689",borderRadius:"10px",color:"#249689",fontSize:"15px",width:"120px",justifyContent:"center"},title:"검색 조건 초기화",children:[n.jsx(Yr,{size:18}),"초기화"]})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"지점"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"이름"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"전화번호"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"이메일"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"주소"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"결제방법"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"수량"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:"등록일"})]})}),n.jsx("tbody",{children:a?n.jsx("tr",{children:n.jsx("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:"로딩 중..."})}):j.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:"구매자 정보가 없습니다."})}):j.map(w=>n.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:w.branch_name||w.user_branch||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:w.customer_name||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:p(w.phone||w.customer_phone)}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:w.email||w.customer_email||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:w.address||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:w.payment_method||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:w.quantity||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:w.created_at?new Date(w.created_at).toLocaleDateString("ko-KR"):"-"})]},w.id))})]})})]})})]})}const Ag=()=>{const t=[];for(let i=8;i<=22;i++){for(let o=0;o<60;o+=30){if(i===8&&o<30)continue;if(i===22&&o>30)break;const l=`${String(i).padStart(2,"0")}:${String(o).padStart(2,"0")}`;t.push(l)}if(i===22&&t.includes(`${String(22).padStart(2,"0")}:${String(30).padStart(2,"0")}`))break}return t},Zi=Ag();function Rg({user:t,onNavigate:r}){const[e,s]=B.useState({workDate:"",startTime:"",endTime:"",dailyCheckClean:!1,dailyCheckTraining:!1,dailyCheckList:!1,outContent:"",exemplaryContent:"",memorableCustomer:"",suggestions:""}),[a,i]=B.useState(0),[o,l]=B.useState(!1),c=t?.user_type==="점장"||t?.user_type==="지점관리자"||t?.userType==="점장"||t?.userType==="지점관리자",d=u=>{const{name:m,value:p,type:x,checked:g}=u.target;s({...e,[m]:x==="checkbox"?g:p})};B.useEffect(()=>{if(!e.workDate||!e.startTime||!e.endTime){i(0);return}try{const u=new Date(`${e.workDate}T${e.startTime}:00`),m=new Date(`${e.workDate}T${e.endTime}:00`);if(isNaN(u.getTime())||isNaN(m.getTime())){i(0);return}const x=(m-u)/(1e3*60*60);i(x>0?parseFloat(x.toFixed(1)):0)}catch(u){console.error("시간 계산 오류:",u),i(0)}},[e.workDate,e.startTime,e.endTime]);const h=async u=>{if(u.preventDefault(),!e.workDate){alert("출근일을 선택해주세요");return}if(!e.startTime){alert("출근시간을 선택해주세요");return}if(!e.endTime){alert("퇴근시간을 선택해주세요");return}if(a<=0){alert("퇴근시간이 출근시간보다 늦어야 합니다");return}l(!0);try{const m={user_id:t.id,user_name:t.name,branch_name:t.branch,work_date:e.workDate,start_time:e.startTime,end_time:e.endTime,work_hours:a,daily_check_clean:e.dailyCheckClean,daily_check_training:e.dailyCheckTraining,daily_check_list:e.dailyCheckList,out_content:e.outContent.trim()||null,exemplary_content:e.exemplaryContent.trim()||null,memorable_customer:e.memorableCustomer.trim()||null,suggestions:e.suggestions.trim()||null};console.log("근무일지 저장 데이터:",m),alert("근무일지가 제출되었습니다!"),r&&r("dashboard")}catch(m){console.error("근무일지 제출 오류:",m),alert("근무일지 제출 중 오류가 발생했습니다: "+m.message)}finally{l(!1)}},f=()=>{e.workDate||e.startTime||e.endTime||e.outContent||e.exemplaryContent||e.memorableCustomer||e.suggestions||e.dailyCheckClean||e.dailyCheckTraining||e.dailyCheckList?window.confirm("작성 중인 내용이 있습니다. 나가기하시겠습니까?")&&r&&r("Dashboard"):r&&r("Dashboard")};return n.jsx("div",{className:"min-h-screen bg-gray-50 p-2",children:n.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg p-4",children:[n.jsx("div",{className:"flex flex-col items-center justify-center mb-2",children:n.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:u=>u.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:c?"SM점장 근무일지":"점주근무일지"})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"지점명"}),n.jsx("input",{type:"text",value:t?.branch||"Current User's brname",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"이름"}),n.jsx("input",{type:"text",value:t?.name||"Current User's name",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"border-t pt-2",children:[n.jsx("h3",{className:"font-bold mb-2",style:{color:"#000000",fontSize:"15px"},children:"근무일자 시간을 선택해 주세요"}),n.jsxs("div",{className:"mb-2",children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"출근일"}),n.jsx("input",{type:"date",name:"workDate",value:e.workDate,onChange:d,required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"출근시간"}),n.jsxs("select",{name:"startTime",value:e.startTime,onChange:d,required:!0,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:"선택"}),Zi.map(u=>n.jsx("option",{value:u,children:u},`start-${u}`))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"퇴근시간"}),n.jsxs("select",{name:"endTime",value:e.endTime,onChange:d,required:!0,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:"선택"}),Zi.map(u=>n.jsx("option",{value:u,children:u},`end-${u}`))]})]})]}),n.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:"#d1fae5",border:"2px solid #10b981"},children:n.jsxs("p",{className:"font-bold text-center",style:{color:"#059669",fontSize:"16px"},children:["총 근무시간: ",a," 시간"]})})]}),c&&n.jsxs("div",{className:"border-t pt-2",children:[n.jsx("h3",{className:"font-bold mb-2",style:{color:"#000000",fontSize:"15px"},children:"일일 확인목록"}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"dailyCheckClean",checked:e.dailyCheckClean,onChange:d,className:"w-5 h-5"}),n.jsx("span",{style:{color:"#000000",fontSize:"15px"},children:"매장 청결점검"})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"dailyCheckTraining",checked:e.dailyCheckTraining,onChange:d,className:"w-5 h-5"}),n.jsx("span",{style:{color:"#000000",fontSize:"15px"},children:"직원 업무교육"})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"dailyCheckList",checked:e.dailyCheckList,onChange:d,className:"w-5 h-5"}),n.jsx("span",{style:{color:"#000000",fontSize:"15px"},children:"직원 체크리스트 점검"})]})]})]}),n.jsxs("div",{className:"border-t pt-2",children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"외근 시 내용을 적어주세요"}),n.jsx("textarea",{name:"outContent",value:e.outContent,onChange:d,placeholder:"외근 시 내용을 적어주세요",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"주인형 모집내용을 적어주세요"}),n.jsx("textarea",{name:"exemplaryContent",value:e.exemplaryContent,onChange:d,placeholder:"주인형 모집내용을 적어주세요",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"오늘 인상깊은 고객에 대해 적어주세요"}),n.jsx("textarea",{name:"memorableCustomer",value:e.memorableCustomer,onChange:d,placeholder:"오늘 인상깊은 고객에 대해 적어주세요",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"건의사항이 있으시면 적어주세요"}),n.jsx("textarea",{name:"suggestions",value:e.suggestions,onChange:d,placeholder:"건의사항이 있으시면 적어주세요",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[n.jsx("button",{type:"button",onClick:h,disabled:o,className:"flex-1 py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:o?"저장 중...":"제출"}),n.jsx("button",{type:"button",onClick:f,disabled:o,className:"flex-1 py-2.5 font-bold rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:"나가기"})]})]})]})})}function Fg({user:t,onNavigate:r}){const[e,s]=B.useState({customerName:"",age:"",address:"",phone:"",email:"",paymentMethod:"카드",quantity:"",depositor:"",depositAmount:"",orderDetails:"",needsShipping:!1,privacyAgreed:!1,marketingAgreed:!1}),[a,i]=B.useState(!1),[o,l]=B.useState(!1),c=m=>{const p=m.replace(/[^\d]/g,"");return p.length<=3?p:p.length<=7?`${p.slice(0,3)}-${p.slice(3)}`:`${p.slice(0,3)}-${p.slice(3,7)}-${p.slice(7,11)}`},d=m=>{const p=m.replace(/[^\d]/g,"");return p?p.replace(/\B(?=(\d{3})+(?!\d))/g,",")+"원":""},h=m=>{const{name:p,value:x,type:g,checked:j}=m.target;let w=g==="checkbox"?j:x;p==="phone"&&(w=c(x)),p==="depositAmount"&&(w=d(x)),s({...e,[p]:w})},f=()=>{if(!e.quantity||e.quantity<1)return alert("판매수량을 입력해주세요"),!1;if(!e.depositAmount?.trim())return alert("입금액을 입력해주세요"),!1;if(e.needsShipping){if(!e.customerName?.trim())return alert("배송을 위해 구매자 이름을 입력해주세요"),!1;if(!e.address?.trim())return alert("배송을 위해 주소를 입력해주세요"),!1;if(!e.phone?.trim())return alert("배송을 위해 연락처를 입력해주세요"),!1}return e.paymentMethod==="입금"&&!e.depositor?.trim()?(alert("입금자명을 입력해주세요"),!1):e.privacyAgreed?!0:(alert("개인정보 수집 및 이용에 동의해주세요"),!1)},u=async()=>{if(f()){i(!0),console.log("=== 저장 시작 ===");try{const m={user_id:t?.id||null,branch_name:t?.branch||null,user_name:t?.name||null,user_branch:t?.branch||null,customer_name:e.customerName?.trim()||null,phone:e.phone?.trim()||null,customer_email:e.email?.trim()||null,address:e.address?.trim()||null,payment_method:e.paymentMethod||null,quantity:parseInt(e.quantity),depositor:e.depositor?.trim()||null,deposit_amount:e.depositAmount?.replace(/,/g,"")||null,order_details:e.orderDetails?.trim()||null,age:e.age?parseInt(e.age):null,needs_shipping:e.needsShipping,privacy_agreed:e.privacyAgreed,marketing_agreed:e.marketingAgreed};console.log("Insert Data:",m);const{data:p,error:x}=await ue.from("sales").insert([m]).select();if(x)throw x;console.log("저장 성공:",p),alert("저장되었습니다!"),s({customerName:"",age:"",address:"",phone:"",email:"",paymentMethod:"카드",quantity:"",depositor:"",depositAmount:"",orderDetails:"",needsShipping:!1,privacyAgreed:!1,marketingAgreed:!1})}catch(m){console.error("=== 저장 오류 상세 ==="),console.error("Error:",m),alert("저장 중 오류가 발생했습니다: "+m.message)}finally{i(!1)}}};return n.jsxs("div",{className:"min-h-screen bg-gray-50 p-2",children:[n.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg",style:{padding:"12px",paddingBottom:"24px"},children:[n.jsx("div",{className:"flex flex-col items-center justify-center mb-2",children:n.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:m=>m.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"LAS Book Store"})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-1 mb-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"지점명"}),n.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-2 py-1.5 border border-gray-300 bg-gray-50",style:{borderRadius:"8px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"이름"}),n.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-2 py-1.5 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2 bg-gray-50",children:[n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"needsShipping",checked:e.needsShipping,onChange:h,className:"w-4 h-4"}),n.jsx("span",{className:"font-bold",style:{color:"#249689",fontSize:"16px"},children:"📦 배송이 필요합니다"})]}),n.jsx("p",{className:"text-xs text-gray-600 mt-1 ml-6",children:e.needsShipping?"✓ 배송 선택: 이름, 연락처, 주소가 필수입니다":"배송을 선택하지 않으면 구매자 정보는 선택사항입니다"})]}),n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[n.jsx("h3",{className:"font-bold mb-2 text-lg",style:{color:"#249689",fontSize:"18px"},children:"구매자 기본정보"}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["이름 ",e.needsShipping&&n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",name:"customerName",value:e.customerName,onChange:h,placeholder:"구매자 성함을 적어주세요",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"나이"}),n.jsx("input",{type:"text",name:"age",value:e.age,onChange:h,placeholder:"구매자 나이를 적어주세요",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["주소 ",e.needsShipping&&n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",name:"address",value:e.address,onChange:h,placeholder:"구매자 주소를 적어주세요",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["연락처 ",e.needsShipping&&n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"tel",name:"phone",value:e.phone,onChange:h,placeholder:"구매자 연락처를 적어주세요",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"이메일"}),n.jsx("input",{type:"email",name:"email",value:e.email,onChange:h,placeholder:"구매자 이메일을 적어주세요",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]})]})]}),n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[n.jsx("h3",{className:"font-bold mb-2 text-lg",style:{color:"#249689",fontSize:"18px"},children:"결제정보"}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"카드",checked:e.paymentMethod==="카드",onChange:h,className:"w-3.5 h-3.5"}),n.jsx("span",{style:{color:"#000000",fontSize:"15px",fontWeight:"bold"},children:"카드"})]}),n.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"입금",checked:e.paymentMethod==="입금",onChange:h,className:"w-3.5 h-3.5"}),n.jsx("span",{style:{color:"#000000",fontSize:"15px",fontWeight:"bold"},children:"입금"})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["판매수량 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"number",name:"quantity",value:e.quantity,onChange:h,placeholder:"수량",min:"1",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["입금액 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",name:"depositAmount",value:e.depositAmount,onChange:h,placeholder:"입금액",className:"w-full px-2 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px",textAlign:"right"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:["입금자명 ",e.paymentMethod==="입금"&&n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",name:"depositor",value:e.depositor,onChange:h,placeholder:"입금자명",disabled:e.paymentMethod==="카드",className:"w-full px-2 py-1.5 border border-gray-300 disabled:bg-gray-100 disabled:text-gray-400",style:{borderRadius:"8px",fontSize:"15px"}})]})]})]})]}),n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[n.jsx("h3",{className:"font-bold mb-1.5 text-lg",style:{color:"#249689",fontSize:"18px"},children:"주문정보"}),n.jsx("textarea",{name:"orderDetails",value:e.orderDetails,onChange:h,placeholder:"주문상품명과 수량을 적어주세요",rows:3,className:"w-full px-2 py-1.5 border border-gray-300",style:{borderRadius:"8px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[n.jsx("h3",{className:"font-bold mb-1.5 text-lg",style:{color:"#249689",fontSize:"18px"},children:"개인정보 수집 및 이용 동의"}),n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"privacyAgreed",checked:e.privacyAgreed,onChange:h,className:"w-4 h-4 mt-0.5"}),n.jsxs("span",{style:{color:"#000000",fontSize:"14px"},children:["개인정보 수집 및 이용에 동의합니다 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]})]}),n.jsx("button",{type:"button",onClick:()=>l(!0),className:"text-sm underline whitespace-nowrap",style:{color:"#249689"},children:"📄 내용보기"})]}),n.jsx("div",{className:"pt-2 border-t border-gray-300",children:n.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"marketingAgreed",checked:e.marketingAgreed,onChange:h,className:"w-4 h-4 mt-0.5"}),n.jsxs("span",{style:{fontSize:"14px",flex:1},children:[n.jsx("span",{className:"font-bold",children:"(선택)"})," 이벤트 및 마케팅 정보 수신에 동의합니다"]})]})})]}),n.jsxs("div",{className:"flex gap-2",style:{marginTop:"20px",marginBottom:"24px"},children:[n.jsx("button",{onClick:u,disabled:a,className:"flex-1 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:a?"저장 중...":"확인"}),n.jsx("button",{onClick:()=>r?.("Dashboard"),disabled:a,className:"flex-1 py-2 font-bold rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:"나가기"})]})]})]}),o&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto p-6",children:[n.jsx("h2",{className:"font-bold mb-4",style:{color:"#249689",fontSize:"24px"},children:"개인정보 수집 및 이용 동의서"}),n.jsxs("div",{className:"space-y-4 text-sm",style:{color:"#333"},children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"1. 개인정보의 수집 및 이용 목적"}),n.jsx("p",{className:"ml-4",children:"- 상품 주문 및 배송"}),n.jsx("p",{className:"ml-4",children:"- 결제 처리 및 영수증 발행"}),n.jsx("p",{className:"ml-4",children:"- 고객 문의 응대 및 불만 처리"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"2. 수집하는 개인정보의 항목"}),n.jsx("p",{className:"ml-4",children:"- 필수항목: 이름, 연락처, 주소(배송 시)"}),n.jsx("p",{className:"ml-4",children:"- 선택항목: 이메일, 나이"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"3. 개인정보의 보유 및 이용 기간"}),n.jsx("p",{className:"ml-4",children:"- 수집된 개인정보는 목적 달성 후 지체 없이 파기합니다."}),n.jsx("p",{className:"ml-4",children:"- 단, 관계 법령에 의해 보존할 필요가 있는 경우 해당 기간 동안 보관합니다."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"4. 동의를 거부할 권리 및 거부 시 불이익"}),n.jsx("p",{className:"ml-4",children:"- 귀하는 개인정보 수집 및 이용을 거부할 권리가 있습니다."}),n.jsx("p",{className:"ml-4",children:"- 단, 필수항목 미동의 시 상품 구매 및 배송이 제한될 수 있습니다."})]})]}),n.jsx("button",{onClick:()=>l(!1),className:"w-full mt-6 py-3 text-white font-bold rounded-lg",style:{backgroundColor:"#249689"},children:"확인"})]})})]})}function rc({user:t,onNavigate:r,config:e}){const[s,a]=B.useState(""),[i,o]=B.useState(""),[l,c]=B.useState(""),[d,h]=B.useState([]),[f,u]=B.useState([]),[m,p]=B.useState(!1),[x,g]=B.useState([]),[j,w]=B.useState("all"),[_,T]=B.useState(!1),[R,z]=B.useState(null),E=t?.user_type==="시스템관리자";B.useEffect(()=>{e.showBranchFilter&&I(),D()},[]);const I=async()=>{try{const{data:y,error:F}=await ue.from("branches").select("*").order("name",{ascending:!0});if(F)throw F;u(y||[])}catch(y){console.error("지점 조회 오류:",y)}},D=async()=>{p(!0);try{let y=ue.from("sales").select("*").order("created_at",{ascending:!1});e.filterByBranch&&t?.branch&&(y=y.eq("branch_name",t.branch));const{data:F,error:O}=await y;if(O){console.error("전체 목록 조회 오류:",O),alert("데이터를 불러오는 중 오류가 발생했습니다: "+O.message);return}console.log("조회된 데이터:",F),h(F||[])}catch(y){console.error("데이터 조회 오류:",y),alert("데이터를 불러오는 중 오류가 발생했습니다: "+y.message)}finally{p(!1)}},P=async()=>{p(!0);try{let y=ue.from("sales").select("*").order("created_at",{ascending:!1});if(e.filterByBranch&&t?.branch&&(y=y.eq("branch_name",t.branch)),e.showBranchFilter&&j!=="all"&&(y=y.eq("branch_name",j)),s.trim()){const b=e.searchFields.map(W=>`${W}.ilike.%${s}%`).join(",");y=y.or(b)}if(i){const b=new Date(i);b.setHours(0,0,0,0),y=y.gte("created_at",b.toISOString())}if(l){const b=new Date(l);b.setHours(23,59,59,999),y=y.lte("created_at",b.toISOString())}const{data:F,error:O}=await y;if(O){console.error("검색 오류:",O),alert("검색 중 오류가 발생했습니다: "+O.message);return}console.log("검색 결과:",F),h(F||[]),(!F||F.length===0)&&alert("검색 결과가 없습니다")}catch(y){console.error("검색 오류:",y),alert("검색 중 오류가 발생했습니다: "+y.message)}finally{p(!1)}},U=()=>{a(""),o(""),c(""),w("all"),g([]),D()},H=y=>{g(F=>F.some(b=>b.id===y.id)?F.filter(b=>b.id!==y.id):[...F,y])},ee=y=>{y.target.checked?g([...d]):g([])},pe=y=>new Date(y).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}),ge=y=>{if(!y)return"-";const F=y.replace(/[^\d]/g,"");return F.length===11?`${F.slice(0,3)}-${F.slice(3,7)}-${F.slice(7)}`:F.length===10?`${F.slice(0,3)}-${F.slice(3,6)}-${F.slice(6)}`:y},je=(y,F)=>{F&&F.stopPropagation(),z(y),T(!0)},_e=async()=>{if(R)try{const{error:y}=await ue.from("sales").delete().eq("id",R.id);if(y)throw y;alert("삭제되었습니다."),T(!1),z(null),g(F=>F.filter(O=>O.id!==R.id)),D()}catch(y){console.error("삭제 실패:",y),alert("삭제에 실패했습니다.")}},ke=()=>{if(x.length===0){alert("출력할 항목을 선택해주세요");return}const y=window.open("","_blank");if(!y){alert("팝업이 차단되었습니다. 팝업 차단을 해제해주세요.");return}const F=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>${e.printTitle}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: 'Malgun Gothic', sans-serif; padding: 0; line-height: 1.4; }
          @page { size: A4; margin: 10mm; }
          .page { width: 100%; display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 5mm; page-break-after: always; padding: 5mm; }
          .page:last-child { page-break-after: auto; }
          .invoice { border: 2px solid #249689; padding: 5mm; background: white; border-radius: 3mm; display: flex; flex-direction: column; height: 100%; }
          .invoice-header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 3mm; margin-bottom: 3mm; }
          .invoice-header h1 { font-size: 14pt; font-weight: bold; margin-bottom: 1mm; }
          .invoice-number { font-size: 9pt; color: #666; }
          .section { margin-bottom: 3mm; }
          .section-title { font-size: 10pt; font-weight: bold; background-color: #f0f0f0; padding: 1.5mm; margin-bottom: 1.5mm; border-left: 3mm solid #249689; }
          .field { display: flex; padding: 1mm 0; font-size: 9pt; }
          .field-label { font-weight: bold; width: 18mm; flex-shrink: 0; }
          .field-value { flex: 1; word-break: break-all; }
          .order-box { border: 1px solid #ddd; padding: 2mm; background-color: #fafafa; min-height: 15mm; max-height: 25mm; font-size: 8pt; white-space: pre-wrap; word-break: break-word; overflow: hidden; }
          .footer { margin-top: auto; padding-top: 2mm; border-top: 1px dashed #ccc; text-align: center; font-size: 7pt; color: #666; }
          @media print { body { margin: 0; padding: 0; } .page { page-break-after: always; } .page:last-child { page-break-after: auto; } }
        </style>
      </head>
      <body>
        ${(()=>{let O="";for(let b=0;b<x.length;b+=4){O+='<div class="page">';for(let W=b;W<Math.min(b+4,x.length);W++){const L=x[W];O+=`
                <div class="invoice">
                  <div class="invoice-header">
                    <h1>${e.printHeaderTitle}</h1>
                    <div class="invoice-number">No. ${String(W+1).padStart(4,"0")}</div>
                  </div>
                  <div class="section">
                    <div class="section-title">${e.printSectionTitle}</div>
                    <div class="field"><div class="field-label">성명</div><div class="field-value">${L.customer_name||"-"}</div></div>
                    <div class="field"><div class="field-label">연락처</div><div class="field-value">${ge(L.customer_phone||L.phone)}</div></div>
                    <div class="field"><div class="field-label">주소</div><div class="field-value">${L.address||"-"}</div></div>
                  </div>
                  <div class="section">
                    <div class="section-title">주문 정보</div>
                    <div class="field"><div class="field-label">주문일</div><div class="field-value">${pe(L.created_at)}</div></div>
                    ${e.showBranchInPrint?`<div class="field"><div class="field-label">지점</div><div class="field-value">${L.branch_name||"-"}</div></div>`:""}
                    <div class="field"><div class="field-label">수량</div><div class="field-value">${L.quantity||"-"}${e.quantityUnit}</div></div>
                    <div style="margin-top: 1.5mm;"><div class="field-label" style="margin-bottom: 1mm;">주문내역</div><div class="order-box">${L.order_details||"주문 정보 없음"}</div></div>
                  </div>
                  <div class="footer">${e.printFooter}<br/>발행일: ${new Date().toLocaleDateString("ko-KR")}</div>
                </div>
              `}O+="</div>"}return O})()}
        <script>
          window.onload = function() { setTimeout(function() { window.print(); }, 500); }
          window.onafterprint = function() { window.close(); };
        <\/script>
      </body>
      </html>
    `;y.document.write(F),y.document.close(),y.focus()},de=()=>{if(x.length===0){alert("다운로드할 항목을 선택해주세요");return}const y=x.map((se,ae)=>e.excelColumns.map(ye=>{switch(ye){case"번호":return ae+1;case"주문일":return pe(se.created_at);case"지점":return se.branch_name||"";case"이름":return se.customer_name||"";case"연락처":return ge(se.customer_phone||se.phone);case"주소":return se.address||"";case"수량":return se.quantity||"";case"주문내역":return(se.order_details||"").replace(/\n/g," ");default:return""}}));let F="\uFEFF";F+=e.excelColumns.join(",")+`
`,y.forEach(se=>{const ae=se.map(ye=>{const G=String(ye);return G.includes(",")||G.includes('"')||G.includes(`
`)?'"'+G.replace(/"/g,'""')+'"':G});F+=ae.join(",")+`
`});const O=new Blob([F],{type:"text/csv;charset=utf-8;"}),b=document.createElement("a"),W=URL.createObjectURL(O),L=new Date().toISOString().slice(0,10),Z=e.getFileName(t,L);b.setAttribute("href",W),b.setAttribute("download",Z),b.style.visibility="hidden",document.body.appendChild(b),b.click(),document.body.removeChild(b)},me=y=>x.some(F=>F.id===y.id),Se=d.length>0&&x.length===d.length;return n.jsxs("div",{className:"min-h-screen bg-white",children:[n.jsx("div",{className:e.containerClass,children:n.jsxs("div",{className:e.cardClass,children:[n.jsxs("div",{className:e.headerClass,children:[e.showBackButton&&n.jsxs("button",{onClick:()=>r(e.backNavigation),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[n.jsx("span",{style:{fontSize:"18px"},children:"←"}),e.backButtonText]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:y=>y.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:e.title})]}),n.jsx("div",{style:{width:"100px"}})]}),e.showBranchInfo&&t?.user_type==="지점관리자"&&n.jsx("div",{className:"mb-4 p-3 bg-purple-50 border border-purple-200 rounded-lg",children:n.jsxs("p",{className:"text-sm",style:{color:"#8b5cf6"},children:["🛡️ ",n.jsx("strong",{children:t.branch})," 지점의 데이터만 표시됩니다"]})}),n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"flex gap-2 items-center",children:[e.showBranchFilter&&n.jsxs("select",{value:j,onChange:y=>w(y.target.value),className:"px-3 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px",width:"150px"},children:[n.jsx("option",{value:"all",children:"전체 지점"}),f.map(y=>n.jsx("option",{value:y.name,children:y.name},y.id))]}),n.jsx("label",{className:"font-bold whitespace-nowrap",style:{color:"#000000",fontSize:"15px"},children:"📅 주문일자"}),n.jsx("input",{type:"date",value:i,onChange:y=>o(y.target.value),className:"px-3 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px",width:"150px"}}),n.jsx("span",{className:"font-bold",style:{color:"#000000",fontSize:"15px"},children:"~"}),n.jsx("input",{type:"date",value:l,onChange:y=>c(y.target.value),className:"px-3 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px",width:"150px"}}),n.jsx("input",{type:"text",value:s,onChange:y=>a(y.target.value),onKeyPress:y=>y.key==="Enter"&&P(),placeholder:e.searchPlaceholder,className:"flex-1 px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}}),n.jsxs("button",{onClick:P,disabled:m,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50 whitespace-nowrap",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px",width:"120px",justifyContent:"center"},children:[n.jsx(rs,{size:18}),m?"검색 중...":"검색"]}),n.jsxs("button",{onClick:U,disabled:m,className:"px-6 py-2 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50 whitespace-nowrap flex items-center gap-2",style:{border:"2px solid #249689",backgroundColor:"white",borderRadius:"10px",fontSize:"15px",color:"#249689",width:"120px",justifyContent:"center"},children:[n.jsx(Yr,{size:18}),"초기화"]})]})}),x.length>0&&n.jsxs("div",{className:"mb-4 p-4 rounded-lg flex items-center justify-between",style:{backgroundColor:"#f0fffe",border:"2px solid #249689"},children:[n.jsxs("span",{className:"font-bold",style:{color:"#249689",fontSize:"15px"},children:["📋 선택된 항목: ",x.length,"건"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:de,className:"px-6 py-2 font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2",style:{backgroundColor:"#5B7FD4",color:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Er,{size:18}),"엑셀다운로드(",x.length.toString().padStart(2,"0"),")"]}),n.jsxs("button",{onClick:ke,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Hc,{size:18}),"인쇄"]})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[n.jsx("th",{className:"px-2 py-3 text-center font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689",width:"50px"},children:n.jsx("input",{type:"checkbox",checked:Se,onChange:ee,className:"w-4 h-4"})}),e.tableColumns.map((y,F)=>n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:y},F)),E&&n.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689",width:"80px"},children:"관리"})]})}),n.jsx("tbody",{children:m?n.jsx("tr",{children:n.jsx("td",{colSpan:e.tableColumns.length+(E?2:1),className:"px-4 py-8 text-center",style:{fontSize:"16px"},children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2",style:{borderColor:"#249689"}}),"로딩 중..."]})})}):d.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:e.tableColumns.length+(E?2:1),className:"px-4 py-8 text-center text-gray-500",style:{fontSize:"16px"},children:n.jsxs("div",{children:[n.jsx("p",{className:"mb-2",children:"등록된 주문 내역이 없습니다"}),n.jsx("p",{className:"text-sm",children:"판매관리에서 판매 데이터를 추가하세요"})]})})}):d.map(y=>n.jsxs("tr",{className:`border-b border-gray-200 hover:bg-gray-50 transition-colors ${me(y)?"bg-blue-50":""}`,children:[n.jsx("td",{className:"px-2 py-3 text-center",children:n.jsx("input",{type:"checkbox",checked:me(y),onChange:()=>H(y),className:"w-4 h-4"})}),e.renderTableRow(y,pe,ge),E&&n.jsx("td",{className:"px-3 py-3 text-center",children:n.jsx("button",{onClick:F=>je(y,F),className:"p-2 text-red-500 hover:text-red-600 hover:bg-red-50 rounded inline-flex items-center justify-center transition-colors",title:"삭제",children:n.jsx(Ar,{size:18})})})]},y.id))})]})}),d.length>0&&n.jsxs("div",{className:"mt-4 text-right text-gray-600",style:{fontSize:"13px"},children:["총 ",n.jsx("strong",{style:{color:"#249689"},children:d.length}),"건"]})]})}),_&&R&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",style:{borderRadius:"10px"},children:[n.jsx("h2",{className:"text-xl font-bold mb-4 text-center text-red-600",children:"⚠️ 삭제 확인"}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700 mb-4",children:"정말로 이 주문 내역을 삭제하시겠습니까?"}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2 text-sm",children:[n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"고객명:"})," ",R.customer_name]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"주문일:"})," ",pe(R.created_at)]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"지점:"})," ",R.branch_name||"-"]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"주문내역:"})," ",R.order_details||"-"]})]}),n.jsx("p",{className:"text-red-600 text-sm mt-4 font-semibold",children:"※ 삭제된 데이터는 복구할 수 없습니다."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>{T(!1),z(null)},className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",style:{borderRadius:"10px"},children:"취소"}),n.jsx("button",{onClick:_e,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 font-medium",style:{borderRadius:"10px"},children:"삭제"})]})]})})]})}function Dg({user:t,onNavigate:r}){const e={containerClass:"max-w-5xl mx-auto p-6",cardClass:"bg-white rounded-lg shadow-lg p-6",headerClass:"flex items-center justify-between mb-8",title:"주문목록",showBackButton:!0,backNavigation:"Dashboard",backButtonText:"나가기",showBranchInfo:!0,showBranchFilter:!1,filterByBranch:!0,searchPlaceholder:"이름, 전화번호, 이메일로 검색",searchFields:["customer_name","phone","email"],tableColumns:["이름","연락처","주소","주문정보","주문일"],renderTableRow:(s,a,i)=>n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:s.customer_name}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:i(s.phone)}),n.jsxs("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:[s.address?.substring(0,30),s.address?.length>30?"...":""]}),n.jsxs("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:[s.order_details?.substring(0,20),s.order_details?.length>20?"...":""]}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:a(s.created_at)})]}),printTitle:"배송 송장",printHeaderTitle:"📦 배송 송장",printSectionTitle:"📍 수취인 정보",printFooter:"LAS Book Store · 배송 송장",showBranchInPrint:!1,quantityUnit:"개",excelColumns:["번호","주문일","이름","연락처","주소","수량","주문내역"],getFileName:(s,a)=>{const i=s?.branch||"지점명",o=s?.name||"사용자";return`주문목록_${i}_${o}_${a}.csv`}};return n.jsx(rc,{user:t,onNavigate:r,config:e})}function sc({user:t,onNavigate:r,isAdminView:e=!1,title:s="구매이력조회",showBranchFilter:a=!1,navigateBack:i="Dashboard"}){const[o,l]=B.useState([]),[c,d]=B.useState([]),[h,f]=B.useState([]),[u,m]=B.useState(!1),[p,x]=B.useState("all"),[g,j]=B.useState(""),[w,_]=B.useState(""),[T,R]=B.useState(""),[z,E]=B.useState(!1),[I,D]=B.useState(null),[P,U]=B.useState(!1),[H,ee]=B.useState(null),pe=h.length,ge=h.reduce((L,Z)=>L+(Z.quantity||0),0),je=e?p==="all"?"전체":p:t?.branch||"-";B.useEffect(()=>{a&&_e(),ke()},[]),B.useEffect(()=>{de()},[o,p,g,w,T]);const _e=async()=>{try{const{data:L,error:Z}=await ue.from("users").select("branch").not("branch","is",null).order("branch");if(Z)throw Z;const se=[...new Set(L.map(ae=>ae.branch))];d(se.map(ae=>({branch_name:ae})))}catch(L){console.error("지점 조회 실패:",L),alert("지점 목록을 불러오는데 실패했습니다.")}},ke=async()=>{m(!0);try{let L=ue.from("sales").select("*").order("created_at",{ascending:!1});!e&&t?.branch&&(L=L.eq("user_branch",t.branch));const{data:Z,error:se}=await L;if(se)throw se;l(Z||[]),f(Z||[])}catch(L){console.error("구매이력 조회 실패:",L),alert("구매이력을 불러오는데 실패했습니다.")}finally{m(!1)}},de=()=>{let L=[...o];if(a&&p!=="all"&&(L=L.filter(Z=>Z.user_branch===p)),g&&(L=L.filter(Z=>new Date(Z.created_at).toISOString().split("T")[0]>=g)),w&&(L=L.filter(Z=>new Date(Z.created_at).toISOString().split("T")[0]<=w)),T.trim()){const Z=T.toLowerCase().trim();L=L.filter(se=>se.customer_name?.toLowerCase().includes(Z)||se.phone?.includes(Z)||se.depositor?.toLowerCase().includes(Z))}f(L)},me=()=>{de()},Se=()=>{x("all"),j(""),_(""),R("")},y=L=>{ee(L),U(!0)},F=async()=>{if(H)try{const{error:L}=await ue.from("sales").delete().eq("id",H.id);if(L)throw L;alert("삭제되었습니다."),U(!1),ee(null),ke()}catch(L){console.error("삭제 실패:",L),alert("삭제에 실패했습니다.")}},O=t?.user_type==="시스템관리자",b=L=>{if(!L)return"-";const Z=new Date(L);return`${Z.getFullYear()}.${String(Z.getMonth()+1).padStart(2,"0")}.${String(Z.getDate()).padStart(2,"0")}`},W=L=>{if(!L)return"-";const Z=L.toString().replace(/\D/g,"");return Z.length===11?Z.replace(/(\d{3})(\d{4})(\d{4})/,"$1-$2-$3"):Z.length===10?Z.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"):L};return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsx("div",{className:"bg-white shadow-sm",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:n.jsxs("div",{className:"flex items-center justify-between relative",children:[n.jsxs("button",{onClick:()=>{console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),console.log("🔙 PurchaseHistoryBase - 나가기 버튼 클릭됨"),console.log("📌 navigateBack 원본 값:",i),console.log("📌 navigateBack 타입:",typeof i),console.log("📌 navigateBack 길이:",i?.length),console.log("📌 navigateBack 문자코드:",[...i].map(L=>L.charCodeAt(0))),console.log("📌 isAdminView:",e),console.log("📌 title:",s),console.log("📌 showBranchFilter:",a),console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),r(i)},className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800",children:[n.jsx(Ot,{size:20}),n.jsx("span",{children:"나가기"})]}),n.jsxs("div",{className:"absolute left-1/2 transform -translate-x-1/2 flex items-center gap-2",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10",onError:L=>L.target.style.display="none"}),n.jsx("h1",{className:"text-4xl font-bold",style:{color:"#249689"},children:s})]}),n.jsx("div",{style:{width:"120px"}})]})})}),n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border-2 border-blue-200",children:[n.jsx("div",{className:"text-sm text-blue-600 mb-1",children:"📦 총 판매건수"}),n.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:[pe,"건"]})]}),n.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border-2 border-green-200",children:[n.jsx("div",{className:"text-sm text-green-600 mb-1",children:"📚 총 판매수량"}),n.jsxs("div",{className:"text-2xl font-bold text-green-700",children:[ge,"권"]})]}),n.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 border-2 border-yellow-200",children:[n.jsx("div",{className:"text-sm text-yellow-600 mb-1",children:"🏢 조회지점"}),n.jsx("div",{className:"text-2xl font-bold text-yellow-700",children:je})]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:n.jsxs("div",{className:"flex items-center gap-3",children:[a?n.jsxs("select",{value:p,onChange:L=>x(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500",children:[n.jsx("option",{value:"all",children:"전체 지점"}),c.map(L=>n.jsx("option",{value:L.branch_name,children:L.branch_name},L.branch_name))]}):n.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-300 rounded-lg font-medium",style:{color:"#249689"},children:t?.branch||"-"}),n.jsx("span",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:"구매일자"}),n.jsx("input",{type:"date",value:g,onChange:L=>j(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"}),n.jsx("span",{className:"text-gray-500",children:"~"}),n.jsx("input",{type:"date",value:w,onChange:L=>_(L.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"}),n.jsx("input",{type:"text",value:T,onChange:L=>R(L.target.value),onKeyPress:L=>L.key==="Enter"&&me(),placeholder:"이름, 연락처, 입금자명 검색",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"}),n.jsxs("button",{onClick:me,className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 flex items-center gap-2 whitespace-nowrap",children:[n.jsx(rs,{size:18}),"검색"]}),n.jsxs("button",{onClick:Se,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center gap-2 whitespace-nowrap",children:[n.jsx(Yr,{size:18}),"초기화"]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:u?n.jsx("div",{className:"text-center py-12",children:n.jsx("p",{className:"text-gray-500",children:"로딩 중..."})}):h.length===0?n.jsx("div",{className:"text-center py-12",children:n.jsx("p",{className:"text-gray-500",children:"조회된 구매이력이 없습니다."})}):n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"실명"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"구매일자"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"지점"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"연락처"}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"수량"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"결제정보"}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:"주문내역"}),O&&n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:"관리"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:h.map((L,Z)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm",children:L.customer_name||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:b(L.created_at)}),n.jsx("td",{className:"px-4 py-3 text-sm",children:L.user_branch||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:W(L.phone)}),n.jsxs("td",{className:"px-4 py-3 text-sm text-center",children:[L.quantity||0,"개"]}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:L.payment_method||"-"}),L.payment_method==="입금"&&n.jsxs("div",{className:"text-gray-600 text-xs",children:[L.depositor&&`${L.depositor} / `,L.deposit_amount&&`${L.deposit_amount.toLocaleString()}원`]})]})}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsx("div",{className:"max-w-xs truncate text-gray-600",children:L.order_details||"-"})}),O&&n.jsx("td",{className:"px-4 py-3 text-sm text-center",children:n.jsx("button",{onClick:()=>y(L),className:"p-2 text-red-500 hover:text-red-600 hover:bg-red-50 rounded inline-flex items-center justify-center transition-colors",title:"삭제",children:n.jsx(Ar,{size:18})})})]},L.id||Z))})]})}),n.jsx("div",{className:"mt-4 flex items-center justify-between",children:n.jsxs("div",{className:"text-lg font-bold",style:{color:"#249689"},children:["검색결과: ",h.length.toLocaleString(),"건"]})})]}),z&&I&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"p-6",children:[n.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",style:{color:"#249689"},children:"🏢 구매이력상세"}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-bold mb-3 text-gray-800",children:"📋 판매 정보"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:"판매일자"}),n.jsx("p",{className:"font-medium",children:b(I.created_at)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:"판매 지점"}),n.jsx("p",{className:"font-medium",children:I.user_branch||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:"수량"}),n.jsxs("p",{className:"font-medium",children:[I.quantity||0,"개"]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:"주문내역"}),n.jsx("p",{className:"font-medium",children:I.order_details||"-"})]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-bold mb-3 text-gray-800",children:"👤 구매자 정보"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:"이름"}),n.jsx("p",{className:"font-medium",children:I.customer_name||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:"전화번호"}),n.jsx("p",{className:"font-medium",children:W(I.phone)})]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-bold mb-3 text-gray-800",children:"💳 결제 정보"}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:"결제 방법"}),n.jsx("p",{className:"font-medium",children:I.payment_method||"-"})]}),I.payment_method==="입금"&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:"입금자명"}),n.jsx("p",{className:"font-medium",children:I.depositor||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:"입금액"}),n.jsx("p",{className:"font-bold text-lg",style:{color:"#249689"},children:I.deposit_amount?`${I.deposit_amount.toLocaleString()}원`:"-"})]})]})]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>window.print(),className:"flex-1 px-4 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 font-medium",children:"🖨️ 출력"}),n.jsx("button",{onClick:()=>E(!1),className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:"❌ 닫기"})]})]})})}),P&&H&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[n.jsx("h2",{className:"text-xl font-bold mb-4 text-center text-red-600",children:"⚠️ 삭제 확인"}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700 mb-4",children:"정말로 이 구매이력을 삭제하시겠습니까?"}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2 text-sm",children:[n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"고객명:"})," ",H.customer_name]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"구매일자:"})," ",b(H.created_at)]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"지점:"})," ",H.user_branch]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"주문내역:"})," ",H.order_details||"-"]})]}),n.jsx("p",{className:"text-red-600 text-sm mt-4 font-semibold",children:"※ 삭제된 데이터는 복구할 수 없습니다."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>{U(!1),ee(null)},className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:"취소"}),n.jsx("button",{onClick:F,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 font-medium",children:"삭제"})]})]})})]})}function Og({user:t,onNavigate:r}){return n.jsx(sc,{user:t,onNavigate:r,isAdminView:!1,title:"구매이력조회",showBranchFilter:!1,navigateBack:"Dashboard"})}function Ig({user:t,onNavigate:r,onLogout:e}){return n.jsx("div",{className:"min-h-screen bg-white",children:n.jsx("div",{className:"max-w-md mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:s=>s.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"시스템관리"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"🏢 지점명"}),n.jsx("input",{type:"text",value:t?.branch||"본사",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"👤 이름"}),n.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("button",{onClick:()=>r("SystemAdminUsers"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(ja,{size:20}),"직원정보관리"]}),n.jsxs("button",{onClick:()=>r("SystemAdminBranches"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(jn,{size:20}),"지점관리"]}),n.jsxs("button",{onClick:()=>r("SystemAdminShipping"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(no,{size:20}),"주문목록관리"]}),n.jsxs("button",{onClick:()=>r("SystemAdminPurchases"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(ao,{size:20}),"구매이력조회"]}),n.jsxs("button",{onClick:()=>r("SystemAdminCustomers"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(sn,{size:20}),"구매자정보"]}),n.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminEventMenu"),r("AdminEventMenu")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#dc2626",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Sa,{size:20}),"이벤트관리"]}),n.jsxs("button",{onClick:e,className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Na,{size:20}),"LogOut"]})]})]})})})}function Pg({user:t,onNavigate:r}){const[e,s]=B.useState([]),[a,i]=B.useState(!1),[o,l]=B.useState(!1),[c,d]=B.useState("create"),[h,f]=B.useState(null),[u,m]=B.useState({name:"",address:"",manager_name:"",phone:""});B.useEffect(()=>{p()},[]);const p=async()=>{i(!0);try{console.log("Fetching branches...");const{data:R,error:z}=await ue.from("branches").select("*").order("created_at",{ascending:!1});if(z)throw console.error("Supabase error:",z),z;console.log("Branches loaded:",R),console.log("Number of branches:",R?.length),R&&R.length>0&&(console.log("First branch:",R[0]),console.log("Branch columns:",Object.keys(R[0]))),s(R||[])}catch(R){console.error("Load branches error:",R),alert("지점 목록을 불러오는 중 오류가 발생했습니다: "+R.message)}finally{i(!1)}},x=R=>{const{name:z,value:E}=R.target;console.log(`Form change: ${z} = ${E}`),m({...u,[z]:E})},g=()=>{console.log("Opening create modal"),d("create"),m({name:"",address:"",manager_name:"",phone:""}),l(!0)},j=R=>{console.log("Opening edit modal for:",R),d("edit"),f(R),m({name:R.name||"",address:R.address||"",manager_name:R.manager_name||"",phone:R.phone||""}),l(!0)},w=async()=>{if(!u.name.trim()){alert("지점명을 입력해주세요");return}i(!0);try{if(c==="create"){console.log("Creating branch:",u);const R={name:u.name.trim(),manager_name:u.manager_name.trim()||null};u.address.trim()&&(R.address=u.address.trim()),u.phone.trim()&&(R.phone=u.phone.trim());const{data:z,error:E}=await ue.from("branches").insert([R]).select();if(E)throw console.error("Insert error:",E),E;console.log("Branch created successfully:",z),alert("지점이 생성되었습니다!")}else{console.log("Updating branch:",u);const R={name:u.name.trim(),manager_name:u.manager_name.trim()||null};u.address.trim()&&(R.address=u.address.trim()),u.phone.trim()&&(R.phone=u.phone.trim());const{data:z,error:E}=await ue.from("branches").update(R).eq("id",h.id).select();if(E)throw console.error("Update error:",E),E;console.log("Branch updated successfully:",z),alert("지점 정보가 수정되었습니다!")}l(!1),p()}catch(R){console.error("Save branch error:",R),alert(`지점 저장 중 오류가 발생했습니다.
오류: ${R.message}`)}finally{i(!1)}},_=async R=>{if(window.confirm(`"${R.name}" 지점을 삭제하시겠습니까?

이 지점에 속한 직원들의 지점명도 함께 확인해주세요.`)){i(!0);try{console.log("Deleting branch:",R.id);const{error:z}=await ue.from("branches").delete().eq("id",R.id);if(z)throw console.error("Delete error:",z),z;console.log("Branch deleted successfully"),alert("지점이 삭제되었습니다!"),p()}catch(z){console.error("Delete branch error:",z),alert("지점 삭제 중 오류가 발생했습니다: "+z.message)}finally{i(!1)}}},T=()=>{if(e.length===0){alert("다운로드할 지점 데이터가 없습니다.");return}try{const z=[["지점명","지점주소","지점장","연락처"].join(","),...e.map(U=>[U.name||"",U.address||"",U.manager_name||"",U.phone||""].map(H=>`"${H}"`).join(","))].join(`
`),E="\uFEFF",I=new Blob([E+z],{type:"text/csv;charset=utf-8;"}),D=document.createElement("a"),P=URL.createObjectURL(I);D.setAttribute("href",P),D.setAttribute("download",`지점정보_${new Date().toISOString().split("T")[0]}.csv`),D.style.visibility="hidden",document.body.appendChild(D),D.click(),document.body.removeChild(D)}catch(R){console.error("Excel download error:",R),alert("엑셀 다운로드 중 오류가 발생했습니다.")}};return n.jsxs("div",{className:"min-h-screen bg-white",children:[n.jsx("div",{className:"max-w-5xl mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("button",{onClick:()=>r("SystemAdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[n.jsx(Ot,{size:20}),"나가기"]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:R=>R.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"지점정보관리"})]}),n.jsx("div",{style:{width:"100px"}})]}),n.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[n.jsxs("div",{className:"font-bold",style:{color:"#249689",fontSize:"15px"},children:["지점수 ",e.length.toString().padStart(2,"0")]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:T,disabled:a,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50",style:{backgroundColor:"#5B7FD4",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Er,{size:18}),"엑셀다운로드(",e.length.toString().padStart(2,"0"),")"]}),n.jsxs("button",{onClick:g,disabled:a,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ta,{size:18}),"지점 생성"]})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:"지점명"}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:"지점주소"}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:"지점장"}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:"연락처"}),n.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689",width:"120px"},children:"관리"})]})}),n.jsx("tbody",{children:a?n.jsx("tr",{children:n.jsx("td",{colSpan:"5",className:"px-4 py-8 text-center",style:{fontSize:"16px"},children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2",style:{borderColor:"#249689"}}),"로딩 중..."]})})}):e.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:"5",className:"px-4 py-8 text-center text-gray-500",style:{fontSize:"16px"},children:n.jsxs("div",{children:[n.jsx(jn,{size:48,className:"mx-auto mb-2 opacity-30"}),n.jsx("p",{className:"mb-2",children:"등록된 지점이 없습니다"}),n.jsx("p",{className:"text-sm",children:'상단의 "지점 생성" 버튼을 클릭하여 지점을 추가하세요'})]})})}):e.map(R=>n.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors",children:[n.jsx("td",{className:"px-3 py-3 font-bold",style:{fontSize:"14px",color:"#249689"},children:R.name}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:R.address||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:R.manager_name||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:R.phone||"-"}),n.jsx("td",{className:"px-3 py-3 text-center",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("button",{onClick:()=>j(R),className:"p-2 rounded-lg hover:bg-blue-50 transition-colors",style:{color:"#2563eb"},title:"수정",children:n.jsx(Ea,{size:18})}),n.jsx("button",{onClick:()=>_(R),className:"p-2 rounded-lg hover:bg-red-50 transition-colors",style:{color:"#dc2626"},title:"삭제",children:n.jsx(Ar,{size:18})})]})})]},R.id))})]})}),e.length>0&&n.jsxs("div",{className:"mt-4 text-right text-gray-600",style:{fontSize:"13px"},children:["총 ",n.jsx("strong",{style:{color:"#249689"},children:e.length}),"개 지점"]})]})}),o&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>l(!1),children:n.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-md w-full",onClick:R=>R.stopPropagation(),style:{borderRadius:"10px"},children:[n.jsx("h3",{className:"font-bold mb-4",style:{color:"#249689",fontSize:"20px"},children:c==="create"?"지점 생성":"지점정보수정"}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:["지점명 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),c==="create"?n.jsx("input",{type:"text",name:"name",value:u.name,onChange:x,placeholder:"서초점",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}}):n.jsxs("select",{name:"name",value:u.name,onChange:x,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:"선택하세요"}),e.map(R=>n.jsx("option",{value:R.name,children:R.name},R.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"지점주소"}),n.jsx("input",{type:"text",name:"address",value:u.address,onChange:x,placeholder:"서울시 서초구...",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"지점장"}),n.jsx("input",{type:"text",name:"manager_name",value:u.manager_name,onChange:x,placeholder:"홍길동",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"연락처"}),n.jsx("input",{type:"tel",name:"phone",value:u.phone,onChange:x,placeholder:"010-1234-5678",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"flex gap-2 mt-6",children:[n.jsx("button",{onClick:w,disabled:a,className:"flex-1 py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:a?"저장 중...":c==="create"?"생성":"수정"}),n.jsx("button",{onClick:()=>l(!1),disabled:a,className:"flex-1 py-2.5 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50",style:{border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:"취소"})]})]})})]})}const Lg=async t=>{try{let r="LAS";if(t==="직원"||t==="점주"||t==="점장")r="LAS1";else if(t==="모니터링요원")r="LAS3";else return null;const{data:e,error:s}=await ue.from("users").select("referral_code").like("referral_code",`${r}%`).order("referral_code",{ascending:!1}).limit(1);if(s)throw s;let a=1;return e&&e.length>0&&e[0].referral_code&&(a=parseInt(e[0].referral_code.slice(4))+1),r+String(a).padStart(3,"0")}catch(r){return console.error("추천인 코드 생성 오류:",r),null}},Zs=t=>{if(!t)return"";const r=t.replace(/[^0-9]/g,"");return r.length<=3?r:r.length<=7?`${r.slice(0,3)}-${r.slice(3)}`:r.length<=11?`${r.slice(0,3)}-${r.slice(3,7)}-${r.slice(7)}`:`${r.slice(0,3)}-${r.slice(3,7)}-${r.slice(7,11)}`};function Bg({user:t,onNavigate:r}){const[e,s]=B.useState([]),[a,i]=B.useState([]),[o,l]=B.useState(!1),[c,d]=B.useState(""),[h,f]=B.useState(""),[u,m]=B.useState("all"),[p,x]=B.useState(""),[g,j]=B.useState(""),[w,_]=B.useState([]),[T,R]=B.useState(!1),[z,E]=B.useState(null),[I,D]=B.useState(null),[P,U]=B.useState(30),[H,ee]=B.useState(1),[pe,ge]=B.useState({name:"",branch:"",phone:"",user_type:""});B.useEffect(()=>{je(),_e()},[]);const je=async()=>{try{const{data:G,error:ve}=await ue.from("branches").select("*").order("name",{ascending:!0});if(ve)throw ve;i(G||[])}catch(G){console.error("지점 조회 오류:",G)}},_e=async()=>{l(!0);try{const{data:G,error:ve}=await ue.from("users").select("*").order("created_at",{ascending:!1});if(ve)throw ve;s(G||[])}catch(G){console.error("직원 조회 오류:",G),alert("직원 목록을 불러오는 중 오류가 발생했습니다.")}finally{l(!1)}},ke=async G=>{if(window.confirm("이 직원을 승인하시겠습니까?")){l(!0);try{const ve=e.find(re=>re.id===G);let M=null;ve&&(M=await Lg(ve.user_type));const Q={status:"approved",approved_at:new Date().toISOString()};M&&(Q.referral_code=M);const{error:he}=await ue.from("users").update(Q).eq("id",G);if(he)throw he;alert(M?`직원이 승인되었습니다!
고유코드: ${M}`:"직원이 승인되었습니다!"),_e()}catch(ve){console.error("승인 오류:",ve),alert("승인 처리 중 오류가 발생했습니다.")}finally{l(!1)}}},de=async G=>{if(window.confirm(`이 직원을 거부하시겠습니까?
거부된 직원은 삭제됩니다.`)){l(!0);try{const{error:ve}=await ue.from("users").delete().eq("id",G);if(ve)throw ve;alert("직원이 거부되었습니다!"),_e()}catch(ve){console.error("거부 오류:",ve),alert("거부 처리 중 오류가 발생했습니다.")}finally{l(!1)}}},me=async G=>{const ve="las0000";if(window.confirm(`${G.name}(${G.email})님의 비밀번호를 초기화하시겠습니까?

초기화 비밀번호: ${ve}

※ 직원에게 유선으로 전달해주세요.`)){D(G.id);try{const{error:M}=await ue.from("users").update({password:ve}).eq("id",G.id);if(M)throw M;alert(`비밀번호가 초기화되었습니다!

초기화 비밀번호: ${ve}

※ 직원에게 유선으로 초기화 비밀번호를 전달하고,
로그인 후 반드시 비밀번호를 변경하도록 안내해주세요.`)}catch(M){console.error("비밀번호 초기화 오류:",M),alert("비밀번호 초기화에 실패했습니다.")}finally{D(null)}}},Se=G=>{E(G),ge({name:G.name,branch:G.branch,phone:Zs(G.phone),user_type:G.user_type}),R(!0)},y=G=>{const{name:ve,value:M}=G.target;ge(ve==="phone"?{...pe,[ve]:Zs(M)}:{...pe,[ve]:M})},F=async()=>{if(!pe.name.trim()){alert("이름을 입력해주세요.");return}if(window.confirm("수정하시겠습니까?")){l(!0);try{const{error:G}=await ue.from("users").update({name:pe.name,phone:pe.phone,branch:pe.branch,user_type:pe.user_type}).eq("id",z.id);if(G)throw G;alert("수정되었습니다!"),R(!1),_e()}catch(G){console.error("수정 오류:",G),alert("수정 처리 중 오류가 발생했습니다.")}finally{l(!1)}}},O=async(G,ve)=>{if(window.confirm(`${ve}님을 삭제하시겠습니까?`)){l(!0);try{const{error:M}=await ue.from("users").delete().eq("id",G);if(M)throw M;alert("삭제되었습니다!"),_e()}catch(M){console.error("삭제 오류:",M),alert("삭제 처리 중 오류가 발생했습니다.")}finally{l(!1)}}},b=G=>{_(ve=>ve.includes(G)?ve.filter(M=>M!==G):[...ve,G])},W=async()=>{if(w.length===0){alert("다운로드할 직원을 선택해주세요.");return}try{l(!0);const G=e.filter(be=>w.includes(be.id)),ve=await Promise.all(G.map(async be=>{const Re=p||new Date(be.created_at).toISOString().split("T")[0],Ue=g||new Date().toISOString().split("T")[0],{data:Le,error:wt}=await ue.from("work_diaries").select("work_hours").eq("user_id",be.id).gte("work_date",Re).lte("work_date",Ue);wt&&console.error(`근무일지 조회 오류 (user_id: ${be.id}):`,wt);const Ee=Le?.reduce((mt,qt)=>mt+(parseFloat(qt.work_hours)||0),0)||0,Ae=be.ssn?be.ssn.substring(0,6)+"-*******":"-",st=be.account_number?be.account_number.substring(0,be.account_number.length-4)+"****":"-";return{지점명:be.branch||"-",이름:be.name||"-",전화번호:Zs(be.phone)||"-",구분:be.user_type||"-",근무시작일:new Date(Re).toLocaleDateString("ko-KR"),근무종료일:new Date(Ue).toLocaleDateString("ko-KR"),총근무시간:`${Ee.toFixed(1)}시간`,주민번호:Ae,예금주:be.account_holder||"-",기관명:be.bank_name||"-",계좌번호:st}})),M=Kr.json_to_sheet(ve),Q=Kr.book_new();Kr.book_append_sheet(Q,M,"직원목록");const re=`직원목록_${(p&&g?`${p}_${g}`:`전체기간_${new Date().toISOString().split("T")[0]}`).replace(/-/g,"")}.xlsx`;Ql(Q,re)}catch(G){console.error("엑셀 다운로드 오류:",G),alert("엑셀 파일 생성 중 오류가 발생했습니다.")}finally{l(!1)}},L=e.filter(G=>{const ve=G.name?.toLowerCase().includes(c.toLowerCase())||G.email?.toLowerCase().includes(c.toLowerCase()),M=!h||G.branch===h,Q=u==="all"||G.user_type===u;let he=!0;if(p||g){const re=new Date(G.created_at);p&&(he=he&&re>=new Date(p)),g&&(he=he&&re<=new Date(g))}return ve&&M&&Q&&he}),Z=Math.ceil(L.length/P),se=(H-1)*P,ae=se+P,ye=L.slice(se,ae);return B.useEffect(()=>{ee(1)},[c,h,u,p,g,P]),n.jsxs("div",{className:"min-h-screen bg-white",children:[n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[n.jsx("div",{className:"bg-white border-b pb-4 mb-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("button",{onClick:()=>r("SystemAdminDashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",style:{fontSize:"15px"},children:[n.jsx(Ot,{size:20}),"나가기"]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Book",className:"h-10"}),n.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:"직원정보관리"})]}),n.jsx("div",{className:"w-24"})]})}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[n.jsx("h2",{className:"text-lg font-bold mb-4",style:{color:"#249689"},children:"검색 조건"}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"이름 / 이메일"}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",value:c,onChange:G=>d(G.target.value),placeholder:"검색어를 입력하세요",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"}}),n.jsx(rs,{className:"absolute left-3 top-2.5 text-gray-400",size:18})]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"지점"}),n.jsxs("select",{value:h,onChange:G=>f(G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"},children:[n.jsx("option",{value:"",children:"전체 지점"}),a.map(G=>n.jsx("option",{value:G.name,children:G.name},G.name))]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"직원구분"}),n.jsxs("select",{value:u,onChange:G=>m(G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"},children:[n.jsx("option",{value:"all",children:"전체"}),n.jsx("option",{value:"점주",children:"점주"}),n.jsx("option",{value:"점장",children:"점장"}),n.jsx("option",{value:"직원",children:"직원"}),n.jsx("option",{value:"모니터링요원",children:"모니터링요원"}),n.jsx("option",{value:"계약근무",children:"계약근무"}),n.jsx("option",{value:"지점관리자",children:"지점관리자"}),n.jsx("option",{value:"시스템관리자",children:"시스템관리자"})]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"근무 시작일"}),n.jsx("input",{type:"date",value:p,onChange:G=>x(G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"}})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:"근무 종료일"}),n.jsx("input",{type:"date",value:g,onChange:G=>j(G.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"}})]})]}),n.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"text-gray-600",style:{fontSize:"15px"},children:["총 ",n.jsx("strong",{style:{color:"#249689",fontSize:"16px"},children:L.length}),"명"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm text-gray-600",children:"페이지당:"}),n.jsxs("select",{value:P,onChange:G=>U(Number(G.target.value)),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm",style:{fontSize:"14px"},children:[n.jsx("option",{value:30,children:"30개"}),n.jsx("option",{value:50,children:"50개"}),n.jsx("option",{value:100,children:"100개"})]})]})]}),n.jsxs("button",{onClick:W,className:"flex items-center gap-2 px-6 py-2 text-white rounded-lg hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#249689",fontSize:"15px",borderRadius:"10px"},children:[n.jsx(Er,{size:18}),"엑셀다운로드(",w.length,")"]})]})]}),o?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"inline-block w-8 h-8 border-4 border-gray-200 border-t-[#249689] rounded-full animate-spin"}),n.jsx("p",{className:"mt-4 text-gray-600",children:"로딩 중..."})]}):L.length===0?n.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm border",children:n.jsx("p",{className:"text-gray-500",style:{fontSize:"15px"},children:"조건에 맞는 직원이 없습니다."})}):n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left",children:n.jsx("input",{type:"checkbox",onChange:G=>{G.target.checked?_(L.map(ve=>ve.id)):_([])},checked:w.length===L.length&&L.length>0,className:"rounded border-gray-300"})}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"이름"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"이메일"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"전화번호"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"지점"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"직원구분"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"고유코드"}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:"상태"}),n.jsx("th",{className:"px-4 py-3 text-center font-bold",style:{fontSize:"14px"},children:"관리"})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:ye.map(G=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"checkbox",checked:w.includes(G.id),onChange:()=>b(G.id),className:"rounded border-gray-300"})}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:G.name}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:G.email}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:Zs(G.phone)||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:G.branch}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:G.user_type}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px",fontWeight:"bold",color:"#249689"},children:G.referral_code||"-"}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold",style:{backgroundColor:G.status==="approved"?"#D1FAE5":G.status==="pending"?"#FEF3C7":"#FEE2E2",color:G.status==="approved"?"#065F46":G.status==="pending"?"#92400E":"#991B1B"},children:G.status==="approved"?"승인됨":G.status==="pending"?"대기중":"거부됨"})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("div",{className:"flex items-center justify-center gap-2",children:G.status==="pending"?n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>ke(G.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"승인",children:n.jsx(io,{size:18})}),n.jsx("button",{onClick:()=>de(G.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"거부",children:n.jsx(oo,{size:18})})]}):n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>Se(G),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"수정",children:n.jsx(Ea,{size:18})}),G.id!==t.id&&n.jsx("button",{onClick:()=>me(G),disabled:I===G.id,className:"p-1 hover:bg-purple-50 rounded disabled:opacity-50",style:{color:"#7f95eb"},title:"비밀번호 초기화",children:n.jsx(Wc,{size:18})}),n.jsx("button",{onClick:()=>O(G.id,G.name),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"삭제",children:n.jsx(Ar,{size:18})})]})})})]},G.id))})]})}),Z>1&&n.jsxs("div",{className:"mt-4 flex justify-center items-center gap-2",children:[n.jsx("button",{onClick:()=>ee(G=>Math.max(1,G-1)),disabled:H===1,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:"이전"}),n.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,Z)},(G,ve)=>{let M;return Z<=5||H<=3?M=ve+1:H>=Z-2?M=Z-4+ve:M=H-2+ve,n.jsx("button",{onClick:()=>ee(M),className:`px-3 py-1 border rounded ${H===M?"text-white font-bold":"hover:bg-gray-50"}`,style:{fontSize:"14px",backgroundColor:H===M?"#249689":"white",borderColor:H===M?"#249689":"#d1d5db"},children:M},M)})}),n.jsx("button",{onClick:()=>ee(G=>Math.min(Z,G+1)),disabled:H===Z,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:"다음"}),n.jsxs("span",{className:"ml-4 text-sm text-gray-600",children:[H," / ",Z," 페이지"]})]})]})]}),T&&z&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>R(!1),children:n.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-md w-full",onClick:G=>G.stopPropagation(),style:{borderRadius:"10px"},children:[n.jsx("div",{className:"flex flex-col items-center mb-6",children:n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:G=>G.target.style.display="none"}),n.jsx("h3",{className:"font-bold",style:{color:"#249689",fontSize:"24px"},children:"직원정보수정"})]})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold text-sm text-gray-600",children:"이메일 (수정불가)"}),n.jsx("input",{type:"text",value:z.email,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-100",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:["이름 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",name:"name",value:pe.name,onChange:y,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:"전화번호"}),n.jsx("input",{type:"tel",name:"phone",value:pe.phone,onChange:y,placeholder:"010-1234-5678",maxLength:"13",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:"지점"}),n.jsxs("select",{name:"branch",value:pe.branch,onChange:y,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:"선택하세요"}),a.map(G=>n.jsx("option",{value:G.name,children:G.name},G.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:"구분"}),n.jsxs("select",{name:"user_type",value:pe.user_type,onChange:y,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:"선택"}),n.jsx("option",{value:"모니터링요원",children:"모니터링요원"}),n.jsx("option",{value:"점주",children:"점주"}),n.jsx("option",{value:"점장",children:"점장"}),n.jsx("option",{value:"계약근무",children:"계약근무"}),n.jsx("option",{value:"지점관리자",children:"지점관리자"})]})]})]}),n.jsxs("div",{className:"flex gap-2 mt-6",children:[n.jsx("button",{onClick:F,disabled:o,className:"flex-1 py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:o?"저장 중...":n.jsxs(n.Fragment,{children:[n.jsx(la,{size:18}),"수정"]})}),n.jsxs("button",{onClick:()=>R(!1),disabled:o,className:"flex-1 py-2.5 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",style:{border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(lo,{size:18}),"취소"]})]})]})})]})}function Mg({user:t,onNavigate:r}){const[e,s]=B.useState([]),[a,i]=B.useState(!1),[o,l]=B.useState(""),[c,d]=B.useState(!1),[h,f]=B.useState(null),[u,m]=B.useState(!1),[p,x]=B.useState(null),g=t?.user_type==="시스템관리자";B.useEffect(()=>{j()},[]);const j=async()=>{i(!0);try{const{data:E,error:I}=await ue.from("sales").select("customer_name, phone, email, address, age").order("created_at",{ascending:!1});if(I)throw I;console.log("🔍 조회된 원본 데이터:",E);const D=[],P=new Set;E.forEach(U=>{let H;if(U.customer_name&&U.phone)H=`${U.customer_name}-${U.phone}`;else if(U.email)H=`email-${U.email}`;else if(U.phone)H=`phone-${U.phone}`;else if(U.customer_name)H=`name-${U.customer_name}`;else return;P.has(H)||(P.add(H),D.push(U))}),console.log("✅ 중복 제거 후 구매자 목록:",D),s(D)}catch(E){console.error("❌ 구매자 조회 오류:",E),alert("구매자 정보를 불러오는 중 오류가 발생했습니다: "+E.message)}finally{i(!1)}},w=async()=>{if(!o.trim()){j();return}i(!0);try{const{data:E,error:I}=await ue.from("sales").select("customer_name, phone, email, address, age").or(`customer_name.ilike.%${o}%,phone.ilike.%${o}%,email.ilike.%${o}%`).order("created_at",{ascending:!1});if(I)throw I;const D=[],P=new Set;E.forEach(U=>{let H;if(U.customer_name&&U.phone)H=`${U.customer_name}-${U.phone}`;else if(U.email)H=`email-${U.email}`;else if(U.phone)H=`phone-${U.phone}`;else if(U.customer_name)H=`name-${U.customer_name}`;else return;P.has(H)||(P.add(H),D.push(U))}),s(D),D.length===0&&alert("검색 결과가 없습니다")}catch(E){console.error("❌ 검색 오류:",E),alert("검색 중 오류가 발생했습니다: "+E.message)}finally{i(!1)}},_=()=>{l(""),j()},T=E=>{f(E),d(!0)},R=(E,I)=>{I.stopPropagation(),x(E),m(!0)},z=async()=>{if(p)try{const{error:E}=await ue.from("sales").delete().eq("customer_name",p.customer_name).eq("phone",p.phone);if(E)throw E;alert("삭제되었습니다."),m(!1),x(null),o.trim()?w():j()}catch(E){console.error("삭제 실패:",E),alert("삭제에 실패했습니다.")}};return n.jsxs("div",{className:"min-h-screen bg-white",children:[n.jsx("div",{className:"max-w-6xl mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("button",{onClick:()=>r("SystemAdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[n.jsx(Ot,{size:20}),"나가기"]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:E=>E.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"구매자정보"})]}),n.jsx("div",{style:{width:"100px"}})]}),n.jsx("div",{className:"mb-6 p-3 rounded-lg",style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6"},children:n.jsxs("p",{className:"text-sm",style:{color:"#1e40af"},children:["ℹ️ 구매자 정보는 ",n.jsx("strong",{children:"조회만 가능"}),"하며 수정할 수 없습니다."]})}),n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:o,onChange:E=>l(E.target.value),onKeyPress:E=>E.key==="Enter"&&w(),placeholder:"이름, 전화번호, 이메일로 검색",disabled:a,className:"flex-1 px-4 py-2 border border-gray-300 disabled:bg-gray-100",style:{borderRadius:"10px",fontSize:"15px"}}),n.jsxs("button",{onClick:w,disabled:a,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50 whitespace-nowrap",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px",width:"120px",justifyContent:"center"},children:[n.jsx(rs,{size:18}),"검색"]}),n.jsxs("button",{onClick:_,disabled:a,className:"px-6 py-2 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50 flex items-center gap-2 whitespace-nowrap",style:{border:"2px solid #249689",backgroundColor:"white",borderRadius:"10px",fontSize:"15px",color:"#249689",width:"120px",justifyContent:"center"},children:[n.jsx(Yr,{size:18}),"초기화"]})]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[n.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689",width:"80px"},children:"상세"}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:"이름"}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:"전화번호"}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:"주소"}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:"이메일"}),g&&n.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689",width:"80px"},children:"관리"})]})}),n.jsx("tbody",{children:a?n.jsx("tr",{children:n.jsx("td",{colSpan:g?"6":"5",className:"px-4 py-8 text-center",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2",style:{borderColor:"#249689"}}),"로딩 중..."]})})}):e.length===0?n.jsx("tr",{children:n.jsxs("td",{colSpan:g?"6":"5",className:"px-4 py-8 text-center text-gray-500",children:[n.jsx(ja,{size:48,className:"mx-auto mb-2 opacity-30"}),n.jsx("p",{className:"mb-2",children:"등록된 구매자 정보가 없습니다"}),n.jsx("p",{className:"text-sm",children:"판매 데이터가 생성되면 자동으로 표시됩니다"})]})}):e.map((E,I)=>n.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>T(E),children:[n.jsx("td",{className:"px-3 py-3 text-center",children:n.jsx("button",{onClick:D=>{D.stopPropagation(),T(E)},className:"p-2 rounded-full hover:bg-gray-200 transition-colors",style:{color:"#249689"},title:"상세보기",children:n.jsx(co,{size:16})})}),n.jsx("td",{className:"px-3 py-3 font-bold",style:{fontSize:"15px"},children:E.customer_name||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:E.phone||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:E.address?E.address.length>30?E.address.substring(0,30)+"...":E.address:"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:E.email||"-"}),g&&n.jsx("td",{className:"px-3 py-3 text-center",children:n.jsx("button",{onClick:D=>R(E,D),className:"p-2 text-red-500 hover:text-red-600 hover:bg-red-50 rounded inline-flex items-center justify-center transition-colors",title:"삭제",children:n.jsx(Ar,{size:18})})})]},I))})]})}),e.length>0&&n.jsxs("div",{className:"mt-4 text-right text-gray-600",style:{fontSize:"13px"},children:["총 ",n.jsx("strong",{style:{color:"#249689"},children:e.length}),"명"]})]})}),c&&h&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>d(!1),children:n.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[85vh] overflow-y-auto",onClick:E=>E.stopPropagation(),style:{borderRadius:"10px"},children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h3",{className:"font-bold",style:{color:"#249689",fontSize:"20px"},children:"👤 구매자 상세정보"})}),n.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"#f0fffe",border:"2px solid #249689"},children:[n.jsx("h4",{className:"font-bold mb-3",style:{color:"#249689",fontSize:"16px"},children:"기본정보"}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:"이름"}),n.jsx("p",{className:"text-sm",children:h.customer_name||"-"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:"나이"}),n.jsx("p",{className:"text-sm",children:h.age?`${h.age}세`:"-"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:"전화번호"}),n.jsx("p",{className:"text-sm",children:h.phone||"-"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:"이메일"}),n.jsx("p",{className:"text-sm break-all",children:h.email||"-"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:"주소"}),n.jsx("p",{className:"text-sm",children:h.address||"-"})]})]})]}),n.jsx("div",{className:"mt-4 flex justify-end",children:n.jsxs("button",{onClick:()=>d(!1),className:"px-6 py-2 font-bold rounded-lg hover:bg-gray-100 transition-colors flex items-center gap-2",style:{border:"2px solid #249689",backgroundColor:"white",borderRadius:"10px",fontSize:"15px",color:"#249689"},children:[n.jsx(lo,{size:18}),"닫기"]})})]})}),u&&p&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",style:{borderRadius:"10px"},children:[n.jsx("h2",{className:"text-xl font-bold mb-4 text-center text-red-600",children:"⚠️ 삭제 확인"}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700 mb-4",children:"정말로 이 구매자의 모든 구매 기록을 삭제하시겠습니까?"}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2 text-sm",children:[n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"이름:"})," ",p.customer_name]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"전화번호:"})," ",p.phone]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"이메일:"})," ",p.email||"-"]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:"주소:"})," ",p.address||"-"]})]}),n.jsx("p",{className:"text-red-600 text-sm mt-4 font-semibold",children:"※ 삭제된 데이터는 복구할 수 없습니다."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>{m(!1),x(null)},className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",style:{borderRadius:"10px"},children:"취소"}),n.jsx("button",{onClick:z,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 font-medium",style:{borderRadius:"10px"},children:"삭제"})]})]})})]})}function zg({user:t,onNavigate:r}){return n.jsx(sc,{user:t,onNavigate:r,isAdminView:!0,title:"구매이력조회",showBranchFilter:!0,navigateBack:"SystemAdminDashboard"})}function Ug({user:t,onNavigate:r}){const e={containerClass:"max-w-6xl mx-auto p-6",cardClass:"bg-white rounded-lg shadow-lg p-6",headerClass:"flex items-center justify-between mb-8",title:"주문목록",showBackButton:!0,backNavigation:"system-admin",backButtonText:"나가기",showBranchInfo:!1,showBranchFilter:!0,filterByBranch:!1,searchPlaceholder:"이름, 전화번호, 이메일로 검색",searchFields:["customer_name","phone","customer_phone","email","address"],tableColumns:["주문일","지점","이름","연락처","주소","수량","주문내역"],renderTableRow:(s,a,i)=>n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:a(s.created_at)}),n.jsx("td",{className:"px-3 py-3 font-bold",style:{fontSize:"15px",color:"#249689"},children:s.branch_name||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:s.customer_name||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:i(s.customer_phone||s.phone)}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:s.address?s.address.length>30?s.address.substring(0,30)+"...":s.address:"-"}),n.jsxs("td",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"15px"},children:[s.quantity||0,"개"]}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:s.order_details?s.order_details.length>20?s.order_details.substring(0,20)+"...":s.order_details:"-"})]}),printTitle:"주문목록",printHeaderTitle:"주문목록",printSectionTitle:"수취인 정보",printFooter:"LAS Book Store · 주문목록",showBranchInPrint:!0,quantityUnit:"권",excelColumns:["번호","주문일","지점","이름","연락처","주소","수량","주문내역"],getFileName:(s,a)=>`주문목록_전체_${a}.csv`};return n.jsx(rc,{user:t,onNavigate:r,config:e})}function $g({user:t,onBack:r,onNavigate:e}){const[s,a]=B.useState(null),[i,o]=B.useState(!0),[l,c]=B.useState(!1),[d,h]=B.useState(!1),[f,u]=B.useState({name:"",phone:""}),[m,p]=B.useState({currentPassword:"",newPassword:"",confirmPassword:""});B.useEffect(()=>{x()},[t]);const x=async()=>{o(!0);try{const{data:R,error:z}=await ue.from("users").select("*").eq("id",t.id).single();if(z)throw z;console.log("✅ 사용자 정보 로드:",R),a(R),u({name:R.name||"",phone:R.phone||""})}catch(R){console.error("❌ 사용자 정보 조회 오류:",R),alert("사용자 정보를 불러오는데 실패했습니다.")}finally{o(!1)}},g=R=>{u({...f,[R.target.name]:R.target.value})},j=R=>{p({...m,[R.target.name]:R.target.value})},w=async()=>{if(!f.name.trim()){alert("이름을 입력해주세요.");return}o(!0);try{const{error:R}=await ue.from("users").update({name:f.name,phone:f.phone}).eq("id",t.id);if(R)throw R;alert("정보가 수정되었습니다."),c(!1),x()}catch(R){console.error("정보 수정 오류:",R),alert("정보 수정에 실패했습니다.")}finally{o(!1)}},_=async()=>{const{currentPassword:R,newPassword:z,confirmPassword:E}=m;if(!R||!z||!E){alert("모든 비밀번호 필드를 입력해주세요.");return}if(z.length<6){alert("새 비밀번호는 6자 이상이어야 합니다.");return}if(z!==E){alert("새 비밀번호가 일치하지 않습니다.");return}o(!0);try{const{data:I,error:D}=await ue.from("users").select("password").eq("id",t.id).single();if(D)throw D;if(I.password!==R){alert("현재 비밀번호가 일치하지 않습니다."),o(!1);return}const{error:P}=await ue.from("users").update({password:z}).eq("id",t.id);if(P)throw P;alert("비밀번호가 변경되었습니다."),h(!1),p({currentPassword:"",newPassword:"",confirmPassword:""})}catch(I){console.error("비밀번호 변경 오류:",I),alert("비밀번호 변경에 실패했습니다.")}finally{o(!1)}},T=()=>{h(!1),p({currentPassword:"",newPassword:"",confirmPassword:""})};return i&&!s?n.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:"#249689"}}),n.jsx("p",{className:"text-gray-600",children:"로딩 중..."})]})}):n.jsx("div",{className:"flex items-start justify-center min-h-screen bg-gray-50 p-2",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md mt-10",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-4",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:R=>R.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"28px"},children:"내 정보관리"})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(Gc,{size:18}),"이메일"]}),n.jsx("input",{type:"text",value:s?.email||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(nn,{size:18}),"이름"]}),l?n.jsx("input",{type:"text",name:"name",value:f.name,onChange:g,className:"w-full px-4 py-2 border border-gray-300 focus:border-teal-500 focus:outline-none",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}}):n.jsx("input",{type:"text",value:s?.name||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(Vc,{size:18}),"전화번호"]}),l?n.jsx("input",{type:"tel",name:"phone",value:f.phone,onChange:g,className:"w-full px-4 py-2 border border-gray-300 focus:border-teal-500 focus:outline-none",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}}):n.jsx("input",{type:"text",value:s?.phone||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(jn,{size:18}),"지점"]}),n.jsx("input",{type:"text",value:s?.branch||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(Xc,{size:18}),"구분"]}),n.jsx("input",{type:"text",value:s?.user_type||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),s?.referral_code&&n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(ni,{size:18}),"고유코드"]}),n.jsx("div",{className:"w-full px-4 py-3 border-2 font-bold",style:{borderRadius:"10px",backgroundColor:"#D1FAE5",borderColor:"#14B8A6",color:"#0D9488",fontSize:"16px",letterSpacing:"0.5px"},children:s.referral_code}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"* 이벤트 참가자 추천 시 이 코드를 알려주세요"}),n.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:n.jsxs("p",{className:"text-xs leading-relaxed",style:{color:"#92400E"},children:["💡 ",n.jsx("span",{className:"font-bold",children:"안내:"})," 이름과 전화번호는 직접 수정할 수 있습니다. 지점이나 구분(직급) 변경이 필요한 경우 관리자에게 문의해 주세요"]})})]}),n.jsx("div",{className:"mt-6 space-y-2.5",children:l?n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:w,disabled:i,className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:i?"저장 중...":"저장"}),n.jsx("button",{onClick:()=>{c(!1),u({name:s.name||"",phone:s.phone||""})},className:"w-full py-3 font-bold rounded-lg transition-colors",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:"취소"})]}):d?n.jsxs("div",{className:"space-y-2.5",children:[n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-3",children:n.jsxs("h3",{className:"font-bold mb-2 flex items-center gap-2",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(ai,{size:18}),"비밀번호 변경"]})}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"14px"},children:"현재 비밀번호 *"}),n.jsx("input",{type:"password",name:"currentPassword",value:m.currentPassword,onChange:j,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},placeholder:"••••••"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"14px"},children:"새 비밀번호 *"}),n.jsx("input",{type:"password",name:"newPassword",value:m.newPassword,onChange:j,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},placeholder:"새 비밀번호 (6자 이상)"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"14px"},children:"새 비밀번호 확인 *"}),n.jsx("input",{type:"password",name:"confirmPassword",value:m.confirmPassword,onChange:j,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},placeholder:"새 비밀번호 다시 입력하세요"})]}),n.jsx("button",{onClick:_,disabled:i,className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:i?"변경 중...":"비밀번호 변경"}),n.jsx("button",{onClick:T,className:"w-full py-3 font-bold rounded-lg transition-colors",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:"취소"})]}):n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>c(!0),className:"w-full py-3 flex items-center justify-center gap-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ca,{size:18}),"정보 수정"]}),s?.referral_code&&n.jsxs("button",{onClick:()=>e("MyQRCode"),className:"w-full py-3 flex items-center justify-center gap-2 font-bold rounded-lg hover:opacity-90 transition-opacity",style:{color:"white",border:"none",backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(ni,{size:18}),"내 QR 코드"]}),n.jsxs("button",{onClick:()=>h(!0),className:"w-full py-3 flex items-center justify-center gap-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#8B8FD9",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(ai,{size:18}),"비밀번호 변경"]}),n.jsxs("button",{onClick:r,className:"w-full py-3 flex items-center justify-center gap-2 font-bold rounded-lg hover:bg-gray-50 transition-colors",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ot,{size:18}),"나가기"]})]})})]})]})})}var zs={},Hg=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},nc={},Rt={};let Ja;const Wg=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Rt.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17};Rt.getSymbolTotalCodewords=function(r){return Wg[r]};Rt.getBCHDigit=function(t){let r=0;for(;t!==0;)r++,t>>>=1;return r};Rt.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');Ja=r};Rt.isKanjiModeEnabled=function(){return typeof Ja<"u"};Rt.toSJIS=function(r){return Ja(r)};var Mn={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function r(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}t.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},t.from=function(s,a){if(t.isValid(s))return s;try{return r(s)}catch{return a}}})(Mn);function ac(){this.buffer=[],this.length=0}ac.prototype={get:function(t){const r=Math.floor(t/8);return(this.buffer[r]>>>7-t%8&1)===1},put:function(t,r){for(let e=0;e<r;e++)this.putBit((t>>>r-e-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),t&&(this.buffer[r]|=128>>>this.length%8),this.length++}};var Gg=ac;function Us(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}Us.prototype.set=function(t,r,e,s){const a=t*this.size+r;this.data[a]=e,s&&(this.reservedBit[a]=!0)};Us.prototype.get=function(t,r){return this.data[t*this.size+r]};Us.prototype.xor=function(t,r,e){this.data[t*this.size+r]^=e};Us.prototype.isReserved=function(t,r){return this.reservedBit[t*this.size+r]};var Vg=Us,ic={};(function(t){const r=Rt.getSymbolSize;t.getRowColCoords=function(s){if(s===1)return[];const a=Math.floor(s/7)+2,i=r(s),o=i===145?26:Math.ceil((i-13)/(2*a-2))*2,l=[i-7];for(let c=1;c<a-1;c++)l[c]=l[c-1]-o;return l.push(6),l.reverse()},t.getPositions=function(s){const a=[],i=t.getRowColCoords(s),o=i.length;for(let l=0;l<o;l++)for(let c=0;c<o;c++)l===0&&c===0||l===0&&c===o-1||l===o-1&&c===0||a.push([i[l],i[c]]);return a}})(ic);var oc={};const Xg=Rt.getSymbolSize,eo=7;oc.getPositions=function(r){const e=Xg(r);return[[0,0],[e-eo,0],[0,e-eo]]};var lc={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const r={N1:3,N2:3,N3:40,N4:10};t.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},t.from=function(a){return t.isValid(a)?parseInt(a,10):void 0},t.getPenaltyN1=function(a){const i=a.size;let o=0,l=0,c=0,d=null,h=null;for(let f=0;f<i;f++){l=c=0,d=h=null;for(let u=0;u<i;u++){let m=a.get(f,u);m===d?l++:(l>=5&&(o+=r.N1+(l-5)),d=m,l=1),m=a.get(u,f),m===h?c++:(c>=5&&(o+=r.N1+(c-5)),h=m,c=1)}l>=5&&(o+=r.N1+(l-5)),c>=5&&(o+=r.N1+(c-5))}return o},t.getPenaltyN2=function(a){const i=a.size;let o=0;for(let l=0;l<i-1;l++)for(let c=0;c<i-1;c++){const d=a.get(l,c)+a.get(l,c+1)+a.get(l+1,c)+a.get(l+1,c+1);(d===4||d===0)&&o++}return o*r.N2},t.getPenaltyN3=function(a){const i=a.size;let o=0,l=0,c=0;for(let d=0;d<i;d++){l=c=0;for(let h=0;h<i;h++)l=l<<1&2047|a.get(d,h),h>=10&&(l===1488||l===93)&&o++,c=c<<1&2047|a.get(h,d),h>=10&&(c===1488||c===93)&&o++}return o*r.N3},t.getPenaltyN4=function(a){let i=0;const o=a.data.length;for(let c=0;c<o;c++)i+=a.data[c];return Math.abs(Math.ceil(i*100/o/5)-10)*r.N4};function e(s,a,i){switch(s){case t.Patterns.PATTERN000:return(a+i)%2===0;case t.Patterns.PATTERN001:return a%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(a+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return a*i%2+a*i%3===0;case t.Patterns.PATTERN110:return(a*i%2+a*i%3)%2===0;case t.Patterns.PATTERN111:return(a*i%3+(a+i)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}t.applyMask=function(a,i){const o=i.size;for(let l=0;l<o;l++)for(let c=0;c<o;c++)i.isReserved(c,l)||i.xor(c,l,e(a,c,l))},t.getBestMask=function(a,i){const o=Object.keys(t.Patterns).length;let l=0,c=1/0;for(let d=0;d<o;d++){i(d),t.applyMask(d,a);const h=t.getPenaltyN1(a)+t.getPenaltyN2(a)+t.getPenaltyN3(a)+t.getPenaltyN4(a);t.applyMask(d,a),h<c&&(c=h,l=d)}return l}})(lc);var zn={};const fr=Mn,en=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],tn=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];zn.getBlocksCount=function(r,e){switch(e){case fr.L:return en[(r-1)*4+0];case fr.M:return en[(r-1)*4+1];case fr.Q:return en[(r-1)*4+2];case fr.H:return en[(r-1)*4+3];default:return}};zn.getTotalCodewordsCount=function(r,e){switch(e){case fr.L:return tn[(r-1)*4+0];case fr.M:return tn[(r-1)*4+1];case fr.Q:return tn[(r-1)*4+2];case fr.H:return tn[(r-1)*4+3];default:return}};var cc={},Un={};const _s=new Uint8Array(512),Sn=new Uint8Array(256);(function(){let r=1;for(let e=0;e<255;e++)_s[e]=r,Sn[r]=e,r<<=1,r&256&&(r^=285);for(let e=255;e<512;e++)_s[e]=_s[e-255]})();Un.log=function(r){if(r<1)throw new Error("log("+r+")");return Sn[r]};Un.exp=function(r){return _s[r]};Un.mul=function(r,e){return r===0||e===0?0:_s[Sn[r]+Sn[e]]};(function(t){const r=Un;t.mul=function(s,a){const i=new Uint8Array(s.length+a.length-1);for(let o=0;o<s.length;o++)for(let l=0;l<a.length;l++)i[o+l]^=r.mul(s[o],a[l]);return i},t.mod=function(s,a){let i=new Uint8Array(s);for(;i.length-a.length>=0;){const o=i[0];for(let c=0;c<a.length;c++)i[c]^=r.mul(a[c],o);let l=0;for(;l<i.length&&i[l]===0;)l++;i=i.slice(l)}return i},t.generateECPolynomial=function(s){let a=new Uint8Array([1]);for(let i=0;i<s;i++)a=t.mul(a,new Uint8Array([1,r.exp(i)]));return a}})(cc);const dc=cc;function Qa(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}Qa.prototype.initialize=function(r){this.degree=r,this.genPoly=dc.generateECPolynomial(this.degree)};Qa.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(r.length+this.degree);e.set(r);const s=dc.mod(e,this.genPoly),a=this.degree-s.length;if(a>0){const i=new Uint8Array(this.degree);return i.set(s,a),i}return s};var Kg=Qa,hc={},gr={},Za={};Za.isValid=function(r){return!isNaN(r)&&r>=1&&r<=40};var Yt={};const fc="[0-9]+",Yg="[A-Z $%*+\\-./:]+";let Rs="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Rs=Rs.replace(/u/g,"\\u");const qg="(?:(?![A-Z0-9 $%*+\\-./:]|"+Rs+`)(?:.|[\r
]))+`;Yt.KANJI=new RegExp(Rs,"g");Yt.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Yt.BYTE=new RegExp(qg,"g");Yt.NUMERIC=new RegExp(fc,"g");Yt.ALPHANUMERIC=new RegExp(Yg,"g");const Jg=new RegExp("^"+Rs+"$"),Qg=new RegExp("^"+fc+"$"),Zg=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Yt.testKanji=function(r){return Jg.test(r)};Yt.testNumeric=function(r){return Qg.test(r)};Yt.testAlphanumeric=function(r){return Zg.test(r)};(function(t){const r=Za,e=Yt;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!r.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return e.testNumeric(i)?t.NUMERIC:e.testAlphanumeric(i)?t.ALPHANUMERIC:e.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function s(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+a)}}t.from=function(i,o){if(t.isValid(i))return i;try{return s(i)}catch{return o}}})(gr);(function(t){const r=Rt,e=zn,s=Mn,a=gr,i=Za,o=7973,l=r.getBCHDigit(o);function c(u,m,p){for(let x=1;x<=40;x++)if(m<=t.getCapacity(x,p,u))return x}function d(u,m){return a.getCharCountIndicator(u,m)+4}function h(u,m){let p=0;return u.forEach(function(x){const g=d(x.mode,m);p+=g+x.getBitsLength()}),p}function f(u,m){for(let p=1;p<=40;p++)if(h(u,p)<=t.getCapacity(p,m,a.MIXED))return p}t.from=function(m,p){return i.isValid(m)?parseInt(m,10):p},t.getCapacity=function(m,p,x){if(!i.isValid(m))throw new Error("Invalid QR Code version");typeof x>"u"&&(x=a.BYTE);const g=r.getSymbolTotalCodewords(m),j=e.getTotalCodewordsCount(m,p),w=(g-j)*8;if(x===a.MIXED)return w;const _=w-d(x,m);switch(x){case a.NUMERIC:return Math.floor(_/10*3);case a.ALPHANUMERIC:return Math.floor(_/11*2);case a.KANJI:return Math.floor(_/13);case a.BYTE:default:return Math.floor(_/8)}},t.getBestVersionForData=function(m,p){let x;const g=s.from(p,s.M);if(Array.isArray(m)){if(m.length>1)return f(m,g);if(m.length===0)return 1;x=m[0]}else x=m;return c(x.mode,x.getLength(),g)},t.getEncodedBits=function(m){if(!i.isValid(m)||m<7)throw new Error("Invalid QR Code version");let p=m<<12;for(;r.getBCHDigit(p)-l>=0;)p^=o<<r.getBCHDigit(p)-l;return m<<12|p}})(hc);var uc={};const ya=Rt,xc=1335,ev=21522,to=ya.getBCHDigit(xc);uc.getEncodedBits=function(r,e){const s=r.bit<<3|e;let a=s<<10;for(;ya.getBCHDigit(a)-to>=0;)a^=xc<<ya.getBCHDigit(a)-to;return(s<<10|a)^ev};var mc={};const tv=gr;function Qr(t){this.mode=tv.NUMERIC,this.data=t.toString()}Qr.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)};Qr.prototype.getLength=function(){return this.data.length};Qr.prototype.getBitsLength=function(){return Qr.getBitsLength(this.data.length)};Qr.prototype.write=function(r){let e,s,a;for(e=0;e+3<=this.data.length;e+=3)s=this.data.substr(e,3),a=parseInt(s,10),r.put(a,10);const i=this.data.length-e;i>0&&(s=this.data.substr(e),a=parseInt(s,10),r.put(a,i*3+1))};var rv=Qr;const sv=gr,sa=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function Zr(t){this.mode=sv.ALPHANUMERIC,this.data=t}Zr.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)};Zr.prototype.getLength=function(){return this.data.length};Zr.prototype.getBitsLength=function(){return Zr.getBitsLength(this.data.length)};Zr.prototype.write=function(r){let e;for(e=0;e+2<=this.data.length;e+=2){let s=sa.indexOf(this.data[e])*45;s+=sa.indexOf(this.data[e+1]),r.put(s,11)}this.data.length%2&&r.put(sa.indexOf(this.data[e]),6)};var nv=Zr;const av=gr;function es(t){this.mode=av.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}es.getBitsLength=function(r){return r*8};es.prototype.getLength=function(){return this.data.length};es.prototype.getBitsLength=function(){return es.getBitsLength(this.data.length)};es.prototype.write=function(t){for(let r=0,e=this.data.length;r<e;r++)t.put(this.data[r],8)};var iv=es;const ov=gr,lv=Rt;function ts(t){this.mode=ov.KANJI,this.data=t}ts.getBitsLength=function(r){return r*13};ts.prototype.getLength=function(){return this.data.length};ts.prototype.getBitsLength=function(){return ts.getBitsLength(this.data.length)};ts.prototype.write=function(t){let r;for(r=0;r<this.data.length;r++){let e=lv.toSJIS(this.data[r]);if(e>=33088&&e<=40956)e-=33088;else if(e>=57408&&e<=60351)e-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);e=(e>>>8&255)*192+(e&255),t.put(e,13)}};var cv=ts,pc={exports:{}};(function(t){var r={single_source_shortest_paths:function(e,s,a){var i={},o={};o[s]=0;var l=r.PriorityQueue.make();l.push(s,0);for(var c,d,h,f,u,m,p,x,g;!l.empty();){c=l.pop(),d=c.value,f=c.cost,u=e[d]||{};for(h in u)u.hasOwnProperty(h)&&(m=u[h],p=f+m,x=o[h],g=typeof o[h]>"u",(g||x>p)&&(o[h]=p,l.push(h,p),i[h]=d))}if(typeof a<"u"&&typeof o[a]>"u"){var j=["Could not find a path from ",s," to ",a,"."].join("");throw new Error(j)}return i},extract_shortest_path_from_predecessor_list:function(e,s){for(var a=[],i=s;i;)a.push(i),e[i],i=e[i];return a.reverse(),a},find_path:function(e,s,a){var i=r.single_source_shortest_paths(e,s,a);return r.extract_shortest_path_from_predecessor_list(i,a)},PriorityQueue:{make:function(e){var s=r.PriorityQueue,a={},i;e=e||{};for(i in s)s.hasOwnProperty(i)&&(a[i]=s[i]);return a.queue=[],a.sorter=e.sorter||s.default_sorter,a},default_sorter:function(e,s){return e.cost-s.cost},push:function(e,s){var a={value:e,cost:s};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=r})(pc);var dv=pc.exports;(function(t){const r=gr,e=rv,s=nv,a=iv,i=cv,o=Yt,l=Rt,c=dv;function d(j){return unescape(encodeURIComponent(j)).length}function h(j,w,_){const T=[];let R;for(;(R=j.exec(_))!==null;)T.push({data:R[0],index:R.index,mode:w,length:R[0].length});return T}function f(j){const w=h(o.NUMERIC,r.NUMERIC,j),_=h(o.ALPHANUMERIC,r.ALPHANUMERIC,j);let T,R;return l.isKanjiModeEnabled()?(T=h(o.BYTE,r.BYTE,j),R=h(o.KANJI,r.KANJI,j)):(T=h(o.BYTE_KANJI,r.BYTE,j),R=[]),w.concat(_,T,R).sort(function(E,I){return E.index-I.index}).map(function(E){return{data:E.data,mode:E.mode,length:E.length}})}function u(j,w){switch(w){case r.NUMERIC:return e.getBitsLength(j);case r.ALPHANUMERIC:return s.getBitsLength(j);case r.KANJI:return i.getBitsLength(j);case r.BYTE:return a.getBitsLength(j)}}function m(j){return j.reduce(function(w,_){const T=w.length-1>=0?w[w.length-1]:null;return T&&T.mode===_.mode?(w[w.length-1].data+=_.data,w):(w.push(_),w)},[])}function p(j){const w=[];for(let _=0;_<j.length;_++){const T=j[_];switch(T.mode){case r.NUMERIC:w.push([T,{data:T.data,mode:r.ALPHANUMERIC,length:T.length},{data:T.data,mode:r.BYTE,length:T.length}]);break;case r.ALPHANUMERIC:w.push([T,{data:T.data,mode:r.BYTE,length:T.length}]);break;case r.KANJI:w.push([T,{data:T.data,mode:r.BYTE,length:d(T.data)}]);break;case r.BYTE:w.push([{data:T.data,mode:r.BYTE,length:d(T.data)}])}}return w}function x(j,w){const _={},T={start:{}};let R=["start"];for(let z=0;z<j.length;z++){const E=j[z],I=[];for(let D=0;D<E.length;D++){const P=E[D],U=""+z+D;I.push(U),_[U]={node:P,lastCount:0},T[U]={};for(let H=0;H<R.length;H++){const ee=R[H];_[ee]&&_[ee].node.mode===P.mode?(T[ee][U]=u(_[ee].lastCount+P.length,P.mode)-u(_[ee].lastCount,P.mode),_[ee].lastCount+=P.length):(_[ee]&&(_[ee].lastCount=P.length),T[ee][U]=u(P.length,P.mode)+4+r.getCharCountIndicator(P.mode,w))}}R=I}for(let z=0;z<R.length;z++)T[R[z]].end=0;return{map:T,table:_}}function g(j,w){let _;const T=r.getBestModeForData(j);if(_=r.from(w,T),_!==r.BYTE&&_.bit<T.bit)throw new Error('"'+j+'" cannot be encoded with mode '+r.toString(_)+`.
 Suggested mode is: `+r.toString(T));switch(_===r.KANJI&&!l.isKanjiModeEnabled()&&(_=r.BYTE),_){case r.NUMERIC:return new e(j);case r.ALPHANUMERIC:return new s(j);case r.KANJI:return new i(j);case r.BYTE:return new a(j)}}t.fromArray=function(w){return w.reduce(function(_,T){return typeof T=="string"?_.push(g(T,null)):T.data&&_.push(g(T.data,T.mode)),_},[])},t.fromString=function(w,_){const T=f(w,l.isKanjiModeEnabled()),R=p(T),z=x(R,_),E=c.find_path(z.map,"start","end"),I=[];for(let D=1;D<E.length-1;D++)I.push(z.table[E[D]].node);return t.fromArray(m(I))},t.rawSplit=function(w){return t.fromArray(f(w,l.isKanjiModeEnabled()))}})(mc);const $n=Rt,na=Mn,hv=Gg,fv=Vg,uv=ic,xv=oc,ba=lc,wa=zn,mv=Kg,Nn=hc,pv=uc,gv=gr,aa=mc;function vv(t,r){const e=t.size,s=xv.getPositions(r);for(let a=0;a<s.length;a++){const i=s[a][0],o=s[a][1];for(let l=-1;l<=7;l++)if(!(i+l<=-1||e<=i+l))for(let c=-1;c<=7;c++)o+c<=-1||e<=o+c||(l>=0&&l<=6&&(c===0||c===6)||c>=0&&c<=6&&(l===0||l===6)||l>=2&&l<=4&&c>=2&&c<=4?t.set(i+l,o+c,!0,!0):t.set(i+l,o+c,!1,!0))}}function yv(t){const r=t.size;for(let e=8;e<r-8;e++){const s=e%2===0;t.set(e,6,s,!0),t.set(6,e,s,!0)}}function bv(t,r){const e=uv.getPositions(r);for(let s=0;s<e.length;s++){const a=e[s][0],i=e[s][1];for(let o=-2;o<=2;o++)for(let l=-2;l<=2;l++)o===-2||o===2||l===-2||l===2||o===0&&l===0?t.set(a+o,i+l,!0,!0):t.set(a+o,i+l,!1,!0)}}function wv(t,r){const e=t.size,s=Nn.getEncodedBits(r);let a,i,o;for(let l=0;l<18;l++)a=Math.floor(l/3),i=l%3+e-8-3,o=(s>>l&1)===1,t.set(a,i,o,!0),t.set(i,a,o,!0)}function ia(t,r,e){const s=t.size,a=pv.getEncodedBits(r,e);let i,o;for(i=0;i<15;i++)o=(a>>i&1)===1,i<6?t.set(i,8,o,!0):i<8?t.set(i+1,8,o,!0):t.set(s-15+i,8,o,!0),i<8?t.set(8,s-i-1,o,!0):i<9?t.set(8,15-i-1+1,o,!0):t.set(8,15-i-1,o,!0);t.set(s-8,8,1,!0)}function _v(t,r){const e=t.size;let s=-1,a=e-1,i=7,o=0;for(let l=e-1;l>0;l-=2)for(l===6&&l--;;){for(let c=0;c<2;c++)if(!t.isReserved(a,l-c)){let d=!1;o<r.length&&(d=(r[o]>>>i&1)===1),t.set(a,l-c,d),i--,i===-1&&(o++,i=7)}if(a+=s,a<0||e<=a){a-=s,s=-s;break}}}function Sv(t,r,e){const s=new hv;e.forEach(function(c){s.put(c.mode.bit,4),s.put(c.getLength(),gv.getCharCountIndicator(c.mode,t)),c.write(s)});const a=$n.getSymbolTotalCodewords(t),i=wa.getTotalCodewordsCount(t,r),o=(a-i)*8;for(s.getLengthInBits()+4<=o&&s.put(0,4);s.getLengthInBits()%8!==0;)s.putBit(0);const l=(o-s.getLengthInBits())/8;for(let c=0;c<l;c++)s.put(c%2?17:236,8);return Nv(s,t,r)}function Nv(t,r,e){const s=$n.getSymbolTotalCodewords(r),a=wa.getTotalCodewordsCount(r,e),i=s-a,o=wa.getBlocksCount(r,e),l=s%o,c=o-l,d=Math.floor(s/o),h=Math.floor(i/o),f=h+1,u=d-h,m=new mv(u);let p=0;const x=new Array(o),g=new Array(o);let j=0;const w=new Uint8Array(t.buffer);for(let E=0;E<o;E++){const I=E<c?h:f;x[E]=w.slice(p,p+I),g[E]=m.encode(x[E]),p+=I,j=Math.max(j,I)}const _=new Uint8Array(s);let T=0,R,z;for(R=0;R<j;R++)for(z=0;z<o;z++)R<x[z].length&&(_[T++]=x[z][R]);for(R=0;R<u;R++)for(z=0;z<o;z++)_[T++]=g[z][R];return _}function jv(t,r,e,s){let a;if(Array.isArray(t))a=aa.fromArray(t);else if(typeof t=="string"){let d=r;if(!d){const h=aa.rawSplit(t);d=Nn.getBestVersionForData(h,e)}a=aa.fromString(t,d||40)}else throw new Error("Invalid data");const i=Nn.getBestVersionForData(a,e);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!r)r=i;else if(r<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=Sv(r,e,a),l=$n.getSymbolSize(r),c=new fv(l);return vv(c,r),yv(c),bv(c,r),ia(c,e,0),r>=7&&wv(c,r),_v(c,o),isNaN(s)&&(s=ba.getBestMask(c,ia.bind(null,c,e))),ba.applyMask(s,c),ia(c,e,s),{modules:c,version:r,errorCorrectionLevel:e,maskPattern:s,segments:a}}nc.create=function(r,e){if(typeof r>"u"||r==="")throw new Error("No input text");let s=na.M,a,i;return typeof e<"u"&&(s=na.from(e.errorCorrectionLevel,na.M),a=Nn.from(e.version),i=ba.from(e.maskPattern),e.toSJISFunc&&$n.setToSJISFunction(e.toSJISFunc)),jv(r,a,s,i)};var gc={},ei={};(function(t){function r(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let s=e.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+e);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(i){return[i,i]}))),s.length===6&&s.push("F","F");const a=parseInt(s.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+s.slice(0,6).join("")}}t.getOptions=function(s){s||(s={}),s.color||(s.color={});const a=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,i=s.width&&s.width>=21?s.width:void 0,o=s.scale||4;return{width:i,scale:i?4:o,margin:a,color:{dark:r(s.color.dark||"#000000ff"),light:r(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},t.getScale=function(s,a){return a.width&&a.width>=s+a.margin*2?a.width/(s+a.margin*2):a.scale},t.getImageWidth=function(s,a){const i=t.getScale(s,a);return Math.floor((s+a.margin*2)*i)},t.qrToImageData=function(s,a,i){const o=a.modules.size,l=a.modules.data,c=t.getScale(o,i),d=Math.floor((o+i.margin*2)*c),h=i.margin*c,f=[i.color.light,i.color.dark];for(let u=0;u<d;u++)for(let m=0;m<d;m++){let p=(u*d+m)*4,x=i.color.light;if(u>=h&&m>=h&&u<d-h&&m<d-h){const g=Math.floor((u-h)/c),j=Math.floor((m-h)/c);x=f[l[g*o+j]?1:0]}s[p++]=x.r,s[p++]=x.g,s[p++]=x.b,s[p]=x.a}}})(ei);(function(t){const r=ei;function e(a,i,o){a.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,o,l){let c=l,d=o;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),o||(d=s()),c=r.getOptions(c);const h=r.getImageWidth(i.modules.size,c),f=d.getContext("2d"),u=f.createImageData(h,h);return r.qrToImageData(u.data,i,c),e(f,d,h),f.putImageData(u,0,0),d},t.renderToDataURL=function(i,o,l){let c=l;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),c||(c={});const d=t.render(i,o,c),h=c.type||"image/png",f=c.rendererOpts||{};return d.toDataURL(h,f.quality)}})(gc);var vc={};const Ev=ei;function ro(t,r){const e=t.a/255,s=r+'="'+t.hex+'"';return e<1?s+" "+r+'-opacity="'+e.toFixed(2).slice(1)+'"':s}function oa(t,r,e){let s=t+r;return typeof e<"u"&&(s+=" "+e),s}function Tv(t,r,e){let s="",a=0,i=!1,o=0;for(let l=0;l<t.length;l++){const c=Math.floor(l%r),d=Math.floor(l/r);!c&&!i&&(i=!0),t[l]?(o++,l>0&&c>0&&t[l-1]||(s+=i?oa("M",c+e,.5+d+e):oa("m",a,0),a=0,i=!1),c+1<r&&t[l+1]||(s+=oa("h",o),o=0)):a++}return s}vc.render=function(r,e,s){const a=Ev.getOptions(e),i=r.modules.size,o=r.modules.data,l=i+a.margin*2,c=a.color.light.a?"<path "+ro(a.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",d="<path "+ro(a.color.dark,"stroke")+' d="'+Tv(o,i,a.margin)+'"/>',h='viewBox="0 0 '+l+" "+l+'"',u='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+h+' shape-rendering="crispEdges">'+c+d+`</svg>
`;return typeof s=="function"&&s(null,u),u};const Cv=Hg,_a=nc,yc=gc,kv=vc;function ti(t,r,e,s,a){const i=[].slice.call(arguments,1),o=i.length,l=typeof i[o-1]=="function";if(!l&&!Cv())throw new Error("Callback required as last argument");if(l){if(o<2)throw new Error("Too few arguments provided");o===2?(a=e,e=r,r=s=void 0):o===3&&(r.getContext&&typeof a>"u"?(a=s,s=void 0):(a=s,s=e,e=r,r=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(e=r,r=s=void 0):o===2&&!r.getContext&&(s=e,e=r,r=void 0),new Promise(function(c,d){try{const h=_a.create(e,s);c(t(h,r,s))}catch(h){d(h)}})}try{const c=_a.create(e,s);a(null,t(c,r,s))}catch(c){a(c)}}zs.create=_a.create;zs.toCanvas=ti.bind(null,yc.render);zs.toDataURL=ti.bind(null,yc.renderToDataURL);zs.toString=ti.bind(null,function(t,r,e){return kv.render(t,e)});function Av({user:t,onBack:r}){const[e,s]=B.useState([]),[a,i]=B.useState(null),[o,l]=B.useState(!0),[c,d]=B.useState(!1),[h,f]=B.useState(null),[u,m]=B.useState(!1),[p,x]=B.useState(""),g=B.useRef(null),j=t?.name||"사용자",w=t?.branch||"지점",_=t?.referral_code||"LAS0000",T=a?`${a.landing_url}?ref=${_}`:p||`https://lasmanager.vercel.app/event?ref=${_}`;B.useEffect(()=>{R();try{const D=localStorage.getItem(`lastQRLink_${t?.id}`);if(D){const P=JSON.parse(D);x(P.url||"")}}catch(D){console.log("링크 불러오기 실패:",D)}},[]);const R=async()=>{try{l(!0);const{data:D,error:P}=await ue.from("events").select("*").eq("status","active").order("created_at",{ascending:!1});if(P)throw P;s(D||[])}catch(D){console.error("이벤트 조회 실패:",D)}finally{l(!1)}},z=async D=>{try{d(!0),console.log("🎨 QR 코드 생성 시작");const P=g.current;if(!P)throw new Error("Canvas not found");const U=P.getContext("2d"),H=new Image;H.crossOrigin="anonymous",await new Promise((y,F)=>{H.onload=y,H.onerror=F,H.src=D.template_image_url}),console.log("✅ 템플릿 이미지 로드:",H.width,"x",H.height),P.width=H.width,P.height=H.height,U.drawImage(H,0,0);const ee=await zs.toDataURL(T,{width:1e3,margin:1,color:{dark:"#000000",light:"#FFFFFF"}}),pe=new Image;await new Promise((y,F)=>{pe.onload=y,pe.onerror=F,pe.src=ee});const ge=D.qr_position,je=ge.x/100*P.width,_e=ge.y/100*P.height,ke=ge.width/100*P.width,de=ge.height/100*P.height;console.log("📍 QR 그리기:",{qrX:je,qrY:_e,qrWidth:ke,qrHeight:de}),U.drawImage(pe,je,_e,ke,de);const me=P.toDataURL("image/png");f(me),i(D);const Se=`${D.landing_url}?ref=${_}`;try{const y={url:Se,eventId:D.id,eventName:D.name,timestamp:new Date().toISOString()};localStorage.setItem(`lastQRLink_${t?.id}`,JSON.stringify(y)),x(Se)}catch(y){console.log("링크 저장 실패:",y)}console.log("✅ QR 이미지 생성 완료")}catch(P){console.error("QR 생성 실패:",P),alert("QR 코드 생성에 실패했습니다.")}finally{d(!1)}},E=()=>{if(!h)return;const D=document.createElement("a");D.href=h,D.download=`내QR페이지_${_}.png`,document.body.appendChild(D),D.click(),document.body.removeChild(D)},I=()=>{navigator.clipboard.writeText(T),m(!0),setTimeout(()=>m(!1),2e3)};return n.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-cyan-50 p-2 sm:p-2",children:[n.jsxs("div",{className:"max-w-md mx-auto",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-2 sm:p-2 mb-2 sm:mb-3",style:{borderRadius:"15px"},children:[n.jsxs("div",{className:"grid grid-cols-3 items-center mb-2",children:[n.jsx("div",{className:"flex justify-start",children:n.jsxs("button",{onClick:()=>{a?(i(null),f(null)):r()},className:"flex items-center gap-1.5 font-bold hover:opacity-70 transition-opacity text-sm sm:text-base",style:{color:"#4A9B8E"},children:[n.jsx(Ot,{size:18,className:"sm:w-5 sm:h-5"}),"나가기"]})}),n.jsxs("div",{className:"flex items-center justify-center gap-1.5 sm:gap-2",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-8 h-8 sm:w-10 sm:h-10 object-contain",onError:D=>D.target.style.display="none"}),n.jsx("h1",{className:"text-base sm:text-lg font-bold",style:{color:"#249689",whiteSpace:"nowrap"},children:"내 QR페이지 만들기"})]}),n.jsx("div",{})]}),n.jsx("div",{className:"p-2 rounded-lg text-center",style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:"10px"},children:n.jsx("p",{className:"text-xs font-medium",style:{color:"#1e40af"},children:a?"🎉 주천 링크가 생성되었습니다!":"🎨 템플릿을 선택하고 나만의 QR 페이지를 만드세요"})}),!a&&n.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg space-y-3",style:{borderRadius:"10px"},children:[n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-x-6 gap-y-2 text-sm font-medium text-gray-700 px-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-gray-600",children:"👤 이름:"}),n.jsx("span",{className:"font-bold text-gray-900",children:j})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-gray-600",children:"🏢 지점:"}),n.jsx("span",{className:"font-bold text-gray-900",children:w})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-gray-600",children:"🔖 고유번호:"}),n.jsx("span",{className:"font-mono font-bold text-gray-900",children:_})]})]}),n.jsxs("div",{className:"flex gap-2",style:{width:"100%"},children:[n.jsx("input",{type:"text",value:T,readOnly:!0,className:"flex-1 px-3 py-2 text-xs bg-white border border-gray-300 rounded-lg",style:{borderRadius:"8px",minWidth:0},placeholder:"내 주천 링크"}),n.jsx("button",{onClick:I,className:"flex items-center gap-1 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-all text-xs font-medium whitespace-nowrap",style:{backgroundColor:u?"#10B981":"#4A9B8E",borderRadius:"8px"},children:u?n.jsxs(n.Fragment,{children:[n.jsx(la,{size:14}),n.jsx("span",{children:"복사됨"})]}):n.jsxs(n.Fragment,{children:[n.jsx(ii,{size:14}),n.jsx("span",{children:"복사"})]})})]})]})]}),n.jsx("div",{className:"bg-white rounded-xl shadow-lg p-2 sm:p-2",style:{borderRadius:"15px"},children:o?n.jsx("div",{className:"flex justify-center items-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2",style:{borderColor:"#4A9B8E"}})}):a?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[n.jsx("h2",{className:"text-base sm:text-lg font-bold",style:{color:"#4A9B8E"},children:"🎉 내 QR 페이지"}),n.jsx("button",{onClick:()=>{i(null),f(null)},className:"text-xs text-gray-600 hover:text-gray-900 font-medium",children:"← 다른 템플릿 선택"})]}),c?n.jsxs("div",{className:"text-center py-2 sm:py-6",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 sm:h-10 sm:w-10 border-b-2 mx-auto mb-2",style:{borderColor:"#4A9B8E"}}),n.jsx("p",{className:"text-sm sm:text-base text-gray-600 font-medium",children:"QR 이미지 생성 중..."}),n.jsx("p",{className:"text-xs text-gray-400 mt-2",children:"잠시만 기다려주세요"})]}):h?n.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[n.jsx("div",{className:"border-4 rounded-xl overflow-hidden shadow-lg",style:{borderColor:"#4A9B8E",borderRadius:"12px"},children:n.jsx("img",{src:h,alt:"내 QR 페이지",className:"w-full h-auto",style:{maxWidth:"300px",margin:"0 auto"}})}),n.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg",style:{borderRadius:"10px"},children:n.jsxs("div",{className:"text-sm space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"👤 이름"}),n.jsx("span",{className:"font-medium",children:j})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"🏢 지점"}),n.jsx("span",{className:"font-medium",children:w})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:"🔖 고유번호"}),n.jsx("span",{className:"font-mono font-medium",children:_})]})]})}),n.jsxs("button",{onClick:E,className:"w-full py-2 flex items-center justify-center gap-2 text-white rounded-xl hover:opacity-90 font-bold text-base sm:text-lg shadow-lg hover:shadow-xl transition-all",style:{backgroundColor:"#5B9BD5",borderRadius:"12px"},children:[n.jsx(Er,{size:22}),"내 QR페이지 저장"]}),n.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-200",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"🔗 내 주천 링크"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:T,readOnly:!0,className:"flex-1 px-3 py-2 text-xs bg-gray-50 border border-gray-300 rounded-lg",style:{borderRadius:"8px"}}),n.jsxs("button",{onClick:I,className:"flex items-center gap-1.5 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-all text-sm font-medium",style:{backgroundColor:u?"#10B981":"#4A9B8E",borderRadius:"8px"},children:[u?n.jsx(la,{size:16}):n.jsx(ii,{size:16}),u?"복사됨":"복사"]})]})]}),n.jsxs("div",{className:"p-2 bg-yellow-50 rounded-lg border border-yellow-200",style:{borderRadius:"8px"},children:[n.jsx("p",{className:"text-xs text-yellow-800 font-medium mb-1",children:"💡 사용 방법:"}),n.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1 ml-4",children:[n.jsx("li",{children:"• QR 페이지를 생성하여 이미지로 전달하거나"}),n.jsx("li",{children:"• 참가자가 QR 코드를 스캔하면 자동으로 내 고유코드로 연결됩니다"}),n.jsx("li",{children:"• 링크를 복사해 카톡/문자로 전달할 수도 있습니다"})]})]})]})]}):null]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[n.jsx("h2",{className:"text-base sm:text-lg font-bold",style:{color:"#4A9B8E"},children:"📋 템플릿 선택하기"}),e.length>0&&n.jsxs("span",{className:"text-xs text-gray-500",children:["총 ",e.length,"개"]})]}),e.length===0?n.jsxs("div",{className:"text-center py-16 sm:py-8",children:[n.jsx("div",{className:"text-5xl sm:text-6xl mb-2",children:"📅"}),n.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-2",children:"활성화된 템플릿이 없습니다"}),n.jsx("p",{className:"text-xs text-gray-400",children:"관리자에게 문의해주세요"})]}):n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 sm:gap-2",children:e.map(D=>n.jsxs("div",{onClick:()=>z(D),className:"group cursor-pointer border-2 rounded-xl overflow-hidden hover:shadow-xl hover:scale-105 transition-all duration-300",style:{borderColor:"#E0E0E0",borderRadius:"12px"},children:[D.template_image_url&&n.jsxs("div",{className:"relative overflow-hidden",style:{backgroundColor:"#f5f5f5"},children:[n.jsx("img",{src:D.template_image_url,alt:D.name,className:"w-full h-auto object-cover group-hover:opacity-90 transition-opacity",style:{maxHeight:"100px"}}),n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center",children:n.jsx("span",{className:"text-white font-bold text-sm sm:text-base opacity-0 group-hover:opacity-100 transition-opacity bg-black bg-opacity-50 px-4 py-2 rounded-lg",children:"선택하기"})})]}),n.jsxs("div",{className:"p-2 sm:p-2",children:[n.jsx("h3",{className:"font-bold mb-1 text-sm sm:text-base",style:{color:"#249689"},children:D.name}),D.description&&n.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:D.description})]})]},D.id))})]})})]}),n.jsx("canvas",{ref:g,style:{display:"none"}})]})}function Rv(){const[t,r]=B.useState(""),[e,s]=B.useState(!1),a=so(),i=c=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c),o=()=>{document.getElementById("subscribe")?.scrollIntoView({behavior:"smooth",block:"start"})},l=c=>{c.preventDefault();const d=t.trim();if(!i(d)){alert("올바른 이메일 주소를 입력해주세요.");return}localStorage.setItem("mathLetterEmail",d);const f=new URLSearchParams(window.location.search).get("ref");a(f?`/event?ref=${encodeURIComponent(f)}`:"/event")};return n.jsxs("div",{style:{fontFamily:"'Noto Sans KR', sans-serif"},children:[n.jsx("style",{children:`
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        :root {
          --primary: #2D7C8E;
          --primary-light: #4BA5B8;
          --primary-dark: #1E5A6A;
          --accent: #5CC0CE;
          --accent-light: #8FD9E3;
          --text-dark: #1a1a1a;
          --text-gray: #4a4a4a;
          --text-light: #6a6a6a;
          --bg-light: #f8fafb;
          --bg-white: #ffffff;
          --gradient-1: linear-gradient(135deg, #2D7C8E 0%, #4BA5B8 100%);
          --gradient-2: linear-gradient(135deg, #5CC0CE 0%, #8FD9E3 100%);
          --shadow-sm: 0 2px 8px rgba(45, 124, 142, 0.08);
          --shadow-md: 0 4px 16px rgba(45, 124, 142, 0.12);
          --shadow-lg: 0 8px 32px rgba(45, 124, 142, 0.16);
        }

        body {
          color: var(--text-dark);
          line-height: 1.7;
          overflow-x: hidden;
          background: var(--bg-white);
        }

        .container {
          max-width: 1200px;
          margin: 0 auto;
          padding: 0 24px;
        }

        /* Navigation */
        .navbar {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          background: rgba(255, 255, 255, 0.95);
          backdrop-filter: blur(10px);
          box-shadow: var(--shadow-sm);
          z-index: 1000;
          transition: all 0.3s ease;
        }

        .nav-content {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 16px 0;
        }

        .logo {
          display: flex;
          align-items: center;
          gap: 12px;
          text-decoration: none;
          color: var(--text-dark);
          font-weight: 700;
          font-size: 1.25rem;
          transition: transform 0.3s ease;
          cursor: pointer;
        }

        .logo:hover {
          transform: translateY(-2px);
        }

        .logo img {
          height: 40px;
          width: auto;
        }

        .cta-btn-nav {
          background: var(--gradient-1);
          color: white;
          border: none;
          padding: 12px 28px;
          border-radius: 50px;
          font-weight: 600;
          font-size: 0.95rem;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: var(--shadow-sm);
        }

        .cta-btn-nav:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        /* Hero Section */
        .hero {
          position: relative;
          min-height: 100vh;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 120px 0 80px;
          overflow: hidden;
          background: linear-gradient(135deg, #f8fafb 0%, #e8f4f7 100%);
        }

        .hero-background {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          overflow: hidden;
          z-index: 0;
        }

        .floating-shape {
          position: absolute;
          border-radius: 50%;
          opacity: 0.1;
          animation: float 20s infinite ease-in-out;
        }

        .shape-1 {
          width: 400px;
          height: 400px;
          background: var(--gradient-1);
          top: -100px;
          right: -100px;
          animation-delay: 0s;
        }

        .shape-2 {
          width: 300px;
          height: 300px;
          background: var(--gradient-2);
          bottom: -50px;
          left: -50px;
          animation-delay: 7s;
        }

        .shape-3 {
          width: 200px;
          height: 200px;
          background: var(--accent);
          top: 50%;
          left: 10%;
          animation-delay: 14s;
        }

        @keyframes float {
          0%, 100% { transform: translate(0, 0) rotate(0deg); }
          33% { transform: translate(30px, -30px) rotate(120deg); }
          66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        .hero-content {
          position: relative;
          z-index: 1;
          text-align: center;
          max-width: 800px;
          margin: 0 auto;
          animation: fadeInUp 1s ease-out;
        }

        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .hero-title {
          font-family: 'Playfair Display', serif;
          font-size: 3.5rem;
          font-weight: 700;
          line-height: 1.2;
          margin-bottom: 24px;
          color: var(--text-dark);
        }

        .hero-title .highlight {
          background: var(--gradient-1);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
        }

        .hero-subtitle {
          font-size: 1.25rem;
          line-height: 1.8;
          color: var(--text-gray);
          margin-bottom: 40px;
        }

        .hero-subtitle strong {
          color: var(--primary);
          font-weight: 700;
        }

        .cta-btn-primary {
          background: var(--gradient-1);
          color: white;
          border: none;
          padding: 18px 48px;
          border-radius: 50px;
          font-size: 1.15rem;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: var(--shadow-md);
          display: inline-flex;
          align-items: center;
          gap: 12px;
        }

        .cta-btn-primary:hover {
          transform: translateY(-3px);
          box-shadow: var(--shadow-lg);
        }

        .hero-note {
          margin-top: 20px;
          font-size: 0.95rem;
          color: var(--text-light);
        }

        .scroll-indicator {
          position: absolute;
          bottom: 40px;
          left: 50%;
          transform: translateX(-50%);
          animation: bounce 2s infinite;
          color: var(--primary);
          font-size: 1.5rem;
          cursor: pointer;
        }

        @keyframes bounce {
          0%, 100% { transform: translate(-50%, 0); }
          50% { transform: translate(-50%, 10px); }
        }

        /* Section Styles */
        section {
          padding: 100px 0;
        }

        .section-header {
          text-align: center;
          margin-bottom: 60px;
        }

        .section-title {
          font-family: 'Playfair Display', serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text-dark);
          margin-bottom: 16px;
          position: relative;
          display: inline-block;
        }

        .section-title::after {
          content: '';
          position: absolute;
          bottom: -10px;
          left: 50%;
          transform: translateX(-50%);
          width: 60px;
          height: 4px;
          background: var(--gradient-1);
          border-radius: 2px;
        }

        /* About Section */
        .about {
          background: var(--bg-white);
        }

        .about-content {
          max-width: 900px;
          margin: 0 auto;
        }

        .lead-text {
          font-size: 1.2rem;
          line-height: 1.9;
          color: var(--text-gray);
          text-align: center;
          margin-bottom: 60px;
        }

        .lead-text strong {
          color: var(--primary);
          font-weight: 700;
        }

        .about-features {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 40px;
        }

        .feature-item {
          display: flex;
          align-items: flex-start;
          gap: 20px;
          padding: 30px;
          background: var(--bg-light);
          border-radius: 16px;
          transition: all 0.3s ease;
        }

        .feature-item:hover {
          transform: translateY(-5px);
          box-shadow: var(--shadow-md);
        }

        .feature-icon {
          font-size: 3rem;
          flex-shrink: 0;
        }

        .feature-text h3 {
          font-size: 1.15rem;
          font-weight: 700;
          color: var(--primary);
          margin-bottom: 8px;
        }

        .feature-text p {
          color: var(--text-gray);
          line-height: 1.6;
        }

        /* Why Section */
        .why {
          background: var(--bg-light);
        }

        .why-content {
          display: grid;
          grid-template-columns: 1fr 1.2fr;
          gap: 60px;
          align-items: center;
        }

        .why-visual {
          position: relative;
        }

        .pattern-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 12px;
          padding: 20px;
          background: white;
          border-radius: 20px;
          box-shadow: var(--shadow-md);
          max-width: 280px;
          margin: 0 auto;
        }

        .pattern-item {
          font-size: 2.5rem;
          text-align: center;
          padding: 12px;
          background: var(--bg-light);
          border-radius: 12px;
          transition: transform 0.3s ease;
        }

        .pattern-item:hover {
          transform: scale(1.1) rotate(5deg);
        }

        .why-text {
          padding: 20px;
        }

        .why-lead {
          font-size: 1.15rem;
          color: var(--text-gray);
          margin-bottom: 24px;
        }

        .why-emphasis {
          font-size: 1.5rem;
          line-height: 1.6;
          color: var(--text-dark);
          margin-bottom: 24px;
        }

        .highlight-text {
          background: var(--gradient-1);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          font-weight: 700;
        }

        .why-description {
          font-size: 1.1rem;
          line-height: 1.8;
          color: var(--text-gray);
        }

        .why-description strong {
          color: var(--primary);
          font-weight: 700;
        }

        /* How Section */
        .how {
          background: var(--bg-white);
        }

        .how-steps {
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 30px;
          flex-wrap: wrap;
        }

        .step-item {
          flex: 1;
          min-width: 250px;
          max-width: 300px;
          padding: 40px 30px;
          text-align: center;
          background: var(--bg-light);
          border-radius: 20px;
          position: relative;
          transition: all 0.3s ease;
        }

        .step-item:hover {
          transform: translateY(-10px);
          box-shadow: var(--shadow-lg);
          background: white;
        }

        .step-number {
          position: absolute;
          top: -20px;
          left: 50%;
          transform: translateX(-50%);
          width: 50px;
          height: 50px;
          background: var(--gradient-1);
          color: white;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 1.5rem;
          font-weight: 700;
          box-shadow: var(--shadow-md);
        }

        .step-icon {
          font-size: 3rem;
          color: var(--primary);
          margin: 20px 0;
        }

        .step-item h3 {
          font-size: 1.2rem;
          font-weight: 700;
          color: var(--text-dark);
          margin-bottom: 12px;
        }

        .step-item p {
          color: var(--text-gray);
          line-height: 1.6;
        }

        .step-arrow {
          font-size: 2rem;
          color: var(--accent);
          flex-shrink: 0;
        }

        /* Social Proof Section */
        .social-proof {
          background: linear-gradient(135deg, #2D7C8E 0%, #4BA5B8 100%);
          color: white;
        }

        .social-proof .section-title {
          color: white;
        }

        .social-proof .section-title::after {
          background: white;
        }

        .testimonials {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 30px;
          margin-bottom: 60px;
        }

        .testimonial-item {
          background: rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(10px);
          padding: 40px 30px;
          border-radius: 20px;
          border: 1px solid rgba(255, 255, 255, 0.2);
          transition: all 0.3s ease;
        }

        .testimonial-item:hover {
          transform: translateY(-5px);
          background: rgba(255, 255, 255, 0.15);
        }

        .quote-icon {
          font-size: 4rem;
          font-family: Georgia, serif;
          color: var(--accent-light);
          line-height: 1;
          margin-bottom: 16px;
        }

        .testimonial-text {
          font-size: 1.3rem;
          line-height: 1.6;
          margin-bottom: 16px;
        }

        .testimonial-author {
          font-size: 1.1rem;
          color: var(--accent-light);
        }

        .stats {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 30px;
          padding: 40px;
          background: rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(10px);
          border-radius: 20px;
          border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-item {
          text-align: center;
        }

        .stat-number {
          font-size: 3rem;
          font-weight: 700;
          margin-bottom: 8px;
        }

        .stat-label {
          font-size: 1rem;
          color: var(--accent-light);
        }

        .stat-divider {
          display: none;
        }

        /* Final CTA Section */
        .final-cta {
          background: var(--bg-light);
          padding: 120px 0;
        }

        .cta-content {
          max-width: 900px;
          margin: 0 auto;
          display: grid;
          grid-template-columns: auto 1fr;
          gap: 60px;
          align-items: center;
        }

        .cta-visual {
          display: flex;
          justify-content: center;
          align-items: center;
        }

        .envelope-icon {
          width: 150px;
          height: 150px;
          background: var(--gradient-1);
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: var(--shadow-lg);
          animation: pulse 2s infinite;
        }

        .envelope-icon i {
          font-size: 4rem;
          color: white;
        }

        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }

        .cta-title {
          font-family: 'Playfair Display', serif;
          font-size: 2rem;
          font-weight: 700;
          line-height: 1.4;
          color: var(--text-dark);
          margin-bottom: 20px;
        }

        .cta-subtitle {
          font-size: 1.15rem;
          line-height: 1.8;
          color: var(--text-gray);
          margin-bottom: 40px;
        }

        .cta-subtitle strong {
          color: var(--primary);
          font-weight: 700;
        }

        /* Subscribe Form */
        .subscribe-form {
          margin-top: 40px;
        }

        .form-group {
          display: flex;
          gap: 12px;
          margin-bottom: 16px;
        }

        .email-input {
          flex: 1;
          padding: 16px 24px;
          border: 2px solid #e0e0e0;
          border-radius: 50px;
          font-size: 1rem;
          font-family: 'Noto Sans KR', sans-serif;
          transition: all 0.3s ease;
        }

        .email-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 4px rgba(45, 124, 142, 0.1);
        }

        .submit-btn {
          background: var(--gradient-1);
          color: white;
          border: none;
          padding: 16px 36px;
          border-radius: 50px;
          font-size: 1rem;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: var(--shadow-md);
          display: inline-flex;
          align-items: center;
          gap: 10px;
          white-space: nowrap;
        }

        .submit-btn:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-lg);
        }

        .form-note {
          font-size: 0.85rem;
          color: var(--text-light);
          display: flex;
          align-items: center;
          gap: 8px;
        }

        .form-note i {
          color: var(--primary);
        }

        /* Footer */
        .footer {
          background: var(--text-dark);
          color: white;
          padding: 60px 0;
        }

        .footer-content {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 24px;
          text-align: center;
        }

        .footer-logo {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 12px;
        }

        .footer-logo img {
          height: 50px;
          width: auto;
        }

        .footer-logo p {
          font-size: 1.1rem;
          font-weight: 600;
        }

        .footer-info {
          color: rgba(255, 255, 255, 0.7);
        }

        .footer-info p {
          margin: 8px 0;
          font-size: 0.95rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
          .why-content {
            grid-template-columns: 1fr;
            gap: 40px;
          }

          .step-arrow {
            display: none;
          }
        }

        @media (max-width: 768px) {
          .hero-title {
            font-size: 2.5rem;
          }

          .hero-subtitle {
            font-size: 1.1rem;
          }

          .section-title {
            font-size: 2rem;
          }

          .pattern-grid {
            max-width: 250px;
            padding: 18px;
            gap: 10px;
          }

          .pattern-item {
            font-size: 2rem;
            padding: 10px;
          }

          .cta-content {
            grid-template-columns: 1fr;
            text-align: center;
          }

          .cta-title {
            font-size: 1.75rem;
          }

          .form-group {
            flex-direction: column;
          }

          .submit-btn {
            width: 100%;
            justify-content: center;
          }

          .about-features {
            grid-template-columns: 1fr;
          }

          .stats {
            gap: 30px;
          }

          .stat-divider {
            display: none;
          }

          .how-steps {
            flex-direction: column;
          }

          .step-item {
            max-width: 100%;
          }
        }

        @media (max-width: 480px) {
          .container {
            padding: 0 16px;
          }

          .hero {
            padding: 100px 0 60px;
          }

          .hero-title {
            font-size: 2rem;
          }

          section {
            padding: 60px 0;
          }

          .cta-btn-primary {
            padding: 16px 32px;
            font-size: 1rem;
          }

          .logo span {
            display: none;
          }

          .cta-btn-nav {
            padding: 10px 20px;
            font-size: 0.85rem;
          }

          .envelope-icon {
            width: 100px;
            height: 100px;
          }

          .envelope-icon i {
            font-size: 2.5rem;
          }

          .pattern-item {
            font-size: 1.8rem;
            padding: 8px;
          }

          .pattern-grid {
            max-width: 220px;
            padding: 15px;
            gap: 8px;
          }
        }
      `}),n.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),n.jsx("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"true"}),n.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap",rel:"stylesheet"}),n.jsx("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"}),n.jsx("nav",{className:"navbar",children:n.jsx("div",{className:"container",children:n.jsxs("div",{className:"nav-content",children:[n.jsxs("div",{className:"logo",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),children:[n.jsx("img",{src:"/images/logo.png",alt:"라스북 로고"}),n.jsx("span",{children:"LAS Book - 수학편지"})]}),n.jsx("button",{className:"cta-btn-nav",onClick:o,children:"무료 구독하기"})]})})}),n.jsxs("section",{className:"hero",children:[n.jsxs("div",{className:"hero-background",children:[n.jsx("div",{className:"floating-shape shape-1"}),n.jsx("div",{className:"floating-shape shape-2"}),n.jsx("div",{className:"floating-shape shape-3"})]}),n.jsx("div",{className:"container",children:n.jsxs("div",{className:"hero-content",children:[n.jsxs("h1",{className:"hero-title",children:["수학을 잘하기보다,",n.jsx("br",{}),n.jsx("span",{className:"highlight",children:"함께 느끼는 시간"}),"이",n.jsx("br",{}),"더 중요합니다."]}),n.jsxs("p",{className:"hero-subtitle",children:["아이와 부모가 함께 읽는 무료 뉴스레터,",n.jsx("br",{}),n.jsx("strong",{children:"'라스북 수학편지'"}),"로 수학의 진짜 의미를 발견하세요."]}),n.jsxs("button",{className:"cta-btn-primary",onClick:o,children:[n.jsx("i",{className:"fas fa-envelope"}),"무료 구독하기"]}),n.jsx("p",{className:"hero-note",children:"매주 한 통의 수학 이야기가 이메일로 도착합니다."})]})}),n.jsx("div",{className:"scroll-indicator",onClick:o,children:n.jsx("i",{className:"fas fa-chevron-down"})})]}),n.jsx("section",{className:"about",children:n.jsxs("div",{className:"container",children:[n.jsx("div",{className:"section-header",children:n.jsxs("h2",{className:"section-title",children:["라스북 수학편지는",n.jsx("br",{}),"무엇인가요?"]})}),n.jsxs("div",{className:"about-content",children:[n.jsxs("p",{className:"lead-text",children:["라스북은 ",n.jsx("strong",{children:"미국 연방교육부 기준의"}),n.jsx("br",{}),n.jsx("strong",{children:"세계 수학교육 표준"}),"을 바탕으로,",n.jsx("br",{}),"아이와 부모가 함께",n.jsx("br",{}),n.jsx("strong",{children:"'수학의 본질'"}),"을 발견하는",n.jsx("br",{}),"무료 교육 편지 프로그램입니다."]}),n.jsxs("div",{className:"about-features",children:[n.jsxs("div",{className:"feature-item",children:[n.jsx("div",{className:"feature-icon",children:"🌿"}),n.jsxs("div",{className:"feature-text",children:[n.jsx("h3",{children:"아이에게는"}),n.jsx("p",{children:"호기심을 키워주는 질문"})]})]}),n.jsxs("div",{className:"feature-item",children:[n.jsx("div",{className:"feature-icon",children:"👨‍👩‍👧"}),n.jsxs("div",{className:"feature-text",children:[n.jsx("h3",{children:"부모에게는"}),n.jsx("p",{children:"대화의 주제와 통찰"})]})]}),n.jsxs("div",{className:"feature-item",children:[n.jsx("div",{className:"feature-icon",children:"📖"}),n.jsxs("div",{className:"feature-text",children:[n.jsx("h3",{children:"가정에는"}),n.jsx("p",{children:"함께 배우는 따뜻한 시간"})]})]})]})]})]})}),n.jsx("section",{className:"why",children:n.jsxs("div",{className:"container",children:[n.jsx("div",{className:"section-header",children:n.jsx("h2",{className:"section-title",children:"왜 이 편지를 읽어야 할까요?"})}),n.jsxs("div",{className:"why-content",children:[n.jsx("div",{className:"why-visual",children:n.jsxs("div",{className:"pattern-grid",children:[n.jsx("div",{className:"pattern-item",children:"❄️"}),n.jsx("div",{className:"pattern-item",children:"🍃"}),n.jsx("div",{className:"pattern-item",children:"⭐"}),n.jsx("div",{className:"pattern-item",children:"🐚"}),n.jsx("div",{className:"pattern-item",children:"🌸"}),n.jsx("div",{className:"pattern-item",children:"🔷"})]})}),n.jsxs("div",{className:"why-text",children:[n.jsxs("p",{className:"why-lead",children:["우리는",n.jsx("br",{}),"오랫동안 ",n.jsx("strong",{children:"'연산'"}),"을 수학의 전부로 배워왔습니다."]}),n.jsxs("p",{className:"why-emphasis",children:["하지만 수학의 본질은 계산이 아니라",n.jsx("br",{}),n.jsx("span",{className:"highlight-text",children:"'세상을 관찰하고 이해하는 힘'"}),"이에요."]}),n.jsxs("p",{className:"why-description",children:["라스북 수학편지는",n.jsx("br",{}),"아이가 ",n.jsx("strong",{children:"세상 속 수학"}),"을 발견하고,",n.jsx("br",{}),"부모가 함께 그 의미를 이야기하도록 돕습니다."]})]})]})]})}),n.jsx("section",{className:"how",children:n.jsxs("div",{className:"container",children:[n.jsx("div",{className:"section-header",children:n.jsx("h2",{className:"section-title",children:"이렇게 진행됩니다"})}),n.jsxs("div",{className:"how-steps",children:[n.jsxs("div",{className:"step-item",children:[n.jsx("div",{className:"step-number",children:"1"}),n.jsx("div",{className:"step-icon",children:n.jsx("i",{className:"fas fa-user-plus"})}),n.jsx("h3",{children:"구독 신청 (무료)"}),n.jsx("p",{children:"간단히 이메일만 입력하세요."})]}),n.jsx("div",{className:"step-arrow",children:n.jsx("i",{className:"fas fa-arrow-right"})}),n.jsxs("div",{className:"step-item",children:[n.jsx("div",{className:"step-number",children:"2"}),n.jsx("div",{className:"step-icon",children:n.jsx("i",{className:"fas fa-envelope-open-text"})}),n.jsx("h3",{children:"매주 한 편의 수학편지 도착"}),n.jsx("p",{children:"매주 자연·예술·과학과 연결된 수학 이야기가 이메일로 전달됩니다."})]}),n.jsx("div",{className:"step-arrow",children:n.jsx("i",{className:"fas fa-arrow-right"})}),n.jsxs("div",{className:"step-item",children:[n.jsx("div",{className:"step-number",children:"3"}),n.jsx("div",{className:"step-icon",children:n.jsx("i",{className:"fas fa-comments"})}),n.jsx("h3",{children:"아이와 함께 대화하기"}),n.jsx("p",{children:"읽고, 묻고, 생각하며 '수학의 언어로 세상을 보는 법'을 함께 익힙니다."})]})]})]})}),n.jsx("section",{className:"social-proof",children:n.jsxs("div",{className:"container",children:[n.jsx("div",{className:"section-header",children:n.jsx("h2",{className:"section-title",children:"함께하는 가정들의 이야기"})}),n.jsxs("div",{className:"testimonials",children:[n.jsxs("div",{className:"testimonial-item",children:[n.jsx("div",{className:"quote-icon",children:'"'}),n.jsx("p",{className:"testimonial-text",children:"아이와 대화가 깊어졌어요."}),n.jsx("div",{className:"testimonial-author",children:"- 초등 2학년 학부모"})]}),n.jsxs("div",{className:"testimonial-item",children:[n.jsx("div",{className:"quote-icon",children:'"'}),n.jsx("p",{className:"testimonial-text",children:"수학이 처음으로 따뜻하게 느껴졌습니다."}),n.jsx("div",{className:"testimonial-author",children:"- 중학생 엄마"})]}),n.jsxs("div",{className:"testimonial-item",children:[n.jsx("div",{className:"quote-icon",children:'"'}),n.jsx("p",{className:"testimonial-text",children:"이건 공부가 아니라 대화예요."}),n.jsx("div",{className:"testimonial-author",children:"- 유치원생 아빠"})]})]}),n.jsxs("div",{className:"stats",children:[n.jsxs("div",{className:"stat-item",children:[n.jsx("div",{className:"stat-number",children:"10,000+"}),n.jsx("div",{className:"stat-label",children:"함께하는 가정"})]}),n.jsx("div",{className:"stat-divider"}),n.jsxs("div",{className:"stat-item",children:[n.jsx("div",{className:"stat-number",children:"매주"}),n.jsx("div",{className:"stat-label",children:"새로운 수학 이야기"})]}),n.jsx("div",{className:"stat-divider"}),n.jsxs("div",{className:"stat-item",children:[n.jsx("div",{className:"stat-number",children:"100%"}),n.jsx("div",{className:"stat-label",children:"무료"})]})]})]})}),n.jsx("section",{className:"final-cta",id:"subscribe",children:n.jsx("div",{className:"container",children:n.jsxs("div",{className:"cta-content",children:[n.jsx("div",{className:"cta-visual",children:n.jsx("div",{className:"envelope-icon",children:n.jsx("i",{className:"fas fa-envelope"})})}),n.jsxs("div",{className:"cta-text",children:[n.jsxs("h2",{className:"cta-title",children:["수학은 계산이 아니라,",n.jsx("br",{}),"세상을 이해하는 언어입니다."]}),n.jsxs("p",{className:"cta-subtitle",children:["지금 구독하고,",n.jsx("br",{}),"아이와 함께 ",n.jsx("strong",{children:"'생각이 자라는 수학 시간'"}),"을 시작하세요."]}),n.jsxs("form",{className:"subscribe-form",onSubmit:l,children:[n.jsxs("div",{className:"form-group",children:[n.jsx("input",{type:"email",value:t,onChange:c=>r(c.target.value),className:"email-input",placeholder:"이메일 주소를 입력하세요",required:!0}),n.jsxs("button",{type:"submit",className:"submit-btn",children:[n.jsx("i",{className:"fas fa-paper-plane"}),"무료로 구독하기"]})]}),n.jsxs("p",{className:"form-note",children:[n.jsx("i",{className:"fas fa-lock"}),"언제든지 구독을 취소할 수 있습니다. 개인정보는 안전하게 보호됩니다."]})]})]})]})})}),n.jsx("footer",{className:"footer",children:n.jsx("div",{className:"container",children:n.jsxs("div",{className:"footer-content",children:[n.jsxs("div",{className:"footer-logo",children:[n.jsx("img",{src:"/images/logo.png",alt:"라스북 로고"}),n.jsx("p",{children:"라스북 수학편지"})]}),n.jsxs("div",{className:"footer-info",children:[n.jsx("p",{children:"© 2024 라스북. All rights reserved."}),n.jsx("p",{children:"아이와 부모가 함께 성장하는 수학 교육"})]})]})})})]})}function Fv(){const[t,r]=B.useState({parentName:"",phone:"",childGender:"",childAge:"",inquiry:"",referrerCode:"",privacyAgreed:!1,marketingAgreed:!1}),[e,s]=B.useState(!1),[a,i]=B.useState(!1),[o,l]=B.useState(!1),[c,d]=B.useState(!1),[h,f]=B.useState(""),[u,m]=B.useState(""),[p,x]=B.useState(!1),[g,j]=B.useState(""),[w,_]=B.useState(""),[T,R]=B.useState(!1),[z,E]=B.useState(!1),[I,D]=B.useState(!0),P="/videos/mathletter.mp4";B.useEffect(()=>{(async()=>{try{const O=new URLSearchParams(window.location.search).get("ref"),b=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";if(!O){if(b){console.log("🔓 개발 환경: ref 없이 접근 허용"),E(!1),D(!1);return}console.log("❌ 접근 차단: ref 파라미터 없음"),E(!0),D(!1);return}console.log("🔍 추천인 코드 검증 중:",O);const W=await ke(O);W.exists&&W.referrerName?(console.log("✅ 유효한 추천인:",W.referrerName),r(L=>({...L,referrerCode:O})),_(W.referrerName),x(!0),E(!1)):(console.log("❌ 접근 차단: 유효하지 않은 추천인 코드"),E(!0)),D(!1)}catch(F){console.error("❌ 접근 검증 오류:",F),E(!0),D(!1)}})()},[]),B.useEffect(()=>{if(z)return;const y=document.createElement("link");y.rel="preload",y.as="video",y.href=P,document.head.appendChild(y);const F=document.createElement("video");return F.src=P,F.preload="auto",F.muted=!0,F.style.display="none",F.style.position="absolute",F.style.pointerEvents="none",document.body.appendChild(F),F.load(),F.addEventListener("loadeddata",()=>{console.log("✅ 영상 프리로드 완료")}),F.addEventListener("error",O=>{console.error("❌ 영상 로드 실패:",O),console.error("파일 경로:",P)}),()=>{document.head.removeChild(y),document.body.removeChild(F)}},[]);const U=y=>{const{name:F,value:O,type:b,checked:W}=y.target;r({...t,[F]:b==="checkbox"?W:O})},H=y=>{const F=y.replace(/[^\d]/g,"");return F.length<=3?F:F.length<=7?`${F.slice(0,3)}-${F.slice(3)}`:`${F.slice(0,3)}-${F.slice(3,7)}-${F.slice(7,11)}`},ee=y=>{const F=H(y.target.value);r({...t,phone:F})},pe=()=>{navigator.clipboard.writeText(u).then(()=>{alert("링크가 복사되었습니다!")}).catch(()=>{prompt("링크를 복사하세요:",u)})},ge=()=>{navigator.share?navigator.share({title:"수학편지 신청",text:"아이들의 인생을 수학으로 디자인하자!",url:u}).catch(y=>console.log("공유 취소:",y)):pe()},je=async()=>{try{const F=await(await fetch(h)).blob(),O=window.URL.createObjectURL(F),b=document.createElement("a");b.href=O,b.download=`QR_${t.referrerCode}.png`,document.body.appendChild(b),b.click(),document.body.removeChild(b),window.URL.revokeObjectURL(O)}catch(y){console.error("QR 다운로드 오류:",y),alert("QR 코드 다운로드에 실패했습니다.")}},_e=()=>{if(!t.parentName.trim())return alert("학부모 이름을 입력해주세요"),!1;if(!t.phone||t.phone.replace(/[^\d]/g,"").length!==11)return alert("휴대전화 번호를 정확히 입력해주세요"),!1;if(!t.childGender)return alert("자녀 성별을 선택해주세요"),!1;if(!t.childAge||t.childAge<1||t.childAge>20)return alert("자녀 연령을 정확히 입력해주세요 (1-20세)"),!1;if(!t.privacyAgreed)return alert("개인정보 수집 및 이용에 동의해주세요"),!1;if(t.referrerCode.trim()){const y=Fd(t.referrerCode);if(!y.isValid)return alert(y.error),!1}return!0},ke=async y=>{if(!y||y.trim()==="")return{exists:!0,referrerId:null};try{const{data:F,error:O}=await ue.from("users").select("id, name, branch, referral_code").eq("referral_code",y.trim().toUpperCase()).maybeSingle();return O?(console.error("추천인 코드 확인 오류:",O),{exists:!1,referrerId:null,error:"추천인 코드 확인 중 오류가 발생했습니다"}):F?(console.log("✅ 고유번호 확인:",F.referral_code,"-",F.name,"(",F.branch,")"),{exists:!0,referrerId:F.id,referrerName:F.name,referrerBranch:F.branch}):{exists:!1,referrerId:null,error:"존재하지 않는 고유번호입니다"}}catch(F){return console.error("추천인 코드 확인 예외:",F),{exists:!1,referrerId:null,error:"추천인 코드 확인 중 오류가 발생했습니다"}}},de=async y=>{if(y.preventDefault(),!!_e()){s(!0);try{const F=t.phone.replace(/[^\d]/g,""),{data:O}=await ue.from("event_participants").select("id").eq("phone",F).maybeSingle();let b=null;if(t.referrerCode.trim()){const L=await ke(t.referrerCode);if(!L.exists){alert(L.error||"존재하지 않는 고유번호입니다"),s(!1);return}b=t.referrerCode.trim().toUpperCase()}const W={parent_name:t.parentName.trim(),phone:F,child_gender:t.childGender,child_age:parseInt(t.childAge),inquiry:t.inquiry.trim()||null,referrer_code:b,privacy_agreed:t.privacyAgreed,marketing_agreed:t.marketingAgreed,created_at:new Date().toISOString()};if(O){const{error:L}=await ue.from("event_participants").update(W).eq("id",O.id);if(L)throw L}else{const{error:L}=await ue.from("event_participants").insert([W]);if(L)throw L}l(!0)}catch(F){console.error("신청 오류:",F),alert("신청 중 오류가 발생했습니다. 다시 시도해주세요.")}finally{s(!1)}}},me=()=>{window.location.href="/"},Se=()=>{const y=`${window.location.origin}${window.location.pathname}?ref=${t.referrerCode||"SHARE"}`;navigator.share?navigator.share({title:"수학편지 신청",text:"아이들의 인생을 수학으로 디자인하자!",url:y}).catch(F=>console.log("공유 취소:",F)):navigator.clipboard.writeText(y).then(()=>{alert("링크가 복사되었습니다!")}).catch(()=>{prompt("링크를 복사하세요:",y)})};return I?n.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#f0fffe"},children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:"#249689"}}),n.jsx("p",{style:{color:"#249689",fontSize:"16px"},children:"링크 검증 중..."})]})}):z?n.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{backgroundColor:"#f0fffe"},children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-md w-full text-center",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("div",{className:"w-20 h-20 mx-auto mb-4 flex items-center justify-center rounded-full",style:{backgroundColor:"#fee"},children:n.jsx("svg",{className:"w-12 h-12",style:{color:"#dc2626"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),n.jsx("h2",{className:"font-bold mb-3",style:{color:"#249689",fontSize:"24px"},children:"접근이 제한되었습니다"}),n.jsx("p",{className:"text-gray-600 mb-2",style:{fontSize:"15px"},children:"이 페이지는 초대 링크를 통해서만 접근할 수 있습니다."}),n.jsx("p",{className:"text-gray-500 text-sm",children:"추천인으로부터 받은 링크나 QR코드를 통해 다시 접속해주세요."})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[n.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"💡 올바른 접근 방법"}),n.jsxs("ul",{className:"text-xs text-left space-y-1",style:{color:"#666"},children:[n.jsx("li",{children:"✓ 추천인에게 받은 QR코드 스캔"}),n.jsx("li",{children:"✓ 추천인에게 받은 링크 클릭"}),n.jsx("li",{children:"✓ 카카오톡 등으로 공유받은 링크 사용"})]})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:n.jsxs("p",{className:"text-xs text-yellow-800",children:[n.jsx("strong",{children:"⚠️ 주의:"})," 직접 URL 입력이나 북마크로는 접근할 수 없습니다."]})}),n.jsx("button",{onClick:()=>window.history.back(),className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689"},children:"이전 페이지로 돌아가기"})]})}):o?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:n.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx("svg",{className:"w-10 h-10 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),n.jsx("h2",{className:"font-bold mb-2",style:{color:"#249689",fontSize:"24px"},children:"신청이 완료되었습니다!"}),n.jsxs("p",{style:{color:"#666",fontSize:"15px"},children:["소중한 참여 감사드립니다.",n.jsx("br",{}),"아이들의 인생을 수학으로 '디자인'하겠습니다!"]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("button",{onClick:Se,className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689",fontSize:"16px"},children:"친구에게 공유하기"}),n.jsx("button",{onClick:me,className:"w-full py-3 font-bold rounded-lg hover:bg-gray-50 transition-colors",style:{color:"#000000",border:"2px solid #d1d5db",backgroundColor:"white",fontSize:"16px"},children:"닫기"})]})]})}):n.jsxs("div",{className:"min-h-screen bg-gray-50 p-2",children:[n.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg p-3",children:[n.jsxs("div",{className:"mb-3",children:[n.jsxs("div",{className:"bg-red-700 text-white text-center py-6 rounded-lg mb-1.5",children:[n.jsx("h1",{className:"font-bold mb-1.5",style:{fontSize:"20px"},children:"우리나라를 살리는"}),n.jsx("h2",{className:"font-bold",style:{fontSize:"24px"},children:"수학 대중화 운동"})]}),n.jsx("div",{className:"text-center py-1",children:n.jsx("p",{className:"font-bold !mt-0",style:{color:"#249689",fontSize:"18px"},children:"아이들의 인생을 수학으로 '디자인'하자!"})})]}),n.jsxs("div",{className:"text-center mt-0 mb-2",style:{marginTop:"-4px"},children:[n.jsx("h2",{className:"font-bold",style:{color:"#dc2626",fontSize:"28px",fontFamily:"'Noto Sans KR', sans-serif",fontWeight:"900"},children:"수학편지 신청하기"}),n.jsx("h3",{className:"font-bold",style:{color:"#249689",fontSize:"20px",fontFamily:"'Noto Sans KR', sans-serif",fontWeight:"900"},children:"(수학편지는 매일 무료로 보내드려요!!)"})]}),n.jsx("div",{className:"text-center mb-4",children:n.jsxs("button",{onClick:()=>R(!0),className:"inline-flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-bold transition-all hover:opacity-90 hover:scale-105",style:{backgroundColor:"#3b82f6",color:"white",fontSize:"17px",boxShadow:"0 4px 6px rgba(59, 130, 246, 0.3)"},children:[n.jsxs("svg",{width:"26",height:"26",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{flexShrink:0},children:[n.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"white",fillOpacity:"0.2"}),n.jsx("path",{d:"M10 8L16 12L10 16V8Z",fill:"white"})]}),n.jsx("span",{style:{fontSize:"17px"},children:"수학편지 샘플영상"})]})}),n.jsxs("div",{className:"space-y-2",style:{marginTop:"16px"},children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"학부모이름 *"}),n.jsx("input",{type:"text",name:"parentName",value:t.parentName,onChange:U,placeholder:"학부모님 이름을 입력해주세요",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"휴대전화 *"}),n.jsx("input",{type:"tel",name:"phone",value:t.phone,onChange:ee,placeholder:"010-0000-0000",maxLength:13,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"자녀성별 *"}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer flex-1",children:[n.jsx("input",{type:"radio",name:"childGender",value:"남",checked:t.childGender==="남",onChange:U,className:"w-5 h-5"}),n.jsx("span",{style:{fontSize:"15px"},children:"남"})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer flex-1",children:[n.jsx("input",{type:"radio",name:"childGender",value:"여",checked:t.childGender==="여",onChange:U,className:"w-5 h-5"}),n.jsx("span",{style:{fontSize:"15px"},children:"여"})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"자녀나이 *"}),n.jsx("input",{type:"number",name:"childAge",value:t.childAge,onChange:U,placeholder:"자녀나이를 입력해주세요",min:"1",max:"20",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"문의사항"}),n.jsx("textarea",{name:"inquiry",value:t.inquiry,onChange:U,placeholder:"궁금한 사항이 있으시면 입력해주세요",rows:4,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"추천인(자동입력)"}),p?n.jsxs(n.Fragment,{children:[n.jsx("input",{type:"text",name:"referrerCode",value:w?`${w}(${t.referrerCode})`:t.referrerCode,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",fontSize:"15px"}}),n.jsx("p",{className:"mt-1 text-xs",style:{color:"#249689"},children:"✓ 추천인 코드가 자동으로 입력되었습니다"})]}):n.jsxs(n.Fragment,{children:[n.jsx("input",{type:"text",name:"referrerCode",value:t.referrerCode,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",fontSize:"15px"}}),g&&n.jsx("p",{className:"mt-1 text-xs text-red-600",children:g})]})]}),n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-3 bg-gray-50",children:[n.jsx("h3",{className:"font-bold mb-2 text-lg",style:{color:"#249689",fontSize:"18px"},children:"개인정보 수집 및 이용 동의"}),n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"privacyAgreed",checked:t.privacyAgreed,onChange:U,className:"w-5 h-5 mt-0.5"}),n.jsxs("span",{style:{color:"#000000",fontSize:"14px"},children:["개인정보 수집 및 이용에 동의합니다 ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]})]}),n.jsx("button",{type:"button",onClick:()=>i(!0),className:"text-sm underline whitespace-nowrap",style:{color:"#249689"},children:"📄 내용보기"})]}),n.jsx("div",{className:"pt-2 border-t border-gray-300",children:n.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"marketingAgreed",checked:t.marketingAgreed,onChange:U,className:"w-5 h-5 mt-0.5"}),n.jsxs("span",{style:{fontSize:"14px",flex:1},children:[n.jsx("span",{className:"font-bold",children:"(선택)"})," 이벤트 및 마케팅 정보 수신에 동의합니다"]})]})})]}),n.jsx("div",{className:"flex gap-2 pt-2",children:n.jsx("button",{type:"button",onClick:de,disabled:e,className:"flex-1 py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#dc2626",fontSize:"16px"},children:e?"신청 중...":"신청하기"})})]}),n.jsx("div",{className:"mt-3 text-center",children:n.jsx("p",{style:{fontSize:"13px",color:"#666"},children:"오늘도 수고하셨습니다."})})]}),c&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[n.jsx("h2",{className:"font-bold mb-4 text-center",style:{color:"#249689",fontSize:"22px"},children:"추천 링크가 생성되었습니다!"}),n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("img",{src:h,alt:"QR Code",className:"w-64 h-64 border-2 border-gray-300 rounded-lg"})}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[n.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"생성된 링크:"}),n.jsx("div",{className:"bg-white p-3 rounded border border-gray-300 break-all text-sm",children:u})]}),n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsx("button",{onClick:je,className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689"},children:"💾 QR 다운로드"}),n.jsx("button",{onClick:pe,className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#2ca89f"},children:"📋 링크 복사하기"}),n.jsx("button",{onClick:ge,className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#3bb5ab"},children:"📤 공유하기"}),n.jsx("button",{onClick:()=>d(!1),className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#6b7280"},children:"✕ 닫기"})]})]})}),a&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6 my-8 max-h-[80vh] overflow-y-auto",children:[n.jsx("h2",{className:"font-bold mb-4 text-center",style:{color:"#249689",fontSize:"22px"},children:"개인정보 수집 및 이용 동의"}),n.jsxs("div",{className:"space-y-4 text-sm text-gray-700",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",children:"1. 수집하는 개인정보 항목"}),n.jsx("p",{children:"학부모 이름, 휴대전화 번호, 자녀 성별, 자녀 연령, 문의사항"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",children:"2. 개인정보의 수집 및 이용 목적"}),n.jsx("p",{children:"이벤트 참여 확인, 당첨자 연락, 상품 배송, 마케팅 및 프로모션 정보 제공"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",children:"3. 개인정보의 보유 및 이용 기간"}),n.jsx("p",{children:"이벤트 종료 후 3개월까지 보관 후 파기"})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",children:"4. 동의 거부 권리 및 불이익"}),n.jsx("p",{children:"귀하는 개인정보 수집 및 이용을 거부할 권리가 있으나, 거부 시 이벤트 참여가 제한될 수 있습니다."})]})]}),n.jsx("button",{onClick:()=>i(!1),className:"w-full mt-6 py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689"},children:"확인"})]})}),T&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",onClick:()=>R(!1),children:n.jsxs("div",{className:"relative bg-black rounded-lg shadow-2xl max-w-4xl w-full",onClick:y=>y.stopPropagation(),style:{aspectRatio:"16/9"},children:[n.jsx("button",{onClick:()=>R(!1),className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors z-10",style:{fontSize:"32px",fontWeight:"bold"},children:"✕"}),n.jsxs("video",{className:"w-full h-full rounded-lg",controls:!0,autoPlay:!0,playsInline:!0,controlsList:"nodownload",onError:y=>{console.error("비디오 재생 오류:",y),alert(`영상을 불러올 수 없습니다. 파일 경로를 확인해주세요.
경로: `+P)},onLoadedData:()=>console.log("영상 로드 완료"),style:{border:"none",backgroundColor:"#000"},children:[n.jsx("source",{src:P,type:"video/mp4"}),"브라우저가 비디오 태그를 지원하지 않습니다."]})]})})]})}function Dv({user:t,onBack:r,viewMode:e,from:s}){let a=e;a||(s==="/system-admin"||s==="SystemAdminDashboard"?a="system":s==="/admin"||s==="AdminDashboard"?a="admin":s==="/dashboard"||s==="Dashboard"?a="user":t?.user_type==="시스템관리자"||t?.role==="system_admin"||t?.role==="SystemAdmin"?a="system":t?.role==="admin"||t?.role==="manager"||t?.role==="점장"||t?.role==="지점관리자"?a="admin":a="user"),console.log("🎯 ViewMode 결정:",a,"| User Role:",t?.role,"| User Type:",t?.user_type,"| From:",s);const i=a==="admin"||a==="system",[o,l]=B.useState({total:0,thisWeek:0,male:0,female:0}),[c,d]=B.useState([]),[h,f]=B.useState([]),[u,m]=B.useState([]),[p,x]=B.useState([]),[g,j]=B.useState(!0),[w,_]=B.useState([]),[T,R]=B.useState(""),[z,E]=B.useState({branch:"",referrer:"",startDate:"",endDate:""}),[I,D]=B.useState([]),[P,U]=B.useState([]),[H,ee]=B.useState(1),[pe,ge]=B.useState(30);B.useEffect(()=>{ke()},[]),B.useEffect(()=>{me(),de()},[T]);const je=M=>M.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),_e=M=>{if(!M)return"";const Q=M.toString().replace(/\D/g,"");return Q.length===11?Q.replace(/(\d{3})(\d{4})(\d{4})/,"$1-$2-$3"):Q.length===10?Q.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"):M},ke=async()=>{try{const{data:M,error:Q}=await ue.from("events").select("name").eq("status","active").order("created_at",{ascending:!1});if(Q)throw Q;_(M||[])}catch(M){console.error("이벤트 목록 로드 실패:",M)}},de=async()=>{try{const{data:M}=await ue.from("users").select("branch").not("branch","is",null).order("branch"),Q=[...new Set(M?.map(Le=>Le.branch)||[])];D(Q);const{data:he}=await ue.from("users").select("name, referral_code").not("referral_code","is",null).order("name");let re=ue.from("event_participants").select("referrer_code, event_name").not("referrer_code","is",null);T&&(re=re.eq("event_name",T));const{data:be}=await re,Re=new Set(be?.map(Le=>Le.referrer_code)||[]),Ue=he?.filter(Le=>Re.has(Le.referral_code)).map(Le=>({referrer_name:Le.name,referrer_code:Le.referral_code}))||[];U(Ue)}catch(M){console.error("필터 옵션 로드 실패:",M)}},me=async()=>{try{console.log("🚀 데이터 로드 시작..."),j(!0),console.log("📊 통계 데이터 로드 중...");let M=ue.from("event_participants").select("child_gender, child_age, event_name, created_at");if(a==="user"&&t?.referral_code)console.log("✅ [일반 유저] 필터 적용 - 추천코드:",t.referral_code),M=M.eq("referrer_code",t.referral_code);else if(a==="admin"&&t?.branch){console.log("✅ [점장/지점관리자] 필터 적용 - 지점:",t.branch);const{data:Qe}=await ue.from("users").select("referral_code").eq("branch",t.branch).not("referral_code","is",null),Ke=Qe?.map(ht=>ht.referral_code)||[];console.log("✅ 지점 직원 수:",Ke.length,"명"),Ke.length>0?M=M.in("referrer_code",Ke):M=M.eq("referrer_code","NONE")}else a==="system"&&console.log("✅ [시스템관리자] 필터 없음 - 전체 데이터");T&&(console.log("✅ 이벤트 필터 적용:",T),M=M.eq("event_name",T));const{data:Q,error:he}=await M;if(he)throw he;console.log("📊 통계용 데이터 로드:",Q?.length,"명"),Q&&Q.length>0?console.log("🔍 샘플 데이터 3개:",Q.slice(0,3)):console.warn("⚠️ 통계 데이터가 비어있습니다!");const re=Q?.length||0,be=Q?.filter(Qe=>Qe.child_gender==="남").length||0,Re=Q?.filter(Qe=>Qe.child_gender==="여").length||0,Ue=new Date,Le=Ue.getDay(),wt=Le===0?6:Le-1,Ee=new Date(Ue);Ee.setDate(Ue.getDate()-wt),Ee.setHours(0,0,0,0);const Ae=Q?.filter(Qe=>new Date(Qe.created_at)>=Ee).length||0;console.log("✅ 통계:",{total:re,thisWeek:Ae,male:be,female:Re}),l({total:re,thisWeek:Ae,male:be,female:Re});const st=[{name:"1~5세 (유아)",min:1,max:5,male:0,female:0,total:0},{name:"6~10세 (초등 저학년)",min:6,max:10,male:0,female:0,total:0},{name:"11~15세 (초등 고학년~중학생)",min:11,max:15,male:0,female:0,total:0},{name:"16~20세 (고등학생~성인)",min:16,max:20,male:0,female:0,total:0}];Q?.forEach(Qe=>{if(Qe.child_age){const Ke=parseInt(Qe.child_age);if(!isNaN(Ke)&&Ke>=1&&Ke<=20){const ht=st.findIndex(or=>Ke>=or.min&&Ke<=or.max);ht!==-1&&(st[ht].total++,Qe.child_gender==="남"?st[ht].male++:Qe.child_gender==="여"&&st[ht].female++)}}}),console.log("✅ 연령 분포:",st),d(st),console.log("🏆 추천인 통계 로드 중...");let mt=ue.from("event_participants").select("referrer_name, referrer_code").not("referrer_code","is",null);if(a==="user"&&t?.referral_code)mt=mt.eq("referrer_code",t.referral_code);else if(a==="admin"&&t?.branch){const{data:Qe}=await ue.from("users").select("referral_code").eq("branch",t.branch).not("referral_code","is",null),Ke=Qe?.map(ht=>ht.referral_code)||[];Ke.length>0?mt=mt.in("referrer_code",Ke):mt=mt.eq("referrer_code","NONE")}T&&(mt=mt.eq("event_name",T));const{data:qt,error:$t}=await mt;if($t&&console.error("❌ 추천인 통계 에러:",$t),i){const Qe=[...new Set(qt?.map(nt=>nt.referrer_code).filter(Boolean))];let Ke=[];if(Qe.length>0){const{data:nt}=await ue.from("users").select("referral_code, name, branch").in("referral_code",Qe);Ke=nt||[]}const ht={};qt?.forEach(nt=>{const Ht=nt.referrer_code,Wt=Ke.find(Pr=>Pr.referral_code===nt.referrer_code);ht[Ht]||(ht[Ht]={name:nt.referrer_name||Wt?.name||"-",code:nt.referrer_code,branch:Wt?.branch||"-",count:0}),ht[Ht].count++});const or=Object.values(ht).sort((nt,Ht)=>Ht.count-nt.count).slice(0,12);console.log("✅ Top 추천인:",or),f(or),console.log("🏢 추천지점 통계 계산 중...");const vr={};qt?.forEach(nt=>{const Wt=Ke.find(Pr=>Pr.referral_code===nt.referrer_code)?.branch||"-";Wt!=="-"&&(vr[Wt]||(vr[Wt]={branch:Wt,count:0}),vr[Wt].count++)});const os=Object.values(vr).sort((nt,Ht)=>Ht.count-nt.count).slice(0,12);console.log("✅ Top 지점:",os),m(os)}else f([]),m([]);console.log("👥 참가자 목록 로드 시작..."),await Se(),console.log("✅ 모든 데이터 로드 완료!")}catch(M){console.error("❌ 데이터 로드 실패:",M),alert("데이터를 불러오는데 실패했습니다: "+M.message)}finally{j(!1)}},Se=async(M=null)=>{try{const Q=M!==null?M:z;console.log("🔍 참가자 목록 로드 시작..."),console.log("📋 현재 필터:",Q);let he=ue.from("event_participants").select("*").order("created_at",{ascending:!1});if(T&&(console.log("✅ 이벤트 필터 적용:",T),he=he.eq("event_name",T)),a==="user"&&t?.referral_code)console.log("✅ [일반 유저] 필터 적용 - 추천코드:",t.referral_code),he=he.eq("referrer_code",t.referral_code);else if(a==="admin"&&t?.branch){console.log("✅ [점장/지점관리자] 필터 적용 - 지점:",t.branch);const{data:Ee}=await ue.from("users").select("referral_code").eq("branch",t.branch).not("referral_code","is",null),Ae=Ee?.map(st=>st.referral_code)||[];console.log("✅ 지점 직원 수:",Ae.length,"명"),Ae.length>0?he=he.in("referrer_code",Ae):he=he.eq("referrer_code","NONE")}else a==="system"&&console.log("✅ [시스템관리자] 필터 없음 - 전체 데이터");Q.referrer&&(console.log("✅ 추천인 필터 적용:",Q.referrer),he=he.eq("referrer_code",Q.referrer)),Q.startDate&&(console.log("✅ 시작일 필터 적용:",Q.startDate),he=he.gte("created_at",`${Q.startDate}T00:00:00`)),Q.endDate&&(console.log("✅ 종료일 필터 적용:",Q.endDate),he=he.lte("created_at",`${Q.endDate}T23:59:59`));const{data:re,error:be}=await he;if(be)throw console.error("❌ 쿼리 에러:",be),be;if(console.log("✅ 참가자 기본 데이터 로드:",re?.length,"명"),re&&re.length>0){const Ee=re.map(Ae=>Ae.referrer_code);console.log("🔍 DB에 있는 referrer_code 목록:",[...new Set(Ee)]),console.log("🔍 샘플 데이터 3개:",re.slice(0,3))}else console.warn("⚠️ 참가자 데이터가 비어있습니다!");const Re=[...new Set(re?.map(Ee=>Ee.referrer_code).filter(Boolean))];let Ue=[];if(Re.length>0){const{data:Ee,error:Ae}=await ue.from("users").select("referral_code, name, branch").in("referral_code",Re);Ae?console.error("❌ Users 조회 에러:",Ae):(Ue=Ee||[],console.log("✅ 추천인 정보 로드:",Ue.length,"명"))}const Le=re?.map(Ee=>{const Ae=Ue.find(st=>st.referral_code===Ee.referrer_code);return{...Ee,users:Ae?{name:Ae.name,branch:Ae.branch}:null}})||[];let wt=Le;Q.branch&&(console.log("✅ 지점 필터 적용:",Q.branch),wt=Le.filter(Ee=>Ee.users?.branch===Q.branch)),console.log("✅ 최종 참가자 데이터:",wt.length,"명"),console.log("📦 데이터:",wt),x(wt)}catch(Q){console.error("❌ 참가자 목록 로드 실패:",Q),alert("참가자 목록을 불러오는데 실패했습니다: "+Q.message)}},y=(M,Q)=>{E(he=>{const re={...he,[M]:Q};return setTimeout(()=>{ee(1),Se(re)},0),re})},F=(M,Q)=>{E(he=>{const re={...he,[M]:Q};return M==="branch"?re.referrer="":M==="referrer"&&(re.branch=""),setTimeout(()=>{ee(1),Se(re)},0),re})},O=()=>{const M={branch:"",referrer:"",startDate:"",endDate:""};E(M),ee(1),Se(M)},b=async M=>{if(confirm("정말 삭제하시겠습니까?"))try{const{error:Q}=await ue.from("event_participants").delete().eq("id",M);if(Q)throw Q;alert("삭제되었습니다."),me()}catch(Q){console.error("삭제 실패:",Q),alert("삭제에 실패했습니다.")}},W=()=>{if(p.length===0){alert("다운로드할 데이터가 없습니다.");return}const M=["신청일시","학부모명","연락처","자녀성별","자녀나이","추천인","추천인코드","지점","문의사항"],Q=p.map(Ee=>[new Date(Ee.created_at).toLocaleString("ko-KR"),Ee.parent_name||"",Ee.phone||"",Ee.child_gender||"",Ee.child_age||"",Ee.users?.name||Ee.referrer_name||"",Ee.referrer_code||"",Ee.users?.branch||"",Ee.inquiry||""]),he=[M.join(","),...Q.map(Ee=>Ee.map(Ae=>`"${Ae}"`).join(","))].join(`
`),re="\uFEFF",be=new Blob([re+he],{type:"text/csv;charset=utf-8;"}),Re=document.createElement("a"),Ue=URL.createObjectURL(be),Le=new Date,wt=Le.getFullYear()+String(Le.getMonth()+1).padStart(2,"0")+String(Le.getDate()).padStart(2,"0");Re.setAttribute("href",Ue),Re.setAttribute("download",`이벤트 참가자목록_${wt}.xls`),Re.style.visibility="hidden",document.body.appendChild(Re),Re.click(),document.body.removeChild(Re)},L=Math.ceil(p.length/pe),Z=(H-1)*pe,se=Z+pe,ae=p.slice(Z,se),ye=()=>{const Q=[];if(L<=10)for(let he=1;he<=L;he++)Q.push(he);else{let he=Math.max(1,H-4),re=Math.min(L,he+10-1);re-he<9&&(he=Math.max(1,re-10+1));for(let be=he;be<=re;be++)Q.push(be)}return Q},G=M=>{ee(M),window.scrollTo({top:0,behavior:"smooth"})},ve=M=>{ge(Number(M)),ee(1)};return g?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-teal-600 mx-auto mb-4"}),n.jsx("p",{className:"text-gray-600",children:"데이터를 불러오는 중..."})]})}):n.jsx("div",{className:"min-h-screen bg-white",children:n.jsx("div",{className:"max-w-7xl mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("button",{onClick:r,className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[n.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[n.jsx("line",{x1:"19",y1:"12",x2:"5",y2:"12"}),n.jsx("polyline",{points:"12 19 5 12 12 5"})]}),"나가기"]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"이벤트 대시보드"})]}),n.jsx("div",{children:n.jsxs("select",{value:T,onChange:M=>R(M.target.value),className:"px-4 py-2 border-2 rounded-lg font-medium",style:{borderColor:"#249689",color:"#249689",borderRadius:"10px",fontSize:"15px",minWidth:"200px"},children:[n.jsx("option",{value:"",children:"전체 이벤트"}),w.map(M=>n.jsx("option",{value:M.name,children:M.name},M.name))]})})]}),n.jsx("div",{className:"mb-6 p-3 rounded-lg",style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6"},children:n.jsx("p",{className:"text-sm",style:{color:"#1e40af"},children:"ℹ️ 이벤트 참가자 정보를 조회하고 관리합니다"})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[n.jsx("div",{className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow-lg p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-blue-100 text-sm mb-2",children:"전체 참가자"}),n.jsxs("p",{className:"text-4xl font-bold",children:[o.total,"명"]})]}),n.jsx("div",{className:"text-5xl",children:"👥"})]})}),n.jsx("div",{className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg shadow-lg p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-purple-100 text-sm mb-2",children:"이번주 참가자"}),n.jsxs("p",{className:"text-4xl font-bold",children:[o.thisWeek,"명"]})]}),n.jsx("div",{className:"text-5xl",children:"📅"})]})}),n.jsx("div",{className:"bg-gradient-to-br from-sky-500 to-sky-600 rounded-lg shadow-lg p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-sky-100 text-sm mb-2",children:"남학생"}),n.jsxs("p",{className:"text-4xl font-bold",children:[o.male,"명"]})]}),n.jsx("div",{className:"text-5xl",children:"👦"})]})}),n.jsx("div",{className:"bg-gradient-to-br from-pink-500 to-pink-600 rounded-lg shadow-lg p-6 text-white",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-pink-100 text-sm mb-2",children:"여학생"}),n.jsxs("p",{className:"text-4xl font-bold",children:[o.female,"명"]})]}),n.jsx("div",{className:"text-5xl",children:"👧"})]})})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#249689"},children:"📊 연령 분포 (1~20세, 4개 구간)"}),n.jsxs("div",{className:"space-y-4",children:[(()=>{const M=Math.max(...c.map(Q=>Q.total),1);return c.map((Q,he)=>n.jsxs("div",{children:[n.jsxs("div",{className:"flex items-center justify-between mb-1.5",children:[n.jsx("span",{className:"font-bold text-gray-700",children:Q.name}),n.jsxs("span",{className:"text-lg font-bold",style:{color:"#249689"},children:["총 ",Q.total,"명"]})]}),Q.total>0?n.jsxs(n.Fragment,{children:[n.jsx("div",{className:"mb-1.5",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm text-sky-600 font-semibold w-20",children:"👦 남학생"}),n.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[n.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-6 overflow-hidden",children:n.jsx("div",{className:"bg-gradient-to-r from-sky-400 to-sky-500 h-full flex items-center justify-end pr-2 transition-all duration-500",style:{width:`${Q.male/M*100}%`},children:Q.male>0&&n.jsxs("span",{className:"text-white text-xs font-bold",children:[Q.male,"명"]})})}),n.jsx("span",{className:"text-sm text-gray-600 w-12 text-right",children:Q.total>0?`${(Q.male/Q.total*100).toFixed(0)}%`:"0%"})]})]})}),n.jsx("div",{className:"mb-1.5",children:n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-sm text-pink-600 font-semibold w-20",children:"👧 여학생"}),n.jsxs("div",{className:"flex-1 flex items-center gap-2",children:[n.jsx("div",{className:"flex-1 bg-gray-100 rounded-full h-6 overflow-hidden",children:n.jsx("div",{className:"bg-gradient-to-r from-pink-400 to-pink-500 h-full flex items-center justify-end pr-2 transition-all duration-500",style:{width:`${Q.female/M*100}%`},children:Q.female>0&&n.jsxs("span",{className:"text-white text-xs font-bold",children:[Q.female,"명"]})})}),n.jsx("span",{className:"text-sm text-gray-600 w-12 text-right",children:Q.total>0?`${(Q.female/Q.total*100).toFixed(0)}%`:"0%"})]})]})})]}):n.jsx("div",{className:"text-sm text-gray-400 text-center py-2 bg-gray-50 rounded-lg",children:"데이터 없음"}),he<c.length-1&&n.jsx("div",{className:"border-b border-gray-200 mt-3"})]},he))})(),c.length===0&&n.jsx("div",{className:"text-center py-8 text-gray-500",children:n.jsx("p",{children:"연령 데이터가 없습니다"})})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#249689"},children:"🎯 성별 비율"}),n.jsx("div",{className:"flex items-center justify-center",children:n.jsxs("div",{className:"relative w-64 h-64",children:[n.jsx("svg",{viewBox:"0 0 100 100",className:"transform -rotate-90",children:o.total>0&&n.jsxs(n.Fragment,{children:[n.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"transparent",stroke:"#0ea5e9",strokeWidth:"20",strokeDasharray:`${o.male/o.total*251.2} 251.2`}),n.jsx("circle",{cx:"50",cy:"50",r:"40",fill:"transparent",stroke:"#ec4899",strokeWidth:"20",strokeDasharray:`${o.female/o.total*251.2} 251.2`,strokeDashoffset:`-${o.male/o.total*251.2}`})]})}),n.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:n.jsxs("div",{className:"text-center",children:[n.jsx("p",{className:"text-3xl font-bold",style:{color:"#249689"},children:o.total}),n.jsx("p",{className:"text-sm text-gray-600",children:"총 참가자"})]})})]})}),n.jsxs("div",{className:"mt-6 space-y-3",children:[n.jsxs("div",{className:"flex items-center justify-between p-3 bg-sky-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 bg-sky-500 rounded"}),n.jsx("span",{className:"font-semibold",children:"남학생"})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"font-bold text-sky-600",children:[o.male,"명"]}),n.jsxs("p",{className:"text-xs text-gray-600",children:[o.total>0?(o.male/o.total*100).toFixed(1):0,"%"]})]})]}),n.jsxs("div",{className:"flex items-center justify-between p-3 bg-pink-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("div",{className:"w-4 h-4 bg-pink-500 rounded"}),n.jsx("span",{className:"font-semibold",children:"여학생"})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("p",{className:"font-bold text-pink-600",children:[o.female,"명"]}),n.jsxs("p",{className:"text-xs text-gray-600",children:[o.total>0?(o.female/o.total*100).toFixed(1):0,"%"]})]})]})]})]})]}),a==="system"&&n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[n.jsx("h3",{className:"text-xl font-bold mb-6",style:{color:"#249689"},children:"🏆 추천 매장 Top 12"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:u.map((M,Q)=>n.jsxs("div",{onClick:()=>F("branch",M.branch),className:"relative bg-gradient-to-br from-white to-gray-50 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 px-3 py-2 border-2 hover:scale-105 cursor-pointer",style:{borderColor:Q===0?"#FFD700":Q===1?"#C0C0C0":Q===2?"#CD7F32":"#249689",backgroundColor:Q<3?"#fffbf0":"white"},children:[n.jsx("div",{className:"absolute -top-1.5 -left-1.5 w-6 h-6 rounded-full flex items-center justify-center text-white font-bold shadow-lg text-xs",style:{backgroundColor:Q===0?"#FFD700":Q===1?"#C0C0C0":Q===2?"#CD7F32":"#249689"},children:Q+1}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[n.jsx("span",{style:{fontSize:"20px"},children:Q===0?"🏅":Q===1?"🥈":Q===2?"🥉":"🏪"}),n.jsx("div",{className:"flex-1",children:n.jsx("p",{className:"font-bold text-sm",style:{color:"#1f2937"},children:M.branch})})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-lg font-bold",style:{color:"#249689"},children:M.count}),n.jsx("p",{className:"text-xs text-gray-500",children:"명"})]})]})]},Q))}),u.length===0&&n.jsxs("div",{className:"text-center py-12 text-gray-500",children:[n.jsx("p",{className:"text-lg mb-2",children:"🏪"}),n.jsx("p",{children:"지점 데이터가 없습니다"})]})]}),i&&n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[n.jsx("h3",{className:"text-xl font-bold mb-6",style:{color:"#249689"},children:"🏆 추천인 Top 12"}),n.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-3",children:h.map((M,Q)=>n.jsxs("div",{onClick:()=>F("referrer",M.code),className:"relative bg-gradient-to-br from-white to-gray-50 rounded-lg shadow-md hover:shadow-lg transition-all duration-300 px-3 py-2 border-2 hover:scale-105 cursor-pointer",style:{borderColor:Q===0?"#FFD700":Q===1?"#C0C0C0":Q===2?"#CD7F32":"#249689",backgroundColor:Q<3?"#fffbf0":"white"},children:[n.jsx("div",{className:"absolute -top-1.5 -left-1.5 w-6 h-6 rounded-full flex items-center justify-center text-white font-bold shadow-lg text-xs",style:{backgroundColor:Q===0?"#FFD700":Q===1?"#C0C0C0":Q===2?"#CD7F32":"#249689"},children:Q+1}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2 flex-1",children:[n.jsx("span",{style:{fontSize:"20px"},children:Q===0?"👑":Q===1?"🥈":Q===2?"🥉":"⭐"}),n.jsxs("div",{className:"flex-1",children:[n.jsxs("p",{className:"font-bold text-sm",style:{color:"#1f2937"},children:[M.name,"(",M.code,")"]}),n.jsxs("p",{className:"text-xs text-gray-500",children:["📍 ",M.branch]})]})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("p",{className:"text-lg font-bold",style:{color:"#249689"},children:M.count}),n.jsx("p",{className:"text-xs text-gray-500",children:"명"})]})]})]},Q))}),h.length===0&&n.jsxs("div",{className:"text-center py-12 text-gray-500",children:[n.jsx("p",{className:"text-lg mb-2",children:"🏆"}),n.jsx("p",{children:"추천인 데이터가 없습니다"})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-8",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#249689"},children:"🔍 검색 필터"}),i?n.jsxs("div",{className:"flex items-end gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"지점"}),n.jsxs("select",{value:z.branch,onChange:M=>y("branch",M.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[n.jsx("option",{value:"",children:"전체지점"}),I.map(M=>n.jsx("option",{value:M,children:M},M))]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"추천인"}),n.jsxs("select",{value:z.referrer,onChange:M=>y("referrer",M.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[n.jsx("option",{value:"",children:"전체"}),P.map(M=>n.jsxs("option",{value:M.referrer_code,children:[M.referrer_name,"(",M.referrer_code,")"]},M.referrer_code))]})]}),n.jsxs("div",{style:{width:"160px"},children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"시작일"}),n.jsx("input",{type:"date",value:z.startDate,onChange:M=>y("startDate",M.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),n.jsxs("div",{style:{width:"160px"},children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"종료일"}),n.jsx("input",{type:"date",value:z.endDate,onChange:M=>y("endDate",M.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:O,className:"py-2 border-2 rounded-lg hover:bg-gray-50 font-bold whitespace-nowrap flex items-center justify-center gap-2",style:{borderColor:"#249689",color:"#249689",borderRadius:"10px",fontSize:"15px",width:"110px"},children:[n.jsx(Yr,{size:18}),"초기화"]}),n.jsxs("button",{onClick:W,className:"px-4 py-2 text-white rounded-lg hover:opacity-90 font-bold whitespace-nowrap flex items-center gap-2",style:{backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Er,{size:18}),"엑셀다운로드(",je(p.length),"명)"]})]})]}):n.jsxs("div",{className:"flex items-end gap-4",children:[n.jsxs("div",{style:{width:"160px"},children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"시작일"}),n.jsx("input",{type:"date",value:z.startDate,onChange:M=>y("startDate",M.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),n.jsxs("div",{style:{width:"160px"},children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:"종료일"}),n.jsx("input",{type:"date",value:z.endDate,onChange:M=>y("endDate",M.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),n.jsxs("div",{className:"flex gap-2 ml-auto",children:[n.jsxs("button",{onClick:O,className:"py-2 border-2 rounded-lg hover:bg-gray-50 font-bold whitespace-nowrap flex items-center justify-center gap-2",style:{borderColor:"#249689",color:"#249689",borderRadius:"10px",fontSize:"15px",width:"110px"},children:[n.jsx(Yr,{size:18}),"초기화"]}),n.jsxs("button",{onClick:W,className:"px-4 py-2 text-white rounded-lg hover:opacity-90 font-bold whitespace-nowrap flex items-center gap-2",style:{backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Er,{size:18}),"엑셀다운로드(",je(p.length),"명)"]})]})]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-xl font-bold",style:{color:"#249689"},children:"👥 참가자 목록"}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm font-medium text-gray-700",children:"페이지당"}),n.jsxs("select",{value:pe,onChange:M=>ve(M.target.value),className:"px-3 py-2 border rounded-lg text-sm font-medium",style:{borderColor:"#249689"},children:[n.jsx("option",{value:"30",children:"30개"}),n.jsx("option",{value:"50",children:"50개"}),n.jsx("option",{value:"100",children:"100개"})]})]}),n.jsxs("div",{className:"text-lg font-bold",style:{color:"#249689"},children:["검색결과: ",je(p.length),"명"]})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b-2",style:{borderColor:"#249689"},children:[n.jsx("th",{className:"px-3 py-2 text-left",children:"No."}),n.jsx("th",{className:"px-3 py-2 text-left",children:"신청일시"}),n.jsx("th",{className:"px-3 py-2 text-left",children:"학부모명"}),n.jsx("th",{className:"px-3 py-2 text-left",children:"연락처"}),n.jsx("th",{className:"px-3 py-2 text-left",children:"자녀성별"}),n.jsx("th",{className:"px-3 py-2 text-left",children:"자녀나이"}),n.jsx("th",{className:"px-3 py-2 text-left",children:"추천인"}),n.jsx("th",{className:"px-3 py-2 text-left",children:"추천인코드"}),n.jsx("th",{className:"px-3 py-2 text-left",children:"지점"}),a==="system"&&n.jsx("th",{className:"px-3 py-2 text-center",children:"삭제"})]})}),n.jsx("tbody",{children:ae.map((M,Q)=>n.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-3 text-sm font-medium text-gray-600",children:Z+Q+1}),n.jsx("td",{className:"px-3 py-3 text-sm",children:new Date(M.created_at).toLocaleString("ko-KR")}),n.jsx("td",{className:"px-3 py-3",children:M.parent_name}),n.jsx("td",{className:"px-3 py-3",children:_e(M.phone)}),n.jsx("td",{className:"px-3 py-3",children:M.child_gender}),n.jsxs("td",{className:"px-3 py-3",children:[M.child_age,"세"]}),n.jsx("td",{className:"px-3 py-3",children:M.users?.name||M.referrer_name||"-"}),n.jsx("td",{className:"px-3 py-3",children:M.referrer_code||"-"}),n.jsx("td",{className:"px-3 py-3",children:M.users?.branch||"-"}),a==="system"&&n.jsx("td",{className:"px-3 py-3 text-center",children:n.jsx("button",{onClick:()=>b(M.id),className:"text-red-600 hover:text-red-800",children:"🗑️"})})]},M.id))})]})}),p.length===0&&n.jsx("div",{className:"text-center py-8 text-gray-500",children:"참가자가 없습니다"}),p.length>0&&L>1&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[n.jsx("button",{onClick:()=>G(1),disabled:H===1,className:`p-2 rounded-lg transition-colors ${H===1?"text-gray-300 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:n.jsx(Kc,{size:20})}),n.jsx("button",{onClick:()=>G(H-1),disabled:H===1,className:`p-2 rounded-lg transition-colors ${H===1?"text-gray-300 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:n.jsx(Yc,{size:20})}),ye().map(M=>n.jsx("button",{onClick:()=>G(M),className:`min-w-[40px] px-3 py-2 rounded-lg font-medium transition-colors ${H===M?"text-white":"text-gray-700 hover:bg-gray-100"}`,style:H===M?{backgroundColor:"#249689"}:{},children:M},M)),n.jsx("button",{onClick:()=>G(H+1),disabled:H===L,className:`p-2 rounded-lg transition-colors ${H===L?"text-gray-300 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:n.jsx(qc,{size:20})}),n.jsx("button",{onClick:()=>G(L),disabled:H===L,className:`p-2 rounded-lg transition-colors ${H===L?"text-gray-300 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:n.jsx(Jc,{size:20})}),n.jsxs("span",{className:"ml-4 text-sm text-gray-600",children:[H," / ",L," 페이지"]})]})]})]})})})}function Ov({user:t,onNavigate:r,onLogout:e,onBack:s}){const a=t?.user_type==="시스템관리자";return n.jsx("div",{className:"min-h-screen bg-white",children:n.jsx("div",{className:"max-w-md mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"이벤트 관리"})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"🏢 지점명"}),n.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:"👤 이름"}),n.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: adminEvent"),r("adminEvent")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Sa,{size:20}),"이벤트 대시보드"]}),n.jsxs("button",{onClick:()=>{console.log("🧭 Navigate to: AdminEventManager"),r("AdminEventManager")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(rn,{size:20}),"이벤트 템플릿 관리"]}),n.jsxs("button",{onClick:()=>{console.log("🧭 Navigate back"),s?s():r(a?"SystemAdminDashboard":"AdminDashboard")},className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ot,{size:20}),"나가기"]})]})]})})})}const Iv=({showBelow:t=300})=>{const[r,e]=B.useState(!1);B.useEffect(()=>{const a=()=>{window.pageYOffset>t?e(!0):e(!1)};return window.addEventListener("scroll",a),()=>window.removeEventListener("scroll",a)},[t]);const s=()=>{window.scrollTo({top:0,behavior:"smooth"})};return r?n.jsx("button",{onClick:s,className:"scroll-to-top","aria-label":"맨 위로 가기",style:{position:"fixed",bottom:"30px",right:"30px",width:"50px",height:"50px",borderRadius:"50%",background:"linear-gradient(135deg, #1e9a8a, #2cb5a3)",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(30, 154, 138, 0.3)",transition:"all 0.3s ease",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:a=>{a.target.style.transform="translateY(-3px)",a.target.style.boxShadow="0 6px 16px rgba(30, 154, 138, 0.4)"},onMouseLeave:a=>{a.target.style.transform="translateY(0)",a.target.style.boxShadow="0 4px 12px rgba(30, 154, 138, 0.3)"},onMouseDown:a=>{a.target.style.transform="translateY(-1px)"},children:"↑"}):null};function Pv({user:t,onBack:r}){const[e,s]=B.useState([]),[a,i]=B.useState(!0),[o,l]=B.useState("all"),[c,d]=B.useState(!1);B.useEffect(()=>{h()},[o]);const h=async()=>{try{i(!0);let f=ue.from("events").select("*").order("created_at",{ascending:!1});o!=="all"&&(f=f.eq("status",o));const{data:u,error:m}=await f;if(m)throw m;s(u||[])}catch(f){console.error("이벤트 조회 실패:",f)}finally{i(!1)}};return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("button",{onClick:r,className:"flex items-center gap-1 font-bold hover:opacity-70 transition-opacity",style:{color:"#4A9B8E",fontSize:"16px"},children:[n.jsx(Ot,{size:20}),"나가기"]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain",onError:f=>f.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"이벤트 템플릿 관리"})]}),n.jsx("div",{style:{width:"80px"}})]}),n.jsx("div",{className:"mb-6 p-3 rounded-lg",style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:"10px"},children:n.jsx("p",{className:"text-sm",style:{color:"#1e40af"},children:"ℹ️ 이벤트 템플릿을 생성하고 관리합니다"})}),n.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200",children:[n.jsx("div",{className:"flex gap-2",children:[{value:"all",label:"전체"},{value:"active",label:"진행중"},{value:"scheduled",label:"예정"},{value:"ended",label:"종료"},{value:"inactive",label:"비활성"}].map(f=>n.jsx("button",{onClick:()=>l(f.value),className:`px-4 py-2 font-medium transition-colors ${o===f.value?"border-b-2":"text-gray-600 hover:text-gray-900"}`,style:o===f.value?{color:"#249689",borderColor:"#249689"}:{},children:f.label},f.value))}),n.jsxs("button",{onClick:()=>d(!0),className:"flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90 font-bold mb-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ta,{size:20}),"생성하기"]})]})]}),a?n.jsx("div",{className:"flex justify-center items-center py-20",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2",style:{borderColor:"#249689"}})}):e.length===0?n.jsxs("div",{className:"text-center py-20 bg-white rounded-lg shadow-sm border",children:[n.jsx(an,{size:64,className:"mx-auto mb-4",style:{color:"#249689"}}),n.jsx("p",{className:"text-gray-600 mb-4",children:"등록된 이벤트가 없습니다"}),n.jsx("button",{onClick:()=>d(!0),className:"px-6 py-2 text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#249689",borderRadius:"10px"},children:"첫 이벤트 만들기"})]}):n.jsx("div",{className:"grid grid-cols-4 gap-4 max-h-[calc(100vh-300px)] overflow-y-auto pr-2",children:e.map(f=>n.jsx(Lv,{event:f,onRefresh:h},f.id))})]}),c&&n.jsx(Bv,{onClose:()=>d(!1),onSuccess:()=>{d(!1),h()}})]})}function Lv({event:t,onRefresh:r}){const[e,s]=B.useState(!1),a=async()=>{try{const c=t.status==="active"?"inactive":"active",{error:d}=await ue.from("events").update({status:c}).eq("id",t.id);if(d)throw d;r()}catch(c){console.error("상태 변경 실패:",c)}},i=async()=>{if(confirm("정말 이 이벤트를 삭제하시겠습니까?"))try{const{error:c}=await ue.from("events").delete().eq("id",t.id);if(c)throw c;r()}catch(c){console.error("삭제 실패:",c)}},o=c=>{const d={active:{text:"진행중",color:"bg-green-100 text-green-800"},inactive:{text:"비활성",color:"bg-gray-100 text-gray-800"},scheduled:{text:"예정",color:"bg-blue-100 text-blue-800"},ended:{text:"종료",color:"bg-red-100 text-red-800"}},h=d[c]||d.inactive;return n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${h.color}`,children:h.text})},l=c=>c?new Date(c).toLocaleDateString("ko-KR"):"-";return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden hover:shadow-md transition-shadow",children:[t.template_image_url?n.jsx("div",{className:"h-32 bg-gray-100 relative overflow-hidden",children:n.jsx("img",{src:t.template_image_url,alt:t.name,className:"w-full h-full object-contain",onError:c=>{c.target.style.display="none",c.target.parentElement.innerHTML='<div class="w-full h-full flex items-center justify-center text-gray-400"><span>이미지를 불러올 수 없습니다</span></div>'}})}):n.jsx("div",{className:"h-32 bg-gray-100 flex items-center justify-center",children:n.jsx("span",{className:"text-gray-400 text-xs",children:"이미지 없음"})}),n.jsxs("div",{className:"p-3",children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-900 line-clamp-1",children:t.name}),o(t.status)]}),t.description&&n.jsx("p",{className:"text-xs text-gray-600 mb-2 line-clamp-1",children:t.description}),n.jsxs("div",{className:"text-xs text-gray-500 space-y-1 mb-3",children:[n.jsxs("div",{children:["시작: ",l(t.start_date)]}),n.jsxs("div",{children:["종료: ",l(t.end_date)]})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsxs("button",{onClick:a,className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-xs",style:{borderRadius:"8px"},children:[t.status==="active"?n.jsx(Qc,{size:14}):n.jsx(co,{size:14}),n.jsx("span",{className:"hidden lg:inline",children:t.status==="active"?"비활성":"활성"})]}),n.jsx("button",{onClick:()=>s(!0),className:"px-2 py-1.5 rounded hover:opacity-80",style:{backgroundColor:"#249689",color:"white",borderRadius:"8px"},children:n.jsx(Ca,{size:14})}),n.jsx("button",{onClick:i,className:"px-2 py-1.5 bg-red-100 text-red-700 rounded hover:bg-red-200",style:{borderRadius:"8px"},children:n.jsx(Ar,{size:14})})]})]})]}),e&&n.jsx(Mv,{event:t,onClose:()=>s(!1),onSuccess:()=>{s(!1),r()}})]})}function bc({imageUrl:t,position:r,onPositionChange:e}){const[s,a]=B.useState(!1),[i,o]=B.useState(null),[l,c]=B.useState(null),d=B.useRef(null),h=B.useRef(null),[f,u]=B.useState(!1),m=()=>h.current?h.current.getBoundingClientRect():null,p=_=>{if(!h.current||!f)return;const T=m();if(!T||_.clientX<T.left||_.clientX>T.right||_.clientY<T.top||_.clientY>T.bottom)return;const R=(_.clientX-T.left)/T.width*100,z=(_.clientY-T.top)/T.height*100;console.log("🖱️ 드래그 시작:",{clientX:_.clientX,clientY:_.clientY,imgLeft:T.left,imgTop:T.top,imgWidth:T.width,imgHeight:T.height,x:R,y:z}),o({x:R,y:z}),c({x:R,y:z}),a(!0)},x=_=>{if(!s||!h.current)return;const T=m();if(!T)return;const R=(_.clientX-T.left)/T.width*100,z=(_.clientY-T.top)/T.height*100,E=Math.max(0,Math.min(100,R)),I=Math.max(0,Math.min(100,z));c({x:E,y:I})},g=()=>{if(!s||!i||!l)return;const _=Math.min(i.x,l.x),T=Math.min(i.y,l.y),R=Math.abs(l.x-i.x),z=Math.abs(l.y-i.y);if(R>1&&z>1){const E={x:Math.max(0,Math.min(100,_)),y:Math.max(0,Math.min(100,T)),width:Math.min(100-_,R),height:Math.min(100-T,z)};e(E),console.log("✅ QR 위치 선택됨:",E),console.log("📊 실제 좌표:",{left:`${_.toFixed(2)}%`,top:`${T.toFixed(2)}%`,right:`${(_+R).toFixed(2)}%`,bottom:`${(T+z).toFixed(2)}%`,width:`${R.toFixed(2)}%`,height:`${z.toFixed(2)}%`})}a(!1),o(null),c(null)},j=()=>{if(!s||!i||!l)return{};const _=Math.min(i.x,l.x),T=Math.min(i.y,l.y),R=Math.abs(l.x-i.x),z=Math.abs(l.y-i.y);return{left:`${_}%`,top:`${T}%`,width:`${R}%`,height:`${z}%`}},w=()=>!r||r.width===0?{}:{left:`${r.x}%`,top:`${r.y}%`,width:`${r.width}%`,height:`${r.height}%`};return n.jsxs("div",{ref:d,className:"relative w-full ",style:{minHeight:"350px"},onMouseDown:p,onMouseMove:x,onMouseUp:g,onMouseLeave:g,children:[n.jsx("img",{ref:h,src:t,alt:"Template",className:"w-full h-auto block cursor-crosshair",style:{maxHeight:"500px",objectFit:"contain"},draggable:"false",onDragStart:_=>_.preventDefault(),onLoad:()=>{u(!0),console.log("✅ 이미지 로드 완료:",t)},onError:_=>{console.error("❌ 이미지 로드 실패:",t),u(!1)}}),s&&i&&l&&n.jsx("div",{className:"absolute border-2 border-blue-500 bg-blue-200 bg-opacity-30 pointer-events-none",style:j()}),!s&&r&&r.width>0&&n.jsx("div",{className:"absolute border-4 border-green-500 bg-green-200 bg-opacity-40 pointer-events-none flex items-center justify-center",style:w(),children:n.jsx("span",{className:"text-xs font-bold text-green-700 bg-white px-2 py-1 rounded shadow-lg",children:"QR 위치"})})]})}function Bv({onClose:t,onSuccess:r}){const[e,s]=B.useState({name:"",description:"",landing_url:"",template_image_url:"",qr_position:null,start_date:"",end_date:"",status:"active"}),[a,i]=B.useState(!1),[o,l]=B.useState(!1),[c,d]=B.useState(""),[h,f]=B.useState({type:"",message:""}),u=async x=>{const g=x.target.files[0];if(!g){console.log("❌ 파일이 선택되지 않음");return}console.log("📂 선택된 파일:",g.name,g.size,"bytes");const j=URL.createObjectURL(g);d(j),f({type:"uploading",message:"이미지 업로드 중..."}),console.log("👁️ 미리보기 URL 생성:",j);try{i(!0);const w=g.name.split(".").pop(),T=`event-templates/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${w}`}`;console.log("📁 업로드 경로:",T);const{data:R,error:z}=await ue.storage.from("event-images").upload(T,g);if(z){console.error("❌ Storage 업로드 실패:",z),f({type:"error",message:"이미지 업로드 실패: "+z.message}),i(!1);return}console.log("✅ 업로드 성공:",R),console.log("📁 저장된 경로:",T);const E="https://sgxnxbhbyvrmgrzhosyh.supabase.co";console.log("🔧 Supabase URL:",E);const I=`${E}/storage/v1/object/public/event-images/${T}`;console.log("🔗 구성한 Public URL:",I),s(D=>{const P={...D,template_image_url:I};return console.log("✅ FormData 업데이트!"),console.log("   → template_image_url:",P.template_image_url),P}),setTimeout(()=>{console.log("🔄 previewUrl 제거, template_image_url로 교체"),d("")},100),f({type:"success",message:"✅ 이미지 업로드 완료! 이제 QR 위치를 선택하세요."}),console.log("🎉 이미지 업로드 프로세스 완료!")}catch(w){console.error("❌ 이미지 업로드 에러:",w),f({type:"error",message:"이미지 업로드 중 오류 발생: "+w.message})}finally{i(!1),console.log("🔄 업로딩 상태 종료")}},m=(x,g)=>{if(!x||!g)return"active";const j=new Date;j.setHours(0,0,0,0);const w=new Date(x);w.setHours(0,0,0,0);const _=new Date(g);return _.setHours(0,0,0,0),j>_?"ended":j<w?"scheduled":"active"},p=async x=>{if(x.preventDefault(),console.log("🚀 생성하기 버튼 클릭!"),console.log("📋 현재 formData:",e),!e.name){console.log("❌ 검증 실패: 이벤트명 없음"),f({type:"error",message:"이벤트명을 입력해주세요."});return}if(!e.landing_url){console.log("❌ 검증 실패: 랜딩페이지 URL 없음"),f({type:"error",message:"랜딩페이지 URL을 입력해주세요."});return}if(a){console.log("❌ 검증 실패: 업로드 진행 중"),f({type:"error",message:"이미지 업로드가 진행 중입니다. 잠시만 기다려주세요."});return}if(console.log("🔍 template_image_url 확인:",e.template_image_url),!e.template_image_url||e.template_image_url===""){console.log("❌ 검증 실패: template_image_url 없음"),console.log("   - previewUrl:",c),f({type:"error",message:"템플릿 이미지를 업로드해주세요."});return}if(console.log("🔍 qr_position 확인:",e.qr_position),!e.qr_position||e.qr_position.width===0){console.log("❌ 검증 실패: QR 위치 미선택"),f({type:"error",message:"QR 코드 위치를 선택해주세요. 이미지에서 마우스로 드래그하여 QR 영역을 선택하세요."});return}try{l(!0),f({type:"uploading",message:"이벤트 생성 중..."}),console.log("📝 저장할 데이터:",e);const g=m(e.start_date,e.end_date),j={...e,status:g};console.log("📅 계산된 상태:",g);const{error:w}=await ue.from("events").insert([j]);if(w)throw console.error("❌ DB 저장 실패:",w),w;console.log("✅ 이벤트 생성 성공!"),f({type:"success",message:"✅ 이벤트가 성공적으로 생성되었습니다!"}),setTimeout(r,500)}catch(g){console.error("❌ 이벤트 생성 실패:",g),f({type:"error",message:"❌ 이벤트 생성에 실패했습니다: "+g.message})}finally{l(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-50 p-4 overflow-y-auto",style:{paddingTop:"2rem"},children:n.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm relative",style:{borderRadius:"10px"},children:n.jsxs("div",{className:"p-5 max-h-[90vh] overflow-y-auto",children:[n.jsx("div",{className:"flex flex-col items-center justify-center mb-3",children:n.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain",onError:x=>x.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"28px"},children:"템플릿 만들기"})]})}),h.message&&n.jsx("div",{className:`mb-3 p-3 rounded-lg ${h.type==="error"?"bg-red-50 border-2 border-red-300":h.type==="success"?"bg-green-50 border-2 border-green-300":"bg-blue-50 border-2 border-blue-300"}`,style:{borderRadius:"10px"},children:n.jsx("p",{className:`text-sm font-medium ${h.type==="error"?"text-red-700":h.type==="success"?"text-green-700":"text-blue-700"}`,children:h.message})}),n.jsxs("form",{onSubmit:p,className:"space-y-2",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["이벤트명 ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"text",value:e.name,onChange:x=>s(g=>({...g,name:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"예: 수학편지 신청 이벤트",style:{borderRadius:"10px"},required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"설명"}),n.jsx("textarea",{value:e.description,onChange:x=>s(g=>({...g,description:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:"2",placeholder:"이벤트에 대한 간단한 설명",style:{borderRadius:"10px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["랜딩페이지 URL ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"url",value:e.landing_url,onChange:x=>s(g=>({...g,landing_url:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"https://example.com/event",style:{borderRadius:"10px"},required:!0})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"시작일"}),n.jsx("input",{type:"date",value:e.start_date,onChange:x=>s(g=>({...g,start_date:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"종료일"}),n.jsx("input",{type:"date",value:e.end_date,onChange:x=>s(g=>({...g,end_date:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["템플릿 이미지 ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"file",accept:"image/*",onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"},disabled:a})]}),n.jsxs("div",{className:"p-3 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border-2 border-blue-300 shadow-md",style:{borderRadius:"10px"},children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2 text-center",children:"📍 QR코드 위치를 선택하세요"}),n.jsx("div",{className:"relative inline-block border-4 border-blue-400 rounded bg-white shadow-xl w-full",style:{borderRadius:"10px",minHeight:"400px"},children:a?n.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"400px"},children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-3"}),n.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"⏳ 이미지 업로드 중..."})]})}):c||e.template_image_url?n.jsx(bc,{imageUrl:c||e.template_image_url,position:e.qr_position,onPositionChange:x=>s(g=>({...g,qr_position:x}))}):n.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"400px"},children:n.jsxs("div",{className:"text-center text-gray-400",children:[n.jsx("svg",{className:"w-16 h-16 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),n.jsx("p",{className:"text-sm",children:"이미지를 선택해주세요"})]})})}),e.qr_position&&e.qr_position.width>0&&n.jsx("div",{className:"mt-2 p-2 bg-green-50 rounded border border-green-300",style:{borderRadius:"10px"},children:n.jsx("p",{className:"text-xs text-green-700 font-medium text-center",children:"✅ QR 위치가 선택되었습니다!"})})]}),n.jsxs("div",{className:"flex gap-3 pt-3",children:[n.jsx("button",{type:"button",onClick:t,className:"w-full py-3 flex items-center justify-center gap-2 bg-white text-gray-700 border-2 border-gray-300 rounded-lg hover:bg-gray-50 font-bold",style:{borderRadius:"10px",fontSize:"15px"},children:"나가기"}),n.jsxs("button",{type:"submit",disabled:o||a,className:"w-full py-3 flex items-center justify-center gap-2 text-white rounded-lg hover:opacity-90 disabled:opacity-50 font-bold",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ta,{size:18}),o?"생성 중...":"생성하기"]})]})]})]})})})}function Mv({event:t,onClose:r,onSuccess:e}){const[s,a]=B.useState({name:t.name||"",description:t.description||"",landing_url:t.landing_url||"",template_image_url:t.template_image_url||"",qr_position:t.qr_position||{x:0,y:0,width:0,height:0},status:t.status||"active",start_date:t.start_date||"",end_date:t.end_date||""}),[i,o]=B.useState(!1),[l,c]=B.useState(!1),[d,h]=B.useState(""),[f,u]=B.useState({type:"",message:""}),m=async g=>{const j=g.target.files[0];if(!j)return;const w=URL.createObjectURL(j);h(w),u({type:"uploading",message:"이미지 업로드 중..."});try{o(!0);const _=j.name.split(".").pop(),R=`event-templates/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${_}`}`,{data:z,error:E}=await ue.storage.from("event-images").upload(R,j);if(E)throw E;const D=`https://sgxnxbhbyvrmgrzhosyh.supabase.co/storage/v1/object/public/event-images/${R}`;a(P=>({...P,template_image_url:D})),setTimeout(()=>h(""),100),u({type:"success",message:"✅ 이미지 업로드 완료!"})}catch(_){u({type:"error",message:"이미지 업로드 실패: "+_.message})}finally{o(!1)}},p=(g,j)=>{if(!g||!j)return"active";const w=new Date;w.setHours(0,0,0,0);const _=new Date(g);_.setHours(0,0,0,0);const T=new Date(j);return T.setHours(0,0,0,0),w>T?"ended":w<_?"scheduled":"active"},x=async g=>{if(g.preventDefault(),!s.name||!s.landing_url){u({type:"error",message:"필수 항목을 입력해주세요."});return}if(!s.template_image_url){u({type:"error",message:"템플릿 이미지를 업로드해주세요."});return}if(!s.qr_position||s.qr_position.width===0){u({type:"error",message:"QR 코드 위치를 선택해주세요."});return}try{c(!0),u({type:"uploading",message:"이벤트 수정 중..."});const j=p(s.start_date,s.end_date),w={...s,status:j};console.log("📅 계산된 상태:",j);const{error:_}=await ue.from("events").update(w).eq("id",t.id);if(_)throw _;u({type:"success",message:"✅ 이벤트가 성공적으로 수정되었습니다!"}),setTimeout(e,500)}catch(j){u({type:"error",message:"❌ 이벤트 수정에 실패했습니다: "+j.message})}finally{c(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-50 p-4 overflow-y-auto",style:{paddingTop:"2rem"},children:n.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm relative",style:{borderRadius:"10px"},children:n.jsxs("div",{className:"p-4 max-h-[85vh] overflow-y-auto",children:[n.jsx("div",{className:"flex flex-col items-center justify-center mb-2.5",children:n.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain",onError:g=>g.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"28px"},children:"이벤트 수정하기"})]})}),f.message&&n.jsx("div",{className:`mb-3 p-3 rounded-lg ${f.type==="error"?"bg-red-50 border-2 border-red-300":f.type==="success"?"bg-green-50 border-2 border-green-300":"bg-blue-50 border-2 border-blue-300"}`,style:{borderRadius:"10px"},children:n.jsx("p",{className:`text-sm font-medium ${f.type==="error"?"text-red-700":f.type==="success"?"text-green-700":"text-blue-700"}`,children:f.message})}),n.jsxs("form",{onSubmit:x,className:"space-y-1.5",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:["이벤트명 ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"text",value:s.name,onChange:g=>a(j=>({...j,name:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"예: 수학편지 신청 이벤트",style:{borderRadius:"10px"},required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:"설명"}),n.jsx("textarea",{value:s.description,onChange:g=>a(j=>({...j,description:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:"2",placeholder:"이벤트에 대한 간단한 설명",style:{borderRadius:"10px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:["랜딩페이지 URL ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"url",value:s.landing_url,onChange:g=>a(j=>({...j,landing_url:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"https://example.com/event",style:{borderRadius:"10px"},required:!0})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:"시작일"}),n.jsx("input",{type:"date",value:s.start_date,onChange:g=>a(j=>({...j,start_date:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:"종료일"}),n.jsx("input",{type:"date",value:s.end_date,onChange:g=>a(j=>({...j,end_date:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:["템플릿 이미지 ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"file",accept:"image/*",onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"},disabled:i})]}),n.jsxs("div",{className:"p-3 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border-2 border-blue-300 shadow-md",style:{borderRadius:"10px"},children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2 text-center",children:"📍 QR코드 위치를 선택하세요"}),n.jsx("div",{className:"relative inline-block border-4 border-blue-400 rounded bg-white shadow-xl w-full",style:{borderRadius:"10px",minHeight:"280px"},children:i?n.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"280px"},children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-3"}),n.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"⏳ 이미지 업로드 중..."})]})}):d||s.template_image_url?n.jsx(bc,{imageUrl:d||s.template_image_url,position:s.qr_position,onPositionChange:g=>a(j=>({...j,qr_position:g}))}):n.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"280px"},children:n.jsxs("div",{className:"text-center text-gray-400",children:[n.jsx("svg",{className:"w-16 h-16 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),n.jsx("p",{className:"text-sm",children:"이미지를 선택해주세요"})]})})}),s.qr_position&&s.qr_position.width>0&&n.jsx("div",{className:"mt-2 p-2 bg-green-50 rounded border border-green-300",style:{borderRadius:"10px"},children:n.jsx("p",{className:"text-xs text-green-700 font-medium text-center",children:"✅ QR 위치가 선택되었습니다!"})})]}),n.jsxs("div",{className:"flex gap-3 pt-3",children:[n.jsx("button",{type:"button",onClick:r,className:"w-full py-3 flex items-center justify-center gap-2 bg-white text-gray-700 border-2 border-gray-300 rounded-lg hover:bg-gray-50 font-bold",style:{borderRadius:"10px",fontSize:"15px"},children:"나가기"}),n.jsxs("button",{type:"submit",disabled:l||i,className:"w-full py-3 flex items-center justify-center gap-2 text-white rounded-lg hover:opacity-90 disabled:opacity-50 font-bold",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ca,{size:18}),l?"저장 중...":"수정하기"]})]})]})]})})})}function zv(){const[t,r]=B.useState(null),[e,s]=B.useState("/dashboard"),a=so(),i=Pc();B.useEffect(()=>{console.log("Current User:",t),console.log("Current Path:",i.pathname),console.log("Previous Path:",e)},[t,i,e]);const o=f=>{console.log("Auto login:",f),r(f),f.user_type==="시스템관리자"?a("/system-admin"):a("/dashboard")},l=async()=>{try{console.log("Logging out..."),await ue.auth.signOut(),r(null),a("/")}catch(f){console.error("로그아웃 오류:",f),alert("로그아웃 중 오류가 발생했습니다.")}},c=f=>{const u=typeof f=="string"?f.trim():f;console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),console.log("🔄 handleNavigate 호출"),console.log("📌 원본 페이지:",`"${f}"`),console.log("📌 정제된 페이지:",`"${u}"`),console.log("📌 페이지 타입:",typeof f);const m={hero:"/",login:"/login",signup:"/signup",mathletter:"/mathletter",event:"/event",Dashboard:"/dashboard",dashboard:"/dashboard",AdminDashboard:"/admin",admin:"/admin",AdminUsers:"/admin/users",AdminWorkDiary:"/admin/workdiary",AdminCustomers:"/admin/customers",AdminEventMenu:"/admin/event-menu",adminEvent:"/admin/event",AdminEventDashboard:"/admin/event",AdminEventManager:"/admin/event-manager",MyInfo:"/myinfo",MyQRCode:"/myqrcode",WorkDiary:"/workdiary",CustomerManagement:"/customers",ShippingList:"/shipping",PurchaseHistory:"/purchases",purchases:"/purchases",SystemAdminDashboard:"/system-admin","system-admin":"/system-admin",SystemAdminBranches:"/system-admin/branches",SystemAdminUsers:"/system-admin/users",SystemAdminCustomers:"/system-admin/customers",SystemAdminPurchases:"/system-admin/purchases",SystemAdminShipping:"/system-admin/shipping",Profile:"/profile"},p=m[u];if(console.log("🎯 매핑된 경로:",p),!p){console.error("❌ 알 수 없는 페이지:",u),console.error("❌ 사용 가능한 페이지:",Object.keys(m).join(", ")),console.error("❌ HeroPage(/)로 리다이렉트됨"),console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),a("/");return}(u==="AdminEventDashboard"||u==="adminEvent")&&(s(i.pathname),console.log("✅ 이전 경로 저장:",i.pathname)),console.log("✅ 성공:",u,"→",p),console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),a(p)},d=f=>{console.log("Login:",f),r(f),f.user_type==="시스템관리자"?a("/system-admin"):a("/dashboard")},h=f=>{console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━"),console.log("App.jsx - handleSwitchMode 호출됨"),console.log("현재 모드:",t?.loginMode),console.log("새로운 모드:",f);const u={...t,loginMode:f};r(u),f===on.MANAGER?(console.log("MANAGER 모드로 전환 → /admin으로 이동"),a("/admin")):f===on.EMPLOYEE&&(console.log("EMPLOYEE 모드로 전환 → /dashboard로 이동"),a("/dashboard")),console.log("━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━")};return n.jsxs(n.Fragment,{children:[n.jsxs(Lc,{children:[n.jsx(Be,{path:"/",element:n.jsx(Dd,{onNavigate:c,onAutoLogin:o})}),n.jsx(Be,{path:"/login",element:n.jsx(Od,{onNavigate:c,onLogin:d})}),n.jsx(Be,{path:"/signup",element:n.jsx(Id,{onNavigate:c})}),n.jsx(Be,{path:"/mathletter",element:n.jsx(Rv,{})}),n.jsx(Be,{path:"/event",element:n.jsx(Fv,{})}),n.jsx(Be,{path:"/dashboard",element:t?n.jsx(Pd,{user:t,onNavigate:c,onLogout:l,onSwitchMode:h}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin",element:t&&fs(t)?n.jsx(Ld,{user:t,onNavigate:c,onLogout:l,onSwitchMode:h}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/users",element:t&&fs(t)?n.jsx(Tg,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/workdiary",element:t&&fs(t)?n.jsx(Cg,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/customers",element:t&&fs(t)?n.jsx(kg,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/event-menu",element:t&&t.user_type==="시스템관리자"?n.jsx(Ov,{user:t,onNavigate:c,onLogout:l,onBack:()=>a("/system-admin")}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/event-manager",element:t&&t.user_type==="시스템관리자"?n.jsx(Pv,{user:t,onBack:()=>a("/admin/event-menu")}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/event",element:t?n.jsx(Dv,{user:t,onNavigate:c,onLogout:l,from:e,onBack:()=>{console.log("🔙 AdminEventDashboard 뒤로가기"),console.log("   이전 경로:",e),e&&e!=="/admin/event"?(console.log("   → 저장된 경로로 이동:",e),a(e)):t.user_type==="시스템관리자"?(console.log("   → 시스템관리자: /admin/event-menu"),a("/admin/event-menu")):fs(t)?(console.log("   → 매장관리자: /admin"),a("/admin")):(console.log("   → 일반 직원: /dashboard"),a("/dashboard"))}}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/myinfo",element:t?n.jsx($g,{user:t,onBack:()=>a("/dashboard"),onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/myqrcode",element:t?n.jsx(Av,{user:t,onBack:()=>a("/myinfo")}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/workdiary",element:t?n.jsx(Rg,{user:t,onNavigate:c,onLogout:l}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/customers",element:t?n.jsx(Fg,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/shipping",element:t?n.jsx(Dg,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/purchases",element:t?n.jsx(Og,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/system-admin",element:t&&t.user_type==="시스템관리자"?n.jsx(Ig,{user:t,onNavigate:c,onLogout:l}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/system-admin/branches",element:t&&t.user_type==="시스템관리자"?n.jsx(Pg,{user:t,onNavigate:c}):n.jsx(We,{to:"/system-admin",replace:!0})}),n.jsx(Be,{path:"/system-admin/users",element:t&&t.user_type==="시스템관리자"?n.jsx(Bg,{user:t,onNavigate:c}):n.jsx(We,{to:"/system-admin",replace:!0})}),n.jsx(Be,{path:"/system-admin/customers",element:t&&t.user_type==="시스템관리자"?n.jsx(Mg,{user:t,onNavigate:c}):n.jsx(We,{to:"/system-admin",replace:!0})}),n.jsx(Be,{path:"/system-admin/purchases",element:t&&t.user_type==="시스템관리자"?n.jsx(zg,{user:t,onNavigate:c}):n.jsx(We,{to:"/system-admin",replace:!0})}),n.jsx(Be,{path:"/system-admin/shipping",element:t&&t.user_type==="시스템관리자"?n.jsx(Ug,{user:t,onNavigate:c}):n.jsx(We,{to:"/system-admin",replace:!0})}),n.jsx(Be,{path:"/profile",element:t?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md",children:[n.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:"#249689"},children:"내 정보관리"}),n.jsxs("div",{className:"mb-4 space-y-2",children:[n.jsxs("p",{className:"text-gray-600",children:["이름: ",t.name]}),n.jsxs("p",{className:"text-gray-600",children:["이메일: ",t.email]}),n.jsxs("p",{className:"text-gray-600",children:["지점: ",t.branch]})]}),n.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"상세 프로필 페이지는 준비중입니다."}),n.jsx("button",{onClick:()=>{t.user_type==="시스템관리자"?a("/system-admin"):a("/dashboard")},className:"w-full py-2 text-white font-bold rounded-lg",style:{backgroundColor:"#249689"},children:"대시보드로 돌아가기"})]})}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"*",element:n.jsx(We,{to:"/",replace:!0})})]}),n.jsx(Iv,{})]})}function Uv(){return n.jsx(Ic,{children:n.jsx(zv,{})})}ca.createRoot(document.getElementById("root")).render(n.jsx(Bc.StrictMode,{children:n.jsx(Uv,{})}));
