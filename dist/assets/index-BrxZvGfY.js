const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-ponyfill-DIMAIuBD.js","assets/vendor-BLl87vHU.js"])))=>i.map(i=>d[i]);
import{r as P,a as Ic,u as lo,B as Pc,b as Lc,R as Bc,c as Be,N as We,d as Mc}from"./vendor-BLl87vHU.js";import{A as Ft,S as zc,F as cn,a as dn,T as co,P as ho,B as Ra,U as hn,L as Fa,b as Uc,c as Da,C as fn,D as Rr,d as fo,X as uo,e as Oa,f as yr,g as Ir,h as $c,i as Hc,j as Rn,R as es,k as Wc,l as Gc,m as Fn,K as Vc,n as ma,o as Cs,E as xo,M as pa,p as Xc,q as Kc,Q as ci,r as di,s as Ia,t as hi,u as Yc,v as qc,w as Jc,x as Qc,y as Zc,z as e0}from"./icons-eJRSAr7H.js";(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))s(a);new MutationObserver(a=>{for(const i of a)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function e(a){const i={};return a.integrity&&(i.integrity=a.integrity),a.referrerPolicy&&(i.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?i.credentials="include":a.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(a){if(a.ep)return;a.ep=!0;const i=e(a);fetch(a.href,i)}})();var mo={exports:{}},Dn={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var t0=P,r0=Symbol.for("react.element"),s0=Symbol.for("react.fragment"),n0=Object.prototype.hasOwnProperty,a0=t0.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,i0={key:!0,ref:!0,__self:!0,__source:!0};function po(t,r,e){var s,a={},i=null,o=null;e!==void 0&&(i=""+e),r.key!==void 0&&(i=""+r.key),r.ref!==void 0&&(o=r.ref);for(s in r)n0.call(r,s)&&!i0.hasOwnProperty(s)&&(a[s]=r[s]);if(t&&t.defaultProps)for(s in r=t.defaultProps,r)a[s]===void 0&&(a[s]=r[s]);return{$$typeof:r0,type:t,key:i,ref:o,props:a,_owner:a0.current}}Dn.Fragment=s0;Dn.jsx=po;Dn.jsxs=po;mo.exports=Dn;var n=mo.exports,ga={},fi=Ic;ga.createRoot=fi.createRoot,ga.hydrateRoot=fi.hydrateRoot;const o0="1.35.7",go={"X-Client-Info":`supabase-js/${o0}`},l0="supabase.auth.token";function c0(t){return t.replace(/\/$/,"")}const d0=()=>typeof window<"u",h0="1.24.0",f0="http://localhost:9999",u0={"X-Client-Info":`gotrue-js/${h0}`},Ys=10,jr={ERROR_MESSAGE:"Request Failed",MAX_RETRIES:10,RETRY_INTERVAL:2},ps="supabase.auth.token",x0={name:"sb",lifetime:60*60*8,domain:"",path:"/",sameSite:"lax"};var Bs=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};const m0=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),p0=(t,r)=>{if(!t?.status)return r({message:jr.ERROR_MESSAGE});if(typeof t.json!="function")return r(t);t.json().then(e=>r({message:m0(e),status:t?.status||500}))},g0=(t,r,e)=>{const s={method:t,headers:r?.headers||{}};return t==="GET"||(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},r?.headers),s.body=JSON.stringify(e)),s};function On(t,r,e,s,a){return Bs(this,void 0,void 0,function*(){return new Promise((i,o)=>{t(e,g0(r,s,a)).then(l=>{if(!l.ok)throw l;return s?.noResolveJson?i:l.json()}).then(l=>i(l)).catch(l=>p0(l,o))})})}function Qn(t,r,e){return Bs(this,void 0,void 0,function*(){return On(t,"GET",r,e)})}function gt(t,r,e,s){return Bs(this,void 0,void 0,function*(){return On(t,"POST",r,s,e)})}function ui(t,r,e,s){return Bs(this,void 0,void 0,function*(){return On(t,"PUT",r,s,e)})}function v0(t,r,e,s){return Bs(this,void 0,void 0,function*(){return On(t,"DELETE",r,s,e)})}function y0(t,r,e){const s=e||{},a=encodeURIComponent,i=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/;if(typeof a!="function")throw new TypeError("option encode is invalid");if(!i.test(t))throw new TypeError("argument name is invalid");const o=a(r);if(o&&!i.test(o))throw new TypeError("argument val is invalid");let l=t+"="+o;if(s.maxAge!=null){const c=s.maxAge-0;if(isNaN(c)||!isFinite(c))throw new TypeError("option maxAge is invalid");l+="; Max-Age="+Math.floor(c)}if(s.domain){if(!i.test(s.domain))throw new TypeError("option domain is invalid");l+="; Domain="+s.domain}if(s.path){if(!i.test(s.path))throw new TypeError("option path is invalid");l+="; Path="+s.path}if(s.expires){if(typeof s.expires.toUTCString!="function")throw new TypeError("option expires is invalid");l+="; Expires="+s.expires.toUTCString()}if(s.httpOnly&&(l+="; HttpOnly"),s.secure&&(l+="; Secure"),s.sameSite)switch(typeof s.sameSite=="string"?s.sameSite.toLowerCase():s.sameSite){case"lax":l+="; SameSite=Lax";break;case"strict":l+="; SameSite=Strict";break;case"none":l+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return l}function b0(t){if(!t||!t.headers||!t.headers.host)throw new Error('The "host" request header is not available');const r=t.headers.host.indexOf(":")>-1&&t.headers.host.split(":")[0]||t.headers.host;return!(["localhost","127.0.0.1"].indexOf(r)>-1||r.endsWith(".local"))}function w0(t,r){var e,s,a;return y0(t.name,t.value,{maxAge:t.maxAge,expires:new Date(Date.now()+t.maxAge*1e3),httpOnly:!0,secure:r,path:(e=t.path)!==null&&e!==void 0?e:"/",domain:(s=t.domain)!==null&&s!==void 0?s:"",sameSite:(a=t.sameSite)!==null&&a!==void 0?a:"lax"})}function va(t,r,e){const s=e.map(i=>w0(i,b0(t))),a=r.getHeader("Set-Cookie");return a&&(a instanceof Array?Array.prototype.push.apply(s,a):typeof a=="string"&&s.push(a)),s}function qs(t,r,e){r.setHeader("Set-Cookie",va(t,r,e))}const _0="modulepreload",S0=function(t){return"/"+t},xi={},In=function(r,e,s){let a=Promise.resolve();if(e&&e.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=o?.nonce||o?.getAttribute("nonce");a=Promise.allSettled(e.map(c=>{if(c=S0(c),c in xi)return;xi[c]=!0;const h=c.endsWith(".css"),d=h?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const f=document.createElement("link");if(f.rel=h?"stylesheet":_0,h||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),h)return new Promise((u,m)=>{f.addEventListener("load",u),f.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return a.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return r().catch(i)})};var Pn=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};function hr(t){return Math.round(Date.now()/1e3)+t}function N0(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const r=Math.random()*16|0;return(t=="x"?r:r&3|8).toString(16)})}const rr=()=>typeof window<"u";function tr(t,r){var e;r||(r=((e=window?.location)===null||e===void 0?void 0:e.href)||""),t=t.replace(/[\[\]]/g,"\\$&");const s=new RegExp("[?&#]"+t+"(=([^&#]*)|&|#|$)"),a=s.exec(r);return a?a[2]?decodeURIComponent(a[2].replace(/\+/g," ")):"":null}const j0=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>Pn(void 0,void 0,void 0,function*(){return yield(yield In(()=>import("./browser-ponyfill-DIMAIuBD.js").then(s=>s.b),__vite__mapDeps([0,1]))).fetch(...e)}):r=fetch,(...e)=>r(...e)},E0=(t,r,e)=>Pn(void 0,void 0,void 0,function*(){rr()&&(yield t?.setItem(r,JSON.stringify(e)))}),T0=(t,r)=>Pn(void 0,void 0,void 0,function*(){const e=rr()&&(yield t?.getItem(r));if(!e)return null;try{return JSON.parse(e)}catch{return e}}),C0=(t,r)=>{const e=rr()&&t?.getItem(r);if(!e||typeof e!="string")return null;try{return JSON.parse(e)}catch{return e}},k0=(t,r)=>Pn(void 0,void 0,void 0,function*(){rr()&&(yield t?.removeItem(r))});var Ve=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};class A0{constructor({url:r="",headers:e={},cookieOptions:s,fetch:a}){this.url=r,this.headers=e,this.cookieOptions=Object.assign(Object.assign({},x0),s),this.fetch=j0(a)}_createRequestHeaders(r){const e=Object.assign({},this.headers);return e.Authorization=`Bearer ${r}`,e}cookieName(){var r;return(r=this.cookieOptions.name)!==null&&r!==void 0?r:""}getUrlForProvider(r,e){const s=[`provider=${encodeURIComponent(r)}`];if(e?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(e.redirectTo)}`),e?.scopes&&s.push(`scopes=${encodeURIComponent(e.scopes)}`),e?.queryParams){const a=new URLSearchParams(e.queryParams);s.push(`${a}`)}return`${this.url}/authorize?${s.join("&")}`}signUpWithEmail(r,e,s={}){return Ve(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers);let i="";s.redirectTo&&(i="?redirect_to="+encodeURIComponent(s.redirectTo));const o=yield gt(this.fetch,`${this.url}/signup${i}`,{email:r,password:e,data:s.data,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:a}),l=Object.assign({},o);return l.expires_in&&(l.expires_at=hr(o.expires_in)),{data:l,error:null}}catch(a){return{data:null,error:a}}})}signInWithEmail(r,e,s={}){return Ve(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers);let i="?grant_type=password";s.redirectTo&&(i+="&redirect_to="+encodeURIComponent(s.redirectTo));const o=yield gt(this.fetch,`${this.url}/token${i}`,{email:r,password:e,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:a}),l=Object.assign({},o);return l.expires_in&&(l.expires_at=hr(o.expires_in)),{data:l,error:null}}catch(a){return{data:null,error:a}}})}signUpWithPhone(r,e,s={}){return Ve(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers),i=yield gt(this.fetch,`${this.url}/signup`,{phone:r,password:e,data:s.data,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:a}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=hr(i.expires_in)),{data:o,error:null}}catch(a){return{data:null,error:a}}})}signInWithPhone(r,e,s={}){return Ve(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers),o=yield gt(this.fetch,`${this.url}/token?grant_type=password`,{phone:r,password:e,gotrue_meta_security:{captcha_token:s.captchaToken}},{headers:a}),l=Object.assign({},o);return l.expires_in&&(l.expires_at=hr(o.expires_in)),{data:l,error:null}}catch(a){return{data:null,error:a}}})}signInWithOpenIDConnect({id_token:r,nonce:e,client_id:s,issuer:a,provider:i}){return Ve(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),c=yield gt(this.fetch,`${this.url}/token?grant_type=id_token`,{id_token:r,nonce:e,client_id:s,issuer:a,provider:i},{headers:o}),h=Object.assign({},c);return h.expires_in&&(h.expires_at=hr(c.expires_in)),{data:h,error:null}}catch(o){return{data:null,error:o}}})}sendMagicLinkEmail(r,e={}){var s;return Ve(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers);let i="";e.redirectTo&&(i+="?redirect_to="+encodeURIComponent(e.redirectTo));const o=(s=e.shouldCreateUser)!==null&&s!==void 0?s:!0;return{data:yield gt(this.fetch,`${this.url}/otp${i}`,{email:r,create_user:o,gotrue_meta_security:{captcha_token:e.captchaToken}},{headers:a}),error:null}}catch(a){return{data:null,error:a}}})}sendMobileOTP(r,e={}){var s;return Ve(this,void 0,void 0,function*(){try{const a=(s=e.shouldCreateUser)!==null&&s!==void 0?s:!0,i=Object.assign({},this.headers);return{data:yield gt(this.fetch,`${this.url}/otp`,{phone:r,create_user:a,gotrue_meta_security:{captcha_token:e.captchaToken}},{headers:i}),error:null}}catch(a){return{data:null,error:a}}})}signOut(r){return Ve(this,void 0,void 0,function*(){try{return yield gt(this.fetch,`${this.url}/logout`,{},{headers:this._createRequestHeaders(r),noResolveJson:!0}),{error:null}}catch(e){return{error:e}}})}verifyMobileOTP(r,e,s={}){return Ve(this,void 0,void 0,function*(){try{const a=Object.assign({},this.headers),i=yield gt(this.fetch,`${this.url}/verify`,{phone:r,token:e,type:"sms",redirect_to:s.redirectTo},{headers:a}),o=Object.assign({},i);return o.expires_in&&(o.expires_at=hr(i.expires_in)),{data:o,error:null}}catch(a){return{data:null,error:a}}})}verifyOTP({email:r,phone:e,token:s,type:a="sms"},i={}){return Ve(this,void 0,void 0,function*(){try{const o=Object.assign({},this.headers),l=yield gt(this.fetch,`${this.url}/verify`,{email:r,phone:e,token:s,type:a,redirect_to:i.redirectTo},{headers:o}),c=Object.assign({},l);return c.expires_in&&(c.expires_at=hr(l.expires_in)),{data:c,error:null}}catch(o){return{data:null,error:o}}})}inviteUserByEmail(r,e={}){return Ve(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let a="";return e.redirectTo&&(a+="?redirect_to="+encodeURIComponent(e.redirectTo)),{data:yield gt(this.fetch,`${this.url}/invite${a}`,{email:r,data:e.data},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}resetPasswordForEmail(r,e={}){return Ve(this,void 0,void 0,function*(){try{const s=Object.assign({},this.headers);let a="";return e.redirectTo&&(a+="?redirect_to="+encodeURIComponent(e.redirectTo)),{data:yield gt(this.fetch,`${this.url}/recover${a}`,{email:r,gotrue_meta_security:{captcha_token:e.captchaToken}},{headers:s}),error:null}}catch(s){return{data:null,error:s}}})}refreshAccessToken(r){return Ve(this,void 0,void 0,function*(){try{const e=yield gt(this.fetch,`${this.url}/token?grant_type=refresh_token`,{refresh_token:r},{headers:this.headers}),s=Object.assign({},e);return s.expires_in&&(s.expires_at=hr(e.expires_in)),{data:s,error:null}}catch(e){return{data:null,error:e}}})}setAuthCookie(r,e){r.method!=="POST"&&(e.setHeader("Allow","POST"),e.status(405).end("Method Not Allowed"));const{event:s,session:a}=r.body;if(!s)throw new Error("Auth event missing!");if(s==="SIGNED_IN"){if(!a)throw new Error("Auth session missing!");qs(r,e,[{key:"access-token",value:a.access_token},{key:"refresh-token",value:a.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}s==="SIGNED_OUT"&&qs(r,e,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))),e.status(200).json({})}deleteAuthCookie(r,e,{redirectTo:s="/"}){return qs(r,e,["access-token","refresh-token"].map(a=>({name:`${this.cookieName()}-${a}`,value:"",maxAge:-1}))),e.redirect(307,s)}getAuthCookieString(r,e){r.method!=="POST"&&(e.setHeader("Allow","POST"),e.status(405).end("Method Not Allowed"));const{event:s,session:a}=r.body;if(!s)throw new Error("Auth event missing!");if(s==="SIGNED_IN"){if(!a)throw new Error("Auth session missing!");return va(r,e,[{key:"access-token",value:a.access_token},{key:"refresh-token",value:a.refresh_token}].map(i=>{var o;return{name:`${this.cookieName()}-${i.key}`,value:i.value,domain:this.cookieOptions.domain,maxAge:(o=this.cookieOptions.lifetime)!==null&&o!==void 0?o:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}}))}return s==="SIGNED_OUT"?va(r,e,["access-token","refresh-token"].map(i=>({name:`${this.cookieName()}-${i}`,value:"",maxAge:-1}))):e.getHeader("Set-Cookie")}generateLink(r,e,s={}){return Ve(this,void 0,void 0,function*(){try{return{data:yield gt(this.fetch,`${this.url}/admin/generate_link`,{type:r,email:e,password:s.password,data:s.data,redirect_to:s.redirectTo},{headers:this.headers}),error:null}}catch(a){return{data:null,error:a}}})}createUser(r){return Ve(this,void 0,void 0,function*(){try{const e=yield gt(this.fetch,`${this.url}/admin/users`,r,{headers:this.headers});return{user:e,data:e,error:null}}catch(e){return{user:null,data:null,error:e}}})}listUsers(){return Ve(this,void 0,void 0,function*(){try{return{data:(yield Qn(this.fetch,`${this.url}/admin/users`,{headers:this.headers})).users,error:null}}catch(r){return{data:null,error:r}}})}getUserById(r){return Ve(this,void 0,void 0,function*(){try{return{data:yield Qn(this.fetch,`${this.url}/admin/users/${r}`,{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}getUserByCookie(r,e){return Ve(this,void 0,void 0,function*(){try{if(!r.cookies)throw new Error("Not able to parse cookies! When using Express make sure the cookie-parser middleware is in use!");const s=r.cookies[`${this.cookieName()}-access-token`],a=r.cookies[`${this.cookieName()}-refresh-token`];if(!s)throw new Error("No cookie found!");const{user:i,error:o}=yield this.getUser(s);if(o){if(!a)throw new Error("No refresh_token cookie found!");if(!e)throw new Error("You need to pass the res object to automatically refresh the session!");const{data:l,error:c}=yield this.refreshAccessToken(a);if(c)throw c;if(l)return qs(r,e,[{key:"access-token",value:l.access_token},{key:"refresh-token",value:l.refresh_token}].map(h=>{var d;return{name:`${this.cookieName()}-${h.key}`,value:h.value,domain:this.cookieOptions.domain,maxAge:(d=this.cookieOptions.lifetime)!==null&&d!==void 0?d:0,path:this.cookieOptions.path,sameSite:this.cookieOptions.sameSite}})),{token:l.access_token,user:l.user,data:l.user,error:null}}return{token:s,user:i,data:i,error:null}}catch(s){return{token:null,user:null,data:null,error:s}}})}updateUserById(r,e){return Ve(this,void 0,void 0,function*(){try{const s=yield ui(this.fetch,`${this.url}/admin/users/${r}`,e,{headers:this.headers});return{user:s,data:s,error:null}}catch(s){return{user:null,data:null,error:s}}})}deleteUser(r){return Ve(this,void 0,void 0,function*(){try{const e=yield v0(this.fetch,`${this.url}/admin/users/${r}`,{},{headers:this.headers});return{user:e,data:e,error:null}}catch(e){return{user:null,data:null,error:e}}})}getUser(r){return Ve(this,void 0,void 0,function*(){try{const e=yield Qn(this.fetch,`${this.url}/user`,{headers:this._createRequestHeaders(r)});return{user:e,data:e,error:null}}catch(e){return{user:null,data:null,error:e}}})}updateUser(r,e){return Ve(this,void 0,void 0,function*(){try{const s=yield ui(this.fetch,`${this.url}/user`,e,{headers:this._createRequestHeaders(r)});return{user:s,data:s,error:null}}catch(s){return{user:null,data:null,error:s}}})}}function R0(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}var vt=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};R0();const F0={url:f0,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:u0},D0=t=>{try{return atob(t.replace(/[-]/g,"+").replace(/[_]/g,"/"))}catch(r){if(r instanceof ReferenceError)return Buffer.from(t,"base64").toString("utf-8");throw r}};class O0{constructor(r){this.stateChangeEmitters=new Map,this.networkRetries=0;const e=Object.assign(Object.assign({},F0),r);this.currentUser=null,this.currentSession=null,this.autoRefreshToken=e.autoRefreshToken,this.persistSession=e.persistSession,this.multiTab=e.multiTab,this.localStorage=e.localStorage||globalThis.localStorage,this.api=new A0({url:e.url,headers:e.headers,cookieOptions:e.cookieOptions,fetch:e.fetch}),this._recoverSession(),this._recoverAndRefresh(),this._listenForMultiTabEvents(),this._handleVisibilityChange(),e.detectSessionInUrl&&rr()&&tr("access_token")&&this.getSessionFromUrl({storeSession:!0}).then(({error:s})=>{if(s)throw new Error("Error getting session from URL.")})}signUp({email:r,password:e,phone:s},a={}){return vt(this,void 0,void 0,function*(){try{this._removeSession();const{data:i,error:o}=s&&e?yield this.api.signUpWithPhone(s,e,{data:a.data,captchaToken:a.captchaToken}):yield this.api.signUpWithEmail(r,e,{redirectTo:a.redirectTo,data:a.data,captchaToken:a.captchaToken});if(o)throw o;if(!i)throw"An error occurred on sign up.";let l=null,c=null;return i.access_token&&(l=i,c=l.user,this._saveSession(l),this._notifyAllSubscribers("SIGNED_IN")),i.id&&(c=i),{user:c,session:l,error:null}}catch(i){return{user:null,session:null,error:i}}})}signIn({email:r,phone:e,password:s,refreshToken:a,provider:i,oidc:o},l={}){return vt(this,void 0,void 0,function*(){try{if(this._removeSession(),r&&!s){const{error:c}=yield this.api.sendMagicLinkEmail(r,{redirectTo:l.redirectTo,shouldCreateUser:l.shouldCreateUser,captchaToken:l.captchaToken});return{user:null,session:null,error:c}}if(r&&s)return this._handleEmailSignIn(r,s,{redirectTo:l.redirectTo,captchaToken:l.captchaToken});if(e&&!s){const{error:c}=yield this.api.sendMobileOTP(e,{shouldCreateUser:l.shouldCreateUser,captchaToken:l.captchaToken});return{user:null,session:null,error:c}}if(e&&s)return this._handlePhoneSignIn(e,s);if(a){const{error:c}=yield this._callRefreshToken(a);if(c)throw c;return{user:this.currentUser,session:this.currentSession,error:null}}if(i)return this._handleProviderSignIn(i,{redirectTo:l.redirectTo,scopes:l.scopes,queryParams:l.queryParams});if(o)return this._handleOpenIDConnectSignIn(o);throw new Error("You must provide either an email, phone number, a third-party provider or OpenID Connect.")}catch(c){return{user:null,session:null,error:c}}})}verifyOTP(r,e={}){return vt(this,void 0,void 0,function*(){try{this._removeSession();const{data:s,error:a}=yield this.api.verifyOTP(r,e);if(a)throw a;if(!s)throw"An error occurred on token verification.";let i=null,o=null;return s.access_token&&(i=s,o=i.user,this._saveSession(i),this._notifyAllSubscribers("SIGNED_IN")),s.id&&(o=s),{user:o,session:i,error:null}}catch(s){return{user:null,session:null,error:s}}})}user(){return this.currentUser}session(){return this.currentSession}refreshSession(){var r;return vt(this,void 0,void 0,function*(){try{if(!(!((r=this.currentSession)===null||r===void 0)&&r.access_token))throw new Error("Not logged in.");const{error:e}=yield this._callRefreshToken();if(e)throw e;return{data:this.currentSession,user:this.currentUser,error:null}}catch(e){return{data:null,user:null,error:e}}})}update(r){var e;return vt(this,void 0,void 0,function*(){try{if(!(!((e=this.currentSession)===null||e===void 0)&&e.access_token))throw new Error("Not logged in.");const{user:s,error:a}=yield this.api.updateUser(this.currentSession.access_token,r);if(a)throw a;if(!s)throw Error("Invalid user data.");const i=Object.assign(Object.assign({},this.currentSession),{user:s});return this._saveSession(i),this._notifyAllSubscribers("USER_UPDATED"),{data:s,user:s,error:null}}catch(s){return{data:null,user:null,error:s}}})}setSession(r){return vt(this,void 0,void 0,function*(){let e;if(typeof r=="string"){const s=r,{data:a,error:i}=yield this.api.refreshAccessToken(s);if(i)return{session:null,error:i};e=a}else{const s=Math.round(Date.now()/1e3);let{refresh_token:a,access_token:i}=r,o=0,l=0;const c=i.split(".");if(c.length!==3)throw new Error("access_token is not a proper JWT");const h=D0(c[1]);let d;try{d=JSON.parse(h)}catch{throw new Error("access_token is not a proper JWT, invalid JSON in body")}if(typeof d=="object"&&d&&typeof d.exp=="number")o=d.exp,l=s-d.exp;else throw new Error("access_token is not a proper JWT, missing exp claim");if(s>o){const{data:f,error:u}=yield this.api.refreshAccessToken(a);if(u)return{session:null,error:u};e=f}else{const{user:f,error:u}=yield this.api.getUser(i);if(u)throw u;e={access_token:i,expires_in:l,expires_at:o,refresh_token:a,token_type:"bearer",user:f}}}try{return this._saveSession(e),this._notifyAllSubscribers("SIGNED_IN"),{session:e,error:null}}catch(s){return{error:s,session:null}}})}setAuth(r){return this.currentSession=Object.assign(Object.assign({},this.currentSession),{access_token:r,token_type:"bearer",user:this.user()}),this._notifyAllSubscribers("TOKEN_REFRESHED"),this.currentSession}getSessionFromUrl(r){return vt(this,void 0,void 0,function*(){try{if(!rr())throw new Error("No browser detected.");const e=tr("error_description");if(e)throw new Error(e);const s=tr("provider_token"),a=tr("provider_refresh_token"),i=tr("access_token");if(!i)throw new Error("No access_token detected.");const o=tr("expires_in");if(!o)throw new Error("No expires_in detected.");const l=tr("refresh_token");if(!l)throw new Error("No refresh_token detected.");const c=tr("token_type");if(!c)throw new Error("No token_type detected.");const d=Math.round(Date.now()/1e3)+parseInt(o),{user:f,error:u}=yield this.api.getUser(i);if(u)throw u;const m={provider_token:s,provider_refresh_token:a,access_token:i,expires_in:parseInt(o),expires_at:d,refresh_token:l,token_type:c,user:f};if(r?.storeSession){this._saveSession(m);const p=tr("type");this._notifyAllSubscribers("SIGNED_IN"),p==="recovery"&&this._notifyAllSubscribers("PASSWORD_RECOVERY")}return window.location.hash="",{data:m,error:null}}catch(e){return{data:null,error:e}}})}signOut(){var r;return vt(this,void 0,void 0,function*(){const e=(r=this.currentSession)===null||r===void 0?void 0:r.access_token;if(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"),e){const{error:s}=yield this.api.signOut(e);if(s)return{error:s}}return{error:null}})}onAuthStateChange(r){try{const e=N0(),s={id:e,callback:r,unsubscribe:()=>{this.stateChangeEmitters.delete(e)}};return this.stateChangeEmitters.set(e,s),{data:s,error:null}}catch(e){return{data:null,error:e}}}_handleEmailSignIn(r,e,s={}){var a,i;return vt(this,void 0,void 0,function*(){try{const{data:o,error:l}=yield this.api.signInWithEmail(r,e,{redirectTo:s.redirectTo,captchaToken:s.captchaToken});return l||!o?{data:null,user:null,session:null,error:l}:((!((a=o?.user)===null||a===void 0)&&a.confirmed_at||!((i=o?.user)===null||i===void 0)&&i.email_confirmed_at)&&(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN")),{data:o,user:o.user,session:o,error:null})}catch(o){return{data:null,user:null,session:null,error:o}}})}_handlePhoneSignIn(r,e,s={}){var a;return vt(this,void 0,void 0,function*(){try{const{data:i,error:o}=yield this.api.signInWithPhone(r,e,s);return o||!i?{data:null,user:null,session:null,error:o}:(!((a=i?.user)===null||a===void 0)&&a.phone_confirmed_at&&(this._saveSession(i),this._notifyAllSubscribers("SIGNED_IN")),{data:i,user:i.user,session:i,error:null})}catch(i){return{data:null,user:null,session:null,error:i}}})}_handleProviderSignIn(r,e={}){const s=this.api.getUrlForProvider(r,{redirectTo:e.redirectTo,scopes:e.scopes,queryParams:e.queryParams});try{return rr()&&(window.location.href=s),{provider:r,url:s,data:null,session:null,user:null,error:null}}catch(a){return s?{provider:r,url:s,data:null,session:null,user:null,error:null}:{data:null,user:null,session:null,error:a}}}_handleOpenIDConnectSignIn({id_token:r,nonce:e,client_id:s,issuer:a,provider:i}){return vt(this,void 0,void 0,function*(){if(r&&e&&(s&&a||i))try{const{data:o,error:l}=yield this.api.signInWithOpenIDConnect({id_token:r,nonce:e,client_id:s,issuer:a,provider:i});return l||!o?{user:null,session:null,error:l}:(this._saveSession(o),this._notifyAllSubscribers("SIGNED_IN"),{user:o.user,session:o,error:null})}catch(o){return{user:null,session:null,error:o}}throw new Error("You must provide a OpenID Connect provider with your id token and nonce.")})}_recoverSession(){try{const r=C0(this.localStorage,ps);if(!r)return null;const{currentSession:e,expiresAt:s}=r,a=Math.round(Date.now()/1e3);s>=a+Ys&&e?.user&&(this._saveSession(e),this._notifyAllSubscribers("SIGNED_IN"))}catch(r){console.log("error",r)}}_recoverAndRefresh(){return vt(this,void 0,void 0,function*(){try{const r=yield T0(this.localStorage,ps);if(!r)return null;const{currentSession:e,expiresAt:s}=r,a=Math.round(Date.now()/1e3);if(s<a+Ys)if(this.autoRefreshToken&&e.refresh_token){this.networkRetries++;const{error:i}=yield this._callRefreshToken(e.refresh_token);if(i){if(console.log(i.message),i.message===jr.ERROR_MESSAGE&&this.networkRetries<jr.MAX_RETRIES){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),this.refreshTokenTimer=setTimeout(()=>this._recoverAndRefresh(),Math.pow(jr.RETRY_INTERVAL,this.networkRetries)*100);return}yield this._removeSession()}this.networkRetries=0}else this._removeSession();else e?(this._saveSession(e),this._notifyAllSubscribers("SIGNED_IN")):(console.log("Current session is missing data."),this._removeSession())}catch(r){return console.error(r),null}})}_callRefreshToken(r){var e;return r===void 0&&(r=(e=this.currentSession)===null||e===void 0?void 0:e.refresh_token),vt(this,void 0,void 0,function*(){try{if(!r)throw new Error("No current session.");const{data:s,error:a}=yield this.api.refreshAccessToken(r);if(a)throw a;if(!s)throw Error("Invalid session data.");return this._saveSession(s),this._notifyAllSubscribers("TOKEN_REFRESHED"),this._notifyAllSubscribers("SIGNED_IN"),{data:s,error:null}}catch(s){return{data:null,error:s}}})}_notifyAllSubscribers(r){this.stateChangeEmitters.forEach(e=>e.callback(r,this.currentSession))}_saveSession(r){this.currentSession=r,this.currentUser=r.user;const e=r.expires_at;if(e){const s=Math.round(Date.now()/1e3),a=e-s,i=a>Ys?Ys:.5;this._startAutoRefreshToken((a-i)*1e3)}this.persistSession&&r.expires_at&&this._persistSession(this.currentSession)}_persistSession(r){const e={currentSession:r,expiresAt:r.expires_at};E0(this.localStorage,ps,e)}_removeSession(){return vt(this,void 0,void 0,function*(){this.currentSession=null,this.currentUser=null,this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),k0(this.localStorage,ps)})}_startAutoRefreshToken(r){this.refreshTokenTimer&&clearTimeout(this.refreshTokenTimer),!(r<=0||!this.autoRefreshToken)&&(this.refreshTokenTimer=setTimeout(()=>vt(this,void 0,void 0,function*(){this.networkRetries++;const{error:e}=yield this._callRefreshToken();e||(this.networkRetries=0),e?.message===jr.ERROR_MESSAGE&&this.networkRetries<jr.MAX_RETRIES&&this._startAutoRefreshToken(Math.pow(jr.RETRY_INTERVAL,this.networkRetries)*100)}),r),typeof this.refreshTokenTimer.unref=="function"&&this.refreshTokenTimer.unref())}_listenForMultiTabEvents(){if(!this.multiTab||!rr()||!window?.addEventListener)return!1;try{window?.addEventListener("storage",r=>{var e;if(r.key===ps){const s=JSON.parse(String(r.newValue));!((e=s?.currentSession)===null||e===void 0)&&e.access_token?(this._saveSession(s.currentSession),this._notifyAllSubscribers("SIGNED_IN")):(this._removeSession(),this._notifyAllSubscribers("SIGNED_OUT"))}})}catch(r){console.error("_listenForMultiTabEvents",r)}}_handleVisibilityChange(){if(!this.multiTab||!rr()||!window?.addEventListener)return!1;try{window?.addEventListener("visibilitychange",()=>{document.visibilityState==="visible"&&this._recoverAndRefresh()})}catch(r){console.error("_handleVisibilityChange",r)}}}class I0 extends O0{constructor(r){super(r)}}var mi=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};class Pa{constructor(r){Object.assign(this,r);let e;r.fetch?e=r.fetch:typeof fetch>"u"?e=(...s)=>mi(this,void 0,void 0,function*(){return yield(yield In(()=>import("./browser-ponyfill-DIMAIuBD.js").then(a=>a.b),__vite__mapDeps([0,1]))).fetch(...s)}):e=fetch,this.fetch=(...s)=>e(...s),this.shouldThrowOnError=r.shouldThrowOnError||!1,this.allowEmpty=r.allowEmpty||!1}throwOnError(r){return r==null&&(r=!0),this.shouldThrowOnError=r,this}then(r,e){typeof this.schema>"u"||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");let s=this.fetch(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(a=>mi(this,void 0,void 0,function*(){var i,o,l,c;let h=null,d=null,f=null,u=a.status,m=a.statusText;if(a.ok){const x=(i=this.headers.Prefer)===null||i===void 0?void 0:i.split(",").includes("return=minimal");if(this.method!=="HEAD"&&!x){const b=yield a.text();b&&(this.headers.Accept==="text/csv"?d=b:d=JSON.parse(b))}const g=(o=this.headers.Prefer)===null||o===void 0?void 0:o.match(/count=(exact|planned|estimated)/),T=(l=a.headers.get("content-range"))===null||l===void 0?void 0:l.split("/");g&&T&&T.length>1&&(f=parseInt(T[1]))}else{const x=yield a.text();try{h=JSON.parse(x)}catch{h={message:x}}if(h&&this.allowEmpty&&(!((c=h?.details)===null||c===void 0)&&c.includes("Results contain 0 rows"))&&(h=null,u=200,m="OK"),h&&this.shouldThrowOnError)throw h}return{error:h,data:d,count:f,status:u,statusText:m,body:d}}));return this.shouldThrowOnError||(s=s.catch(a=>({error:{message:`FetchError: ${a.message}`,details:"",hint:"",code:a.code||""},data:null,body:null,count:null,status:400,statusText:"Bad Request"}))),s.then(r,e)}}class P0 extends Pa{select(r="*"){let e=!1;const s=r.split("").map(a=>/\s/.test(a)&&!e?"":(a==='"'&&(e=!e),a)).join("");return this.url.searchParams.set("select",s),this}order(r,{ascending:e=!0,nullsFirst:s=!1,foreignTable:a}={}){const i=typeof a>"u"?"order":`${a}.order`,o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${r}.${e?"asc":"desc"}.${s?"nullsfirst":"nullslast"}`),this}limit(r,{foreignTable:e}={}){const s=typeof e>"u"?"limit":`${e}.limit`;return this.url.searchParams.set(s,`${r}`),this}range(r,e,{foreignTable:s}={}){const a=typeof s>"u"?"offset":`${s}.offset`,i=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(a,`${r}`),this.url.searchParams.set(i,`${e-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.headers.Accept="application/vnd.pgrst.object+json",this.allowEmpty=!0,this}csv(){return this.headers.Accept="text/csv",this}}class Vr extends P0{constructor(){super(...arguments),this.cs=this.contains,this.cd=this.containedBy,this.sl=this.rangeLt,this.sr=this.rangeGt,this.nxl=this.rangeGte,this.nxr=this.rangeLte,this.adj=this.rangeAdjacent,this.ov=this.overlaps}not(r,e,s){return this.url.searchParams.append(`${r}`,`not.${e}.${s}`),this}or(r,{foreignTable:e}={}){const s=typeof e>"u"?"or":`${e}.or`;return this.url.searchParams.append(s,`(${r})`),this}eq(r,e){return this.url.searchParams.append(`${r}`,`eq.${e}`),this}neq(r,e){return this.url.searchParams.append(`${r}`,`neq.${e}`),this}gt(r,e){return this.url.searchParams.append(`${r}`,`gt.${e}`),this}gte(r,e){return this.url.searchParams.append(`${r}`,`gte.${e}`),this}lt(r,e){return this.url.searchParams.append(`${r}`,`lt.${e}`),this}lte(r,e){return this.url.searchParams.append(`${r}`,`lte.${e}`),this}like(r,e){return this.url.searchParams.append(`${r}`,`like.${e}`),this}ilike(r,e){return this.url.searchParams.append(`${r}`,`ilike.${e}`),this}is(r,e){return this.url.searchParams.append(`${r}`,`is.${e}`),this}in(r,e){const s=e.map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(`${r}`,`in.(${s})`),this}contains(r,e){return typeof e=="string"?this.url.searchParams.append(`${r}`,`cs.${e}`):Array.isArray(e)?this.url.searchParams.append(`${r}`,`cs.{${e.join(",")}}`):this.url.searchParams.append(`${r}`,`cs.${JSON.stringify(e)}`),this}containedBy(r,e){return typeof e=="string"?this.url.searchParams.append(`${r}`,`cd.${e}`):Array.isArray(e)?this.url.searchParams.append(`${r}`,`cd.{${e.join(",")}}`):this.url.searchParams.append(`${r}`,`cd.${JSON.stringify(e)}`),this}rangeLt(r,e){return this.url.searchParams.append(`${r}`,`sl.${e}`),this}rangeGt(r,e){return this.url.searchParams.append(`${r}`,`sr.${e}`),this}rangeGte(r,e){return this.url.searchParams.append(`${r}`,`nxl.${e}`),this}rangeLte(r,e){return this.url.searchParams.append(`${r}`,`nxr.${e}`),this}rangeAdjacent(r,e){return this.url.searchParams.append(`${r}`,`adj.${e}`),this}overlaps(r,e){return typeof e=="string"?this.url.searchParams.append(`${r}`,`ov.${e}`):this.url.searchParams.append(`${r}`,`ov.{${e.join(",")}}`),this}textSearch(r,e,{config:s,type:a=null}={}){let i="";a==="plain"?i="pl":a==="phrase"?i="ph":a==="websearch"&&(i="w");const o=s===void 0?"":`(${s})`;return this.url.searchParams.append(`${r}`,`${i}fts${o}.${e}`),this}fts(r,e,{config:s}={}){const a=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`fts${a}.${e}`),this}plfts(r,e,{config:s}={}){const a=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`plfts${a}.${e}`),this}phfts(r,e,{config:s}={}){const a=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`phfts${a}.${e}`),this}wfts(r,e,{config:s}={}){const a=typeof s>"u"?"":`(${s})`;return this.url.searchParams.append(`${r}`,`wfts${a}.${e}`),this}filter(r,e,s){return this.url.searchParams.append(`${r}`,`${e}.${s}`),this}match(r){return Object.keys(r).forEach(e=>{this.url.searchParams.append(`${e}`,`eq.${r[e]}`)}),this}}class vo extends Pa{constructor(r,{headers:e={},schema:s,fetch:a,shouldThrowOnError:i}={}){super({fetch:a,shouldThrowOnError:i}),this.url=new URL(r),this.headers=Object.assign({},e),this.schema=s}select(r="*",{head:e=!1,count:s=null}={}){this.method="GET";let a=!1;const i=r.split("").map(o=>/\s/.test(o)&&!a?"":(o==='"'&&(a=!a),o)).join("");return this.url.searchParams.set("select",i),s&&(this.headers.Prefer=`count=${s}`),e&&(this.method="HEAD"),new Vr(this)}insert(r,{upsert:e=!1,onConflict:s,returning:a="representation",count:i=null}={}){this.method="POST";const o=[`return=${a}`];if(e&&o.push("resolution=merge-duplicates"),e&&s!==void 0&&this.url.searchParams.set("on_conflict",s),this.body=r,i&&o.push(`count=${i}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),Array.isArray(r)){const l=r.reduce((c,h)=>c.concat(Object.keys(h)),[]);if(l.length>0){const c=[...new Set(l)].map(h=>`"${h}"`);this.url.searchParams.set("columns",c.join(","))}}return new Vr(this)}upsert(r,{onConflict:e,returning:s="representation",count:a=null,ignoreDuplicates:i=!1}={}){this.method="POST";const o=[`resolution=${i?"ignore":"merge"}-duplicates`,`return=${s}`];return e!==void 0&&this.url.searchParams.set("on_conflict",e),this.body=r,a&&o.push(`count=${a}`),this.headers.Prefer&&o.unshift(this.headers.Prefer),this.headers.Prefer=o.join(","),new Vr(this)}update(r,{returning:e="representation",count:s=null}={}){this.method="PATCH";const a=[`return=${e}`];return this.body=r,s&&a.push(`count=${s}`),this.headers.Prefer&&a.unshift(this.headers.Prefer),this.headers.Prefer=a.join(","),new Vr(this)}delete({returning:r="representation",count:e=null}={}){this.method="DELETE";const s=[`return=${r}`];return e&&s.push(`count=${e}`),this.headers.Prefer&&s.unshift(this.headers.Prefer),this.headers.Prefer=s.join(","),new Vr(this)}}class L0 extends Pa{constructor(r,{headers:e={},schema:s,fetch:a,shouldThrowOnError:i}={}){super({fetch:a,shouldThrowOnError:i}),this.url=new URL(r),this.headers=Object.assign({},e),this.schema=s}rpc(r,{head:e=!1,count:s=null}={}){return e?(this.method="HEAD",r&&Object.entries(r).forEach(([a,i])=>{this.url.searchParams.append(a,i)})):(this.method="POST",this.body=r),s&&(this.headers.Prefer!==void 0?this.headers.Prefer+=`,count=${s}`:this.headers.Prefer=`count=${s}`),new Vr(this)}}const B0="0.37.4",M0={"X-Client-Info":`postgrest-js/${B0}`};class z0{constructor(r,{headers:e={},schema:s,fetch:a,throwOnError:i}={}){this.url=r,this.headers=Object.assign(Object.assign({},M0),e),this.schema=s,this.fetch=a,this.shouldThrowOnError=i}auth(r){return this.headers.Authorization=`Bearer ${r}`,this}from(r){const e=`${this.url}/${r}`;return new vo(e,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(r,e,{head:s=!1,count:a=null}={}){const i=`${this.url}/rpc/${r}`;return new L0(i,{headers:this.headers,schema:this.schema,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError}).rpc(e,{head:s,count:a})}}var ze;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(ze||(ze={}));const pi=(t,r,e={})=>{var s;const a=(s=e.skipTypes)!==null&&s!==void 0?s:[];return Object.keys(r).reduce((i,o)=>(i[o]=U0(o,t,r,a),i),{})},U0=(t,r,e,s)=>{const a=r.find(l=>l.name===t),i=a?.type,o=e[t];return i&&!s.includes(i)?yo(i,o):ya(o)},yo=(t,r)=>{if(t.charAt(0)==="_"){const e=t.slice(1,t.length);return G0(r,e)}switch(t){case ze.bool:return $0(r);case ze.float4:case ze.float8:case ze.int2:case ze.int4:case ze.int8:case ze.numeric:case ze.oid:return H0(r);case ze.json:case ze.jsonb:return W0(r);case ze.timestamp:return V0(r);case ze.abstime:case ze.date:case ze.daterange:case ze.int4range:case ze.int8range:case ze.money:case ze.reltime:case ze.text:case ze.time:case ze.timestamptz:case ze.timetz:case ze.tsrange:case ze.tstzrange:return ya(r);default:return ya(r)}},ya=t=>t,$0=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},H0=t=>{if(typeof t=="string"){const r=parseFloat(t);if(!Number.isNaN(r))return r}return t},W0=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(r){return console.log(`JSON parse error: ${r}`),t}return t},G0=(t,r)=>{if(typeof t!="string")return t;const e=t.length-1,s=t[e];if(t[0]==="{"&&s==="}"){let i;const o=t.slice(1,e);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>yo(r,l))}return t},V0=t=>typeof t=="string"?t.replace(" ","T"):t;var Zn,gi;function X0(){if(gi)return Zn;gi=1;var t=function(){if(typeof self=="object"&&self)return self;if(typeof window=="object"&&window)return window;throw new Error("Unable to resolve global `this`")};return Zn=function(){if(this)return this;if(typeof globalThis=="object"&&globalThis)return globalThis;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch{return t()}try{return __global__||t()}finally{delete Object.prototype.__global__}}(),Zn}const K0="1.0.35",Y0={version:K0};var q0=Y0.version,Er;if(typeof globalThis=="object")Er=globalThis;else try{Er=X0()}catch{}finally{if(!Er&&typeof window<"u"&&(Er=window),!Er)throw new Error("Could not determine global this")}var ks=Er.WebSocket||Er.MozWebSocket,J0=q0;function bo(t,r){var e;return r?e=new ks(t,r):e=new ks(t),e}ks&&["CONNECTING","OPEN","CLOSING","CLOSED"].forEach(function(t){Object.defineProperty(bo,t,{get:function(){return ks[t]}})});var Q0={w3cwebsocket:ks?bo:null,version:J0};const Z0="1.7.5",ed={"X-Client-Info":`realtime-js/${Z0}`},td="1.0.0",wo=1e4,rd=1e3;var bs;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(bs||(bs={}));var St;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(St||(St={}));var $t;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})($t||($t={}));var ba;(function(t){t.websocket="websocket"})(ba||(ba={}));var Tr;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Tr||(Tr={}));class _o{constructor(r,e){this.callback=r,this.timerCalc=e,this.timer=void 0,this.tries=0,this.callback=r,this.timerCalc=e}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}class sd{constructor(){this.HEADER_LENGTH=1}decode(r,e){return r.constructor===ArrayBuffer?e(this._binaryDecode(r)):e(typeof r=="string"?JSON.parse(r):{})}_binaryDecode(r){const e=new DataView(r),s=new TextDecoder;return this._decodeBroadcast(r,e,s)}_decodeBroadcast(r,e,s){const a=e.getUint8(1),i=e.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(r.slice(o,o+a));o=o+a;const c=s.decode(r.slice(o,o+i));o=o+i;const h=JSON.parse(s.decode(r.slice(o,r.byteLength)));return{ref:null,topic:l,event:c,payload:h}}}class ea{constructor(r,e,s={},a=wo){this.channel=r,this.event=e,this.payload=s,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(r){this.timeout=r,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel.joinRef()}))}updatePayload(r){this.payload=Object.assign(Object.assign({},this.payload),r)}receive(r,e){var s;return this._hasReceived(r)&&e((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:r,callback:e}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket.makeRef(),this.refEvent=this.channel.replyEventName(this.ref);const r=e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)};this.channel.on(this.refEvent,r),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(r,e){this.refEvent&&this.channel.trigger(this.refEvent,{status:r,response:e})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel.off(this.refEvent)}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:r,response:e}){this.recHooks.filter(s=>s.status===r).forEach(s=>s.callback(e))}_hasReceived(r){return this.receivedResp&&this.receivedResp.status===r}}class nd{constructor(r,e={},s){this.topic=r,this.params=e,this.socket=s,this.bindings=[],this.state=St.closed,this.joinedOnce=!1,this.pushBuffer=[],this.timeout=this.socket.timeout,this.joinPush=new ea(this,$t.join,this.params,this.timeout),this.rejoinTimer=new _o(()=>this.rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=St.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this.onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this.joinRef()}`),this.state=St.closed,this.socket.remove(this)}),this.onError(a=>{this.isLeaving()||this.isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=St.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this.isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=St.errored,this.rejoinTimer.scheduleTimeout())}),this.on($t.reply,(a,i)=>{this.trigger(this.replyEventName(i),a)})}rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this.rejoin()}subscribe(r=this.timeout){if(this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";return this.joinedOnce=!0,this.rejoin(r),this.joinPush}onClose(r){this.on($t.close,r)}onError(r){this.on($t.error,e=>r(e))}on(r,e){this.bindings.push({event:r,callback:e})}off(r){this.bindings=this.bindings.filter(e=>e.event!==r)}canPush(){return this.socket.isConnected()&&this.isJoined()}push(r,e,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${r}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new ea(this,r,e,s);return this.canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}updateJoinPayload(r){this.joinPush.updatePayload(r)}unsubscribe(r=this.timeout){this.state=St.leaving;let e=()=>{this.socket.log("channel",`leave ${this.topic}`),this.trigger($t.close,"leave",this.joinRef())};this.joinPush.destroy();let s=new ea(this,$t.leave,{},r);return s.receive("ok",()=>e()).receive("timeout",()=>e()),s.send(),this.canPush()||s.trigger("ok",{}),s}onMessage(r,e,s){return e}isMember(r){return this.topic===r}joinRef(){return this.joinPush.ref}rejoin(r=this.timeout){this.isLeaving()||(this.socket.leaveOpenTopic(this.topic),this.state=St.joining,this.joinPush.resend(r))}trigger(r,e,s){let{close:a,error:i,leave:o,join:l}=$t;if(s&&[a,i,o,l].indexOf(r)>=0&&s!==this.joinRef())return;let h=this.onMessage(r,e,s);if(e&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";this.bindings.filter(d=>d.event==="*"?r===e?.type:d.event===r).map(d=>d.callback(h,s))}replyEventName(r){return`chan_reply_${r}`}isClosed(){return this.state===St.closed}isErrored(){return this.state===St.errored}isJoined(){return this.state===St.joined}isJoining(){return this.state===St.joining}isLeaving(){return this.state===St.leaving}}var ad=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};const id=()=>{};class od{constructor(r,e){this.accessToken=null,this.channels=[],this.endPoint="",this.headers=ed,this.params={},this.timeout=wo,this.transport=Q0.w3cwebsocket,this.heartbeatIntervalMs=3e4,this.longpollerTimeout=2e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=id,this.conn=null,this.sendBuffer=[],this.serializer=new sd,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.endPoint=`${r}/${ba.websocket}`,e?.params&&(this.params=e.params),e?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),e.headers)),e?.timeout&&(this.timeout=e.timeout),e?.logger&&(this.logger=e.logger),e?.transport&&(this.transport=e.transport),e?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=e.heartbeatIntervalMs),e?.longpollerTimeout&&(this.longpollerTimeout=e.longpollerTimeout),this.reconnectAfterMs=e?.reconnectAfterMs?e.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=e?.encode?e.encode:(s,a)=>a(JSON.stringify(s)),this.decode=e?.decode?e.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new _o(()=>ad(this,void 0,void 0,function*(){yield this.disconnect(),this.connect()}),this.reconnectAfterMs)}connect(){this.conn||(this.conn=new this.transport(this.endPointURL(),[],null,this.headers),this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=r=>this._onConnError(r),this.conn.onmessage=r=>this.onConnMessage(r),this.conn.onclose=r=>this._onConnClose(r)))}disconnect(r,e){return new Promise((s,a)=>{try{this.conn&&(this.conn.onclose=function(){},r?this.conn.close(r,e||""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset()),s({error:null,data:!0})}catch(i){s({error:i,data:!1})}})}log(r,e,s){this.logger(r,e,s)}onOpen(r){this.stateChangeCallbacks.open.push(r)}onClose(r){this.stateChangeCallbacks.close.push(r)}onError(r){this.stateChangeCallbacks.error.push(r)}onMessage(r){this.stateChangeCallbacks.message.push(r)}connectionState(){switch(this.conn&&this.conn.readyState){case bs.connecting:return Tr.Connecting;case bs.open:return Tr.Open;case bs.closing:return Tr.Closing;default:return Tr.Closed}}isConnected(){return this.connectionState()===Tr.Open}remove(r){this.channels=this.channels.filter(e=>e.joinRef()!==r.joinRef())}channel(r,e={}){const s=new nd(r,e,this);return this.channels.push(s),s}push(r){const{topic:e,event:s,payload:a,ref:i}=r;let o=()=>{this.encode(r,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${e} ${s} (${i})`,a),this.isConnected()?o():this.sendBuffer.push(o)}onConnMessage(r){this.decode(r.data,e=>{let{topic:s,event:a,payload:i,ref:o}=e;(o&&o===this.pendingHeartbeatRef||a===i?.type)&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${s} ${a} ${o&&"("+o+")"||""}`,i),this.channels.filter(l=>l.isMember(s)).forEach(l=>l.trigger(a,i,o)),this.stateChangeCallbacks.message.forEach(l=>l(e))})}endPointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:td}))}makeRef(){let r=this.ref+1;return r===this.ref?this.ref=0:this.ref=r,this.ref.toString()}setAuth(r){this.accessToken=r,this.channels.forEach(e=>{r&&e.updateJoinPayload({user_token:r}),e.joinedOnce&&e.isJoined()&&e.push($t.access_token,{access_token:r})})}leaveOpenTopic(r){let e=this.channels.find(s=>s.topic===r&&(s.isJoined()||s.isJoining()));e&&(this.log("transport",`leaving duplicate topic "${r}"`),e.unsubscribe())}_onConnOpen(){this.log("transport",`connected to ${this.endPointURL()}`),this._flushSendBuffer(),this.reconnectTimer.reset(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this._sendHeartbeat(),this.heartbeatIntervalMs),this.stateChangeCallbacks.open.forEach(r=>r())}_onConnClose(r){this.log("transport","close",r),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(e=>e(r))}_onConnError(r){this.log("transport",r.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(e=>e(r))}_triggerChanError(){this.channels.forEach(r=>r.trigger($t.error))}_appendParams(r,e){if(Object.keys(e).length===0)return r;const s=r.match(/\?/)?"&":"?",a=new URLSearchParams(e);return`${r}${s}${a}`}_flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(r=>r()),this.sendBuffer=[])}_sendHeartbeat(){var r;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(r=this.conn)===null||r===void 0||r.close(rd,"hearbeat timeout");return}this.pendingHeartbeatRef=this.makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth(this.accessToken)}}}class ld{constructor(r,e,s,a){const i={},o=a==="*"?`realtime:${s}`:`realtime:${s}:${a}`,l=e.Authorization.split(" ")[1];l&&(i.user_token=l),this.subscription=r.channel(o,i)}getPayloadRecords(r){const e={new:{},old:{}};return(r.type==="INSERT"||r.type==="UPDATE")&&(e.new=pi(r.columns,r.record)),(r.type==="UPDATE"||r.type==="DELETE")&&(e.old=pi(r.columns,r.old_record)),e}on(r,e){return this.subscription.on(r,s=>{let a={schema:s.schema,table:s.table,commit_timestamp:s.commit_timestamp,eventType:s.type,new:{},old:{},errors:s.errors};a=Object.assign(Object.assign({},a),this.getPayloadRecords(s)),e(a)}),this}subscribe(r=()=>{}){return this.subscription.onError(e=>r("SUBSCRIPTION_ERROR",e)),this.subscription.onClose(()=>r("CLOSED")),this.subscription.subscribe().receive("ok",()=>r("SUBSCRIBED")).receive("error",e=>r("SUBSCRIPTION_ERROR",e)).receive("timeout",()=>r("RETRYING_AFTER_TIMEOUT")),this.subscription}}class cd extends vo{constructor(r,{headers:e={},schema:s,realtime:a,table:i,fetch:o,shouldThrowOnError:l}){super(r,{headers:e,schema:s,fetch:o,shouldThrowOnError:l}),this._subscription=null,this._realtime=a,this._headers=e,this._schema=s,this._table=i}on(r,e){return this._realtime.isConnected()||this._realtime.connect(),this._subscription||(this._subscription=new ld(this._realtime,this._headers,this._schema,this._table)),this._subscription.on(r,e)}}const dd="1.7.3",hd={"X-Client-Info":`storage-js/${dd}`};var Ms=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};const fd=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),ud=(t,r)=>{if(typeof t.json!="function")return r(t);t.json().then(e=>r({message:fd(e),status:t?.status||500}))},xd=(t,r,e,s)=>{const a={method:t,headers:r?.headers||{}};return t==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},r?.headers),a.body=JSON.stringify(s),Object.assign(Object.assign({},a),e))};function Ln(t,r,e,s,a,i){return Ms(this,void 0,void 0,function*(){return new Promise((o,l)=>{t(e,xd(r,s,a,i)).then(c=>{if(!c.ok)throw c;return s?.noResolveJson?o(c):c.json()}).then(c=>o(c)).catch(c=>ud(c,l))})})}function wa(t,r,e,s){return Ms(this,void 0,void 0,function*(){return Ln(t,"GET",r,e,s)})}function Cr(t,r,e,s,a){return Ms(this,void 0,void 0,function*(){return Ln(t,"POST",r,s,a,e)})}function md(t,r,e,s,a){return Ms(this,void 0,void 0,function*(){return Ln(t,"PUT",r,s,a,e)})}function So(t,r,e,s,a){return Ms(this,void 0,void 0,function*(){return Ln(t,"DELETE",r,s,a,e)})}var pd=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};const No=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>pd(void 0,void 0,void 0,function*(){return yield(yield In(()=>import("./browser-ponyfill-DIMAIuBD.js").then(s=>s.b),__vite__mapDeps([0,1]))).fetch(...e)}):r=fetch,(...e)=>r(...e)};var $r=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};class gd{constructor(r,e={},s){this.url=r,this.headers=Object.assign(Object.assign({},hd),e),this.fetch=No(s)}listBuckets(){return $r(this,void 0,void 0,function*(){try{return{data:yield wa(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(r){return{data:null,error:r}}})}getBucket(r){return $r(this,void 0,void 0,function*(){try{return{data:yield wa(this.fetch,`${this.url}/bucket/${r}`,{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}createBucket(r,e={public:!1}){return $r(this,void 0,void 0,function*(){try{return{data:(yield Cr(this.fetch,`${this.url}/bucket`,{id:r,name:r,public:e.public},{headers:this.headers})).name,error:null}}catch(s){return{data:null,error:s}}})}updateBucket(r,e){return $r(this,void 0,void 0,function*(){try{return{data:yield md(this.fetch,`${this.url}/bucket/${r}`,{id:r,name:r,public:e.public},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}emptyBucket(r){return $r(this,void 0,void 0,function*(){try{return{data:yield Cr(this.fetch,`${this.url}/bucket/${r}/empty`,{},{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}deleteBucket(r){return $r(this,void 0,void 0,function*(){try{return{data:yield So(this.fetch,`${this.url}/bucket/${r}`,{},{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}}var Kt=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};const vd={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},yd={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class bd{constructor(r,e={},s,a){this.url=r,this.headers=e,this.bucketId=s,this.fetch=No(a)}uploadOrUpdate(r,e,s,a){return Kt(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},yd),a),l=Object.assign(Object.assign({},this.headers),r==="POST"&&{"x-upsert":String(o.upsert)});typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.append("cacheControl",o.cacheControl)):(i=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType);const c=this._removeEmptyFolders(e),h=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${h}`,{method:r,body:i,headers:l});return d.ok?{data:{Key:h},error:null}:{data:null,error:yield d.json()}}catch(i){return{data:null,error:i}}})}upload(r,e,s){return Kt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",r,e,s)})}update(r,e,s){return Kt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",r,e,s)})}move(r,e){return Kt(this,void 0,void 0,function*(){try{return{data:yield Cr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}copy(r,e){return Kt(this,void 0,void 0,function*(){try{return{data:yield Cr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:r,destinationKey:e},{headers:this.headers}),error:null}}catch(s){return{data:null,error:s}}})}createSignedUrl(r,e){return Kt(this,void 0,void 0,function*(){try{const s=this._getFinalPath(r);let a=yield Cr(this.fetch,`${this.url}/object/sign/${s}`,{expiresIn:e},{headers:this.headers});const i=`${this.url}${a.signedURL}`;return a={signedURL:i},{data:a,error:null,signedURL:i}}catch(s){return{data:null,error:s,signedURL:null}}})}createSignedUrls(r,e){return Kt(this,void 0,void 0,function*(){try{return{data:(yield Cr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:e,paths:r},{headers:this.headers})).map(a=>Object.assign(Object.assign({},a),{signedURL:a.signedURL?`${this.url}${a.signedURL}`:null})),error:null}}catch(s){return{data:null,error:s}}})}download(r){return Kt(this,void 0,void 0,function*(){try{const e=this._getFinalPath(r);return{data:yield(yield wa(this.fetch,`${this.url}/object/${e}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(e){return{data:null,error:e}}})}getPublicUrl(r){try{const e=this._getFinalPath(r),s=`${this.url}/object/public/${e}`;return{data:{publicURL:s},error:null,publicURL:s}}catch(e){return{data:null,error:e,publicURL:null}}}remove(r){return Kt(this,void 0,void 0,function*(){try{return{data:yield So(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:r},{headers:this.headers}),error:null}}catch(e){return{data:null,error:e}}})}list(r,e,s){return Kt(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},vd),e),{prefix:r||""});return{data:yield Cr(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},s),error:null}}catch(a){return{data:null,error:a}}})}_getFinalPath(r){return`${this.bucketId}/${r}`}_removeEmptyFolders(r){return r.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}}class wd extends gd{constructor(r,e={},s){super(r,e,s)}from(r){return new bd(this.url,this.headers,r,this.fetch)}}var _d=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};const Sd=t=>{let r;return t?r=t:typeof fetch>"u"?r=(...e)=>_d(void 0,void 0,void 0,function*(){return yield(yield In(()=>import("./browser-ponyfill-DIMAIuBD.js").then(s=>s.b),__vite__mapDeps([0,1]))).fetch(...e)}):r=fetch,(...e)=>r(...e)};var Nd=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};class jd{constructor(r,{headers:e={},customFetch:s}={}){this.url=r,this.headers=e,this.fetch=Sd(s)}setAuth(r){this.headers.Authorization=`Bearer ${r}`}invoke(r,e){return Nd(this,void 0,void 0,function*(){try{const{headers:s,body:a}=e??{},i=yield this.fetch(`${this.url}/${r}`,{method:"POST",headers:Object.assign({},this.headers,s),body:a}),o=i.headers.get("x-relay-error");if(o&&o==="true")return{data:null,error:new Error(yield i.text())};let l;const{responseType:c}=e??{};return!c||c==="json"?l=yield i.json():c==="arrayBuffer"?l=yield i.arrayBuffer():c==="blob"?l=yield i.blob():l=yield i.text(),{data:l,error:null}}catch(s){return{data:null,error:s}}})}}var ta=function(t,r,e,s){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(d){try{h(s.next(d))}catch(f){o(f)}}function c(d){try{h(s.throw(d))}catch(f){o(f)}}function h(d){d.done?i(d.value):a(d.value).then(l,c)}h((s=s.apply(t,r||[])).next())})};const Ed={schema:"public",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,multiTab:!0,headers:go};class Td{constructor(r,e,s){if(this.supabaseUrl=r,this.supabaseKey=e,!r)throw new Error("supabaseUrl is required.");if(!e)throw new Error("supabaseKey is required.");const a=c0(r),i=Object.assign(Object.assign({},Ed),s);if(this.restUrl=`${a}/rest/v1`,this.realtimeUrl=`${a}/realtime/v1`.replace("http","ws"),this.authUrl=`${a}/auth/v1`,this.storageUrl=`${a}/storage/v1`,a.match(/(supabase\.co)|(supabase\.in)/)){const l=a.split(".");this.functionsUrl=`${l[0]}.functions.${l[1]}.${l[2]}`}else this.functionsUrl=`${a}/functions/v1`;this.schema=i.schema,this.multiTab=i.multiTab,this.fetch=i.fetch,this.headers=Object.assign(Object.assign({},go),s?.headers),this.shouldThrowOnError=i.shouldThrowOnError||!1,this.auth=this._initSupabaseAuthClient(i),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers},i.realtime)),this._listenForAuthEvents(),this._listenForMultiTabEvents()}get functions(){return new jd(this.functionsUrl,{headers:this._getAuthHeaders(),customFetch:this.fetch})}get storage(){return new wd(this.storageUrl,this._getAuthHeaders(),this.fetch)}from(r){const e=`${this.restUrl}/${r}`;return new cd(e,{headers:this._getAuthHeaders(),schema:this.schema,realtime:this.realtime,table:r,fetch:this.fetch,shouldThrowOnError:this.shouldThrowOnError})}rpc(r,e,{head:s=!1,count:a=null}={}){return this._initPostgRESTClient().rpc(r,e,{head:s,count:a})}removeAllSubscriptions(){return ta(this,void 0,void 0,function*(){const r=this.getSubscriptions().slice(),e=r.map(a=>this.removeSubscription(a));return(yield Promise.all(e)).map(({error:a},i)=>({data:{subscription:r[i]},error:a}))})}removeSubscription(r){return ta(this,void 0,void 0,function*(){const{error:e}=yield this._closeSubscription(r),s=this.getSubscriptions(),a=s.filter(i=>i.isJoined()).length;return s.length===0&&(yield this.realtime.disconnect()),{data:{openSubscriptions:a},error:e}})}_closeSubscription(r){return ta(this,void 0,void 0,function*(){let e=null;if(!r.isClosed()){const{error:s}=yield this._unsubscribeSubscription(r);e=s}return this.realtime.remove(r),{error:e}})}_unsubscribeSubscription(r){return new Promise(e=>{r.unsubscribe().receive("ok",()=>e({error:null})).receive("error",s=>e({error:s})).receive("timeout",()=>e({error:new Error("timed out")}))})}getSubscriptions(){return this.realtime.channels}_initSupabaseAuthClient({autoRefreshToken:r,persistSession:e,detectSessionInUrl:s,localStorage:a,headers:i,fetch:o,cookieOptions:l,multiTab:c}){const h={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new I0({url:this.authUrl,headers:Object.assign(Object.assign({},i),h),autoRefreshToken:r,persistSession:e,detectSessionInUrl:s,localStorage:a,fetch:o,cookieOptions:l,multiTab:c})}_initRealtimeClient(r){return new od(this.realtimeUrl,Object.assign(Object.assign({},r),{params:Object.assign(Object.assign({},r?.params),{apikey:this.supabaseKey})}))}_initPostgRESTClient(){return new z0(this.restUrl,{headers:this._getAuthHeaders(),schema:this.schema,fetch:this.fetch,throwOnError:this.shouldThrowOnError})}_getAuthHeaders(){var r,e;const s=Object.assign({},this.headers),a=(e=(r=this.auth.session())===null||r===void 0?void 0:r.access_token)!==null&&e!==void 0?e:this.supabaseKey;return s.apikey=this.supabaseKey,s.Authorization=s.Authorization||`Bearer ${a}`,s}_listenForMultiTabEvents(){if(!this.multiTab||!d0()||!window?.addEventListener)return null;try{return window?.addEventListener("storage",r=>{var e,s,a;if(r.key===l0){const i=JSON.parse(String(r.newValue)),o=(s=(e=i?.currentSession)===null||e===void 0?void 0:e.access_token)!==null&&s!==void 0?s:void 0,l=(a=this.auth.session())===null||a===void 0?void 0:a.access_token;o?!l&&o?this._handleTokenChanged("SIGNED_IN",o,"STORAGE"):l!==o&&this._handleTokenChanged("TOKEN_REFRESHED",o,"STORAGE"):this._handleTokenChanged("SIGNED_OUT",o,"STORAGE")}})}catch(r){return console.error("_listenForMultiTabEvents",r),null}}_listenForAuthEvents(){let{data:r}=this.auth.onAuthStateChange((e,s)=>{this._handleTokenChanged(e,s?.access_token,"CLIENT")});return r}_handleTokenChanged(r,e,s){(r==="TOKEN_REFRESHED"||r==="SIGNED_IN")&&this.changedAccessToken!==e?(this.realtime.setAuth(e),s=="STORAGE"&&this.auth.setAuth(e),this.changedAccessToken=e):(r==="SIGNED_OUT"||r==="USER_DELETED")&&(this.realtime.setAuth(this.supabaseKey),s=="STORAGE"&&this.auth.signOut())}}const Cd=(t,r,e)=>new Td(t,r,e),kd="https://sgxnxbhbyvrmgrzhosyh.supabase.co",Ad="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InNneG54YmhieXZybWdyemhvc3loIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTc5MDAzMzMsImV4cCI6MjA3MzQ3NjMzM30.1qS_3Qr-zv7woSyPbkdiLkhuXp2pVHJHGiF3iKWEBkc",ce=Cd(kd,Ad),_a={getUsers:()=>JSON.parse(localStorage.getItem("las_users")||"[]"),setUsers:t=>localStorage.setItem("las_users",JSON.stringify(t)),getWorkDiaries:()=>JSON.parse(localStorage.getItem("las_work_diaries")||"[]"),setWorkDiaries:t=>localStorage.setItem("las_work_diaries",JSON.stringify(t)),getSales:()=>JSON.parse(localStorage.getItem("las_sales")||"[]"),setSales:t=>localStorage.setItem("las_sales",JSON.stringify(t)),getCurrentUser:()=>JSON.parse(localStorage.getItem("las_current_user")||"null"),setCurrentUser:t=>localStorage.setItem("las_current_user",JSON.stringify(t)),clearCurrentUser:()=>localStorage.removeItem("las_current_user"),initAdmin:()=>{if(_a.getUsers().length===0){const r={id:"1",email:"admin@las.com",password:"admin123",name:"",branch:"",phone:"010-0000-0000",userType:"",status:"approved",createdAt:new Date().toISOString(),approvedAt:new Date().toISOString()};_a.setUsers([r]),console.log("    : admin@las.com / admin123")}}};_a.initAdmin();const un={EMPLOYEE:"employee",MANAGER:"manager"},sr={MONITORING_AGENT:"",CONTRACT_WORKER:"",STORE_MANAGER:"",BRANCH_MANAGER:"",SYSTEM_ADMIN:""},Rd=t=>t?t.user_type===sr.MONITORING_AGENT:!1,Fd=t=>t?t.user_type===sr.CONTRACT_WORKER:!1,gs=t=>t?t.user_type===sr.STORE_MANAGER||t.user_type===sr.BRANCH_MANAGER||t.user_type===sr.SYSTEM_ADMIN:!1,ts=t=>t?t.user_type===sr.SYSTEM_ADMIN:!1,Dd=t=>t?t.user_type===sr.STORE_MANAGER||t.user_type===sr.BRANCH_MANAGER||t.user_type===sr.SYSTEM_ADMIN:!1,Od=t=>{if(!t||typeof t!="string")return{isValid:!1,error:" "};const r=t.trim().toUpperCase();if(!/^LAS\d{4}$/.test(r))return{isValid:!1,error:"    (: LAS1000)"};const s=parseInt(r.replace("LAS",""));return s>=1e3&&s<=2999||s>=3e3&&s<=4999||s>=5e3&&s<=6999?{isValid:!0,error:""}:{isValid:!1,error:"   "}};function Id({onNavigate:t,onAutoLogin:r}){const[e,s]=P.useState(!0);P.useEffect(()=>{a()},[]);const a=async()=>{try{const{data:{session:i},error:o}=await ce.auth.getSession();if(o){console.error("  :",o),s(!1);return}if(i&&i.user){const{data:l,error:c}=await ce.from("users").select("*").eq("id",i.user.id).single();if(c){console.error("   :",c),s(!1);return}l&&l.status==="approved"?(console.log(" :",l.name,"/",l.user_type),r&&r(l)):(console.log("   :",l?.name),s(!1))}else s(!1)}catch(i){console.error("   :",i),s(!1)}};return e?n.jsx("div",{className:"min-h-screen bg-gray-100 flex justify-center items-center",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:"#249689"}}),n.jsx("p",{className:"text-gray-600",children:"  ..."})]})}):n.jsx("div",{className:"min-h-screen bg-gray-100 flex justify-center items-start pt-8 pb-8",children:n.jsxs("div",{className:"bg-white flex flex-col w-full max-w-md rounded-lg shadow-lg overflow-hidden",children:[n.jsx("div",{className:"flex items-center justify-between p-2 border-b",children:n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:i=>i.target.style.display="none"}),n.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:"LAS "})]})}),n.jsxs("div",{className:"flex-1 flex flex-col items-center justify-center p-6",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("img",{src:"/images/hero-cell.jpg",alt:"The Rise of Life Forms with a Nucleus",className:"w-full max-w-xs rounded-lg shadow-lg",onError:i=>{i.target.style.display="none",i.target.nextElementSibling.style.display="block"}}),n.jsx("div",{className:"hidden w-full max-w-xs h-64 bg-gradient-to-br from-teal-400 to-blue-500 rounded-lg shadow-lg flex items-center justify-center",children:n.jsx("p",{className:"text-white text-xl font-bold",children:"The Rise of Life Forms with a Nucleus"})})]}),n.jsxs("div",{className:"flex flex-col gap-2 w-full px-10",children:[n.jsx("button",{onClick:()=>t("login"),className:"px-8 py-3.5 text-white font-bold rounded-lg shadow-md hover:opacity-90 transition-opacity w-full",style:{backgroundColor:"#249689",fontSize:"15px"},children:""}),n.jsx("button",{onClick:()=>t("signup"),className:"px-8 py-3.5 font-bold rounded-lg shadow-md hover:bg-gray-50 transition-colors w-full",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",fontSize:"15px"},children:""})]})]})]})})}function Pd({onNavigate:t,onLogin:r}){const[e,s]=P.useState(""),[a,i]=P.useState(""),[o,l]=P.useState(!1),c=async h=>{h.preventDefault(),l(!0);try{const{data:d,error:f}=await ce.from("users").select("*").eq("email",e).eq("password",a).single();if(f||!d){alert("    .");return}if(d.status!=="approved"){alert("   .    .");return}r(d)}catch(d){console.error(" :",d),alert(" : "+d.message)}finally{l(!1)}};return n.jsx("div",{className:"min-h-screen flex items-start justify-center p-4 pt-4",style:{backgroundColor:"#f5f5f5"},children:n.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-8",children:[n.jsxs("div",{className:"text-center mb-6",children:[n.jsx("p",{className:"text-sm mb-4",style:{color:"#249689"},children:"LAS    ."}),n.jsxs("div",{className:"flex items-center justify-center gap-3",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Book Logo",className:"h-16"}),n.jsx("h1",{className:"text-3xl font-bold",style:{color:"#249689"},children:""})]})]}),n.jsxs("form",{onSubmit:c,className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:""})]}),n.jsx("input",{type:"email",value:e,onChange:h=>s(h.target.value),placeholder:" ",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:""})]}),n.jsx("input",{type:"password",value:a,onChange:h=>i(h.target.value),placeholder:" ",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsx("button",{type:"submit",disabled:o,className:"w-full py-3 rounded-lg font-bold text-white hover:opacity-90 mt-6",style:{backgroundColor:"#249689",fontSize:"16px"},children:o?" ...":""}),n.jsx("button",{type:"button",onClick:()=>t("hero"),className:"w-full py-3 rounded-lg font-bold border-2 hover:bg-gray-50",style:{borderColor:"#cccccc",fontSize:"16px"},children:""})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs("p",{style:{color:"#666666",fontSize:"13px"},children:["   ?"," ",n.jsx("button",{onClick:()=>t("signup"),className:"font-bold hover:underline",style:{color:"#249689"},children:" "})]})})]})})}function Ld({onNavigate:t}){const[r,e]=P.useState(""),[s,a]=P.useState(""),[i,o]=P.useState(""),[l,c]=P.useState(""),[h,d]=P.useState(""),[f,u]=P.useState(""),[m,p]=P.useState(""),[x,g]=P.useState(!1),[T,b]=P.useState([]),[w,A]=P.useState(!1),[_,L]=P.useState(""),[E,O]=P.useState(""),[F,M]=P.useState(""),[U,H]=P.useState("");P.useEffect(()=>{J()},[]);const J=async()=>{try{const{data:le,error:ue}=await ce.from("branches").select("name").order("name",{ascending:!0});if(ue)throw ue;b(le||[])}catch(le){console.error("   :",le)}},ge=le=>{const ue=le.replace(/[^\d]/g,"");return ue.length<=3?ue:ue.length<=7?`${ue.slice(0,3)}-${ue.slice(3)}`:`${ue.slice(0,3)}-${ue.slice(3,7)}-${ue.slice(7,11)}`},xe=le=>{const ue=ge(le.target.value);u(ue)},Ee=le=>{const ue=le.replace(/[^\d]/g,"");return ue.length<=6?ue:`${ue.slice(0,6)}-${ue.slice(6,13)}`},be=le=>{const ue=Ee(le.target.value);L(ue),ue.replace(/-/g,"").length===13||ue.replace(/-/g,"").length>0},Te=async le=>{if(le.preventDefault(),s!==i){alert("  .");return}if(s.length<6){alert("  6  .");return}if(_&&_.replace(/-/g,"").length!==13){alert(" 13 .");return}g(!0);try{const{data:ue}=await ce.from("users").select("referral_code").not("referral_code","is",null).order("referral_code",{ascending:!1});let _e="LAS001";if(ue&&ue.length>0){const z=ue[0].referral_code,Q=parseInt(z.replace("LAS",""))+1;_e=`LAS${String(Q).padStart(3,"0")}`}const S=crypto.randomUUID(),I=f.replace(/-/g,""),D=_?_.replace(/-/g,""):null,{error:y}=await ce.from("users").insert([{id:S,email:r,password:s,name:l,branch:h,phone:I,user_type:m,status:"pending",referral_code:_e,ssn:D,bank_name:E||null,account_holder:F||null,account_number:U||null}]);if(y)throw y;alert(" .      ."),t("login")}catch(ue){console.error(" :",ue),alert("   : "+ue.message)}finally{g(!1)}};return n.jsx("div",{className:"min-h-screen flex items-start justify-center p-4 pt-4",style:{backgroundColor:"#f5f5f5"},children:n.jsxs("div",{className:"w-full max-w-md bg-white rounded-lg shadow-md p-6",children:[n.jsxs("div",{className:"text-center mb-4",children:[n.jsx("p",{className:"text-sm mb-3",style:{color:"#249689"},children:"LAS    ."}),n.jsxs("div",{className:"flex items-center justify-center gap-3",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Book Logo",className:"h-12"}),n.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:""})]})]}),n.jsxs("form",{onSubmit:Te,className:"space-y-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:""})]}),n.jsx("input",{type:"email",value:r,onChange:le=>e(le.target.value),placeholder:" ",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:""})]}),n.jsx("input",{type:"password",value:s,onChange:le=>a(le.target.value),placeholder:"",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:" "})]}),n.jsx("input",{type:"password",value:i,onChange:le=>o(le.target.value),placeholder:" ",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:""})]}),n.jsx("input",{type:"text",value:l,onChange:le=>c(le.target.value),placeholder:"",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:" "})]}),n.jsx("input",{type:"tel",value:f,onChange:xe,placeholder:"000-0000-0000",required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:""})]}),n.jsxs("select",{value:h,onChange:le=>d(le.target.value),required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:" "}),T.map(le=>n.jsx("option",{value:le.name,children:le.name},le.name))]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:""})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",value:"",checked:m==="",onChange:le=>p(le.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),n.jsx("span",{style:{fontSize:"15px"},children:""})]}),n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",value:"",checked:m==="",onChange:le=>p(le.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),n.jsx("span",{style:{fontSize:"15px"},children:""})]}),n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",value:"",checked:m==="",onChange:le=>p(le.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),n.jsx("span",{style:{fontSize:"15px"},children:""})]}),n.jsxs("label",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"radio",value:"",checked:m==="",onChange:le=>p(le.target.value),className:"w-4 h-4",style:{accentColor:"#249689"}}),n.jsx("span",{style:{fontSize:"15px"},children:""})]})]})]}),n.jsxs("div",{className:"border-t pt-3 mt-4",children:[n.jsxs("button",{type:"button",onClick:()=>A(!w),className:"w-full flex items-center justify-between p-3 rounded-lg border-2 hover:bg-gray-50",style:{borderColor:"#249689",fontSize:"15px"},children:[n.jsx("span",{className:"font-bold",style:{color:"#249689"},children:"   ()"}),n.jsx("span",{style:{color:"#249689"},children:w?"":""})]}),w&&n.jsxs("div",{className:"mt-3 space-y-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:" ()"})]}),n.jsx("input",{type:"text",value:_,onChange:be,placeholder:"000000-0000000",maxLength:"14",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}}),_&&_.replace(/-/g,"").length>0&&_.replace(/-/g,"").length!==13&&n.jsx("p",{className:"text-sm mt-1",style:{color:"#e74c3c"},children:"  13 ."})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:" ()"})]}),n.jsx("input",{type:"text",value:F,onChange:le=>M(le.target.value),placeholder:"",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:" ()"})]}),n.jsx("input",{type:"text",value:E,onChange:le=>O(le.target.value),placeholder:"",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-2 mb-1 font-bold",style:{fontSize:"15px",color:"#666"},children:[n.jsx("span",{children:""}),n.jsx("span",{children:" ()"})]}),n.jsx("input",{type:"text",value:U,onChange:le=>H(le.target.value),placeholder:"",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3 mt-4",children:[n.jsxs("button",{type:"button",onClick:()=>t("login"),className:"py-3 rounded-lg font-bold border-2 hover:bg-gray-50 flex items-center justify-center gap-2",style:{borderColor:"#cccccc",fontSize:"16px"},children:[n.jsx(Ft,{size:18}),""]}),n.jsx("button",{type:"submit",disabled:x,className:"py-3 rounded-lg font-bold text-white hover:opacity-90",style:{backgroundColor:"#249689",fontSize:"16px"},children:x?" ...":""})]})]}),n.jsx("div",{className:"mt-4 text-center",children:n.jsxs("p",{style:{color:"#666666",fontSize:"13px"},children:[" ?"," ",n.jsx("button",{onClick:()=>t("login"),className:"font-bold hover:underline",style:{color:"#249689"},children:""})]})})]})})}function Bd({user:t,onNavigate:r,onLogout:e}){const s=Rd(t),a=Fd(t),i=s,o=a;return n.jsx("div",{className:"min-h-screen bg-white",children:n.jsx("div",{className:"max-w-md mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:l=>l.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:""})]}),!i&&!o&&n.jsx("div",{className:"mb-6",children:n.jsx("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"#f0f9ff",borderColor:"#0284c7"},children:n.jsxs("div",{className:"flex items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-left gap-2 flex-1",children:[n.jsx(zc,{size:20,style:{color:"#0284c7"}}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold",style:{color:"#075985",fontSize:"14px"},children:"  "}),n.jsx("p",{className:"text-xs",style:{color:"#075985"},children:" ,  ,    "})]})]}),n.jsx("button",{onClick:()=>r("AdminDashboard"),className:"px-4 py-2 bg-white border-2 rounded-lg hover:bg-gray-50 font-bold transition-colors text-sm whitespace-nowrap",style:{borderColor:"#0284c7",color:"#075985",borderRadius:"10px"},children:" "})]})})}),n.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:" "}),n.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:" "}),n.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-4",children:[o&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>r("WorkDiary"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(cn,{size:20}),""]}),n.jsxs("button",{onClick:()=>r("CustomerManagement"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(dn,{size:20}),""]})]}),!i&&!o&&n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>r("WorkDiary"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(cn,{size:20}),""]}),n.jsxs("button",{onClick:()=>r("CustomerManagement"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(dn,{size:20}),""]}),n.jsxs("button",{onClick:()=>r("ShippingList"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(co,{size:20}),""]}),n.jsxs("button",{onClick:()=>r("PurchaseHistory"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(ho,{size:20}),""]})]}),n.jsxs("button",{onClick:()=>r("AdminEventDashboard"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#dc2626",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ra,{size:20})," "]}),n.jsxs("button",{onClick:()=>r("MyInfo"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#7f95eb",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(hn,{size:20}),""]}),n.jsxs("button",{onClick:e,className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Fa,{size:20}),"LogOut"]})]})]})})})}function Md({user:t,onNavigate:r,onLogout:e,onSwitchMode:s}){console.log(" AdminDashboard "),console.log(" user:",t),console.log(" onSwitchMode:",s);const a=()=>{if(console.log(""),console.log("   "),console.log(" onSwitchMode :",!!s),console.log(" LOGIN_MODES.EMPLOYEE:",un.EMPLOYEE),!s){console.error(" onSwitchMode undefined!"),alert("    .");return}if(typeof s!="function"){console.error(" onSwitchMode  !"),alert("    .");return}try{console.log(" onSwitchMode   (EMPLOYEE )"),s(un.EMPLOYEE),console.log(" onSwitchMode  "),console.log("")}catch(o){console.error(" onSwitchMode   :",o),alert("    : "+o.message)}},i=Dd(t);return n.jsx("div",{className:"min-h-screen bg-white",children:n.jsx("div",{className:"max-w-md mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:o=>o.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:""})]}),n.jsx("div",{className:"mb-6",children:n.jsx("div",{className:"p-4 rounded-lg border-2",style:{backgroundColor:"#f0f9ff",borderColor:"#0284c7"},children:n.jsxs("div",{className:"flex items-center justify-between gap-4",children:[n.jsxs("div",{className:"flex items-left gap-2 flex-1",children:[n.jsx(Uc,{size:20,style:{color:"#0284c7"}}),n.jsxs("div",{children:[n.jsx("p",{className:"font-bold",style:{color:"#075985",fontSize:"14px"},children:"  "}),n.jsx("p",{className:"text-xs",style:{color:"#075985"},children:",     "})]})]}),n.jsx("button",{onClick:a,className:"px-4 py-2 bg-white border-2 rounded-lg hover:bg-gray-50 font-bold transition-colors text-sm whitespace-nowrap",style:{borderColor:"#0284c7",color:"#075985",borderRadius:"10px"},children:" "})]})})}),n.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:" "}),n.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:" "}),n.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("button",{onClick:()=>{console.log(" Navigate to: AdminWorkDiary"),r("AdminWorkDiary")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(cn,{size:20}),""]}),n.jsxs("button",{onClick:()=>{console.log(" Navigate to: AdminUsers"),r("AdminUsers")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Da,{size:20}),""]}),n.jsxs("button",{onClick:()=>{console.log(" Navigate to: AdminCustomers"),r("AdminCustomers")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(dn,{size:20}),""]}),i&&n.jsxs("button",{onClick:()=>{console.log(" Navigate to: AdminEventDashboard"),r("AdminEventDashboard")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#dc2626",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(fn,{size:20})," "]}),n.jsxs("button",{onClick:e,className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Fa,{size:20}),"LogOut"]})]})]})})})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var xn={};xn.version="0.18.5";var jo=1252,zd=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],Eo=function(t){zd.indexOf(t)!=-1&&(jo=t)};function Ud(){Eo(1252)}var As=function(t){Eo(t)};function $d(){As(1200),Ud()}var Js=function(r){return String.fromCharCode(r)},vi=function(r){return String.fromCharCode(r)},mn,ur="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Rs(t){for(var r="",e=0,s=0,a=0,i=0,o=0,l=0,c=0,h=0;h<t.length;)e=t.charCodeAt(h++),i=e>>2,s=t.charCodeAt(h++),o=(e&3)<<4|s>>4,a=t.charCodeAt(h++),l=(s&15)<<2|a>>6,c=a&63,isNaN(s)?l=c=64:isNaN(a)&&(c=64),r+=ur.charAt(i)+ur.charAt(o)+ur.charAt(l)+ur.charAt(c);return r}function or(t){var r="",e=0,s=0,a=0,i=0,o=0,l=0,c=0;t=t.replace(/[^\w\+\/\=]/g,"");for(var h=0;h<t.length;)i=ur.indexOf(t.charAt(h++)),o=ur.indexOf(t.charAt(h++)),e=i<<2|o>>4,r+=String.fromCharCode(e),l=ur.indexOf(t.charAt(h++)),s=(o&15)<<4|l>>2,l!==64&&(r+=String.fromCharCode(s)),c=ur.indexOf(t.charAt(h++)),a=(l&3)<<6|c,c!==64&&(r+=String.fromCharCode(a));return r}var Re=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),cr=function(){if(typeof Buffer<"u"){var t=!Buffer.from;if(!t)try{Buffer.from("foo","utf8")}catch{t=!0}return t?function(r,e){return e?new Buffer(r,e):new Buffer(r)}:Buffer.from.bind(Buffer)}return function(){}}();function Fr(t){return Re?Buffer.alloc?Buffer.alloc(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}function yi(t){return Re?Buffer.allocUnsafe?Buffer.allocUnsafe(t):new Buffer(t):typeof Uint8Array<"u"?new Uint8Array(t):new Array(t)}var Ht=function(r){return Re?cr(r,"binary"):r.split("").map(function(e){return e.charCodeAt(0)&255})};function Bn(t){if(typeof ArrayBuffer>"u")return Ht(t);for(var r=new ArrayBuffer(t.length),e=new Uint8Array(r),s=0;s!=t.length;++s)e[s]=t.charCodeAt(s)&255;return r}function zs(t){if(Array.isArray(t))return t.map(function(s){return String.fromCharCode(s)}).join("");for(var r=[],e=0;e<t.length;++e)r[e]=String.fromCharCode(t[e]);return r.join("")}function Hd(t){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(t)}var ot=Re?function(t){return Buffer.concat(t.map(function(r){return Buffer.isBuffer(r)?r:cr(r)}))}:function(t){if(typeof Uint8Array<"u"){var r=0,e=0;for(r=0;r<t.length;++r)e+=t[r].length;var s=new Uint8Array(e),a=0;for(r=0,e=0;r<t.length;e+=a,++r)if(a=t[r].length,t[r]instanceof Uint8Array)s.set(t[r],e);else{if(typeof t[r]=="string")throw"wtf";s.set(new Uint8Array(t[r]),e)}return s}return[].concat.apply([],t.map(function(i){return Array.isArray(i)?i:[].slice.call(i)}))};function Wd(t){for(var r=[],e=0,s=t.length+250,a=Fr(t.length+255),i=0;i<t.length;++i){var o=t.charCodeAt(i);if(o<128)a[e++]=o;else if(o<2048)a[e++]=192|o>>6&31,a[e++]=128|o&63;else if(o>=55296&&o<57344){o=(o&1023)+64;var l=t.charCodeAt(++i)&1023;a[e++]=240|o>>8&7,a[e++]=128|o>>2&63,a[e++]=128|l>>6&15|(o&3)<<4,a[e++]=128|l&63}else a[e++]=224|o>>12&15,a[e++]=128|o>>6&63,a[e++]=128|o&63;e>s&&(r.push(a.slice(0,e)),e=0,a=Fr(65535),s=65530)}return r.push(a.slice(0,e)),ot(r)}var ws=/\u0000/g,Qs=/[\u0001-\u0006]/g;function Yr(t){for(var r="",e=t.length-1;e>=0;)r+=t.charAt(e--);return r}function Wt(t,r){var e=""+t;return e.length>=r?e:Xe("0",r-e.length)+e}function La(t,r){var e=""+t;return e.length>=r?e:Xe(" ",r-e.length)+e}function pn(t,r){var e=""+t;return e.length>=r?e:e+Xe(" ",r-e.length)}function Gd(t,r){var e=""+Math.round(t);return e.length>=r?e:Xe("0",r-e.length)+e}function Vd(t,r){var e=""+t;return e.length>=r?e:Xe("0",r-e.length)+e}var bi=Math.pow(2,32);function Hr(t,r){if(t>bi||t<-bi)return Gd(t,r);var e=Math.round(t);return Vd(e,r)}function gn(t,r){return r=r||0,t.length>=7+r&&(t.charCodeAt(r)|32)===103&&(t.charCodeAt(r+1)|32)===101&&(t.charCodeAt(r+2)|32)===110&&(t.charCodeAt(r+3)|32)===101&&(t.charCodeAt(r+4)|32)===114&&(t.charCodeAt(r+5)|32)===97&&(t.charCodeAt(r+6)|32)===108}var wi=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],ra=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function Xd(t){return t||(t={}),t[0]="General",t[1]="0",t[2]="0.00",t[3]="#,##0",t[4]="#,##0.00",t[9]="0%",t[10]="0.00%",t[11]="0.00E+00",t[12]="# ?/?",t[13]="# ??/??",t[14]="m/d/yy",t[15]="d-mmm-yy",t[16]="d-mmm",t[17]="mmm-yy",t[18]="h:mm AM/PM",t[19]="h:mm:ss AM/PM",t[20]="h:mm",t[21]="h:mm:ss",t[22]="m/d/yy h:mm",t[37]="#,##0 ;(#,##0)",t[38]="#,##0 ;[Red](#,##0)",t[39]="#,##0.00;(#,##0.00)",t[40]="#,##0.00;[Red](#,##0.00)",t[45]="mm:ss",t[46]="[h]:mm:ss",t[47]="mmss.0",t[48]="##0.0E+0",t[49]="@",t[56]='"/ "hh""mm""ss" "',t}var Ke={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},_i={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},Kd={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function vn(t,r,e){for(var s=t<0?-1:1,a=t*s,i=0,o=1,l=0,c=1,h=0,d=0,f=Math.floor(a);h<r&&(f=Math.floor(a),l=f*o+i,d=f*h+c,!(a-f<5e-8));)a=1/(a-f),i=o,o=l,c=h,h=d;if(d>r&&(h>r?(d=c,l=i):(d=h,l=o)),!e)return[0,s*l,d];var u=Math.floor(s*l/d);return[u,s*l-u*d,d]}function Zs(t,r,e){if(t>2958465||t<0)return null;var s=t|0,a=Math.floor(86400*(t-s)),i=0,o=[],l={D:s,T:a,u:86400*(t-s)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),r&&r.date1904&&(s+=1462),l.u>.9999&&(l.u=0,++a==86400&&(l.T=a=0,++s,++l.D)),s===60)o=e?[1317,10,29]:[1900,2,29],i=3;else if(s===0)o=e?[1317,8,29]:[1900,1,0],i=6;else{s>60&&--s;var c=new Date(1900,0,1);c.setDate(c.getDate()+s-1),o=[c.getFullYear(),c.getMonth()+1,c.getDate()],i=c.getDay(),s<60&&(i=(i+6)%7),e&&(i=th(c,o))}return l.y=o[0],l.m=o[1],l.d=o[2],l.S=a%60,a=Math.floor(a/60),l.M=a%60,a=Math.floor(a/60),l.H=a,l.q=i,l}var To=new Date(1899,11,31,0,0,0),Yd=To.getTime(),qd=new Date(1900,2,1,0,0,0);function Co(t,r){var e=t.getTime();return r?e-=1461*24*60*60*1e3:t>=qd&&(e+=24*60*60*1e3),(e-(Yd+(t.getTimezoneOffset()-To.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function Ba(t){return t.indexOf(".")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function Jd(t){return t.indexOf("E")==-1?t:t.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function Qd(t){var r=t<0?12:11,e=Ba(t.toFixed(12));return e.length<=r||(e=t.toPrecision(10),e.length<=r)?e:t.toExponential(5)}function Zd(t){var r=Ba(t.toFixed(11));return r.length>(t<0?12:11)||r==="0"||r==="-0"?t.toPrecision(6):r}function eh(t){var r=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),e;return r>=-4&&r<=-1?e=t.toPrecision(10+r):Math.abs(r)<=9?e=Qd(t):r===10?e=t.toFixed(10).substr(0,12):e=Zd(t),Ba(Jd(e.toUpperCase()))}function Sa(t,r){switch(typeof t){case"string":return t;case"boolean":return t?"TRUE":"FALSE";case"number":return(t|0)===t?t.toString(10):eh(t);case"undefined":return"";case"object":if(t==null)return"";if(t instanceof Date)return pr(14,Co(t,r&&r.date1904),r)}throw new Error("unsupported value in General format: "+t)}function th(t,r){r[0]-=581;var e=t.getDay();return t<60&&(e=(e+6)%7),e}function rh(t,r,e,s){var a="",i=0,o=0,l=e.y,c,h=0;switch(t){case 98:l=e.y+543;case 121:switch(r.length){case 1:case 2:c=l%100,h=2;break;default:c=l%1e4,h=4;break}break;case 109:switch(r.length){case 1:case 2:c=e.m,h=r.length;break;case 3:return ra[e.m-1][1];case 5:return ra[e.m-1][0];default:return ra[e.m-1][2]}break;case 100:switch(r.length){case 1:case 2:c=e.d,h=r.length;break;case 3:return wi[e.q][0];default:return wi[e.q][1]}break;case 104:switch(r.length){case 1:case 2:c=1+(e.H+11)%12,h=r.length;break;default:throw"bad hour format: "+r}break;case 72:switch(r.length){case 1:case 2:c=e.H,h=r.length;break;default:throw"bad hour format: "+r}break;case 77:switch(r.length){case 1:case 2:c=e.M,h=r.length;break;default:throw"bad minute format: "+r}break;case 115:if(r!="s"&&r!="ss"&&r!=".0"&&r!=".00"&&r!=".000")throw"bad second format: "+r;return e.u===0&&(r=="s"||r=="ss")?Wt(e.S,r.length):(s>=2?o=s===3?1e3:100:o=s===1?10:1,i=Math.round(o*(e.S+e.u)),i>=60*o&&(i=0),r==="s"?i===0?"0":""+i/o:(a=Wt(i,2+s),r==="ss"?a.substr(0,2):"."+a.substr(2,r.length-1)));case 90:switch(r){case"[h]":case"[hh]":c=e.D*24+e.H;break;case"[m]":case"[mm]":c=(e.D*24+e.H)*60+e.M;break;case"[s]":case"[ss]":c=((e.D*24+e.H)*60+e.M)*60+Math.round(e.S+e.u);break;default:throw"bad abstime format: "+r}h=r.length===3?1:2;break;case 101:c=l,h=1;break}var d=h>0?Wt(c,h):"";return d}function xr(t){var r=3;if(t.length<=r)return t;for(var e=t.length%r,s=t.substr(0,e);e!=t.length;e+=r)s+=(s.length>0?",":"")+t.substr(e,r);return s}var ko=/%/g;function sh(t,r,e){var s=r.replace(ko,""),a=r.length-s.length;return nr(t,s,e*Math.pow(10,2*a))+Xe("%",a)}function nh(t,r,e){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return nr(t,r.substr(0,s),e/Math.pow(10,3*(r.length-s)))}function Ao(t,r){var e,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Ao(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),e=(r/Math.pow(10,i)).toPrecision(s+1+(a+i)%a),e.indexOf("e")===-1){var o=Math.floor(Math.log(r)*Math.LOG10E);for(e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+i):e+="E+"+(o-i);e.substr(0,2)==="0.";)e=e.charAt(0)+e.substr(2,a)+"."+e.substr(2+a),e=e.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,h,d){return c+h+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else e=r.toExponential(s);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}var Ro=/# (\?+)( ?)\/( ?)(\d+)/;function ah(t,r,e){var s=parseInt(t[4],10),a=Math.round(r*s),i=Math.floor(a/s),o=a-i*s,l=s;return e+(i===0?"":""+i)+" "+(o===0?Xe(" ",t[1].length+1+t[4].length):La(o,t[1].length)+t[2]+"/"+t[3]+Wt(l,t[4].length))}function ih(t,r,e){return e+(r===0?"":""+r)+Xe(" ",t[1].length+2+t[4].length)}var Fo=/^#*0*\.([0#]+)/,Do=/\).*[0#]/,Oo=/\(###\) ###\\?-####/;function yt(t){for(var r="",e,s=0;s!=t.length;++s)switch(e=t.charCodeAt(s)){case 35:break;case 63:r+=" ";break;case 48:r+="0";break;default:r+=String.fromCharCode(e)}return r}function Si(t,r){var e=Math.pow(10,r);return""+Math.round(t*e)/e}function Ni(t,r){var e=t-Math.floor(t),s=Math.pow(10,r);return r<(""+Math.round(e*s)).length?0:Math.round(e*s)}function oh(t,r){return r<(""+Math.round((t-Math.floor(t))*Math.pow(10,r))).length?1:0}function lh(t){return t<2147483647&&t>-2147483648?""+(t>=0?t|0:t-1|0):""+Math.floor(t)}function Pt(t,r,e){if(t.charCodeAt(0)===40&&!r.match(Do)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Pt("n",s,e):"("+Pt("n",s,-e)+")"}if(r.charCodeAt(r.length-1)===44)return nh(t,r,e);if(r.indexOf("%")!==-1)return sh(t,r,e);if(r.indexOf("E")!==-1)return Ao(r,e);if(r.charCodeAt(0)===36)return"$"+Pt(t,r.substr(r.charAt(1)==" "?2:1),e);var a,i,o,l,c=Math.abs(e),h=e<0?"-":"";if(r.match(/^00+$/))return h+Hr(c,r.length);if(r.match(/^[#?]+$/))return a=Hr(e,0),a==="0"&&(a=""),a.length>r.length?a:yt(r.substr(0,r.length-a.length))+a;if(i=r.match(Ro))return ah(i,c,h);if(r.match(/^#+0+$/))return h+Hr(c,r.length-r.indexOf("0"));if(i=r.match(Fo))return a=Si(e,i[1].length).replace(/^([^\.]+)$/,"$1."+yt(i[1])).replace(/\.$/,"."+yt(i[1])).replace(/\.(\d*)$/,function(p,x){return"."+x+Xe("0",yt(i[1]).length-x.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return h+Si(c,i[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return h+xr(Hr(c,0));if(i=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Pt(t,r,-e):xr(""+(Math.floor(e)+oh(e,i[1].length)))+"."+Wt(Ni(e,i[1].length),i[1].length);if(i=r.match(/^#,#*,#0/))return Pt(t,r.replace(/^#,#*,/,""),e);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Yr(Pt(t,r.replace(/[\\-]/g,""),e)),o=0,Yr(Yr(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<a.length?a.charAt(o++):p==="0"?"0":""}));if(r.match(Oo))return a=Pt(t,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=vn(c,Math.pow(10,o)-1,!1),a=""+h,d=nr("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=pn(l[2],o),d.length<i[4].length&&(d=yt(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=vn(c,Math.pow(10,o)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?La(l[1],o)+i[2]+"/"+i[3]+pn(l[2],o):Xe(" ",2*o+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=Hr(e,0),r.length<=a.length?a:yt(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0?]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=r.indexOf(".")-o,u=r.length-a.length-f;return yt(r.substr(0,f)+a+r.substr(r.length-u))}if(i=r.match(/^00,000\.([#0]*0)$/))return o=Ni(e,i[1].length),e<0?"-"+Pt(t,r,-e):xr(lh(e)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Wt(0,3-p.length):"")+p})+"."+Wt(o,i[1].length);switch(r){case"###,##0.00":return Pt(t,"#,##0.00",e);case"###,###":case"##,###":case"#,###":var m=xr(Hr(c,0));return m!=="0"?h+m:"";case"###,###.00":return Pt(t,"###,##0.00",e).replace(/^0\./,".");case"#,###.00":return Pt(t,"#,##0.00",e).replace(/^0\./,".")}throw new Error("unsupported format |"+r+"|")}function ch(t,r,e){for(var s=r.length-1;r.charCodeAt(s-1)===44;)--s;return nr(t,r.substr(0,s),e/Math.pow(10,3*(r.length-s)))}function dh(t,r,e){var s=r.replace(ko,""),a=r.length-s.length;return nr(t,s,e*Math.pow(10,2*a))+Xe("%",a)}function Io(t,r){var e,s=t.indexOf("E")-t.indexOf(".")-1;if(t.match(/^#+0.0E\+0$/)){if(r==0)return"0.0E+0";if(r<0)return"-"+Io(t,-r);var a=t.indexOf(".");a===-1&&(a=t.indexOf("E"));var i=Math.floor(Math.log(r)*Math.LOG10E)%a;if(i<0&&(i+=a),e=(r/Math.pow(10,i)).toPrecision(s+1+(a+i)%a),!e.match(/[Ee]/)){var o=Math.floor(Math.log(r)*Math.LOG10E);e.indexOf(".")===-1?e=e.charAt(0)+"."+e.substr(1)+"E+"+(o-e.length+i):e+="E+"+(o-i),e=e.replace(/\+-/,"-")}e=e.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(l,c,h,d){return c+h+d.substr(0,(a+i)%a)+"."+d.substr(i)+"E"})}else e=r.toExponential(s);return t.match(/E\+00$/)&&e.match(/e[+-]\d$/)&&(e=e.substr(0,e.length-1)+"0"+e.charAt(e.length-1)),t.match(/E\-/)&&e.match(/e\+/)&&(e=e.replace(/e\+/,"e")),e.replace("e","E")}function Yt(t,r,e){if(t.charCodeAt(0)===40&&!r.match(Do)){var s=r.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return e>=0?Yt("n",s,e):"("+Yt("n",s,-e)+")"}if(r.charCodeAt(r.length-1)===44)return ch(t,r,e);if(r.indexOf("%")!==-1)return dh(t,r,e);if(r.indexOf("E")!==-1)return Io(r,e);if(r.charCodeAt(0)===36)return"$"+Yt(t,r.substr(r.charAt(1)==" "?2:1),e);var a,i,o,l,c=Math.abs(e),h=e<0?"-":"";if(r.match(/^00+$/))return h+Wt(c,r.length);if(r.match(/^[#?]+$/))return a=""+e,e===0&&(a=""),a.length>r.length?a:yt(r.substr(0,r.length-a.length))+a;if(i=r.match(Ro))return ih(i,c,h);if(r.match(/^#+0+$/))return h+Wt(c,r.length-r.indexOf("0"));if(i=r.match(Fo))return a=(""+e).replace(/^([^\.]+)$/,"$1."+yt(i[1])).replace(/\.$/,"."+yt(i[1])),a=a.replace(/\.(\d*)$/,function(p,x){return"."+x+Xe("0",yt(i[1]).length-x.length)}),r.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(r=r.replace(/^#+([0.])/,"$1"),i=r.match(/^(0*)\.(#*)$/))return h+(""+c).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,i[1].length?"0.":".");if(i=r.match(/^#{1,3},##0(\.?)$/))return h+xr(""+c);if(i=r.match(/^#,##0\.([#0]*0)$/))return e<0?"-"+Yt(t,r,-e):xr(""+e)+"."+Xe("0",i[1].length);if(i=r.match(/^#,#*,#0/))return Yt(t,r.replace(/^#,#*,/,""),e);if(i=r.match(/^([0#]+)(\\?-([0#]+))+$/))return a=Yr(Yt(t,r.replace(/[\\-]/g,""),e)),o=0,Yr(Yr(r.replace(/\\/g,"")).replace(/[0#]/g,function(p){return o<a.length?a.charAt(o++):p==="0"?"0":""}));if(r.match(Oo))return a=Yt(t,"##########",e),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var d="";if(i=r.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(i[4].length,7),l=vn(c,Math.pow(10,o)-1,!1),a=""+h,d=nr("n",i[1],l[1]),d.charAt(d.length-1)==" "&&(d=d.substr(0,d.length-1)+"0"),a+=d+i[2]+"/"+i[3],d=pn(l[2],o),d.length<i[4].length&&(d=yt(i[4].substr(i[4].length-d.length))+d),a+=d,a;if(i=r.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return o=Math.min(Math.max(i[1].length,i[4].length),7),l=vn(c,Math.pow(10,o)-1,!0),h+(l[0]||(l[1]?"":"0"))+" "+(l[1]?La(l[1],o)+i[2]+"/"+i[3]+pn(l[2],o):Xe(" ",2*o+1+i[2].length+i[3].length));if(i=r.match(/^[#0?]+$/))return a=""+e,r.length<=a.length?a:yt(r.substr(0,r.length-a.length))+a;if(i=r.match(/^([#0]+)\.([#0]+)$/)){a=""+e.toFixed(Math.min(i[2].length,10)).replace(/([^0])0+$/,"$1"),o=a.indexOf(".");var f=r.indexOf(".")-o,u=r.length-a.length-f;return yt(r.substr(0,f)+a+r.substr(r.length-u))}if(i=r.match(/^00,000\.([#0]*0)$/))return e<0?"-"+Yt(t,r,-e):xr(""+e).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(p){return"00,"+(p.length<3?Wt(0,3-p.length):"")+p})+"."+Wt(0,i[1].length);switch(r){case"###,###":case"##,###":case"#,###":var m=xr(""+c);return m!=="0"?h+m:"";default:if(r.match(/\.[0#?]*$/))return Yt(t,r.slice(0,r.lastIndexOf(".")),e)+yt(r.slice(r.lastIndexOf(".")))}throw new Error("unsupported format |"+r+"|")}function nr(t,r,e){return(e|0)===e?Yt(t,r,e):Pt(t,r,e)}function hh(t){for(var r=[],e=!1,s=0,a=0;s<t.length;++s)switch(t.charCodeAt(s)){case 34:e=!e;break;case 95:case 42:case 92:++s;break;case 59:r[r.length]=t.substr(a,s-a),a=s+1}if(r[r.length]=t.substr(a),e===!0)throw new Error("Format |"+t+"| unterminated string ");return r}var Po=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function Lo(t){for(var r=0,e="",s="";r<t.length;)switch(e=t.charAt(r)){case"G":gn(t,r)&&(r+=6),r++;break;case'"':for(;t.charCodeAt(++r)!==34&&r<t.length;);++r;break;case"\\":r+=2;break;case"_":r+=2;break;case"@":++r;break;case"B":case"b":if(t.charAt(r+1)==="1"||t.charAt(r+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(t.substr(r,3).toUpperCase()==="A/P"||t.substr(r,5).toUpperCase()==="AM/PM"||t.substr(r,5).toUpperCase()==="/")return!0;++r;break;case"[":for(s=e;t.charAt(r++)!=="]"&&r<t.length;)s+=t.charAt(r);if(s.match(Po))return!0;break;case".":case"0":case"#":for(;r<t.length&&("0#?.,E+-%".indexOf(e=t.charAt(++r))>-1||e=="\\"&&t.charAt(r+1)=="-"&&"0#".indexOf(t.charAt(r+2))>-1););break;case"?":for(;t.charAt(++r)===e;);break;case"*":++r,(t.charAt(r)==" "||t.charAt(r)=="*")&&++r;break;case"(":case")":++r;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;r<t.length&&"0123456789".indexOf(t.charAt(++r))>-1;);break;case" ":++r;break;default:++r;break}return!1}function fh(t,r,e,s){for(var a=[],i="",o=0,l="",c="t",h,d,f,u="H";o<t.length;)switch(l=t.charAt(o)){case"G":if(!gn(t,o))throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"G",v:"General"},o+=7;break;case'"':for(i="";(f=t.charCodeAt(++o))!==34&&o<t.length;)i+=String.fromCharCode(f);a[a.length]={t:"t",v:i},++o;break;case"\\":var m=t.charAt(++o),p=m==="("||m===")"?m:"t";a[a.length]={t:p,v:m},++o;break;case"_":a[a.length]={t:"t",v:" "},o+=2;break;case"@":a[a.length]={t:"T",v:r},++o;break;case"B":case"b":if(t.charAt(o+1)==="1"||t.charAt(o+1)==="2"){if(h==null&&(h=Zs(r,e,t.charAt(o+1)==="2"),h==null))return"";a[a.length]={t:"X",v:t.substr(o,2)},c=l,o+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":l=l.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(r<0||h==null&&(h=Zs(r,e),h==null))return"";for(i=l;++o<t.length&&t.charAt(o).toLowerCase()===l;)i+=l;l==="m"&&c.toLowerCase()==="h"&&(l="M"),l==="h"&&(l=u),a[a.length]={t:l,v:i},c=l;break;case"A":case"a":case"":var x={t:l,v:l};if(h==null&&(h=Zs(r,e)),t.substr(o,3).toUpperCase()==="A/P"?(h!=null&&(x.v=h.H>=12?"P":"A"),x.t="T",u="h",o+=3):t.substr(o,5).toUpperCase()==="AM/PM"?(h!=null&&(x.v=h.H>=12?"PM":"AM"),x.t="T",o+=5,u="h"):t.substr(o,5).toUpperCase()==="/"?(h!=null&&(x.v=h.H>=12?"":""),x.t="T",o+=5,u="h"):(x.t="t",++o),h==null&&x.t==="T")return"";a[a.length]=x,c=l;break;case"[":for(i=l;t.charAt(o++)!=="]"&&o<t.length;)i+=t.charAt(o);if(i.slice(-1)!=="]")throw'unterminated "[" block: |'+i+"|";if(i.match(Po)){if(h==null&&(h=Zs(r,e),h==null))return"";a[a.length]={t:"Z",v:i.toLowerCase()},c=i.charAt(1)}else i.indexOf("$")>-1&&(i=(i.match(/\$([^-\[\]]*)/)||[])[1]||"$",Lo(t)||(a[a.length]={t:"t",v:i}));break;case".":if(h!=null){for(i=l;++o<t.length&&(l=t.charAt(o))==="0";)i+=l;a[a.length]={t:"s",v:i};break}case"0":case"#":for(i=l;++o<t.length&&"0#?.,E+-%".indexOf(l=t.charAt(o))>-1;)i+=l;a[a.length]={t:"n",v:i};break;case"?":for(i=l;t.charAt(++o)===l;)i+=l;a[a.length]={t:l,v:i},c=l;break;case"*":++o,(t.charAt(o)==" "||t.charAt(o)=="*")&&++o;break;case"(":case")":a[a.length]={t:s===1?"t":l,v:l},++o;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(i=l;o<t.length&&"0123456789".indexOf(t.charAt(++o))>-1;)i+=t.charAt(o);a[a.length]={t:"D",v:i};break;case" ":a[a.length]={t:l,v:l},++o;break;case"$":a[a.length]={t:"t",v:"$"},++o;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(l)===-1)throw new Error("unrecognized character "+l+" in "+t);a[a.length]={t:"t",v:l},++o;break}var g=0,T=0,b;for(o=a.length-1,c="t";o>=0;--o)switch(a[o].t){case"h":case"H":a[o].t=u,c="h",g<1&&(g=1);break;case"s":(b=a[o].v.match(/\.0+$/))&&(T=Math.max(T,b[0].length-1)),g<3&&(g=3);case"d":case"y":case"M":case"e":c=a[o].t;break;case"m":c==="s"&&(a[o].t="M",g<2&&(g=2));break;case"X":break;case"Z":g<1&&a[o].v.match(/[Hh]/)&&(g=1),g<2&&a[o].v.match(/[Mm]/)&&(g=2),g<3&&a[o].v.match(/[Ss]/)&&(g=3)}switch(g){case 0:break;case 1:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M),h.M>=60&&(h.M=0,++h.H);break;case 2:h.u>=.5&&(h.u=0,++h.S),h.S>=60&&(h.S=0,++h.M);break}var w="",A;for(o=0;o<a.length;++o)switch(a[o].t){case"t":case"T":case" ":case"D":break;case"X":a[o].v="",a[o].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[o].v=rh(a[o].t.charCodeAt(0),a[o].v,h,T),a[o].t="t";break;case"n":case"?":for(A=o+1;a[A]!=null&&((l=a[A].t)==="?"||l==="D"||(l===" "||l==="t")&&a[A+1]!=null&&(a[A+1].t==="?"||a[A+1].t==="t"&&a[A+1].v==="/")||a[o].t==="("&&(l===" "||l==="n"||l===")")||l==="t"&&(a[A].v==="/"||a[A].v===" "&&a[A+1]!=null&&a[A+1].t=="?"));)a[o].v+=a[A].v,a[A]={v:"",t:";"},++A;w+=a[o].v,o=A-1;break;case"G":a[o].t="t",a[o].v=Sa(r,e);break}var _="",L,E;if(w.length>0){w.charCodeAt(0)==40?(L=r<0&&w.charCodeAt(0)===45?-r:r,E=nr("n",w,L)):(L=r<0&&s>1?-r:r,E=nr("n",w,L),L<0&&a[0]&&a[0].t=="t"&&(E=E.substr(1),a[0].v="-"+a[0].v)),A=E.length-1;var O=a.length;for(o=0;o<a.length;++o)if(a[o]!=null&&a[o].t!="t"&&a[o].v.indexOf(".")>-1){O=o;break}var F=a.length;if(O===a.length&&E.indexOf("E")===-1){for(o=a.length-1;o>=0;--o)a[o]==null||"n?".indexOf(a[o].t)===-1||(A>=a[o].v.length-1?(A-=a[o].v.length,a[o].v=E.substr(A+1,a[o].v.length)):A<0?a[o].v="":(a[o].v=E.substr(0,A+1),A=-1),a[o].t="t",F=o);A>=0&&F<a.length&&(a[F].v=E.substr(0,A+1)+a[F].v)}else if(O!==a.length&&E.indexOf("E")===-1){for(A=E.indexOf(".")-1,o=O;o>=0;--o)if(!(a[o]==null||"n?".indexOf(a[o].t)===-1)){for(d=a[o].v.indexOf(".")>-1&&o===O?a[o].v.indexOf(".")-1:a[o].v.length-1,_=a[o].v.substr(d+1);d>=0;--d)A>=0&&(a[o].v.charAt(d)==="0"||a[o].v.charAt(d)==="#")&&(_=E.charAt(A--)+_);a[o].v=_,a[o].t="t",F=o}for(A>=0&&F<a.length&&(a[F].v=E.substr(0,A+1)+a[F].v),A=E.indexOf(".")+1,o=O;o<a.length;++o)if(!(a[o]==null||"n?(".indexOf(a[o].t)===-1&&o!==O)){for(d=a[o].v.indexOf(".")>-1&&o===O?a[o].v.indexOf(".")+1:0,_=a[o].v.substr(0,d);d<a[o].v.length;++d)A<E.length&&(_+=E.charAt(A++));a[o].v=_,a[o].t="t",F=o}}}for(o=0;o<a.length;++o)a[o]!=null&&"n?".indexOf(a[o].t)>-1&&(L=s>1&&r<0&&o>0&&a[o-1].v==="-"?-r:r,a[o].v=nr(a[o].t,a[o].v,L),a[o].t="t");var M="";for(o=0;o!==a.length;++o)a[o]!=null&&(M+=a[o].v);return M}var ji=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function Ei(t,r){if(r==null)return!1;var e=parseFloat(r[2]);switch(r[1]){case"=":if(t==e)return!0;break;case">":if(t>e)return!0;break;case"<":if(t<e)return!0;break;case"<>":if(t!=e)return!0;break;case">=":if(t>=e)return!0;break;case"<=":if(t<=e)return!0;break}return!1}function uh(t,r){var e=hh(t),s=e.length,a=e[s-1].indexOf("@");if(s<4&&a>-1&&--s,e.length>4)throw new Error("cannot find right format for |"+e.join("|")+"|");if(typeof r!="number")return[4,e.length===4||a>-1?e[e.length-1]:"@"];switch(e.length){case 1:e=a>-1?["General","General","General",e[0]]:[e[0],e[0],e[0],"@"];break;case 2:e=a>-1?[e[0],e[0],e[0],e[1]]:[e[0],e[1],e[0],"@"];break;case 3:e=a>-1?[e[0],e[1],e[0],e[2]]:[e[0],e[1],e[2],"@"];break}var i=r>0?e[0]:r<0?e[1]:e[2];if(e[0].indexOf("[")===-1&&e[1].indexOf("[")===-1)return[s,i];if(e[0].match(/\[[=<>]/)!=null||e[1].match(/\[[=<>]/)!=null){var o=e[0].match(ji),l=e[1].match(ji);return Ei(r,o)?[s,e[0]]:Ei(r,l)?[s,e[1]]:[s,e[o!=null&&l!=null?2:1]]}return[s,i]}function pr(t,r,e){e==null&&(e={});var s="";switch(typeof t){case"string":t=="m/d/yy"&&e.dateNF?s=e.dateNF:s=t;break;case"number":t==14&&e.dateNF?s=e.dateNF:s=(e.table!=null?e.table:Ke)[t],s==null&&(s=e.table&&e.table[_i[t]]||Ke[_i[t]]),s==null&&(s=Kd[t]||"General");break}if(gn(s,0))return Sa(r,e);r instanceof Date&&(r=Co(r,e.date1904));var a=uh(s,r);if(gn(a[1]))return Sa(r,e);if(r===!0)r="TRUE";else if(r===!1)r="FALSE";else if(r===""||r==null)return"";return fh(a[1],r,e,a[0])}function Bo(t,r){if(typeof r!="number"){r=+r||-1;for(var e=0;e<392;++e){if(Ke[e]==null){r<0&&(r=e);continue}if(Ke[e]==t){r=e;break}}r<0&&(r=391)}return Ke[r]=t,r}function Mn(t){for(var r=0;r!=392;++r)t[r]!==void 0&&Bo(t[r],r)}function zn(){Ke=Xd()}var Mo=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function xh(t){var r=typeof t=="number"?Ke[t]:t;return r=r.replace(Mo,"(\\d+)"),new RegExp("^"+r+"$")}function mh(t,r,e){var s=-1,a=-1,i=-1,o=-1,l=-1,c=-1;(r.match(Mo)||[]).forEach(function(f,u){var m=parseInt(e[u+1],10);switch(f.toLowerCase().charAt(0)){case"y":s=m;break;case"d":i=m;break;case"h":o=m;break;case"s":c=m;break;case"m":o>=0?l=m:a=m;break}}),c>=0&&l==-1&&a>=0&&(l=a,a=-1);var h=(""+(s>=0?s:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(i>=1?i:1)).slice(-2);h.length==7&&(h="0"+h),h.length==8&&(h="20"+h);var d=("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2)+":"+("00"+(c>=0?c:0)).slice(-2);return o==-1&&l==-1&&c==-1?h:s==-1&&a==-1&&i==-1?d:h+"T"+d}var ph=function(){var t={};t.version="1.2.0";function r(){for(var E=0,O=new Array(256),F=0;F!=256;++F)E=F,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,E=E&1?-306674912^E>>>1:E>>>1,O[F]=E;return typeof Int32Array<"u"?new Int32Array(O):O}var e=r();function s(E){var O=0,F=0,M=0,U=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(M=0;M!=256;++M)U[M]=E[M];for(M=0;M!=256;++M)for(F=E[M],O=256+M;O<4096;O+=256)F=U[O]=F>>>8^E[F&255];var H=[];for(M=1;M!=16;++M)H[M-1]=typeof Int32Array<"u"?U.subarray(M*256,M*256+256):U.slice(M*256,M*256+256);return H}var a=s(e),i=a[0],o=a[1],l=a[2],c=a[3],h=a[4],d=a[5],f=a[6],u=a[7],m=a[8],p=a[9],x=a[10],g=a[11],T=a[12],b=a[13],w=a[14];function A(E,O){for(var F=O^-1,M=0,U=E.length;M<U;)F=F>>>8^e[(F^E.charCodeAt(M++))&255];return~F}function _(E,O){for(var F=O^-1,M=E.length-15,U=0;U<M;)F=w[E[U++]^F&255]^b[E[U++]^F>>8&255]^T[E[U++]^F>>16&255]^g[E[U++]^F>>>24]^x[E[U++]]^p[E[U++]]^m[E[U++]]^u[E[U++]]^f[E[U++]]^d[E[U++]]^h[E[U++]]^c[E[U++]]^l[E[U++]]^o[E[U++]]^i[E[U++]]^e[E[U++]];for(M+=15;U<M;)F=F>>>8^e[(F^E[U++])&255];return~F}function L(E,O){for(var F=O^-1,M=0,U=E.length,H=0,J=0;M<U;)H=E.charCodeAt(M++),H<128?F=F>>>8^e[(F^H)&255]:H<2048?(F=F>>>8^e[(F^(192|H>>6&31))&255],F=F>>>8^e[(F^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,J=E.charCodeAt(M++)&1023,F=F>>>8^e[(F^(240|H>>8&7))&255],F=F>>>8^e[(F^(128|H>>2&63))&255],F=F>>>8^e[(F^(128|J>>6&15|(H&3)<<4))&255],F=F>>>8^e[(F^(128|J&63))&255]):(F=F>>>8^e[(F^(224|H>>12&15))&255],F=F>>>8^e[(F^(128|H>>6&63))&255],F=F>>>8^e[(F^(128|H&63))&255]);return~F}return t.table=e,t.bstr=A,t.buf=_,t.str=L,t}(),Me=function(){var r={};r.version="1.2.1";function e(v,C){for(var N=v.split("/"),j=C.split("/"),k=0,R=0,G=Math.min(N.length,j.length);k<G;++k){if(R=N[k].length-j[k].length)return R;if(N[k]!=j[k])return N[k]<j[k]?-1:1}return N.length-j.length}function s(v){if(v.charAt(v.length-1)=="/")return v.slice(0,-1).indexOf("/")===-1?v:s(v.slice(0,-1));var C=v.lastIndexOf("/");return C===-1?v:v.slice(0,C+1)}function a(v){if(v.charAt(v.length-1)=="/")return a(v.slice(0,-1));var C=v.lastIndexOf("/");return C===-1?v:v.slice(C+1)}function i(v,C){typeof C=="string"&&(C=new Date(C));var N=C.getHours();N=N<<6|C.getMinutes(),N=N<<5|C.getSeconds()>>>1,v.write_shift(2,N);var j=C.getFullYear()-1980;j=j<<4|C.getMonth()+1,j=j<<5|C.getDate(),v.write_shift(2,j)}function o(v){var C=v.read_shift(2)&65535,N=v.read_shift(2)&65535,j=new Date,k=N&31;N>>>=5;var R=N&15;N>>>=4,j.setMilliseconds(0),j.setFullYear(N+1980),j.setMonth(R-1),j.setDate(k);var G=C&31;C>>>=5;var Z=C&63;return C>>>=6,j.setHours(C),j.setMinutes(Z),j.setSeconds(G<<1),j}function l(v){Ct(v,0);for(var C={},N=0;v.l<=v.length-4;){var j=v.read_shift(2),k=v.read_shift(2),R=v.l+k,G={};switch(j){case 21589:N=v.read_shift(1),N&1&&(G.mtime=v.read_shift(4)),k>5&&(N&2&&(G.atime=v.read_shift(4)),N&4&&(G.ctime=v.read_shift(4))),G.mtime&&(G.mt=new Date(G.mtime*1e3));break}v.l=R,C[j]=G}return C}var c;function h(){return c||(c={})}function d(v,C){if(v[0]==80&&v[1]==75)return Zt(v,C);if((v[0]|32)==109&&(v[1]|32)==105)return kc(v,C);if(v.length<512)throw new Error("CFB file size "+v.length+" < 512");var N=3,j=512,k=0,R=0,G=0,Z=0,W=0,X=[],K=v.slice(0,512);Ct(K,0);var se=f(K);switch(N=se[0],N){case 3:j=512;break;case 4:j=4096;break;case 0:if(se[1]==0)return Zt(v,C);default:throw new Error("Major Version: Expected 3 or 4 saw "+N)}j!==512&&(K=v.slice(0,j),Ct(K,28));var oe=v.slice(0,j);u(K,N);var me=K.read_shift(4,"i");if(N===3&&me!==0)throw new Error("# Directory Sectors: Expected 0 saw "+me);K.l+=4,G=K.read_shift(4,"i"),K.l+=4,K.chk("00100000","Mini Stream Cutoff Size: "),Z=K.read_shift(4,"i"),k=K.read_shift(4,"i"),W=K.read_shift(4,"i"),R=K.read_shift(4,"i");for(var ne=-1,fe=0;fe<109&&(ne=K.read_shift(4,"i"),!(ne<0));++fe)X[fe]=ne;var we=m(v,j);g(W,R,we,j,X);var $e=b(we,G,X,j);$e[G].name="!Directory",k>0&&Z!==J&&($e[Z].name="!MiniFAT"),$e[X[0]].name="!FAT",$e.fat_addrs=X,$e.ssz=j;var He={},ft=[],us=[],xs=[];w(G,$e,we,ft,k,He,us,Z),p(us,xs,ft),ft.shift();var ms={FileIndex:us,FullPaths:xs};return C&&C.raw&&(ms.raw={header:oe,sectors:we}),ms}function f(v){if(v[v.l]==80&&v[v.l+1]==75)return[0,0];v.chk(ge,"Header Signature: "),v.l+=16;var C=v.read_shift(2,"u");return[v.read_shift(2,"u"),C]}function u(v,C){var N=9;switch(v.l+=2,N=v.read_shift(2)){case 9:if(C!=3)throw new Error("Sector Shift: Expected 9 saw "+N);break;case 12:if(C!=4)throw new Error("Sector Shift: Expected 12 saw "+N);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+N)}v.chk("0600","Mini Sector Shift: "),v.chk("000000000000","Reserved: ")}function m(v,C){for(var N=Math.ceil(v.length/C)-1,j=[],k=1;k<N;++k)j[k-1]=v.slice(k*C,(k+1)*C);return j[N-1]=v.slice(N*C),j}function p(v,C,N){for(var j=0,k=0,R=0,G=0,Z=0,W=N.length,X=[],K=[];j<W;++j)X[j]=K[j]=j,C[j]=N[j];for(;Z<K.length;++Z)j=K[Z],k=v[j].L,R=v[j].R,G=v[j].C,X[j]===j&&(k!==-1&&X[k]!==k&&(X[j]=X[k]),R!==-1&&X[R]!==R&&(X[j]=X[R])),G!==-1&&(X[G]=j),k!==-1&&j!=X[j]&&(X[k]=X[j],K.lastIndexOf(k)<Z&&K.push(k)),R!==-1&&j!=X[j]&&(X[R]=X[j],K.lastIndexOf(R)<Z&&K.push(R));for(j=1;j<W;++j)X[j]===j&&(R!==-1&&X[R]!==R?X[j]=X[R]:k!==-1&&X[k]!==k&&(X[j]=X[k]));for(j=1;j<W;++j)if(v[j].type!==0){if(Z=j,Z!=X[Z])do Z=X[Z],C[j]=C[Z]+"/"+C[j];while(Z!==0&&X[Z]!==-1&&Z!=X[Z]);X[j]=-1}for(C[0]+="/",j=1;j<W;++j)v[j].type!==2&&(C[j]+="/")}function x(v,C,N){for(var j=v.start,k=v.size,R=[],G=j;N&&k>0&&G>=0;)R.push(C.slice(G*H,G*H+H)),k-=H,G=kr(N,G*4);return R.length===0?q(0):ot(R).slice(0,v.size)}function g(v,C,N,j,k){var R=J;if(v===J){if(C!==0)throw new Error("DIFAT chain shorter than expected")}else if(v!==-1){var G=N[v],Z=(j>>>2)-1;if(!G)return;for(var W=0;W<Z&&(R=kr(G,W*4))!==J;++W)k.push(R);g(kr(G,j-4),C-1,N,j,k)}}function T(v,C,N,j,k){var R=[],G=[];k||(k=[]);var Z=j-1,W=0,X=0;for(W=C;W>=0;){k[W]=!0,R[R.length]=W,G.push(v[W]);var K=N[Math.floor(W*4/j)];if(X=W*4&Z,j<4+X)throw new Error("FAT boundary crossed: "+W+" 4 "+j);if(!v[K])break;W=kr(v[K],X)}return{nodes:R,data:Oi([G])}}function b(v,C,N,j){var k=v.length,R=[],G=[],Z=[],W=[],X=j-1,K=0,se=0,oe=0,me=0;for(K=0;K<k;++K)if(Z=[],oe=K+C,oe>=k&&(oe-=k),!G[oe]){W=[];var ne=[];for(se=oe;se>=0;){ne[se]=!0,G[se]=!0,Z[Z.length]=se,W.push(v[se]);var fe=N[Math.floor(se*4/j)];if(me=se*4&X,j<4+me)throw new Error("FAT boundary crossed: "+se+" 4 "+j);if(!v[fe]||(se=kr(v[fe],me),ne[se]))break}R[oe]={nodes:Z,data:Oi([W])}}return R}function w(v,C,N,j,k,R,G,Z){for(var W=0,X=j.length?2:0,K=C[v].data,se=0,oe=0,me;se<K.length;se+=128){var ne=K.slice(se,se+128);Ct(ne,64),oe=ne.read_shift(2),me=Ha(ne,0,oe-X),j.push(me);var fe={name:me,type:ne.read_shift(1),color:ne.read_shift(1),L:ne.read_shift(4,"i"),R:ne.read_shift(4,"i"),C:ne.read_shift(4,"i"),clsid:ne.read_shift(16),state:ne.read_shift(4,"i"),start:0,size:0},we=ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2);we!==0&&(fe.ct=A(ne,ne.l-8));var $e=ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2)+ne.read_shift(2);$e!==0&&(fe.mt=A(ne,ne.l-8)),fe.start=ne.read_shift(4,"i"),fe.size=ne.read_shift(4,"i"),fe.size<0&&fe.start<0&&(fe.size=fe.type=0,fe.start=J,fe.name=""),fe.type===5?(W=fe.start,k>0&&W!==J&&(C[W].name="!StreamData")):fe.size>=4096?(fe.storage="fat",C[fe.start]===void 0&&(C[fe.start]=T(N,fe.start,C.fat_addrs,C.ssz)),C[fe.start].name=fe.name,fe.content=C[fe.start].data.slice(0,fe.size)):(fe.storage="minifat",fe.size<0?fe.size=0:W!==J&&fe.start!==J&&C[W]&&(fe.content=x(fe,C[W].data,(C[Z]||{}).data))),fe.content&&Ct(fe.content,0),R[me]=fe,G.push(fe)}}function A(v,C){return new Date((At(v,C+4)/1e7*Math.pow(2,32)+At(v,C)/1e7-11644473600)*1e3)}function _(v,C){return h(),d(c.readFileSync(v),C)}function L(v,C){var N=C&&C.type;switch(N||Re&&Buffer.isBuffer(v)&&(N="buffer"),N||"base64"){case"file":return _(v,C);case"base64":return d(Ht(or(v)),C);case"binary":return d(Ht(v),C)}return d(v,C)}function E(v,C){var N=C||{},j=N.root||"Root Entry";if(v.FullPaths||(v.FullPaths=[]),v.FileIndex||(v.FileIndex=[]),v.FullPaths.length!==v.FileIndex.length)throw new Error("inconsistent CFB structure");v.FullPaths.length===0&&(v.FullPaths[0]=j+"/",v.FileIndex[0]={name:j,type:5}),N.CLSID&&(v.FileIndex[0].clsid=N.CLSID),O(v)}function O(v){var C="Sh33tJ5";if(!Me.find(v,"/"+C)){var N=q(4);N[0]=55,N[1]=N[3]=50,N[2]=54,v.FileIndex.push({name:C,type:2,content:N,size:4,L:69,R:69,C:69}),v.FullPaths.push(v.FullPaths[0]+C),F(v)}}function F(v,C){E(v);for(var N=!1,j=!1,k=v.FullPaths.length-1;k>=0;--k){var R=v.FileIndex[k];switch(R.type){case 0:j?N=!0:(v.FileIndex.pop(),v.FullPaths.pop());break;case 1:case 2:case 5:j=!0,isNaN(R.R*R.L*R.C)&&(N=!0),R.R>-1&&R.L>-1&&R.R==R.L&&(N=!0);break;default:N=!0;break}}if(!(!N&&!C)){var G=new Date(1987,1,19),Z=0,W=Object.create?Object.create(null):{},X=[];for(k=0;k<v.FullPaths.length;++k)W[v.FullPaths[k]]=!0,v.FileIndex[k].type!==0&&X.push([v.FullPaths[k],v.FileIndex[k]]);for(k=0;k<X.length;++k){var K=s(X[k][0]);j=W[K],j||(X.push([K,{name:a(K).replace("/",""),type:1,clsid:Ee,ct:G,mt:G,content:null}]),W[K]=!0)}for(X.sort(function(me,ne){return e(me[0],ne[0])}),v.FullPaths=[],v.FileIndex=[],k=0;k<X.length;++k)v.FullPaths[k]=X[k][0],v.FileIndex[k]=X[k][1];for(k=0;k<X.length;++k){var se=v.FileIndex[k],oe=v.FullPaths[k];if(se.name=a(oe).replace("/",""),se.L=se.R=se.C=-(se.color=1),se.size=se.content?se.content.length:0,se.start=0,se.clsid=se.clsid||Ee,k===0)se.C=X.length>1?1:-1,se.size=0,se.type=5;else if(oe.slice(-1)=="/"){for(Z=k+1;Z<X.length&&s(v.FullPaths[Z])!=oe;++Z);for(se.C=Z>=X.length?-1:Z,Z=k+1;Z<X.length&&s(v.FullPaths[Z])!=s(oe);++Z);se.R=Z>=X.length?-1:Z,se.type=1}else s(v.FullPaths[k+1]||"")==s(oe)&&(se.R=k+1),se.type=2}}}function M(v,C){var N=C||{};if(N.fileType=="mad")return Ac(v,N);switch(F(v),N.fileType){case"zip":return It(v,N)}var j=function(me){for(var ne=0,fe=0,we=0;we<me.FileIndex.length;++we){var $e=me.FileIndex[we];if($e.content){var He=$e.content.length;He>0&&(He<4096?ne+=He+63>>6:fe+=He+511>>9)}}for(var ft=me.FullPaths.length+3>>2,us=ne+7>>3,xs=ne+127>>7,ms=us+fe+ft+xs,Nr=ms+127>>7,Jn=Nr<=109?0:Math.ceil((Nr-109)/127);ms+Nr+Jn+127>>7>Nr;)Jn=++Nr<=109?0:Math.ceil((Nr-109)/127);var er=[1,Jn,Nr,xs,ft,fe,ne,0];return me.FileIndex[0].size=ne<<6,er[7]=(me.FileIndex[0].start=er[0]+er[1]+er[2]+er[3]+er[4]+er[5])+(er[6]+7>>3),er}(v),k=q(j[7]<<9),R=0,G=0;{for(R=0;R<8;++R)k.write_shift(1,xe[R]);for(R=0;R<8;++R)k.write_shift(2,0);for(k.write_shift(2,62),k.write_shift(2,3),k.write_shift(2,65534),k.write_shift(2,9),k.write_shift(2,6),R=0;R<3;++R)k.write_shift(2,0);for(k.write_shift(4,0),k.write_shift(4,j[2]),k.write_shift(4,j[0]+j[1]+j[2]+j[3]-1),k.write_shift(4,0),k.write_shift(4,4096),k.write_shift(4,j[3]?j[0]+j[1]+j[2]-1:J),k.write_shift(4,j[3]),k.write_shift(-4,j[1]?j[0]-1:J),k.write_shift(4,j[1]),R=0;R<109;++R)k.write_shift(-4,R<j[2]?j[1]+R:-1)}if(j[1])for(G=0;G<j[1];++G){for(;R<236+G*127;++R)k.write_shift(-4,R<j[2]?j[1]+R:-1);k.write_shift(-4,G===j[1]-1?J:G+1)}var Z=function(me){for(G+=me;R<G-1;++R)k.write_shift(-4,R+1);me&&(++R,k.write_shift(-4,J))};for(G=R=0,G+=j[1];R<G;++R)k.write_shift(-4,be.DIFSECT);for(G+=j[2];R<G;++R)k.write_shift(-4,be.FATSECT);Z(j[3]),Z(j[4]);for(var W=0,X=0,K=v.FileIndex[0];W<v.FileIndex.length;++W)K=v.FileIndex[W],K.content&&(X=K.content.length,!(X<4096)&&(K.start=G,Z(X+511>>9)));for(Z(j[6]+7>>3);k.l&511;)k.write_shift(-4,be.ENDOFCHAIN);for(G=R=0,W=0;W<v.FileIndex.length;++W)K=v.FileIndex[W],K.content&&(X=K.content.length,!(!X||X>=4096)&&(K.start=G,Z(X+63>>6)));for(;k.l&511;)k.write_shift(-4,be.ENDOFCHAIN);for(R=0;R<j[4]<<2;++R){var se=v.FullPaths[R];if(!se||se.length===0){for(W=0;W<17;++W)k.write_shift(4,0);for(W=0;W<3;++W)k.write_shift(4,-1);for(W=0;W<12;++W)k.write_shift(4,0);continue}K=v.FileIndex[R],R===0&&(K.start=K.size?K.start-1:J);var oe=R===0&&N.root||K.name;if(X=2*(oe.length+1),k.write_shift(64,oe,"utf16le"),k.write_shift(2,X),k.write_shift(1,K.type),k.write_shift(1,K.color),k.write_shift(-4,K.L),k.write_shift(-4,K.R),k.write_shift(-4,K.C),K.clsid)k.write_shift(16,K.clsid,"hex");else for(W=0;W<4;++W)k.write_shift(4,0);k.write_shift(4,K.state||0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,0),k.write_shift(4,K.start),k.write_shift(4,K.size),k.write_shift(4,0)}for(R=1;R<v.FileIndex.length;++R)if(K=v.FileIndex[R],K.size>=4096)if(k.l=K.start+1<<9,Re&&Buffer.isBuffer(K.content))K.content.copy(k,k.l,0,K.size),k.l+=K.size+511&-512;else{for(W=0;W<K.size;++W)k.write_shift(1,K.content[W]);for(;W&511;++W)k.write_shift(1,0)}for(R=1;R<v.FileIndex.length;++R)if(K=v.FileIndex[R],K.size>0&&K.size<4096)if(Re&&Buffer.isBuffer(K.content))K.content.copy(k,k.l,0,K.size),k.l+=K.size+63&-64;else{for(W=0;W<K.size;++W)k.write_shift(1,K.content[W]);for(;W&63;++W)k.write_shift(1,0)}if(Re)k.l=k.length;else for(;k.l<k.length;)k.write_shift(1,0);return k}function U(v,C){var N=v.FullPaths.map(function(W){return W.toUpperCase()}),j=N.map(function(W){var X=W.split("/");return X[X.length-(W.slice(-1)=="/"?2:1)]}),k=!1;C.charCodeAt(0)===47?(k=!0,C=N[0].slice(0,-1)+C):k=C.indexOf("/")!==-1;var R=C.toUpperCase(),G=k===!0?N.indexOf(R):j.indexOf(R);if(G!==-1)return v.FileIndex[G];var Z=!R.match(Qs);for(R=R.replace(ws,""),Z&&(R=R.replace(Qs,"!")),G=0;G<N.length;++G)if((Z?N[G].replace(Qs,"!"):N[G]).replace(ws,"")==R||(Z?j[G].replace(Qs,"!"):j[G]).replace(ws,"")==R)return v.FileIndex[G];return null}var H=64,J=-2,ge="d0cf11e0a1b11ae1",xe=[208,207,17,224,161,177,26,225],Ee="00000000000000000000000000000000",be={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:J,FREESECT:-1,HEADER_SIGNATURE:ge,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:Ee,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function Te(v,C,N){h();var j=M(v,N);c.writeFileSync(C,j)}function le(v){for(var C=new Array(v.length),N=0;N<v.length;++N)C[N]=String.fromCharCode(v[N]);return C.join("")}function ue(v,C){var N=M(v,C);switch(C&&C.type||"buffer"){case"file":return h(),c.writeFileSync(C.filename,N),N;case"binary":return typeof N=="string"?N:le(N);case"base64":return Rs(typeof N=="string"?N:le(N));case"buffer":if(Re)return Buffer.isBuffer(N)?N:cr(N);case"array":return typeof N=="string"?Ht(N):N}return N}var _e;function S(v){try{var C=v.InflateRaw,N=new C;if(N._processChunk(new Uint8Array([3,0]),N._finishFlushFlag),N.bytesRead)_e=v;else throw new Error("zlib does not expose bytesRead")}catch(j){console.error("cannot use native zlib: "+(j.message||j))}}function I(v,C){if(!_e)return Ae(v,C);var N=_e.InflateRaw,j=new N,k=j._processChunk(v.slice(v.l),j._finishFlushFlag);return v.l+=j.bytesRead,k}function D(v){return _e?_e.deflateRawSync(v):Mt(v)}var y=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],B=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Q(v){var C=(v<<1|v<<11)&139536|(v<<5|v<<15)&558144;return(C>>16|C>>8|C)&255}for(var te=typeof Uint8Array<"u",re=te?new Uint8Array(256):[],ve=0;ve<256;++ve)re[ve]=Q(ve);function V(v,C){var N=re[v&255];return C<=8?N>>>8-C:(N=N<<8|re[v>>8&255],C<=16?N>>>16-C:(N=N<<8|re[v>>16&255],N>>>24-C))}function pe(v,C){var N=C&7,j=C>>>3;return(v[j]|(N<=6?0:v[j+1]<<8))>>>N&3}function he(v,C){var N=C&7,j=C>>>3;return(v[j]|(N<=5?0:v[j+1]<<8))>>>N&7}function De(v,C){var N=C&7,j=C>>>3;return(v[j]|(N<=4?0:v[j+1]<<8))>>>N&15}function Ne(v,C){var N=C&7,j=C>>>3;return(v[j]|(N<=3?0:v[j+1]<<8))>>>N&31}function de(v,C){var N=C&7,j=C>>>3;return(v[j]|(N<=1?0:v[j+1]<<8))>>>N&127}function je(v,C,N){var j=C&7,k=C>>>3,R=(1<<N)-1,G=v[k]>>>j;return N<8-j||(G|=v[k+1]<<8-j,N<16-j)||(G|=v[k+2]<<16-j,N<24-j)||(G|=v[k+3]<<24-j),G&R}function ht(v,C,N){var j=C&7,k=C>>>3;return j<=5?v[k]|=(N&7)<<j:(v[k]|=N<<j&255,v[k+1]=(N&7)>>8-j),C+3}function _t(v,C,N){var j=C&7,k=C>>>3;return N=(N&1)<<j,v[k]|=N,C+1}function Vt(v,C,N){var j=C&7,k=C>>>3;return N<<=j,v[k]|=N&255,N>>>=8,v[k+1]=N,C+8}function _r(v,C,N){var j=C&7,k=C>>>3;return N<<=j,v[k]|=N&255,N>>>=8,v[k+1]=N&255,v[k+2]=N>>>8,C+16}function Sr(v,C){var N=v.length,j=2*N>C?2*N:C+5,k=0;if(N>=C)return v;if(Re){var R=yi(j);if(v.copy)v.copy(R);else for(;k<v.length;++k)R[k]=v[k];return R}else if(te){var G=new Uint8Array(j);if(G.set)G.set(v);else for(;k<N;++k)G[k]=v[k];return G}return v.length=j,v}function mt(v){for(var C=new Array(v),N=0;N<v;++N)C[N]=0;return C}function Y(v,C,N){var j=1,k=0,R=0,G=0,Z=0,W=v.length,X=te?new Uint16Array(32):mt(32);for(R=0;R<32;++R)X[R]=0;for(R=W;R<N;++R)v[R]=0;W=v.length;var K=te?new Uint16Array(W):mt(W);for(R=0;R<W;++R)X[k=v[R]]++,j<k&&(j=k),K[R]=0;for(X[0]=0,R=1;R<=j;++R)X[R+16]=Z=Z+X[R-1]<<1;for(R=0;R<W;++R)Z=v[R],Z!=0&&(K[R]=X[Z+16]++);var se=0;for(R=0;R<W;++R)if(se=v[R],se!=0)for(Z=V(K[R],j)>>j-se,G=(1<<j+4-se)-1;G>=0;--G)C[Z|G<<se]=se&15|R<<4;return j}var ye=te?new Uint16Array(512):mt(512),Fe=te?new Uint16Array(32):mt(32);if(!te){for(var ke=0;ke<512;++ke)ye[ke]=0;for(ke=0;ke<32;++ke)Fe[ke]=0}(function(){for(var v=[],C=0;C<32;C++)v.push(5);Y(v,Fe,32);var N=[];for(C=0;C<=143;C++)N.push(8);for(;C<=255;C++)N.push(9);for(;C<=279;C++)N.push(7);for(;C<=287;C++)N.push(8);Y(N,ye,288)})();var Ot=function(){for(var C=te?new Uint8Array(32768):[],N=0,j=0;N<B.length-1;++N)for(;j<B[N+1];++j)C[j]=N;for(;j<32768;++j)C[j]=29;var k=te?new Uint8Array(259):[];for(N=0,j=0;N<z.length-1;++N)for(;j<z[N+1];++j)k[j]=N;function R(Z,W){for(var X=0;X<Z.length;){var K=Math.min(65535,Z.length-X),se=X+K==Z.length;for(W.write_shift(1,+se),W.write_shift(2,K),W.write_shift(2,~K&65535);K-- >0;)W[W.l++]=Z[X++]}return W.l}function G(Z,W){for(var X=0,K=0,se=te?new Uint16Array(32768):[];K<Z.length;){var oe=Math.min(65535,Z.length-K);if(oe<10){for(X=ht(W,X,+(K+oe==Z.length)),X&7&&(X+=8-(X&7)),W.l=X/8|0,W.write_shift(2,oe),W.write_shift(2,~oe&65535);oe-- >0;)W[W.l++]=Z[K++];X=W.l*8;continue}X=ht(W,X,+(K+oe==Z.length)+2);for(var me=0;oe-- >0;){var ne=Z[K];me=(me<<5^ne)&32767;var fe=-1,we=0;if((fe=se[me])&&(fe|=K&-32768,fe>K&&(fe-=32768),fe<K))for(;Z[fe+we]==Z[K+we]&&we<250;)++we;if(we>2){ne=k[we],ne<=22?X=Vt(W,X,re[ne+1]>>1)-1:(Vt(W,X,3),X+=5,Vt(W,X,re[ne-23]>>5),X+=3);var $e=ne<8?0:ne-4>>2;$e>0&&(_r(W,X,we-z[ne]),X+=$e),ne=C[K-fe],X=Vt(W,X,re[ne]>>3),X-=3;var He=ne<4?0:ne-2>>1;He>0&&(_r(W,X,K-fe-B[ne]),X+=He);for(var ft=0;ft<we;++ft)se[me]=K&32767,me=(me<<5^Z[K])&32767,++K;oe-=we-1}else ne<=143?ne=ne+48:X=_t(W,X,1),X=Vt(W,X,re[ne]),se[me]=K&32767,++K}X=Vt(W,X,0)-1}return W.l=(X+7)/8|0,W.l}return function(W,X){return W.length<8?R(W,X):G(W,X)}}();function Mt(v){var C=q(50+Math.floor(v.length*1.1)),N=Ot(v,C);return C.slice(0,N)}var Ge=te?new Uint16Array(32768):mt(32768),et=te?new Uint16Array(32768):mt(32768),Ur=te?new Uint16Array(128):mt(128),hs=1,tt=1;function fs(v,C){var N=Ne(v,C)+257;C+=5;var j=Ne(v,C)+1;C+=5;var k=De(v,C)+4;C+=4;for(var R=0,G=te?new Uint8Array(19):mt(19),Z=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],W=1,X=te?new Uint8Array(8):mt(8),K=te?new Uint8Array(8):mt(8),se=G.length,oe=0;oe<k;++oe)G[y[oe]]=R=he(v,C),W<R&&(W=R),X[R]++,C+=3;var me=0;for(X[0]=0,oe=1;oe<=W;++oe)K[oe]=me=me+X[oe-1]<<1;for(oe=0;oe<se;++oe)(me=G[oe])!=0&&(Z[oe]=K[me]++);var ne=0;for(oe=0;oe<se;++oe)if(ne=G[oe],ne!=0){me=re[Z[oe]]>>8-ne;for(var fe=(1<<7-ne)-1;fe>=0;--fe)Ur[me|fe<<ne]=ne&7|oe<<3}var we=[];for(W=1;we.length<N+j;)switch(me=Ur[de(v,C)],C+=me&7,me>>>=3){case 16:for(R=3+pe(v,C),C+=2,me=we[we.length-1];R-- >0;)we.push(me);break;case 17:for(R=3+he(v,C),C+=3;R-- >0;)we.push(0);break;case 18:for(R=11+de(v,C),C+=7;R-- >0;)we.push(0);break;default:we.push(me),W<me&&(W=me);break}var $e=we.slice(0,N),He=we.slice(N);for(oe=N;oe<286;++oe)$e[oe]=0;for(oe=j;oe<30;++oe)He[oe]=0;return hs=Y($e,Ge,286),tt=Y(He,et,30),C}function Ks(v,C){if(v[0]==3&&!(v[1]&3))return[Fr(C),2];for(var N=0,j=0,k=yi(C||1<<18),R=0,G=k.length>>>0,Z=0,W=0;!(j&1);){if(j=he(v,N),N+=3,j>>>1)j>>1==1?(Z=9,W=5):(N=fs(v,N),Z=hs,W=tt);else{N&7&&(N+=8-(N&7));var X=v[N>>>3]|v[(N>>>3)+1]<<8;if(N+=32,X>0)for(!C&&G<R+X&&(k=Sr(k,R+X),G=k.length);X-- >0;)k[R++]=v[N>>>3],N+=8;continue}for(;;){!C&&G<R+32767&&(k=Sr(k,R+32767),G=k.length);var K=je(v,N,Z),se=j>>>1==1?ye[K]:Ge[K];if(N+=se&15,se>>>=4,!(se>>>8&255))k[R++]=se;else{if(se==256)break;se-=257;var oe=se<8?0:se-4>>2;oe>5&&(oe=0);var me=R+z[se];oe>0&&(me+=je(v,N,oe),N+=oe),K=je(v,N,W),se=j>>>1==1?Fe[K]:et[K],N+=se&15,se>>>=4;var ne=se<4?0:se-2>>1,fe=B[se];for(ne>0&&(fe+=je(v,N,ne),N+=ne),!C&&G<me&&(k=Sr(k,me+100),G=k.length);R<me;)k[R]=k[R-fe],++R}}}return C?[k,N+7>>>3]:[k.slice(0,R),N+7>>>3]}function Ae(v,C){var N=v.slice(v.l||0),j=Ks(N,C);return v.l+=j[1],j[0]}function Ye(v,C){if(v)typeof console<"u"&&console.error(C);else throw new Error(C)}function Zt(v,C){var N=v;Ct(N,0);var j=[],k=[],R={FileIndex:j,FullPaths:k};E(R,{root:C.root});for(var G=N.length-4;(N[G]!=80||N[G+1]!=75||N[G+2]!=5||N[G+3]!=6)&&G>=0;)--G;N.l=G+4,N.l+=4;var Z=N.read_shift(2);N.l+=6;var W=N.read_shift(4);for(N.l=W,G=0;G<Z;++G){N.l+=20;var X=N.read_shift(4),K=N.read_shift(4),se=N.read_shift(2),oe=N.read_shift(2),me=N.read_shift(2);N.l+=8;var ne=N.read_shift(4),fe=l(N.slice(N.l+se,N.l+se+oe));N.l+=se+oe+me;var we=N.l;N.l=ne+4,pt(N,X,K,R,fe),N.l=we}return R}function pt(v,C,N,j,k){v.l+=2;var R=v.read_shift(2),G=v.read_shift(2),Z=o(v);if(R&8257)throw new Error("Unsupported ZIP encryption");for(var W=v.read_shift(4),X=v.read_shift(4),K=v.read_shift(4),se=v.read_shift(2),oe=v.read_shift(2),me="",ne=0;ne<se;++ne)me+=String.fromCharCode(v[v.l++]);if(oe){var fe=l(v.slice(v.l,v.l+oe));(fe[21589]||{}).mt&&(Z=fe[21589].mt),((k||{})[21589]||{}).mt&&(Z=k[21589].mt)}v.l+=oe;var we=v.slice(v.l,v.l+X);switch(G){case 8:we=I(v,K);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+G)}var $e=!1;R&8&&(W=v.read_shift(4),W==134695760&&(W=v.read_shift(4),$e=!0),X=v.read_shift(4),K=v.read_shift(4)),X!=C&&Ye($e,"Bad compressed size: "+C+" != "+X),K!=N&&Ye($e,"Bad uncompressed size: "+N+" != "+K),qn(j,me,we,{unsafe:!0,mt:Z})}function It(v,C){var N=C||{},j=[],k=[],R=q(1),G=N.compression?8:0,Z=0,W=0,X=0,K=0,se=0,oe=v.FullPaths[0],me=oe,ne=v.FileIndex[0],fe=[],we=0;for(W=1;W<v.FullPaths.length;++W)if(me=v.FullPaths[W].slice(oe.length),ne=v.FileIndex[W],!(!ne.size||!ne.content||me=="Sh33tJ5")){var $e=K,He=q(me.length);for(X=0;X<me.length;++X)He.write_shift(1,me.charCodeAt(X)&127);He=He.slice(0,He.l),fe[se]=ph.buf(ne.content,0);var ft=ne.content;G==8&&(ft=D(ft)),R=q(30),R.write_shift(4,67324752),R.write_shift(2,20),R.write_shift(2,Z),R.write_shift(2,G),ne.mt?i(R,ne.mt):R.write_shift(4,0),R.write_shift(-4,fe[se]),R.write_shift(4,ft.length),R.write_shift(4,ne.content.length),R.write_shift(2,He.length),R.write_shift(2,0),K+=R.length,j.push(R),K+=He.length,j.push(He),K+=ft.length,j.push(ft),R=q(46),R.write_shift(4,33639248),R.write_shift(2,0),R.write_shift(2,20),R.write_shift(2,Z),R.write_shift(2,G),R.write_shift(4,0),R.write_shift(-4,fe[se]),R.write_shift(4,ft.length),R.write_shift(4,ne.content.length),R.write_shift(2,He.length),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(4,0),R.write_shift(4,$e),we+=R.l,k.push(R),we+=He.length,k.push(He),++se}return R=q(22),R.write_shift(4,101010256),R.write_shift(2,0),R.write_shift(2,0),R.write_shift(2,se),R.write_shift(2,se),R.write_shift(4,we),R.write_shift(4,K),R.write_shift(2,0),ot([ot(j),ot(k),R])}var Xt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function dr(v,C){if(v.ctype)return v.ctype;var N=v.name||"",j=N.match(/\.([^\.]+)$/);return j&&Xt[j[1]]||C&&(j=(N=C).match(/[\.\\]([^\.\\])+$/),j&&Xt[j[1]])?Xt[j[1]]:"application/octet-stream"}function jc(v){for(var C=Rs(v),N=[],j=0;j<C.length;j+=76)N.push(C.slice(j,j+76));return N.join(`\r
`)+`\r
`}function Ec(v){var C=v.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(X){var K=X.charCodeAt(0).toString(16).toUpperCase();return"="+(K.length==1?"0"+K:K)});C=C.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),C.charAt(0)==`
`&&(C="=0D"+C.slice(1)),C=C.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var N=[],j=C.split(`\r
`),k=0;k<j.length;++k){var R=j[k];if(R.length==0){N.push("");continue}for(var G=0;G<R.length;){var Z=76,W=R.slice(G,G+Z);W.charAt(Z-1)=="="?Z--:W.charAt(Z-2)=="="?Z-=2:W.charAt(Z-3)=="="&&(Z-=3),W=R.slice(G,G+Z),G+=Z,G<R.length&&(W+="="),N.push(W)}}return N.join(`\r
`)}function Tc(v){for(var C=[],N=0;N<v.length;++N){for(var j=v[N];N<=v.length&&j.charAt(j.length-1)=="=";)j=j.slice(0,j.length-1)+v[++N];C.push(j)}for(var k=0;k<C.length;++k)C[k]=C[k].replace(/[=][0-9A-Fa-f]{2}/g,function(R){return String.fromCharCode(parseInt(R.slice(1),16))});return Ht(C.join(`\r
`))}function Cc(v,C,N){for(var j="",k="",R="",G,Z=0;Z<10;++Z){var W=C[Z];if(!W||W.match(/^\s*$/))break;var X=W.match(/^(.*?):\s*([^\s].*)$/);if(X)switch(X[1].toLowerCase()){case"content-location":j=X[2].trim();break;case"content-type":R=X[2].trim();break;case"content-transfer-encoding":k=X[2].trim();break}}switch(++Z,k.toLowerCase()){case"base64":G=Ht(or(C.slice(Z).join("")));break;case"quoted-printable":G=Tc(C.slice(Z));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+k)}var K=qn(v,j.slice(N.length),G,{unsafe:!0});R&&(K.ctype=R)}function kc(v,C){if(le(v.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var N=C&&C.root||"",j=(Re&&Buffer.isBuffer(v)?v.toString("binary"):le(v)).split(`\r
`),k=0,R="";for(k=0;k<j.length;++k)if(R=j[k],!!/^Content-Location:/i.test(R)&&(R=R.slice(R.indexOf("file")),N||(N=R.slice(0,R.lastIndexOf("/")+1)),R.slice(0,N.length)!=N))for(;N.length>0&&(N=N.slice(0,N.length-1),N=N.slice(0,N.lastIndexOf("/")+1),R.slice(0,N.length)!=N););var G=(j[1]||"").match(/boundary="(.*?)"/);if(!G)throw new Error("MAD cannot find boundary");var Z="--"+(G[1]||""),W=[],X=[],K={FileIndex:W,FullPaths:X};E(K);var se,oe=0;for(k=0;k<j.length;++k){var me=j[k];me!==Z&&me!==Z+"--"||(oe++&&Cc(K,j.slice(se,k),N),se=k)}return K}function Ac(v,C){var N=C||{},j=N.boundary||"SheetJS";j="------="+j;for(var k=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+j.slice(2)+'"',"","",""],R=v.FullPaths[0],G=R,Z=v.FileIndex[0],W=1;W<v.FullPaths.length;++W)if(G=v.FullPaths[W].slice(R.length),Z=v.FileIndex[W],!(!Z.size||!Z.content||G=="Sh33tJ5")){G=G.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(we){return"_x"+we.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(we){return"_u"+we.charCodeAt(0).toString(16)+"_"});for(var X=Z.content,K=Re&&Buffer.isBuffer(X)?X.toString("binary"):le(X),se=0,oe=Math.min(1024,K.length),me=0,ne=0;ne<=oe;++ne)(me=K.charCodeAt(ne))>=32&&me<128&&++se;var fe=se>=oe*4/5;k.push(j),k.push("Content-Location: "+(N.root||"file:///C:/SheetJS/")+G),k.push("Content-Transfer-Encoding: "+(fe?"quoted-printable":"base64")),k.push("Content-Type: "+dr(Z,G)),k.push(""),k.push(fe?Ec(K):jc(K))}return k.push(j+`--\r
`),k.join(`\r
`)}function Rc(v){var C={};return E(C,v),C}function qn(v,C,N,j){var k=j&&j.unsafe;k||E(v);var R=!k&&Me.find(v,C);if(!R){var G=v.FullPaths[0];C.slice(0,G.length)==G?G=C:(G.slice(-1)!="/"&&(G+="/"),G=(G+C).replace("//","/")),R={name:a(C),type:2},v.FileIndex.push(R),v.FullPaths.push(G),k||Me.utils.cfb_gc(v)}return R.content=N,R.size=N?N.length:0,j&&(j.CLSID&&(R.clsid=j.CLSID),j.mt&&(R.mt=j.mt),j.ct&&(R.ct=j.ct)),R}function Fc(v,C){E(v);var N=Me.find(v,C);if(N){for(var j=0;j<v.FileIndex.length;++j)if(v.FileIndex[j]==N)return v.FileIndex.splice(j,1),v.FullPaths.splice(j,1),!0}return!1}function Dc(v,C,N){E(v);var j=Me.find(v,C);if(j){for(var k=0;k<v.FileIndex.length;++k)if(v.FileIndex[k]==j)return v.FileIndex[k].name=a(N),v.FullPaths[k]=N,!0}return!1}function Oc(v){F(v,!0)}return r.find=U,r.read=L,r.parse=d,r.write=ue,r.writeFile=Te,r.utils={cfb_new:Rc,cfb_add:qn,cfb_del:Fc,cfb_mov:Dc,cfb_gc:Oc,ReadShift:Ss,CheckField:sl,prep_blob:Ct,bconcat:ot,use_zlib:S,_deflateRaw:Mt,_inflateRaw:Ae,consts:be},r}();function gh(t){return typeof t=="string"?Bn(t):Array.isArray(t)?Hd(t):t}function Us(t,r,e){if(typeof Deno<"u"){if(e&&typeof r=="string")switch(e){case"utf8":r=new TextEncoder(e).encode(r);break;case"binary":r=Bn(r);break;default:throw new Error("Unsupported encoding "+e)}return Deno.writeFileSync(t,r)}var s=e=="utf8"?Ds(r):r;if(typeof IE_SaveFile<"u")return IE_SaveFile(s,t);if(typeof Blob<"u"){var a=new Blob([gh(s)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(a,t);if(typeof saveAs<"u")return saveAs(a,t);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var i=URL.createObjectURL(a);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),chrome.downloads.download({url:i,filename:t,saveAs:!0});var o=document.createElement("a");if(o.download!=null)return o.download=t,o.href=i,document.body.appendChild(o),o.click(),document.body.removeChild(o),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(i)},6e4),i}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var l=File(t);return l.open("w"),l.encoding="binary",Array.isArray(r)&&(r=zs(r)),l.write(r),l.close(),r}catch(c){if(!c.message||!c.message.match(/onstruct/))throw c}throw new Error("cannot save file "+t)}function dt(t){for(var r=Object.keys(t),e=[],s=0;s<r.length;++s)Object.prototype.hasOwnProperty.call(t,r[s])&&e.push(r[s]);return e}function Ti(t,r){for(var e=[],s=dt(t),a=0;a!==s.length;++a)e[t[s[a]][r]]==null&&(e[t[s[a]][r]]=s[a]);return e}function Ma(t){for(var r=[],e=dt(t),s=0;s!==e.length;++s)r[t[e[s]]]=e[s];return r}function Un(t){for(var r=[],e=dt(t),s=0;s!==e.length;++s)r[t[e[s]]]=parseInt(e[s],10);return r}function vh(t){for(var r=[],e=dt(t),s=0;s!==e.length;++s)r[t[e[s]]]==null&&(r[t[e[s]]]=[]),r[t[e[s]]].push(e[s]);return r}var yn=new Date(1899,11,30,0,0,0);function jt(t,r){var e=t.getTime(),s=yn.getTime()+(t.getTimezoneOffset()-yn.getTimezoneOffset())*6e4;return(e-s)/(24*60*60*1e3)}var zo=new Date,yh=yn.getTime()+(zo.getTimezoneOffset()-yn.getTimezoneOffset())*6e4,Ci=zo.getTimezoneOffset();function Uo(t){var r=new Date;return r.setTime(t*24*60*60*1e3+yh),r.getTimezoneOffset()!==Ci&&r.setTime(r.getTime()+(r.getTimezoneOffset()-Ci)*6e4),r}var ki=new Date("2017-02-19T19:06:09.000Z"),$o=isNaN(ki.getFullYear())?new Date("2/19/17"):ki,bh=$o.getFullYear()==2017;function wt(t,r){var e=new Date(t);if(bh)return r>0?e.setTime(e.getTime()+e.getTimezoneOffset()*60*1e3):r<0&&e.setTime(e.getTime()-e.getTimezoneOffset()*60*1e3),e;if(t instanceof Date)return t;if($o.getFullYear()==1917&&!isNaN(e.getFullYear())){var s=e.getFullYear();return t.indexOf(""+s)>-1||e.setFullYear(e.getFullYear()+100),e}var a=t.match(/\d+/g)||["2017","2","19","0","0","0"],i=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return t.indexOf("Z")>-1&&(i=new Date(i.getTime()-i.getTimezoneOffset()*60*1e3)),i}function $n(t,r){if(Re&&Buffer.isBuffer(t))return t.toString("binary");if(typeof TextDecoder<"u")try{var e={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(t)&&(t=new Uint8Array(t)),new TextDecoder("latin1").decode(t).replace(/[]/g,function(i){return e[i]||i})}catch{}for(var s=[],a=0;a!=t.length;++a)s.push(String.fromCharCode(t[a]));return s.join("")}function Et(t){if(typeof JSON<"u"&&!Array.isArray(t))return JSON.parse(JSON.stringify(t));if(typeof t!="object"||t==null)return t;if(t instanceof Date)return new Date(t.getTime());var r={};for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(r[e]=Et(t[e]));return r}function Xe(t,r){for(var e="";e.length<r;)e+=t;return e}function ar(t){var r=Number(t);if(!isNaN(r))return isFinite(r)?r:NaN;if(!/\d/.test(t))return r;var e=1,s=t.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return e*=100,""});return!isNaN(r=Number(s))||(s=s.replace(/[(](.*)[)]/,function(a,i){return e=-e,i}),!isNaN(r=Number(s)))?r/e:r}var wh=["january","february","march","april","may","june","july","august","september","october","november","december"];function Fs(t){var r=new Date(t),e=new Date(NaN),s=r.getYear(),a=r.getMonth(),i=r.getDate();if(isNaN(i))return e;var o=t.toLowerCase();if(o.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(o=o.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),o.length>3&&wh.indexOf(o)==-1)return e}else if(o.match(/[a-z]/))return e;return s<0||s>8099?e:(a>0||i>1)&&s!=101?r:t.match(/[^-0-9:,\/\\]/)?e:r}function Se(t,r,e){if(t.FullPaths){if(typeof e=="string"){var s;return Re?s=cr(e):s=Wd(e),Me.utils.cfb_add(t,r,s)}Me.utils.cfb_add(t,r,e)}else t.file(r,e)}function za(){return Me.utils.cfb_new()}var Qe=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,_h={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Ua=Ma(_h),$a=/[&<>'"]/g,Sh=/[\u0000-\u0008\u000b-\u001f]/g;function Pe(t){var r=t+"";return r.replace($a,function(e){return Ua[e]}).replace(Sh,function(e){return"_x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+"_"})}function Ai(t){return Pe(t).replace(/ /g,"_x0020_")}var Ho=/[\u0000-\u001f]/g;function Nh(t){var r=t+"";return r.replace($a,function(e){return Ua[e]}).replace(/\n/g,"<br/>").replace(Ho,function(e){return"&#x"+("000"+e.charCodeAt(0).toString(16)).slice(-4)+";"})}function jh(t){var r=t+"";return r.replace($a,function(e){return Ua[e]}).replace(Ho,function(e){return"&#x"+e.charCodeAt(0).toString(16).toUpperCase()+";"})}function Eh(t){return t.replace(/(\r\n|[\r\n])/g,"&#10;")}function Th(t){switch(t){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function sa(t){for(var r="",e=0,s=0,a=0,i=0,o=0,l=0;e<t.length;){if(s=t.charCodeAt(e++),s<128){r+=String.fromCharCode(s);continue}if(a=t.charCodeAt(e++),s>191&&s<224){o=(s&31)<<6,o|=a&63,r+=String.fromCharCode(o);continue}if(i=t.charCodeAt(e++),s<240){r+=String.fromCharCode((s&15)<<12|(a&63)<<6|i&63);continue}o=t.charCodeAt(e++),l=((s&7)<<18|(a&63)<<12|(i&63)<<6|o&63)-65536,r+=String.fromCharCode(55296+(l>>>10&1023)),r+=String.fromCharCode(56320+(l&1023))}return r}function Ri(t){var r=Fr(2*t.length),e,s,a=1,i=0,o=0,l;for(s=0;s<t.length;s+=a)a=1,(l=t.charCodeAt(s))<128?e=l:l<224?(e=(l&31)*64+(t.charCodeAt(s+1)&63),a=2):l<240?(e=(l&15)*4096+(t.charCodeAt(s+1)&63)*64+(t.charCodeAt(s+2)&63),a=3):(a=4,e=(l&7)*262144+(t.charCodeAt(s+1)&63)*4096+(t.charCodeAt(s+2)&63)*64+(t.charCodeAt(s+3)&63),e-=65536,o=55296+(e>>>10&1023),e=56320+(e&1023)),o!==0&&(r[i++]=o&255,r[i++]=o>>>8,o=0),r[i++]=e%256,r[i++]=e>>>8;return r.slice(0,i).toString("ucs2")}function Fi(t){return cr(t,"binary").toString("utf8")}var en="foo bar baz",_s=Re&&(Fi(en)==sa(en)&&Fi||Ri(en)==sa(en)&&Ri)||sa,Ds=Re?function(t){return cr(t,"utf8").toString("binary")}:function(t){for(var r=[],e=0,s=0,a=0;e<t.length;)switch(s=t.charCodeAt(e++),!0){case s<128:r.push(String.fromCharCode(s));break;case s<2048:r.push(String.fromCharCode(192+(s>>6))),r.push(String.fromCharCode(128+(s&63)));break;case(s>=55296&&s<57344):s-=55296,a=t.charCodeAt(e++)-56320+(s<<10),r.push(String.fromCharCode(240+(a>>18&7))),r.push(String.fromCharCode(144+(a>>12&63))),r.push(String.fromCharCode(128+(a>>6&63))),r.push(String.fromCharCode(128+(a&63)));break;default:r.push(String.fromCharCode(224+(s>>12))),r.push(String.fromCharCode(128+(s>>6&63))),r.push(String.fromCharCode(128+(s&63)))}return r.join("")},Ch=function(){var t=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(r){return[new RegExp("&"+r[0]+";","ig"),r[1]]});return function(e){for(var s=e.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<t.length;++a)s=s.replace(t[a][0],t[a][1]);return s}}(),Wo=/(^\s|\s$|\n)/;function lt(t,r){return"<"+t+(r.match(Wo)?' xml:space="preserve"':"")+">"+r+"</"+t+">"}function Os(t){return dt(t).map(function(r){return" "+r+'="'+t[r]+'"'}).join("")}function ae(t,r,e){return"<"+t+(e!=null?Os(e):"")+(r!=null?(r.match(Wo)?' xml:space="preserve"':"")+">"+r+"</"+t:"/")+">"}function Na(t,r){try{return t.toISOString().replace(/\.\d*/,"")}catch(e){if(r)throw e}return""}function kh(t,r){switch(typeof t){case"string":var e=ae("vt:lpwstr",Pe(t));return e=e.replace(/&quot;/g,"_x0022_"),e;case"number":return ae((t|0)==t?"vt:i4":"vt:r8",Pe(String(t)));case"boolean":return ae("vt:bool",t?"true":"false")}if(t instanceof Date)return ae("vt:filetime",Na(t));throw new Error("Unable to serialize "+t)}var rt={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},os=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],kt={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function Ah(t,r){for(var e=1-2*(t[r+7]>>>7),s=((t[r+7]&127)<<4)+(t[r+6]>>>4&15),a=t[r+6]&15,i=5;i>=0;--i)a=a*256+t[r+i];return s==2047?a==0?e*(1/0):NaN:(s==0?s=-1022:(s-=1023,a+=Math.pow(2,52)),e*Math.pow(2,s-52)*a)}function Rh(t,r,e){var s=(r<0||1/r==-1/0?1:0)<<7,a=0,i=0,o=s?-r:r;isFinite(o)?o==0?a=i=0:(a=Math.floor(Math.log(o)/Math.LN2),i=o*Math.pow(2,52-a),a<=-1023&&(!isFinite(i)||i<Math.pow(2,52))?a=-1022:(i-=Math.pow(2,52),a+=1023)):(a=2047,i=isNaN(r)?26985:0);for(var l=0;l<=5;++l,i/=256)t[e+l]=i&255;t[e+6]=(a&15)<<4|i&15,t[e+7]=a>>4|s}var Di=function(t){for(var r=[],e=10240,s=0;s<t[0].length;++s)if(t[0][s])for(var a=0,i=t[0][s].length;a<i;a+=e)r.push.apply(r,t[0][s].slice(a,a+e));return r},Oi=Re?function(t){return t[0].length>0&&Buffer.isBuffer(t[0][0])?Buffer.concat(t[0].map(function(r){return Buffer.isBuffer(r)?r:cr(r)})):Di(t)}:Di,Ii=function(t,r,e){for(var s=[],a=r;a<e;a+=2)s.push(String.fromCharCode(ys(t,a)));return s.join("").replace(ws,"")},Ha=Re?function(t,r,e){return Buffer.isBuffer(t)?t.toString("utf16le",r,e).replace(ws,""):Ii(t,r,e)}:Ii,Pi=function(t,r,e){for(var s=[],a=r;a<r+e;++a)s.push(("0"+t[a].toString(16)).slice(-2));return s.join("")},Go=Re?function(t,r,e){return Buffer.isBuffer(t)?t.toString("hex",r,r+e):Pi(t,r,e)}:Pi,Li=function(t,r,e){for(var s=[],a=r;a<e;a++)s.push(String.fromCharCode(Xr(t,a)));return s.join("")},$s=Re?function(r,e,s){return Buffer.isBuffer(r)?r.toString("utf8",e,s):Li(r,e,s)}:Li,Vo=function(t,r){var e=At(t,r);return e>0?$s(t,r+4,r+4+e-1):""},Xo=Vo,Ko=function(t,r){var e=At(t,r);return e>0?$s(t,r+4,r+4+e-1):""},Yo=Ko,qo=function(t,r){var e=2*At(t,r);return e>0?$s(t,r+4,r+4+e-1):""},Jo=qo,Qo=function(r,e){var s=At(r,e);return s>0?Ha(r,e+4,e+4+s):""},Zo=Qo,el=function(t,r){var e=At(t,r);return e>0?$s(t,r+4,r+4+e):""},tl=el,rl=function(t,r){return Ah(t,r)},bn=rl,Wa=function(r){return Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array};Re&&(Xo=function(r,e){if(!Buffer.isBuffer(r))return Vo(r,e);var s=r.readUInt32LE(e);return s>0?r.toString("utf8",e+4,e+4+s-1):""},Yo=function(r,e){if(!Buffer.isBuffer(r))return Ko(r,e);var s=r.readUInt32LE(e);return s>0?r.toString("utf8",e+4,e+4+s-1):""},Jo=function(r,e){if(!Buffer.isBuffer(r))return qo(r,e);var s=2*r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+s-1)},Zo=function(r,e){if(!Buffer.isBuffer(r))return Qo(r,e);var s=r.readUInt32LE(e);return r.toString("utf16le",e+4,e+4+s)},tl=function(r,e){if(!Buffer.isBuffer(r))return el(r,e);var s=r.readUInt32LE(e);return r.toString("utf8",e+4,e+4+s)},bn=function(r,e){return Buffer.isBuffer(r)?r.readDoubleLE(e):rl(r,e)},Wa=function(r){return Buffer.isBuffer(r)||Array.isArray(r)||typeof Uint8Array<"u"&&r instanceof Uint8Array});var Xr=function(t,r){return t[r]},ys=function(t,r){return t[r+1]*256+t[r]},Fh=function(t,r){var e=t[r+1]*256+t[r];return e<32768?e:(65535-e+1)*-1},At=function(t,r){return t[r+3]*(1<<24)+(t[r+2]<<16)+(t[r+1]<<8)+t[r]},kr=function(t,r){return t[r+3]<<24|t[r+2]<<16|t[r+1]<<8|t[r]},Dh=function(t,r){return t[r]<<24|t[r+1]<<16|t[r+2]<<8|t[r+3]};function Ss(t,r){var e="",s,a,i=[],o,l,c,h;switch(r){case"dbcs":if(h=this.l,Re&&Buffer.isBuffer(this))e=this.slice(this.l,this.l+2*t).toString("utf16le");else for(c=0;c<t;++c)e+=String.fromCharCode(ys(this,h)),h+=2;t*=2;break;case"utf8":e=$s(this,this.l,this.l+t);break;case"utf16le":t*=2,e=Ha(this,this.l,this.l+t);break;case"wstr":return Ss.call(this,t,"dbcs");case"lpstr-ansi":e=Xo(this,this.l),t=4+At(this,this.l);break;case"lpstr-cp":e=Yo(this,this.l),t=4+At(this,this.l);break;case"lpwstr":e=Jo(this,this.l),t=4+2*At(this,this.l);break;case"lpp4":t=4+At(this,this.l),e=Zo(this,this.l),t&2&&(t+=2);break;case"8lpp4":t=4+At(this,this.l),e=tl(this,this.l),t&3&&(t+=4-(t&3));break;case"cstr":for(t=0,e="";(o=Xr(this,this.l+t++))!==0;)i.push(Js(o));e=i.join("");break;case"_wstr":for(t=0,e="";(o=ys(this,this.l+t))!==0;)i.push(Js(o)),t+=2;t+=2,e=i.join("");break;case"dbcs-cont":for(e="",h=this.l,c=0;c<t;++c){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Xr(this,h),this.l=h+1,l=Ss.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Js(ys(this,h))),h+=2}e=i.join(""),t*=2;break;case"cpstr":case"sbcs-cont":for(e="",h=this.l,c=0;c!=t;++c){if(this.lens&&this.lens.indexOf(h)!==-1)return o=Xr(this,h),this.l=h+1,l=Ss.call(this,t-c,o?"dbcs-cont":"sbcs-cont"),i.join("")+l;i.push(Js(Xr(this,h))),h+=1}e=i.join("");break;default:switch(t){case 1:return s=Xr(this,this.l),this.l++,s;case 2:return s=(r==="i"?Fh:ys)(this,this.l),this.l+=2,s;case 4:case-4:return r==="i"||!(this[this.l+3]&128)?(s=(t>0?kr:Dh)(this,this.l),this.l+=4,s):(a=At(this,this.l),this.l+=4,a);case 8:case-8:if(r==="f")return t==8?a=bn(this,this.l):a=bn([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;t=8;case 16:e=Go(this,this.l,t);break}}return this.l+=t,e}var Oh=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255,t[e+2]=r>>>16&255,t[e+3]=r>>>24&255},Ih=function(t,r,e){t[e]=r&255,t[e+1]=r>>8&255,t[e+2]=r>>16&255,t[e+3]=r>>24&255},Ph=function(t,r,e){t[e]=r&255,t[e+1]=r>>>8&255};function Lh(t,r,e){var s=0,a=0;if(e==="dbcs"){for(a=0;a!=r.length;++a)Ph(this,r.charCodeAt(a),this.l+2*a);s=2*r.length}else if(e==="sbcs"){for(r=r.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=r.length;++a)this[this.l+a]=r.charCodeAt(a)&255;s=r.length}else if(e==="hex"){for(;a<t;++a)this[this.l++]=parseInt(r.slice(2*a,2*a+2),16)||0;return this}else if(e==="utf16le"){var i=Math.min(this.l+t,this.length);for(a=0;a<Math.min(r.length,t);++a){var o=r.charCodeAt(a);this[this.l++]=o&255,this[this.l++]=o>>8}for(;this.l<i;)this[this.l++]=0;return this}else switch(t){case 1:s=1,this[this.l]=r&255;break;case 2:s=2,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255;break;case 3:s=3,this[this.l]=r&255,r>>>=8,this[this.l+1]=r&255,r>>>=8,this[this.l+2]=r&255;break;case 4:s=4,Oh(this,r,this.l);break;case 8:if(s=8,e==="f"){Rh(this,r,this.l);break}case 16:break;case-4:s=4,Ih(this,r,this.l);break}return this.l+=s,this}function sl(t,r){var e=Go(this,this.l,t.length>>1);if(e!==t)throw new Error(r+"Expected "+t+" saw "+e);this.l+=t.length>>1}function Ct(t,r){t.l=r,t.read_shift=Ss,t.chk=sl,t.write_shift=Lh}function Jt(t,r){t.l+=r}function q(t){var r=Fr(t);return Ct(r,0),r}function Nt(){var t=[],r=Re?256:2048,e=function(h){var d=q(h);return Ct(d,0),d},s=e(r),a=function(){s&&(s.length>s.l&&(s=s.slice(0,s.l),s.l=s.length),s.length>0&&t.push(s),s=null)},i=function(h){return s&&h<s.length-s.l?s:(a(),s=e(Math.max(h+1,r)))},o=function(){return a(),ot(t)},l=function(h){a(),s=h,s.l==null&&(s.l=s.length),i(r)};return{next:i,push:l,end:o,_bufs:t}}function ee(t,r,e,s){var a=+r,i;if(!isNaN(a)){s||(s=Rg[a].p||(e||[]).length||0),i=1+(a>=128?1:0)+1,s>=128&&++i,s>=16384&&++i,s>=2097152&&++i;var o=t.next(i);a<=127?o.write_shift(1,a):(o.write_shift(1,(a&127)+128),o.write_shift(1,a>>7));for(var l=0;l!=4;++l)if(s>=128)o.write_shift(1,(s&127)+128),s>>=7;else{o.write_shift(1,s);break}s>0&&Wa(e)&&t.push(e)}}function Ns(t,r,e){var s=Et(t);if(r.s?(s.cRel&&(s.c+=r.s.c),s.rRel&&(s.r+=r.s.r)):(s.cRel&&(s.c+=r.c),s.rRel&&(s.r+=r.r)),!e||e.biff<12){for(;s.c>=256;)s.c-=256;for(;s.r>=65536;)s.r-=65536}return s}function Bi(t,r,e){var s=Et(t);return s.s=Ns(s.s,r.s,e),s.e=Ns(s.e,r.s,e),s}function js(t,r){if(t.cRel&&t.c<0)for(t=Et(t);t.c<0;)t.c+=r>8?16384:256;if(t.rRel&&t.r<0)for(t=Et(t);t.r<0;)t.r+=r>8?1048576:r>5?65536:16384;var e=Le(t);return!t.cRel&&t.cRel!=null&&(e=zh(e)),!t.rRel&&t.rRel!=null&&(e=Bh(e)),e}function na(t,r){return t.s.r==0&&!t.s.rRel&&t.e.r==(r.biff>=12?1048575:r.biff>=8?65536:16384)&&!t.e.rRel?(t.s.cRel?"":"$")+ut(t.s.c)+":"+(t.e.cRel?"":"$")+ut(t.e.c):t.s.c==0&&!t.s.cRel&&t.e.c==(r.biff>=12?16383:255)&&!t.e.cRel?(t.s.rRel?"":"$")+ct(t.s.r)+":"+(t.e.rRel?"":"$")+ct(t.e.r):js(t.s,r.biff)+":"+js(t.e,r.biff)}function Ga(t){return parseInt(Mh(t),10)-1}function ct(t){return""+(t+1)}function Bh(t){return t.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Mh(t){return t.replace(/\$(\d+)$/,"$1")}function Va(t){for(var r=Uh(t),e=0,s=0;s!==r.length;++s)e=26*e+r.charCodeAt(s)-64;return e-1}function ut(t){if(t<0)throw new Error("invalid column "+t);var r="";for(++t;t;t=Math.floor((t-1)/26))r=String.fromCharCode((t-1)%26+65)+r;return r}function zh(t){return t.replace(/^([A-Z])/,"$$$1")}function Uh(t){return t.replace(/^\$([A-Z])/,"$1")}function $h(t){return t.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function st(t){for(var r=0,e=0,s=0;s<t.length;++s){var a=t.charCodeAt(s);a>=48&&a<=57?r=10*r+(a-48):a>=65&&a<=90&&(e=26*e+(a-64))}return{c:e-1,r:r-1}}function Le(t){for(var r=t.c+1,e="";r;r=(r-1)/26|0)e=String.fromCharCode((r-1)%26+65)+e;return e+(t.r+1)}function Rt(t){var r=t.indexOf(":");return r==-1?{s:st(t),e:st(t)}:{s:st(t.slice(0,r)),e:st(t.slice(r+1))}}function Je(t,r){return typeof r>"u"||typeof r=="number"?Je(t.s,t.e):(typeof t!="string"&&(t=Le(t)),typeof r!="string"&&(r=Le(r)),t==r?t:t+":"+r)}function Ue(t){var r={s:{c:0,r:0},e:{c:0,r:0}},e=0,s=0,a=0,i=t.length;for(e=0;s<i&&!((a=t.charCodeAt(s)-64)<1||a>26);++s)e=26*e+a;for(r.s.c=--e,e=0;s<i&&!((a=t.charCodeAt(s)-48)<0||a>9);++s)e=10*e+a;if(r.s.r=--e,s===i||a!=10)return r.e.c=r.s.c,r.e.r=r.s.r,r;for(++s,e=0;s!=i&&!((a=t.charCodeAt(s)-64)<1||a>26);++s)e=26*e+a;for(r.e.c=--e,e=0;s!=i&&!((a=t.charCodeAt(s)-48)<0||a>9);++s)e=10*e+a;return r.e.r=--e,r}function Mi(t,r){var e=t.t=="d"&&r instanceof Date;if(t.z!=null)try{return t.w=pr(t.z,e?jt(r):r)}catch{}try{return t.w=pr((t.XF||{}).numFmtId||(e?14:0),e?jt(r):r)}catch{return""+r}}function lr(t,r,e){return t==null||t.t==null||t.t=="z"?"":t.w!==void 0?t.w:(t.t=="d"&&!t.z&&e&&e.dateNF&&(t.z=e.dateNF),t.t=="e"?Hs[t.v]||t.v:r==null?Mi(t,t.v):Mi(t,r))}function Pr(t,r){var e=r&&r.sheet?r.sheet:"Sheet1",s={};return s[e]=t,{SheetNames:[e],Sheets:s}}function nl(t,r,e){var s=e||{},a=t?Array.isArray(t):s.dense,i=t||(a?[]:{}),o=0,l=0;if(i&&s.origin!=null){if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?st(s.origin):s.origin;o=c.r,l=c.c}i["!ref"]||(i["!ref"]="A1:A1")}var h={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(i["!ref"]){var d=Ue(i["!ref"]);h.s.c=d.s.c,h.s.r=d.s.r,h.e.c=Math.max(h.e.c,d.e.c),h.e.r=Math.max(h.e.r,d.e.r),o==-1&&(h.e.r=o=d.e.r+1)}for(var f=0;f!=r.length;++f)if(r[f]){if(!Array.isArray(r[f]))throw new Error("aoa_to_sheet expects an array of arrays");for(var u=0;u!=r[f].length;++u)if(!(typeof r[f][u]>"u")){var m={v:r[f][u]},p=o+f,x=l+u;if(h.s.r>p&&(h.s.r=p),h.s.c>x&&(h.s.c=x),h.e.r<p&&(h.e.r=p),h.e.c<x&&(h.e.c=x),r[f][u]&&typeof r[f][u]=="object"&&!Array.isArray(r[f][u])&&!(r[f][u]instanceof Date))m=r[f][u];else if(Array.isArray(m.v)&&(m.f=r[f][u][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(s.nullError)m.t="e",m.v=0;else if(s.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=s.dateNF||Ke[14],s.cellDates?(m.t="d",m.w=pr(m.z,jt(m.v))):(m.t="n",m.v=jt(m.v),m.w=pr(m.z,m.v))):m.t="s";if(a)i[p]||(i[p]=[]),i[p][x]&&i[p][x].z&&(m.z=i[p][x].z),i[p][x]=m;else{var g=Le({c:x,r:p});i[g]&&i[g].z&&(m.z=i[g].z),i[g]=m}}}return h.s.c<1e7&&(i["!ref"]=Je(h)),i}function ls(t,r){return nl(null,t,r)}function Hh(t){return t.read_shift(4,"i")}function Gt(t,r){return r||(r=q(4)),r.write_shift(4,t),r}function xt(t){var r=t.read_shift(4);return r===0?"":t.read_shift(r,"dbcs")}function nt(t,r){var e=!1;return r==null&&(e=!0,r=q(4+2*t.length)),r.write_shift(4,t.length),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}function Wh(t){return{ich:t.read_shift(2),ifnt:t.read_shift(2)}}function Gh(t,r){return r||(r=q(4)),r.write_shift(2,0),r.write_shift(2,0),r}function Xa(t,r){var e=t.l,s=t.read_shift(1),a=xt(t),i=[],o={t:a,h:a};if(s&1){for(var l=t.read_shift(4),c=0;c!=l;++c)i.push(Wh(t));o.r=i}else o.r=[{ich:0,ifnt:0}];return t.l=e+r,o}function Vh(t,r){var e=!1;return r==null&&(e=!0,r=q(15+4*t.t.length)),r.write_shift(1,0),nt(t.t,r),e?r.slice(0,r.l):r}var Xh=Xa;function Kh(t,r){var e=!1;return r==null&&(e=!0,r=q(23+4*t.t.length)),r.write_shift(1,1),nt(t.t,r),r.write_shift(4,1),Gh({},r),e?r.slice(0,r.l):r}function Bt(t){var r=t.read_shift(4),e=t.read_shift(2);return e+=t.read_shift(1)<<16,t.l++,{c:r,iStyleRef:e}}function Lr(t,r){return r==null&&(r=q(8)),r.write_shift(-4,t.c),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}function Br(t){var r=t.read_shift(2);return r+=t.read_shift(1)<<16,t.l++,{c:-1,iStyleRef:r}}function Mr(t,r){return r==null&&(r=q(4)),r.write_shift(3,t.iStyleRef||t.s),r.write_shift(1,0),r}var Yh=xt,al=nt;function Ka(t){var r=t.read_shift(4);return r===0||r===4294967295?"":t.read_shift(r,"dbcs")}function wn(t,r){var e=!1;return r==null&&(e=!0,r=q(127)),r.write_shift(4,t.length>0?t.length:4294967295),t.length>0&&r.write_shift(0,t,"dbcs"),e?r.slice(0,r.l):r}var qh=xt,ja=Ka,Ya=wn;function il(t){var r=t.slice(t.l,t.l+4),e=r[0]&1,s=r[0]&2;t.l+=4;var a=s===0?bn([0,0,0,0,r[0]&252,r[1],r[2],r[3]],0):kr(r,0)>>2;return e?a/100:a}function ol(t,r){r==null&&(r=q(4));var e=0,s=0,a=t*100;if(t==(t|0)&&t>=-536870912&&t<1<<29?s=1:a==(a|0)&&a>=-536870912&&a<1<<29&&(s=1,e=1),s)r.write_shift(-4,((e?a:t)<<2)+(e+2));else throw new Error("unsupported RkNumber "+t)}function ll(t){var r={s:{},e:{}};return r.s.r=t.read_shift(4),r.e.r=t.read_shift(4),r.s.c=t.read_shift(4),r.e.c=t.read_shift(4),r}function Jh(t,r){return r||(r=q(16)),r.write_shift(4,t.s.r),r.write_shift(4,t.e.r),r.write_shift(4,t.s.c),r.write_shift(4,t.e.c),r}var zr=ll,cs=Jh;function ds(t){if(t.length-t.l<8)throw"XLS Xnum Buffer underflow";return t.read_shift(8,"f")}function Dr(t,r){return(r||q(8)).write_shift(8,t,"f")}function Qh(t){var r={},e=t.read_shift(1),s=e>>>1,a=t.read_shift(1),i=t.read_shift(2,"i"),o=t.read_shift(1),l=t.read_shift(1),c=t.read_shift(1);switch(t.l++,s){case 0:r.auto=1;break;case 1:r.index=a;var h=lf[a];h&&(r.rgb=qi(h));break;case 2:r.rgb=qi([o,l,c]);break;case 3:r.theme=a;break}return i!=0&&(r.tint=i>0?i/32767:i/32768),r}function _n(t,r){if(r||(r=q(8)),!t||t.auto)return r.write_shift(4,0),r.write_shift(4,0),r;t.index!=null?(r.write_shift(1,2),r.write_shift(1,t.index)):t.theme!=null?(r.write_shift(1,6),r.write_shift(1,t.theme)):(r.write_shift(1,5),r.write_shift(1,0));var e=t.tint||0;if(e>0?e*=32767:e<0&&(e*=32768),r.write_shift(2,e),!t.rgb||t.theme!=null)r.write_shift(2,0),r.write_shift(1,0),r.write_shift(1,0);else{var s=t.rgb||"FFFFFF";typeof s=="number"&&(s=("000000"+s.toString(16)).slice(-6)),r.write_shift(1,parseInt(s.slice(0,2),16)),r.write_shift(1,parseInt(s.slice(2,4),16)),r.write_shift(1,parseInt(s.slice(4,6),16)),r.write_shift(1,255)}return r}function Zh(t){var r=t.read_shift(1);t.l++;var e={fBold:r&1,fItalic:r&2,fUnderline:r&4,fStrikeout:r&8,fOutline:r&16,fShadow:r&32,fCondense:r&64,fExtend:r&128};return e}function ef(t,r){r||(r=q(2));var e=(t.italic?2:0)|(t.strike?8:0)|(t.outline?16:0)|(t.shadow?32:0)|(t.condense?64:0)|(t.extend?128:0);return r.write_shift(1,e),r.write_shift(1,0),r}var cl=2,Tt=3,tn=11,Sn=19,rn=64,tf=65,rf=71,sf=4108,nf=4126,it=80,zi={1:{n:"CodePage",t:cl},2:{n:"Category",t:it},3:{n:"PresentationFormat",t:it},4:{n:"ByteCount",t:Tt},5:{n:"LineCount",t:Tt},6:{n:"ParagraphCount",t:Tt},7:{n:"SlideCount",t:Tt},8:{n:"NoteCount",t:Tt},9:{n:"HiddenCount",t:Tt},10:{n:"MultimediaClipCount",t:Tt},11:{n:"ScaleCrop",t:tn},12:{n:"HeadingPairs",t:sf},13:{n:"TitlesOfParts",t:nf},14:{n:"Manager",t:it},15:{n:"Company",t:it},16:{n:"LinksUpToDate",t:tn},17:{n:"CharacterCount",t:Tt},19:{n:"SharedDoc",t:tn},22:{n:"HyperlinksChanged",t:tn},23:{n:"AppVersion",t:Tt,p:"version"},24:{n:"DigSig",t:tf},26:{n:"ContentType",t:it},27:{n:"ContentStatus",t:it},28:{n:"Language",t:it},29:{n:"Version",t:it},255:{},2147483648:{n:"Locale",t:Sn},2147483651:{n:"Behavior",t:Sn},1919054434:{}},Ui={1:{n:"CodePage",t:cl},2:{n:"Title",t:it},3:{n:"Subject",t:it},4:{n:"Author",t:it},5:{n:"Keywords",t:it},6:{n:"Comments",t:it},7:{n:"Template",t:it},8:{n:"LastAuthor",t:it},9:{n:"RevNumber",t:it},10:{n:"EditTime",t:rn},11:{n:"LastPrinted",t:rn},12:{n:"CreatedDate",t:rn},13:{n:"ModifiedDate",t:rn},14:{n:"PageCount",t:Tt},15:{n:"WordCount",t:Tt},16:{n:"CharCount",t:Tt},17:{n:"Thumbnail",t:rf},18:{n:"Application",t:it},19:{n:"DocSecurity",t:Tt},255:{},2147483648:{n:"Locale",t:Sn},2147483651:{n:"Behavior",t:Sn},1919054434:{}};function af(t){return t.map(function(r){return[r>>16&255,r>>8&255,r&255]})}var of=af([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),lf=Et(of),Hs={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},cf={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},sn={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function dl(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function hl(t,r){var e=vh(cf),s=[],a;s[s.length]=Qe,s[s.length]=ae("Types",null,{xmlns:rt.CT,"xmlns:xsd":rt.xsd,"xmlns:xsi":rt.xsi}),s=s.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(c){return ae("Default",null,{Extension:c[0],ContentType:c[1]})}));var i=function(c){t[c]&&t[c].length>0&&(a=t[c][0],s[s.length]=ae("Override",null,{PartName:(a[0]=="/"?"":"/")+a,ContentType:sn[c][r.bookType]||sn[c].xlsx}))},o=function(c){(t[c]||[]).forEach(function(h){s[s.length]=ae("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:sn[c][r.bookType]||sn[c].xlsx})})},l=function(c){(t[c]||[]).forEach(function(h){s[s.length]=ae("Override",null,{PartName:(h[0]=="/"?"":"/")+h,ContentType:e[c][0]})})};return i("workbooks"),o("sheets"),o("charts"),l("themes"),["strs","styles"].forEach(i),["coreprops","extprops","custprops"].forEach(l),l("vba"),l("comments"),l("threadedcomments"),l("drawings"),o("metadata"),l("people"),s.length>2&&(s[s.length]="</Types>",s[1]=s[1].replace("/>",">")),s.join("")}var Ce={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function fl(t){var r=t.lastIndexOf("/");return t.slice(0,r+1)+"_rels/"+t.slice(r+1)+".rels"}function qr(t){var r=[Qe,ae("Relationships",null,{xmlns:rt.RELS})];return dt(t["!id"]).forEach(function(e){r[r.length]=ae("Relationship",null,t["!id"][e])}),r.length>2&&(r[r.length]="</Relationships>",r[1]=r[1].replace("/>",">")),r.join("")}function Ie(t,r,e,s,a,i){if(a||(a={}),t["!id"]||(t["!id"]={}),t["!idx"]||(t["!idx"]=1),r<0)for(r=t["!idx"];t["!id"]["rId"+r];++r);if(t["!idx"]=r+1,a.Id="rId"+r,a.Type=s,a.Target=e,[Ce.HLINK,Ce.XPATH,Ce.XMISS].indexOf(a.Type)>-1&&(a.TargetMode="External"),t["!id"][a.Id])throw new Error("Cannot rewrite rId "+r);return t["!id"][a.Id]=a,t[("/"+a.Target).replace("//","/")]=a,r}function df(t){var r=[Qe];r.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),r.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var e=0;e<t.length;++e)r.push('  <manifest:file-entry manifest:full-path="'+t[e][0]+'" manifest:media-type="'+t[e][1]+`"/>
`);return r.push("</manifest:manifest>"),r.join("")}function $i(t,r,e){return['  <rdf:Description rdf:about="'+t+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(e||"odf")+"#"+r+`"/>
`,`  </rdf:Description>
`].join("")}function hf(t,r){return['  <rdf:Description rdf:about="'+t+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+r+`"/>
`,`  </rdf:Description>
`].join("")}function ff(t){var r=[Qe];r.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var e=0;e!=t.length;++e)r.push($i(t[e][0],t[e][1])),r.push(hf("",t[e][0]));return r.push($i("","Document","pkg")),r.push("</rdf:RDF>"),r.join("")}function ul(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+xn.version+"</meta:generator></office:meta></office:document-meta>"}var Ar=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function aa(t,r,e,s,a){a[t]!=null||r==null||r===""||(a[t]=r,r=Pe(r),s[s.length]=e?ae(t,r,e):lt(t,r))}function xl(t,r){var e=r||{},s=[Qe,ae("cp:coreProperties",null,{"xmlns:cp":rt.CORE_PROPS,"xmlns:dc":rt.dc,"xmlns:dcterms":rt.dcterms,"xmlns:dcmitype":rt.dcmitype,"xmlns:xsi":rt.xsi})],a={};if(!t&&!e.Props)return s.join("");t&&(t.CreatedDate!=null&&aa("dcterms:created",typeof t.CreatedDate=="string"?t.CreatedDate:Na(t.CreatedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a),t.ModifiedDate!=null&&aa("dcterms:modified",typeof t.ModifiedDate=="string"?t.ModifiedDate:Na(t.ModifiedDate,e.WTF),{"xsi:type":"dcterms:W3CDTF"},s,a));for(var i=0;i!=Ar.length;++i){var o=Ar[i],l=e.Props&&e.Props[o[1]]!=null?e.Props[o[1]]:t?t[o[1]]:null;l===!0?l="1":l===!1?l="0":typeof l=="number"&&(l=String(l)),l!=null&&aa(o[0],l,null,s,a)}return s.length>2&&(s[s.length]="</cp:coreProperties>",s[1]=s[1].replace("/>",">")),s.join("")}var Jr=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],ml=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function pl(t){var r=[],e=ae;return t||(t={}),t.Application="SheetJS",r[r.length]=Qe,r[r.length]=ae("Properties",null,{xmlns:rt.EXT_PROPS,"xmlns:vt":rt.vt}),Jr.forEach(function(s){if(t[s[1]]!==void 0){var a;switch(s[2]){case"string":a=Pe(String(t[s[1]]));break;case"bool":a=t[s[1]]?"true":"false";break}a!==void 0&&(r[r.length]=e(s[0],a))}}),r[r.length]=e("HeadingPairs",e("vt:vector",e("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+e("vt:variant",e("vt:i4",String(t.Worksheets))),{size:2,baseType:"variant"})),r[r.length]=e("TitlesOfParts",e("vt:vector",t.SheetNames.map(function(s){return"<vt:lpstr>"+Pe(s)+"</vt:lpstr>"}).join(""),{size:t.Worksheets,baseType:"lpstr"})),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}function gl(t){var r=[Qe,ae("Properties",null,{xmlns:rt.CUST_PROPS,"xmlns:vt":rt.vt})];if(!t)return r.join("");var e=1;return dt(t).forEach(function(a){++e,r[r.length]=ae("property",kh(t[a]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:e,name:Pe(a)})}),r.length>2&&(r[r.length]="</Properties>",r[1]=r[1].replace("/>",">")),r.join("")}var Hi={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function uf(t,r){var e=[];return dt(Hi).map(function(s){for(var a=0;a<Ar.length;++a)if(Ar[a][1]==s)return Ar[a];for(a=0;a<Jr.length;++a)if(Jr[a][1]==s)return Jr[a];throw s}).forEach(function(s){if(t[s[1]]!=null){var a=r&&r.Props&&r.Props[s[1]]!=null?r.Props[s[1]]:t[s[1]];switch(s[2]){case"date":a=new Date(a).toISOString().replace(/\.\d*Z/,"Z");break}typeof a=="number"?a=String(a):a===!0||a===!1?a=a?"1":"0":a instanceof Date&&(a=new Date(a).toISOString().replace(/\.\d*Z/,"")),e.push(lt(Hi[s[1]]||s[1],a))}}),ae("DocumentProperties",e.join(""),{xmlns:kt.o})}function xf(t,r){var e=["Worksheets","SheetNames"],s="CustomDocumentProperties",a=[];return t&&dt(t).forEach(function(i){if(Object.prototype.hasOwnProperty.call(t,i)){for(var o=0;o<Ar.length;++o)if(i==Ar[o][1])return;for(o=0;o<Jr.length;++o)if(i==Jr[o][1])return;for(o=0;o<e.length;++o)if(i==e[o])return;var l=t[i],c="string";typeof l=="number"?(c="float",l=String(l)):l===!0||l===!1?(c="boolean",l=l?"1":"0"):l=String(l),a.push(ae(Ai(i),l,{"dt:dt":c}))}}),r&&dt(r).forEach(function(i){if(Object.prototype.hasOwnProperty.call(r,i)&&!(t&&Object.prototype.hasOwnProperty.call(t,i))){var o=r[i],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o instanceof Date?(l="dateTime.tz",o=o.toISOString()):o=String(o),a.push(ae(Ai(i),o,{"dt:dt":l}))}}),"<"+s+' xmlns="'+kt.o+'">'+a.join("")+"</"+s+">"}function mf(t){var r=typeof t=="string"?new Date(Date.parse(t)):t,e=r.getTime()/1e3+11644473600,s=e%Math.pow(2,32),a=(e-s)/Math.pow(2,32);s*=1e7,a*=1e7;var i=s/Math.pow(2,32)|0;i>0&&(s=s%Math.pow(2,32),a+=i);var o=q(8);return o.write_shift(4,s),o.write_shift(4,a),o}function Wi(t,r){var e=q(4),s=q(4);switch(e.write_shift(4,t==80?31:t),t){case 3:s.write_shift(-4,r);break;case 5:s=q(8),s.write_shift(8,r,"f");break;case 11:s.write_shift(4,r?1:0);break;case 64:s=mf(r);break;case 31:case 80:for(s=q(4+2*(r.length+1)+(r.length%2?0:2)),s.write_shift(4,r.length+1),s.write_shift(0,r,"dbcs");s.l!=s.length;)s.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}return ot([e,s])}var vl=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function pf(t){switch(typeof t){case"boolean":return 11;case"number":return(t|0)==t?3:5;case"string":return 31;case"object":if(t instanceof Date)return 64;break}return-1}function Gi(t,r,e){var s=q(8),a=[],i=[],o=8,l=0,c=q(8),h=q(8);if(c.write_shift(4,2),c.write_shift(4,1200),h.write_shift(4,1),i.push(c),a.push(h),o+=8+c.length,!r){h=q(8),h.write_shift(4,0),a.unshift(h);var d=[q(4)];for(d[0].write_shift(4,t.length),l=0;l<t.length;++l){var f=t[l][0];for(c=q(8+2*(f.length+1)+(f.length%2?0:2)),c.write_shift(4,l+2),c.write_shift(4,f.length+1),c.write_shift(0,f,"dbcs");c.l!=c.length;)c.write_shift(1,0);d.push(c)}c=ot(d),i.unshift(c),o+=8+c.length}for(l=0;l<t.length;++l)if(!(r&&!r[t[l][0]])&&!(vl.indexOf(t[l][0])>-1||ml.indexOf(t[l][0])>-1)&&t[l][1]!=null){var u=t[l][1],m=0;if(r){m=+r[t[l][0]];var p=e[m];if(p.p=="version"&&typeof u=="string"){var x=u.split(".");u=(+x[0]<<16)+(+x[1]||0)}c=Wi(p.t,u)}else{var g=pf(u);g==-1&&(g=31,u=String(u)),c=Wi(g,u)}i.push(c),h=q(8),h.write_shift(4,r?m:2+l),a.push(h),o+=8+c.length}var T=8*(i.length+1);for(l=0;l<i.length;++l)a[l].write_shift(4,T),T+=i[l].length;return s.write_shift(4,o),s.write_shift(4,i.length),ot([s].concat(a).concat(i))}function Vi(t,r,e,s,a,i){var o=q(a?68:48),l=[o];o.write_shift(2,65534),o.write_shift(2,0),o.write_shift(4,842412599),o.write_shift(16,Me.utils.consts.HEADER_CLSID,"hex"),o.write_shift(4,a?2:1),o.write_shift(16,r,"hex"),o.write_shift(4,a?68:48);var c=Gi(t,e,s);if(l.push(c),a){var h=Gi(a,null,null);o.write_shift(16,i,"hex"),o.write_shift(4,68+c.length),l.push(h)}return ot(l)}function gf(t,r){r||(r=q(t));for(var e=0;e<t;++e)r.write_shift(1,0);return r}function vf(t,r){return t.read_shift(r)===1}function bt(t,r){return r||(r=q(2)),r.write_shift(2,+!!t),r}function yl(t){return t.read_shift(2,"u")}function Lt(t,r){return r||(r=q(2)),r.write_shift(2,t),r}function bl(t,r,e){return e||(e=q(2)),e.write_shift(1,r=="e"?+t:+!!t),e.write_shift(1,r=="e"?1:0),e}function wl(t,r,e){var s=t.read_shift(e&&e.biff>=12?2:1),a="sbcs-cont";if(e&&e.biff>=8,!e||e.biff==8){var i=t.read_shift(1);i&&(a="dbcs-cont")}else e.biff==12&&(a="wstr");e.biff>=2&&e.biff<=5&&(a="cpstr");var o=s?t.read_shift(s,a):"";return o}function yf(t){var r=t.t||"",e=q(3);e.write_shift(2,r.length),e.write_shift(1,1);var s=q(2*r.length);s.write_shift(2*r.length,r,"utf16le");var a=[e,s];return ot(a)}function bf(t,r,e){var s;if(e){if(e.biff>=2&&e.biff<=5)return t.read_shift(r,"cpstr");if(e.biff>=12)return t.read_shift(r,"dbcs-cont")}var a=t.read_shift(1);return a===0?s=t.read_shift(r,"sbcs-cont"):s=t.read_shift(r,"dbcs-cont"),s}function wf(t,r,e){var s=t.read_shift(e&&e.biff==2?1:2);return s===0?(t.l++,""):bf(t,s,e)}function _f(t,r,e){if(e.biff>5)return wf(t,r,e);var s=t.read_shift(1);return s===0?(t.l++,""):t.read_shift(s,e.biff<=4||!t.lens?"cpstr":"sbcs-cont")}function _l(t,r,e){return e||(e=q(3+2*t.length)),e.write_shift(2,t.length),e.write_shift(1,1),e.write_shift(31,t,"utf16le"),e}function Xi(t,r){r||(r=q(6+t.length*2)),r.write_shift(4,1+t.length);for(var e=0;e<t.length;++e)r.write_shift(2,t.charCodeAt(e));return r.write_shift(2,0),r}function Sf(t){var r=q(512),e=0,s=t.Target;s.slice(0,7)=="file://"&&(s=s.slice(7));var a=s.indexOf("#"),i=a>-1?31:23;switch(s.charAt(0)){case"#":i=28;break;case".":i&=-3;break}r.write_shift(4,2),r.write_shift(4,i);var o=[8,6815827,6619237,4849780,83];for(e=0;e<o.length;++e)r.write_shift(4,o[e]);if(i==28)s=s.slice(1),Xi(s,r);else if(i&2){for(o="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),e=0;e<o.length;++e)r.write_shift(1,parseInt(o[e],16));var l=a>-1?s.slice(0,a):s;for(r.write_shift(4,2*(l.length+1)),e=0;e<l.length;++e)r.write_shift(2,l.charCodeAt(e));r.write_shift(2,0),i&8&&Xi(a>-1?s.slice(a+1):"",r)}else{for(o="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),e=0;e<o.length;++e)r.write_shift(1,parseInt(o[e],16));for(var c=0;s.slice(c*3,c*3+3)=="../"||s.slice(c*3,c*3+3)=="..\\";)++c;for(r.write_shift(2,c),r.write_shift(4,s.length-3*c+1),e=0;e<s.length-3*c;++e)r.write_shift(1,s.charCodeAt(e+3*c)&255);for(r.write_shift(1,0),r.write_shift(2,65535),r.write_shift(2,57005),e=0;e<6;++e)r.write_shift(4,0)}return r.slice(0,r.l)}function Or(t,r,e,s){return s||(s=q(6)),s.write_shift(2,t),s.write_shift(2,r),s.write_shift(2,e||0),s}function Nf(t,r,e){var s=e.biff>8?4:2,a=t.read_shift(s),i=t.read_shift(s,"i"),o=t.read_shift(s,"i");return[a,i,o]}function jf(t){var r=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(2),a=t.read_shift(2);return{s:{c:s,r},e:{c:a,r:e}}}function Sl(t,r){return r||(r=q(8)),r.write_shift(2,t.s.r),r.write_shift(2,t.e.r),r.write_shift(2,t.s.c),r.write_shift(2,t.e.c),r}function qa(t,r,e){var s=1536,a=16;switch(e.bookType){case"biff8":break;case"biff5":s=1280,a=8;break;case"biff4":s=4,a=6;break;case"biff3":s=3,a=6;break;case"biff2":s=2,a=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var i=q(a);return i.write_shift(2,s),i.write_shift(2,r),a>4&&i.write_shift(2,29282),a>6&&i.write_shift(2,1997),a>8&&(i.write_shift(2,49161),i.write_shift(2,1),i.write_shift(2,1798),i.write_shift(2,0)),i}function Ef(t,r){var e=!r||r.biff==8,s=q(e?112:54);for(s.write_shift(r.biff==8?2:1,7),e&&s.write_shift(1,0),s.write_shift(4,859007059),s.write_shift(4,5458548|(e?0:536870912));s.l<s.length;)s.write_shift(1,e?0:32);return s}function Tf(t,r){var e=!r||r.biff>=8?2:1,s=q(8+e*t.name.length);s.write_shift(4,t.pos),s.write_shift(1,t.hs||0),s.write_shift(1,t.dt),s.write_shift(1,t.name.length),r.biff>=8&&s.write_shift(1,1),s.write_shift(e*t.name.length,t.name,r.biff<8?"sbcs":"utf16le");var a=s.slice(0,s.l);return a.l=s.l,a}function Cf(t,r){var e=q(8);e.write_shift(4,t.Count),e.write_shift(4,t.Unique);for(var s=[],a=0;a<t.length;++a)s[a]=yf(t[a]);var i=ot([e].concat(s));return i.parts=[e.length].concat(s.map(function(o){return o.length})),i}function kf(){var t=q(18);return t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,29280),t.write_shift(2,17600),t.write_shift(2,56),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,1),t.write_shift(2,500),t}function Af(t){var r=q(18),e=1718;return t&&t.RTL&&(e|=64),r.write_shift(2,e),r.write_shift(4,0),r.write_shift(4,64),r.write_shift(4,0),r.write_shift(4,0),r}function Rf(t,r){var e=t.name||"Arial",s=r&&r.biff==5,a=s?15+e.length:16+2*e.length,i=q(a);return i.write_shift(2,t.sz*20),i.write_shift(4,0),i.write_shift(2,400),i.write_shift(4,0),i.write_shift(2,0),i.write_shift(1,e.length),s||i.write_shift(1,1),i.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le"),i}function Ff(t,r,e,s){var a=q(10);return Or(t,r,s,a),a.write_shift(4,e),a}function Df(t,r,e,s,a){var i=!a||a.biff==8,o=q(8+ +i+(1+i)*e.length);return Or(t,r,s,o),o.write_shift(2,e.length),i&&o.write_shift(1,1),o.write_shift((1+i)*e.length,e,i?"utf16le":"sbcs"),o}function Of(t,r,e,s){var a=e&&e.biff==5;s||(s=q(a?3+r.length:5+2*r.length)),s.write_shift(2,t),s.write_shift(a?1:2,r.length),a||s.write_shift(1,1),s.write_shift((a?1:2)*r.length,r,a?"sbcs":"utf16le");var i=s.length>s.l?s.slice(0,s.l):s;return i.l==null&&(i.l=i.length),i}function If(t,r){var e=r.biff==8||!r.biff?4:2,s=q(2*e+6);return s.write_shift(e,t.s.r),s.write_shift(e,t.e.r+1),s.write_shift(2,t.s.c),s.write_shift(2,t.e.c+1),s.write_shift(2,0),s}function Ki(t,r,e,s){var a=e&&e.biff==5;s||(s=q(a?16:20)),s.write_shift(2,0),t.style?(s.write_shift(2,t.numFmtId||0),s.write_shift(2,65524)):(s.write_shift(2,t.numFmtId||0),s.write_shift(2,r<<4));var i=0;return t.numFmtId>0&&a&&(i|=1024),s.write_shift(4,i),s.write_shift(4,0),a||s.write_shift(4,0),s.write_shift(2,0),s}function Pf(t){var r=q(8);return r.write_shift(4,0),r.write_shift(2,0),r.write_shift(2,0),r}function Lf(t,r,e,s,a,i){var o=q(8);return Or(t,r,s,o),bl(e,i,o),o}function Bf(t,r,e,s){var a=q(14);return Or(t,r,s,a),Dr(e,a),a}function Mf(t,r,e){if(e.biff<8)return zf(t,r,e);for(var s=[],a=t.l+r,i=t.read_shift(e.biff>8?4:2);i--!==0;)s.push(Nf(t,e.biff>8?12:6,e));if(t.l!=a)throw new Error("Bad ExternSheet: "+t.l+" != "+a);return s}function zf(t,r,e){t[t.l+1]==3&&t[t.l]++;var s=wl(t,r,e);return s.charCodeAt(0)==3?s.slice(1):s}function Uf(t){var r=q(2+t.length*8);r.write_shift(2,t.length);for(var e=0;e<t.length;++e)Sl(t[e],r);return r}function $f(t){var r=q(24),e=st(t[0]);r.write_shift(2,e.r),r.write_shift(2,e.r),r.write_shift(2,e.c),r.write_shift(2,e.c);for(var s="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),a=0;a<16;++a)r.write_shift(1,parseInt(s[a],16));return ot([r,Sf(t[1])])}function Hf(t){var r=t[1].Tooltip,e=q(10+2*(r.length+1));e.write_shift(2,2048);var s=st(t[0]);e.write_shift(2,s.r),e.write_shift(2,s.r),e.write_shift(2,s.c),e.write_shift(2,s.c);for(var a=0;a<r.length;++a)e.write_shift(2,r.charCodeAt(a));return e.write_shift(2,0),e}function Wf(t){return t||(t=q(4)),t.write_shift(2,1),t.write_shift(2,1),t}function Gf(t,r,e){if(!e.cellStyles)return Jt(t,r);var s=e&&e.biff>=12?4:2,a=t.read_shift(s),i=t.read_shift(s),o=t.read_shift(s),l=t.read_shift(s),c=t.read_shift(2);s==2&&(t.l+=2);var h={s:a,e:i,w:o,ixfe:l,flags:c};return(e.biff>=5||!e.biff)&&(h.level=c>>8&7),h}function Vf(t,r){var e=q(12);e.write_shift(2,r),e.write_shift(2,r),e.write_shift(2,t.width*256),e.write_shift(2,0);var s=0;return t.hidden&&(s|=1),e.write_shift(1,s),s=t.level||0,e.write_shift(1,s),e.write_shift(2,0),e}function Xf(t){for(var r=q(2*t),e=0;e<t;++e)r.write_shift(2,e+1);return r}function Kf(t,r,e){var s=q(15);return Gs(s,t,r),s.write_shift(8,e,"f"),s}function Yf(t,r,e){var s=q(9);return Gs(s,t,r),s.write_shift(2,e),s}var qf=function(){var t={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},r=Ma({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function e(l,c){var h=[],d=Fr(1);switch(c.type){case"base64":d=Ht(or(l));break;case"binary":d=Ht(l);break;case"buffer":case"array":d=l;break}Ct(d,0);var f=d.read_shift(1),u=!!(f&136),m=!1,p=!1;switch(f){case 2:break;case 3:break;case 48:m=!0,u=!0;break;case 49:m=!0,u=!0;break;case 131:break;case 139:break;case 140:p=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+f.toString(16))}var x=0,g=521;f==2&&(x=d.read_shift(2)),d.l+=3,f!=2&&(x=d.read_shift(4)),x>1048576&&(x=1e6),f!=2&&(g=d.read_shift(2));var T=d.read_shift(2),b=c.codepage||1252;f!=2&&(d.l+=16,d.read_shift(1),d[d.l]!==0&&(b=t[d[d.l]]),d.l+=1,d.l+=2),p&&(d.l+=36);for(var w=[],A={},_=Math.min(d.length,f==2?521:g-10-(m?264:0)),L=p?32:11;d.l<_&&d[d.l]!=13;)switch(A={},A.name=mn.utils.decode(b,d.slice(d.l,d.l+L)).replace(/[\u0000\r\n].*$/g,""),d.l+=L,A.type=String.fromCharCode(d.read_shift(1)),f!=2&&!p&&(A.offset=d.read_shift(4)),A.len=d.read_shift(1),f==2&&(A.offset=d.read_shift(2)),A.dec=d.read_shift(1),A.name.length&&w.push(A),f!=2&&(d.l+=p?13:14),A.type){case"B":(!m||A.len!=8)&&c.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"G":case"P":c.WTF&&console.log("Skipping "+A.name+":"+A.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+A.type)}if(d[d.l]!==13&&(d.l=g-1),d.read_shift(1)!==13)throw new Error("DBF Terminator not found "+d.l+" "+d[d.l]);d.l=g;var E=0,O=0;for(h[0]=[],O=0;O!=w.length;++O)h[0][O]=w[O].name;for(;x-- >0;){if(d[d.l]===42){d.l+=T;continue}for(++d.l,h[++E]=[],O=0,O=0;O!=w.length;++O){var F=d.slice(d.l,d.l+w[O].len);d.l+=w[O].len,Ct(F,0);var M=mn.utils.decode(b,F);switch(w[O].type){case"C":M.trim().length&&(h[E][O]=M.replace(/\s+$/,""));break;case"D":M.length===8?h[E][O]=new Date(+M.slice(0,4),+M.slice(4,6)-1,+M.slice(6,8)):h[E][O]=M;break;case"F":h[E][O]=parseFloat(M.trim());break;case"+":case"I":h[E][O]=p?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(M.trim().toUpperCase()){case"Y":case"T":h[E][O]=!0;break;case"N":case"F":h[E][O]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+M+"|")}break;case"M":if(!u)throw new Error("DBF Unexpected MEMO for type "+f.toString(16));h[E][O]="##MEMO##"+(p?parseInt(M.trim(),10):F.read_shift(4));break;case"N":M=M.replace(/\u0000/g,"").trim(),M&&M!="."&&(h[E][O]=+M||0);break;case"@":h[E][O]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":h[E][O]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":h[E][O]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":h[E][O]=-F.read_shift(-8,"f");break;case"B":if(m&&w[O].len==8){h[E][O]=F.read_shift(8,"f");break}case"G":case"P":F.l+=w[O].len;break;case"0":if(w[O].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+w[O].type)}}}if(f!=2&&d.l<d.length&&d[d.l++]!=26)throw new Error("DBF EOF Marker missing "+(d.l-1)+" of "+d.length+" "+d[d.l-1].toString(16));return c&&c.sheetRows&&(h=h.slice(0,c.sheetRows)),c.DBF=w,h}function s(l,c){var h=c||{};h.dateNF||(h.dateNF="yyyymmdd");var d=ls(e(l,h),h);return d["!cols"]=h.DBF.map(function(f){return{wch:f.len,DBF:f}}),delete h.DBF,d}function a(l,c){try{return Pr(s(l,c),c)}catch(h){if(c&&c.WTF)throw h}return{SheetNames:[],Sheets:{}}}var i={B:8,C:250,L:1,D:8,"?":0,"":0};function o(l,c){var h=c||{};if(+h.codepage>=0&&As(+h.codepage),h.type=="string")throw new Error("Cannot write DBF to JS string");var d=Nt(),f=Cn(l,{header:1,raw:!0,cellDates:!0}),u=f[0],m=f.slice(1),p=l["!cols"]||[],x=0,g=0,T=0,b=1;for(x=0;x<u.length;++x){if(((p[x]||{}).DBF||{}).name){u[x]=p[x].DBF.name,++T;continue}if(u[x]!=null){if(++T,typeof u[x]=="number"&&(u[x]=u[x].toString(10)),typeof u[x]!="string")throw new Error("DBF Invalid column name "+u[x]+" |"+typeof u[x]+"|");if(u.indexOf(u[x])!==x){for(g=0;g<1024;++g)if(u.indexOf(u[x]+"_"+g)==-1){u[x]+="_"+g;break}}}}var w=Ue(l["!ref"]),A=[],_=[],L=[];for(x=0;x<=w.e.c-w.s.c;++x){var E="",O="",F=0,M=[];for(g=0;g<m.length;++g)m[g][x]!=null&&M.push(m[g][x]);if(M.length==0||u[x]==null){A[x]="?";continue}for(g=0;g<M.length;++g){switch(typeof M[g]){case"number":O="B";break;case"string":O="C";break;case"boolean":O="L";break;case"object":O=M[g]instanceof Date?"D":"C";break;default:O="C"}F=Math.max(F,String(M[g]).length),E=E&&E!=O?"C":O}F>250&&(F=250),O=((p[x]||{}).DBF||{}).type,O=="C"&&p[x].DBF.len>F&&(F=p[x].DBF.len),E=="B"&&O=="N"&&(E="N",L[x]=p[x].DBF.dec,F=p[x].DBF.len),_[x]=E=="C"||O=="N"?F:i[E]||0,b+=_[x],A[x]=E}var U=d.next(32);for(U.write_shift(4,318902576),U.write_shift(4,m.length),U.write_shift(2,296+32*T),U.write_shift(2,b),x=0;x<4;++x)U.write_shift(4,0);for(U.write_shift(4,0|(+r[jo]||3)<<8),x=0,g=0;x<u.length;++x)if(u[x]!=null){var H=d.next(32),J=(u[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);H.write_shift(1,J,"sbcs"),H.write_shift(1,A[x]=="?"?"C":A[x],"sbcs"),H.write_shift(4,g),H.write_shift(1,_[x]||i[A[x]]||0),H.write_shift(1,L[x]||0),H.write_shift(1,2),H.write_shift(4,0),H.write_shift(1,0),H.write_shift(4,0),H.write_shift(4,0),g+=_[x]||i[A[x]]||0}var ge=d.next(264);for(ge.write_shift(4,13),x=0;x<65;++x)ge.write_shift(4,0);for(x=0;x<m.length;++x){var xe=d.next(b);for(xe.write_shift(1,0),g=0;g<u.length;++g)if(u[g]!=null)switch(A[g]){case"L":xe.write_shift(1,m[x][g]==null?63:m[x][g]?84:70);break;case"B":xe.write_shift(8,m[x][g]||0,"f");break;case"N":var Ee="0";for(typeof m[x][g]=="number"&&(Ee=m[x][g].toFixed(L[g]||0)),T=0;T<_[g]-Ee.length;++T)xe.write_shift(1,32);xe.write_shift(1,Ee,"sbcs");break;case"D":m[x][g]?(xe.write_shift(4,("0000"+m[x][g].getFullYear()).slice(-4),"sbcs"),xe.write_shift(2,("00"+(m[x][g].getMonth()+1)).slice(-2),"sbcs"),xe.write_shift(2,("00"+m[x][g].getDate()).slice(-2),"sbcs")):xe.write_shift(8,"00000000","sbcs");break;case"C":var be=String(m[x][g]!=null?m[x][g]:"").slice(0,_[g]);for(xe.write_shift(1,be,"sbcs"),T=0;T<_[g]-be.length;++T)xe.write_shift(1,32);break}}return d.next(1).write_shift(1,26),d.end()}return{to_workbook:a,to_sheet:s,from_sheet:o}}(),Jf=function(){var t={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},r=new RegExp("\x1BN("+dt(t).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),e=function(u,m){var p=t[m];return typeof p=="number"?vi(p):p},s=function(u,m,p){var x=m.charCodeAt(0)-32<<4|p.charCodeAt(0)-48;return x==59?u:vi(x)};t["|"]=254;function a(u,m){switch(m.type){case"base64":return i(or(u),m);case"binary":return i(u,m);case"buffer":return i(Re&&Buffer.isBuffer(u)?u.toString("binary"):zs(u),m);case"array":return i($n(u),m)}throw new Error("Unrecognized type "+m.type)}function i(u,m){var p=u.split(/[\n\r]+/),x=-1,g=-1,T=0,b=0,w=[],A=[],_=null,L={},E=[],O=[],F=[],M=0,U;for(+m.codepage>=0&&As(+m.codepage);T!==p.length;++T){M=0;var H=p[T].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,s).replace(r,e),J=H.replace(/;;/g,"\0").split(";").map(function(y){return y.replace(/\u0000/g,";")}),ge=J[0],xe;if(H.length>0)switch(ge){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":J[1].charAt(0)=="P"&&A.push(H.slice(3).replace(/;;/g,";"));break;case"C":var Ee=!1,be=!1,Te=!1,le=!1,ue=-1,_e=-1;for(b=1;b<J.length;++b)switch(J[b].charAt(0)){case"A":break;case"X":g=parseInt(J[b].slice(1))-1,be=!0;break;case"Y":for(x=parseInt(J[b].slice(1))-1,be||(g=0),U=w.length;U<=x;++U)w[U]=[];break;case"K":xe=J[b].slice(1),xe.charAt(0)==='"'?xe=xe.slice(1,xe.length-1):xe==="TRUE"?xe=!0:xe==="FALSE"?xe=!1:isNaN(ar(xe))?isNaN(Fs(xe).getDate())||(xe=wt(xe)):(xe=ar(xe),_!==null&&Lo(_)&&(xe=Uo(xe))),Ee=!0;break;case"E":le=!0;var S=Yu(J[b].slice(1),{r:x,c:g});w[x][g]=[w[x][g],S];break;case"S":Te=!0,w[x][g]=[w[x][g],"S5S"];break;case"G":break;case"R":ue=parseInt(J[b].slice(1))-1;break;case"C":_e=parseInt(J[b].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+H)}if(Ee&&(w[x][g]&&w[x][g].length==2?w[x][g][0]=xe:w[x][g]=xe,_=null),Te){if(le)throw new Error("SYLK shared formula cannot have own formula");var I=ue>-1&&w[ue][_e];if(!I||!I[1])throw new Error("SYLK shared formula cannot find base");w[x][g][1]=qu(I[1],{r:x-ue,c:g-_e})}break;case"F":var D=0;for(b=1;b<J.length;++b)switch(J[b].charAt(0)){case"X":g=parseInt(J[b].slice(1))-1,++D;break;case"Y":for(x=parseInt(J[b].slice(1))-1,U=w.length;U<=x;++U)w[U]=[];break;case"M":M=parseInt(J[b].slice(1))/20;break;case"F":break;case"G":break;case"P":_=A[parseInt(J[b].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=J[b].slice(1).split(" "),U=parseInt(F[0],10);U<=parseInt(F[1],10);++U)M=parseInt(F[2],10),O[U-1]=M===0?{hidden:!0}:{wch:M},Ja(O[U-1]);break;case"C":g=parseInt(J[b].slice(1))-1,O[g]||(O[g]={});break;case"R":x=parseInt(J[b].slice(1))-1,E[x]||(E[x]={}),M>0?(E[x].hpt=M,E[x].hpx=Cl(M)):M===0&&(E[x].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+H)}D<1&&(_=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+H)}}return E.length>0&&(L["!rows"]=E),O.length>0&&(L["!cols"]=O),m&&m.sheetRows&&(w=w.slice(0,m.sheetRows)),[w,L]}function o(u,m){var p=a(u,m),x=p[0],g=p[1],T=ls(x,m);return dt(g).forEach(function(b){T[b]=g[b]}),T}function l(u,m){return Pr(o(u,m),m)}function c(u,m,p,x){var g="C;Y"+(p+1)+";X"+(x+1)+";K";switch(u.t){case"n":g+=u.v||0,u.f&&!u.F&&(g+=";E"+Za(u.f,{r:p,c:x}));break;case"b":g+=u.v?"TRUE":"FALSE";break;case"e":g+=u.w||u.v;break;case"d":g+='"'+(u.w||u.v)+'"';break;case"s":g+='"'+u.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return g}function h(u,m){m.forEach(function(p,x){var g="F;W"+(x+1)+" "+(x+1)+" ";p.hidden?g+="0":(typeof p.width=="number"&&!p.wpx&&(p.wpx=Nn(p.width)),typeof p.wpx=="number"&&!p.wch&&(p.wch=jn(p.wpx)),typeof p.wch=="number"&&(g+=Math.round(p.wch))),g.charAt(g.length-1)!=" "&&u.push(g)})}function d(u,m){m.forEach(function(p,x){var g="F;";p.hidden?g+="M0;":p.hpt?g+="M"+20*p.hpt+";":p.hpx&&(g+="M"+20*En(p.hpx)+";"),g.length>2&&u.push(g+"R"+(x+1))})}function f(u,m){var p=["ID;PWXL;N;E"],x=[],g=Ue(u["!ref"]),T,b=Array.isArray(u),w=`\r
`;p.push("P;PGeneral"),p.push("F;P0;DG0G8;M255"),u["!cols"]&&h(p,u["!cols"]),u["!rows"]&&d(p,u["!rows"]),p.push("B;Y"+(g.e.r-g.s.r+1)+";X"+(g.e.c-g.s.c+1)+";D"+[g.s.c,g.s.r,g.e.c,g.e.r].join(" "));for(var A=g.s.r;A<=g.e.r;++A)for(var _=g.s.c;_<=g.e.c;++_){var L=Le({r:A,c:_});T=b?(u[A]||[])[_]:u[L],!(!T||T.v==null&&(!T.f||T.F))&&x.push(c(T,u,A,_))}return p.join(w)+w+x.join(w)+w+"E"+w}return{to_workbook:l,to_sheet:o,from_sheet:f}}(),Qf=function(){function t(i,o){switch(o.type){case"base64":return r(or(i),o);case"binary":return r(i,o);case"buffer":return r(Re&&Buffer.isBuffer(i)?i.toString("binary"):zs(i),o);case"array":return r($n(i),o)}throw new Error("Unrecognized type "+o.type)}function r(i,o){for(var l=i.split(`
`),c=-1,h=-1,d=0,f=[];d!==l.length;++d){if(l[d].trim()==="BOT"){f[++c]=[],h=0;continue}if(!(c<0)){var u=l[d].trim().split(","),m=u[0],p=u[1];++d;for(var x=l[d]||"";(x.match(/["]/g)||[]).length&1&&d<l.length-1;)x+=`
`+l[++d];switch(x=x.trim(),+m){case-1:if(x==="BOT"){f[++c]=[],h=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?f[c][h]=!0:x==="FALSE"?f[c][h]=!1:isNaN(ar(p))?isNaN(Fs(p).getDate())?f[c][h]=p:f[c][h]=wt(p):f[c][h]=ar(p),++h;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),f[c][h++]=x!==""?x:null;break}if(x==="EOD")break}}return o&&o.sheetRows&&(f=f.slice(0,o.sheetRows)),f}function e(i,o){return ls(t(i,o),o)}function s(i,o){return Pr(e(i,o),o)}var a=function(){var i=function(c,h,d,f,u){c.push(h),c.push(d+","+f),c.push('"'+u.replace(/"/g,'""')+'"')},o=function(c,h,d,f){c.push(h+","+d),c.push(h==1?'"'+f.replace(/"/g,'""')+'"':f)};return function(c){var h=[],d=Ue(c["!ref"]),f,u=Array.isArray(c);i(h,"TABLE",0,1,"sheetjs"),i(h,"VECTORS",0,d.e.r-d.s.r+1,""),i(h,"TUPLES",0,d.e.c-d.s.c+1,""),i(h,"DATA",0,0,"");for(var m=d.s.r;m<=d.e.r;++m){o(h,-1,0,"BOT");for(var p=d.s.c;p<=d.e.c;++p){var x=Le({r:m,c:p});if(f=u?(c[m]||[])[p]:c[x],!f){o(h,1,0,"");continue}switch(f.t){case"n":var g=f.w;!g&&f.v!=null&&(g=f.v),g==null?f.f&&!f.F?o(h,1,0,"="+f.f):o(h,1,0,""):o(h,0,g,"V");break;case"b":o(h,0,f.v?1:0,f.v?"TRUE":"FALSE");break;case"s":o(h,1,0,isNaN(f.v)?f.v:'="'+f.v+'"');break;case"d":f.w||(f.w=pr(f.z||Ke[14],jt(wt(f.v)))),o(h,0,f.w,"V");break;default:o(h,1,0,"")}}}o(h,-1,0,"EOD");var T=`\r
`,b=h.join(T);return b}}();return{to_workbook:s,to_sheet:e,from_sheet:a}}(),Nl=function(){function t(f){return f.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function r(f){return f.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function e(f,u){for(var m=f.split(`
`),p=-1,x=-1,g=0,T=[];g!==m.length;++g){var b=m[g].trim().split(":");if(b[0]==="cell"){var w=st(b[1]);if(T.length<=w.r)for(p=T.length;p<=w.r;++p)T[p]||(T[p]=[]);switch(p=w.r,x=w.c,b[2]){case"t":T[p][x]=t(b[3]);break;case"v":T[p][x]=+b[3];break;case"vtf":var A=b[b.length-1];case"vtc":switch(b[3]){case"nl":T[p][x]=!!+b[4];break;default:T[p][x]=+b[4];break}b[2]=="vtf"&&(T[p][x]=[T[p][x],A])}}}return u&&u.sheetRows&&(T=T.slice(0,u.sheetRows)),T}function s(f,u){return ls(e(f,u),u)}function a(f,u){return Pr(s(f,u),u)}var i=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),o=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,l=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),c="--SocialCalcSpreadsheetControlSave--";function h(f){if(!f||!f["!ref"])return"";for(var u=[],m=[],p,x="",g=Rt(f["!ref"]),T=Array.isArray(f),b=g.s.r;b<=g.e.r;++b)for(var w=g.s.c;w<=g.e.c;++w)if(x=Le({r:b,c:w}),p=T?(f[b]||[])[w]:f[x],!(!p||p.v==null||p.t==="z")){switch(m=["cell",x,"t"],p.t){case"s":case"str":m.push(r(p.v));break;case"n":p.f?(m[2]="vtf",m[3]="n",m[4]=p.v,m[5]=r(p.f)):(m[2]="v",m[3]=p.v);break;case"b":m[2]="vt"+(p.f?"f":"c"),m[3]="nl",m[4]=p.v?"1":"0",m[5]=r(p.f||(p.v?"TRUE":"FALSE"));break;case"d":var A=jt(wt(p.v));m[2]="vtc",m[3]="nd",m[4]=""+A,m[5]=p.w||pr(p.z||Ke[14],A);break;case"e":continue}u.push(m.join(":"))}return u.push("sheet:c:"+(g.e.c-g.s.c+1)+":r:"+(g.e.r-g.s.r+1)+":tvf:1"),u.push("valueformat:1:text-wiki"),u.join(`
`)}function d(f){return[i,o,l,o,h(f),c].join(`
`)}return{to_workbook:a,to_sheet:s,from_sheet:d}}(),Zf=function(){function t(d,f,u,m,p){p.raw?f[u][m]=d:d===""||(d==="TRUE"?f[u][m]=!0:d==="FALSE"?f[u][m]=!1:isNaN(ar(d))?isNaN(Fs(d).getDate())?f[u][m]=d:f[u][m]=wt(d):f[u][m]=ar(d))}function r(d,f){var u=f||{},m=[];if(!d||d.length===0)return m;for(var p=d.split(/[\r\n]/),x=p.length-1;x>=0&&p[x].length===0;)--x;for(var g=10,T=0,b=0;b<=x;++b)T=p[b].indexOf(" "),T==-1?T=p[b].length:T++,g=Math.max(g,T);for(b=0;b<=x;++b){m[b]=[];var w=0;for(t(p[b].slice(0,g).trim(),m,b,w,u),w=1;w<=(p[b].length-g)/10+1;++w)t(p[b].slice(g+(w-1)*10,g+w*10).trim(),m,b,w,u)}return u.sheetRows&&(m=m.slice(0,u.sheetRows)),m}var e={44:",",9:"	",59:";",124:"|"},s={44:3,9:2,59:1,124:0};function a(d){for(var f={},u=!1,m=0,p=0;m<d.length;++m)(p=d.charCodeAt(m))==34?u=!u:!u&&p in e&&(f[p]=(f[p]||0)+1);p=[];for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m]);if(!p.length){f=s;for(m in f)Object.prototype.hasOwnProperty.call(f,m)&&p.push([f[m],m])}return p.sort(function(x,g){return x[0]-g[0]||s[x[1]]-s[g[1]]}),e[p.pop()[1]]||44}function i(d,f){var u=f||{},m="",p=u.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};d.slice(0,4)=="sep="?d.charCodeAt(5)==13&&d.charCodeAt(6)==10?(m=d.charAt(4),d=d.slice(7)):d.charCodeAt(5)==13||d.charCodeAt(5)==10?(m=d.charAt(4),d=d.slice(6)):m=a(d.slice(0,1024)):u&&u.FS?m=u.FS:m=a(d.slice(0,1024));var g=0,T=0,b=0,w=0,A=0,_=m.charCodeAt(0),L=!1,E=0,O=d.charCodeAt(0);d=d.replace(/\r\n/mg,`
`);var F=u.dateNF!=null?xh(u.dateNF):null;function M(){var U=d.slice(w,A),H={};if(U.charAt(0)=='"'&&U.charAt(U.length-1)=='"'&&(U=U.slice(1,-1).replace(/""/g,'"')),U.length===0)H.t="z";else if(u.raw)H.t="s",H.v=U;else if(U.trim().length===0)H.t="s",H.v=U;else if(U.charCodeAt(0)==61)U.charCodeAt(1)==34&&U.charCodeAt(U.length-1)==34?(H.t="s",H.v=U.slice(2,-1).replace(/""/g,'"')):Ju(U)?(H.t="n",H.f=U.slice(1)):(H.t="s",H.v=U);else if(U=="TRUE")H.t="b",H.v=!0;else if(U=="FALSE")H.t="b",H.v=!1;else if(!isNaN(b=ar(U)))H.t="n",u.cellText!==!1&&(H.w=U),H.v=b;else if(!isNaN(Fs(U).getDate())||F&&U.match(F)){H.z=u.dateNF||Ke[14];var J=0;F&&U.match(F)&&(U=mh(U,u.dateNF,U.match(F)||[]),J=1),u.cellDates?(H.t="d",H.v=wt(U,J)):(H.t="n",H.v=jt(wt(U,J))),u.cellText!==!1&&(H.w=pr(H.z,H.v instanceof Date?jt(H.v):H.v)),u.cellNF||delete H.z}else H.t="s",H.v=U;if(H.t=="z"||(u.dense?(p[g]||(p[g]=[]),p[g][T]=H):p[Le({c:T,r:g})]=H),w=A+1,O=d.charCodeAt(w),x.e.c<T&&(x.e.c=T),x.e.r<g&&(x.e.r=g),E==_)++T;else if(T=0,++g,u.sheetRows&&u.sheetRows<=g)return!0}e:for(;A<d.length;++A)switch(E=d.charCodeAt(A)){case 34:O===34&&(L=!L);break;case _:case 10:case 13:if(!L&&M())break e;break}return A-w>0&&M(),p["!ref"]=Je(x),p}function o(d,f){return!(f&&f.PRN)||f.FS||d.slice(0,4)=="sep="||d.indexOf("	")>=0||d.indexOf(",")>=0||d.indexOf(";")>=0?i(d,f):ls(r(d,f),f)}function l(d,f){var u="",m=f.type=="string"?[0,0,0,0]:h1(d,f);switch(f.type){case"base64":u=or(d);break;case"binary":u=d;break;case"buffer":f.codepage==65001?u=d.toString("utf8"):f.codepage&&typeof mn<"u"||(u=Re&&Buffer.isBuffer(d)?d.toString("binary"):zs(d));break;case"array":u=$n(d);break;case"string":u=d;break;default:throw new Error("Unrecognized type "+f.type)}return m[0]==239&&m[1]==187&&m[2]==191?u=_s(u.slice(3)):f.type!="string"&&f.type!="buffer"&&f.codepage==65001?u=_s(u):f.type=="binary"&&typeof mn<"u",u.slice(0,19)=="socialcalc:version:"?Nl.to_sheet(f.type=="string"?u:_s(u),f):o(u,f)}function c(d,f){return Pr(l(d,f),f)}function h(d){for(var f=[],u=Ue(d["!ref"]),m,p=Array.isArray(d),x=u.s.r;x<=u.e.r;++x){for(var g=[],T=u.s.c;T<=u.e.c;++T){var b=Le({r:x,c:T});if(m=p?(d[x]||[])[T]:d[b],!m||m.v==null){g.push("          ");continue}for(var w=(m.w||(lr(m),m.w)||"").slice(0,10);w.length<10;)w+=" ";g.push(w+(T===0?" ":""))}f.push(g.join(""))}return f.join(`
`)}return{to_workbook:c,to_sheet:l,from_sheet:h}}(),Yi=function(){function t(S,I,D){if(S){Ct(S,S.l||0);for(var y=D.Enum||ue;S.l<S.length;){var z=S.read_shift(2),B=y[z]||y[65535],Q=S.read_shift(2),te=S.l+Q,re=B.f&&B.f(S,Q,D);if(S.l=te,I(re,B,z))return}}}function r(S,I){switch(I.type){case"base64":return e(Ht(or(S)),I);case"binary":return e(Ht(S),I);case"buffer":case"array":return e(S,I)}throw"Unsupported type "+I.type}function e(S,I){if(!S)return S;var D=I||{},y=D.dense?[]:{},z="Sheet1",B="",Q=0,te={},re=[],ve=[],V={s:{r:0,c:0},e:{r:0,c:0}},pe=D.sheetRows||0;if(S[2]==0&&(S[3]==8||S[3]==9)&&S.length>=16&&S[14]==5&&S[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(S[2]==2)D.Enum=ue,t(S,function(de,je,ht){switch(ht){case 0:D.vers=de,de>=4096&&(D.qpro=!0);break;case 6:V=de;break;case 204:de&&(B=de);break;case 222:B=de;break;case 15:case 51:D.qpro||(de[1].v=de[1].v.slice(1));case 13:case 14:case 16:ht==14&&(de[2]&112)==112&&(de[2]&15)>1&&(de[2]&15)<15&&(de[1].z=D.dateNF||Ke[14],D.cellDates&&(de[1].t="d",de[1].v=Uo(de[1].v))),D.qpro&&de[3]>Q&&(y["!ref"]=Je(V),te[z]=y,re.push(z),y=D.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},Q=de[3],z=B||"Sheet"+(Q+1),B="");var _t=D.dense?(y[de[0].r]||[])[de[0].c]:y[Le(de[0])];if(_t){_t.t=de[1].t,_t.v=de[1].v,de[1].z!=null&&(_t.z=de[1].z),de[1].f!=null&&(_t.f=de[1].f);break}D.dense?(y[de[0].r]||(y[de[0].r]=[]),y[de[0].r][de[0].c]=de[1]):y[Le(de[0])]=de[1];break}},D);else if(S[2]==26||S[2]==14)D.Enum=_e,S[2]==14&&(D.qpro=!0,S.l=0),t(S,function(de,je,ht){switch(ht){case 204:z=de;break;case 22:de[1].v=de[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(de[3]>Q&&(y["!ref"]=Je(V),te[z]=y,re.push(z),y=D.dense?[]:{},V={s:{r:0,c:0},e:{r:0,c:0}},Q=de[3],z="Sheet"+(Q+1)),pe>0&&de[0].r>=pe)break;D.dense?(y[de[0].r]||(y[de[0].r]=[]),y[de[0].r][de[0].c]=de[1]):y[Le(de[0])]=de[1],V.e.c<de[0].c&&(V.e.c=de[0].c),V.e.r<de[0].r&&(V.e.r=de[0].r);break;case 27:de[14e3]&&(ve[de[14e3][0]]=de[14e3][1]);break;case 1537:ve[de[0]]=de[1],de[0]==Q&&(z=de[1]);break}},D);else throw new Error("Unrecognized LOTUS BOF "+S[2]);if(y["!ref"]=Je(V),te[B||z]=y,re.push(B||z),!ve.length)return{SheetNames:re,Sheets:te};for(var he={},De=[],Ne=0;Ne<ve.length;++Ne)te[re[Ne]]?(De.push(ve[Ne]||re[Ne]),he[ve[Ne]]=te[ve[Ne]]||te[re[Ne]]):(De.push(ve[Ne]),he[ve[Ne]]={"!ref":"A1"});return{SheetNames:De,Sheets:he}}function s(S,I){var D=I||{};if(+D.codepage>=0&&As(+D.codepage),D.type=="string")throw new Error("Cannot write WK1 to JS string");var y=Nt(),z=Ue(S["!ref"]),B=Array.isArray(S),Q=[];ie(y,0,i(1030)),ie(y,6,c(z));for(var te=Math.min(z.e.r,8191),re=z.s.r;re<=te;++re)for(var ve=ct(re),V=z.s.c;V<=z.e.c;++V){re===z.s.r&&(Q[V]=ut(V));var pe=Q[V]+ve,he=B?(S[re]||[])[V]:S[pe];if(!(!he||he.t=="z"))if(he.t=="n")(he.v|0)==he.v&&he.v>=-32768&&he.v<=32767?ie(y,13,m(re,V,he.v)):ie(y,14,x(re,V,he.v));else{var De=lr(he);ie(y,15,f(re,V,De.slice(0,239)))}}return ie(y,1),y.end()}function a(S,I){var D=I||{};if(+D.codepage>=0&&As(+D.codepage),D.type=="string")throw new Error("Cannot write WK3 to JS string");var y=Nt();ie(y,0,o(S));for(var z=0,B=0;z<S.SheetNames.length;++z)(S.Sheets[S.SheetNames[z]]||{})["!ref"]&&ie(y,27,le(S.SheetNames[z],B++));var Q=0;for(z=0;z<S.SheetNames.length;++z){var te=S.Sheets[S.SheetNames[z]];if(!(!te||!te["!ref"])){for(var re=Ue(te["!ref"]),ve=Array.isArray(te),V=[],pe=Math.min(re.e.r,8191),he=re.s.r;he<=pe;++he)for(var De=ct(he),Ne=re.s.c;Ne<=re.e.c;++Ne){he===re.s.r&&(V[Ne]=ut(Ne));var de=V[Ne]+De,je=ve?(te[he]||[])[Ne]:te[de];if(!(!je||je.t=="z"))if(je.t=="n")ie(y,23,M(he,Ne,Q,je.v));else{var ht=lr(je);ie(y,22,E(he,Ne,Q,ht.slice(0,239)))}}++Q}}return ie(y,1),y.end()}function i(S){var I=q(2);return I.write_shift(2,S),I}function o(S){var I=q(26);I.write_shift(2,4096),I.write_shift(2,4),I.write_shift(4,0);for(var D=0,y=0,z=0,B=0;B<S.SheetNames.length;++B){var Q=S.SheetNames[B],te=S.Sheets[Q];if(!(!te||!te["!ref"])){++z;var re=Rt(te["!ref"]);D<re.e.r&&(D=re.e.r),y<re.e.c&&(y=re.e.c)}}return D>8191&&(D=8191),I.write_shift(2,D),I.write_shift(1,z),I.write_shift(1,y),I.write_shift(2,0),I.write_shift(2,0),I.write_shift(1,1),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(4,0),I}function l(S,I,D){var y={s:{c:0,r:0},e:{c:0,r:0}};return I==8&&D.qpro?(y.s.c=S.read_shift(1),S.l++,y.s.r=S.read_shift(2),y.e.c=S.read_shift(1),S.l++,y.e.r=S.read_shift(2),y):(y.s.c=S.read_shift(2),y.s.r=S.read_shift(2),I==12&&D.qpro&&(S.l+=2),y.e.c=S.read_shift(2),y.e.r=S.read_shift(2),I==12&&D.qpro&&(S.l+=2),y.s.c==65535&&(y.s.c=y.e.c=y.s.r=y.e.r=0),y)}function c(S){var I=q(8);return I.write_shift(2,S.s.c),I.write_shift(2,S.s.r),I.write_shift(2,S.e.c),I.write_shift(2,S.e.r),I}function h(S,I,D){var y=[{c:0,r:0},{t:"n",v:0},0,0];return D.qpro&&D.vers!=20768?(y[0].c=S.read_shift(1),y[3]=S.read_shift(1),y[0].r=S.read_shift(2),S.l+=2):(y[2]=S.read_shift(1),y[0].c=S.read_shift(2),y[0].r=S.read_shift(2)),y}function d(S,I,D){var y=S.l+I,z=h(S,I,D);if(z[1].t="s",D.vers==20768){S.l++;var B=S.read_shift(1);return z[1].v=S.read_shift(B,"utf8"),z}return D.qpro&&S.l++,z[1].v=S.read_shift(y-S.l,"cstr"),z}function f(S,I,D){var y=q(7+D.length);y.write_shift(1,255),y.write_shift(2,I),y.write_shift(2,S),y.write_shift(1,39);for(var z=0;z<y.length;++z){var B=D.charCodeAt(z);y.write_shift(1,B>=128?95:B)}return y.write_shift(1,0),y}function u(S,I,D){var y=h(S,I,D);return y[1].v=S.read_shift(2,"i"),y}function m(S,I,D){var y=q(7);return y.write_shift(1,255),y.write_shift(2,I),y.write_shift(2,S),y.write_shift(2,D,"i"),y}function p(S,I,D){var y=h(S,I,D);return y[1].v=S.read_shift(8,"f"),y}function x(S,I,D){var y=q(13);return y.write_shift(1,255),y.write_shift(2,I),y.write_shift(2,S),y.write_shift(8,D,"f"),y}function g(S,I,D){var y=S.l+I,z=h(S,I,D);if(z[1].v=S.read_shift(8,"f"),D.qpro)S.l=y;else{var B=S.read_shift(2);A(S.slice(S.l,S.l+B),z),S.l+=B}return z}function T(S,I,D){var y=I&32768;return I&=-32769,I=(y?S:0)+(I>=8192?I-16384:I),(y?"":"$")+(D?ut(I):ct(I))}var b={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},w=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function A(S,I){Ct(S,0);for(var D=[],y=0,z="",B="",Q="",te="";S.l<S.length;){var re=S[S.l++];switch(re){case 0:D.push(S.read_shift(8,"f"));break;case 1:B=T(I[0].c,S.read_shift(2),!0),z=T(I[0].r,S.read_shift(2),!1),D.push(B+z);break;case 2:{var ve=T(I[0].c,S.read_shift(2),!0),V=T(I[0].r,S.read_shift(2),!1);B=T(I[0].c,S.read_shift(2),!0),z=T(I[0].r,S.read_shift(2),!1),D.push(ve+V+":"+B+z)}break;case 3:if(S.l<S.length){console.error("WK1 premature formula end");return}break;case 4:D.push("("+D.pop()+")");break;case 5:D.push(S.read_shift(2));break;case 6:{for(var pe="";re=S[S.l++];)pe+=String.fromCharCode(re);D.push('"'+pe.replace(/"/g,'""')+'"')}break;case 8:D.push("-"+D.pop());break;case 23:D.push("+"+D.pop());break;case 22:D.push("NOT("+D.pop()+")");break;case 20:case 21:te=D.pop(),Q=D.pop(),D.push(["AND","OR"][re-20]+"("+Q+","+te+")");break;default:if(re<32&&w[re])te=D.pop(),Q=D.pop(),D.push(Q+w[re]+te);else if(b[re]){if(y=b[re][1],y==69&&(y=S[S.l++]),y>D.length){console.error("WK1 bad formula parse 0x"+re.toString(16)+":|"+D.join("|")+"|");return}var he=D.slice(-y);D.length-=y,D.push(b[re][0]+"("+he.join(",")+")")}else return re<=7?console.error("WK1 invalid opcode "+re.toString(16)):re<=24?console.error("WK1 unsupported op "+re.toString(16)):re<=30?console.error("WK1 invalid opcode "+re.toString(16)):re<=115?console.error("WK1 unsupported function opcode "+re.toString(16)):console.error("WK1 unrecognized opcode "+re.toString(16))}}D.length==1?I[1].f=""+D[0]:console.error("WK1 bad formula parse |"+D.join("|")+"|")}function _(S){var I=[{c:0,r:0},{t:"n",v:0},0];return I[0].r=S.read_shift(2),I[3]=S[S.l++],I[0].c=S[S.l++],I}function L(S,I){var D=_(S);return D[1].t="s",D[1].v=S.read_shift(I-4,"cstr"),D}function E(S,I,D,y){var z=q(6+y.length);z.write_shift(2,S),z.write_shift(1,D),z.write_shift(1,I),z.write_shift(1,39);for(var B=0;B<y.length;++B){var Q=y.charCodeAt(B);z.write_shift(1,Q>=128?95:Q)}return z.write_shift(1,0),z}function O(S,I){var D=_(S);D[1].v=S.read_shift(2);var y=D[1].v>>1;if(D[1].v&1)switch(y&7){case 0:y=(y>>3)*5e3;break;case 1:y=(y>>3)*500;break;case 2:y=(y>>3)/20;break;case 3:y=(y>>3)/200;break;case 4:y=(y>>3)/2e3;break;case 5:y=(y>>3)/2e4;break;case 6:y=(y>>3)/16;break;case 7:y=(y>>3)/64;break}return D[1].v=y,D}function F(S,I){var D=_(S),y=S.read_shift(4),z=S.read_shift(4),B=S.read_shift(2);if(B==65535)return y===0&&z===3221225472?(D[1].t="e",D[1].v=15):y===0&&z===3489660928?(D[1].t="e",D[1].v=42):D[1].v=0,D;var Q=B&32768;return B=(B&32767)-16446,D[1].v=(1-Q*2)*(z*Math.pow(2,B+32)+y*Math.pow(2,B)),D}function M(S,I,D,y){var z=q(14);if(z.write_shift(2,S),z.write_shift(1,D),z.write_shift(1,I),y==0)return z.write_shift(4,0),z.write_shift(4,0),z.write_shift(2,65535),z;var B=0,Q=0,te=0,re=0;return y<0&&(B=1,y=-y),Q=Math.log2(y)|0,y/=Math.pow(2,Q-31),re=y>>>0,re&2147483648||(y/=2,++Q,re=y>>>0),y-=re,re|=2147483648,re>>>=0,y*=Math.pow(2,32),te=y>>>0,z.write_shift(4,te),z.write_shift(4,re),Q+=16383+(B?32768:0),z.write_shift(2,Q),z}function U(S,I){var D=F(S);return S.l+=I-14,D}function H(S,I){var D=_(S),y=S.read_shift(4);return D[1].v=y>>6,D}function J(S,I){var D=_(S),y=S.read_shift(8,"f");return D[1].v=y,D}function ge(S,I){var D=J(S);return S.l+=I-10,D}function xe(S,I){return S[S.l+I-1]==0?S.read_shift(I,"cstr"):""}function Ee(S,I){var D=S[S.l++];D>I-1&&(D=I-1);for(var y="";y.length<D;)y+=String.fromCharCode(S[S.l++]);return y}function be(S,I,D){if(!(!D.qpro||I<21)){var y=S.read_shift(1);S.l+=17,S.l+=1,S.l+=2;var z=S.read_shift(I-21,"cstr");return[y,z]}}function Te(S,I){for(var D={},y=S.l+I;S.l<y;){var z=S.read_shift(2);if(z==14e3){for(D[z]=[0,""],D[z][0]=S.read_shift(2);S[S.l];)D[z][1]+=String.fromCharCode(S[S.l]),S.l++;S.l++}}return D}function le(S,I){var D=q(5+S.length);D.write_shift(2,14e3),D.write_shift(2,I);for(var y=0;y<S.length;++y){var z=S.charCodeAt(y);D[D.l++]=z>127?95:z}return D[D.l++]=0,D}var ue={0:{n:"BOF",f:yl},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:l},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:u},14:{n:"NUMBER",f:p},15:{n:"LABEL",f:d},16:{n:"FORMULA",f:g},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:d},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:xe},222:{n:"SHEETNAMELP",f:Ee},65535:{n:""}},_e={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:L},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:O},25:{n:"FORMULA19",f:U},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:Te},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:H},38:{n:"??"},39:{n:"NUMBER27",f:J},40:{n:"FORMULA28",f:ge},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:xe},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:be},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:s,book_to_wk3:a,to_workbook:r}}(),eu=/^\s|\s$|[\t\n\r]/;function jl(t,r){if(!r.bookSST)return"";var e=[Qe];e[e.length]=ae("sst",null,{xmlns:os[0],count:t.Count,uniqueCount:t.Unique});for(var s=0;s!=t.length;++s)if(t[s]!=null){var a=t[s],i="<si>";a.r?i+=a.r:(i+="<t",a.t||(a.t=""),a.t.match(eu)&&(i+=' xml:space="preserve"'),i+=">"+Pe(a.t)+"</t>"),i+="</si>",e[e.length]=i}return e.length>2&&(e[e.length]="</sst>",e[1]=e[1].replace("/>",">")),e.join("")}function tu(t){return[t.read_shift(4),t.read_shift(4)]}function ru(t,r){return r||(r=q(8)),r.write_shift(4,t.Count),r.write_shift(4,t.Unique),r}var su=Vh;function nu(t){var r=Nt();ee(r,159,ru(t));for(var e=0;e<t.length;++e)ee(r,19,su(t[e]));return ee(r,160),r.end()}function au(t){for(var r=[],e=t.split(""),s=0;s<e.length;++s)r[s]=e[s].charCodeAt(0);return r}function El(t){var r=0,e,s=au(t),a=s.length+1,i,o,l,c,h;for(e=Fr(a),e[0]=s.length,i=1;i!=a;++i)e[i]=s[i-1];for(i=a-1;i>=0;--i)o=e[i],l=r&16384?1:0,c=r<<1&32767,h=l|c,r=h^o;return r^52811}var iu=function(){function t(a,i){switch(i.type){case"base64":return r(or(a),i);case"binary":return r(a,i);case"buffer":return r(Re&&Buffer.isBuffer(a)?a.toString("binary"):zs(a),i);case"array":return r($n(a),i)}throw new Error("Unrecognized type "+i.type)}function r(a,i){var o=i||{},l=o.dense?[]:{},c=a.match(/\\trowd.*?\\row\b/g);if(!c.length)throw new Error("RTF missing table");var h={s:{c:0,r:0},e:{c:0,r:c.length-1}};return c.forEach(function(d,f){Array.isArray(l)&&(l[f]=[]);for(var u=/\\\w+\b/g,m=0,p,x=-1;p=u.exec(d);){switch(p[0]){case"\\cell":var g=d.slice(m,u.lastIndex-p[0].length);if(g[0]==" "&&(g=g.slice(1)),++x,g.length){var T={v:g,t:"s"};Array.isArray(l)?l[f][x]=T:l[Le({r:f,c:x})]=T}break}m=u.lastIndex}x>h.e.c&&(h.e.c=x)}),l["!ref"]=Je(h),l}function e(a,i){return Pr(t(a,i),i)}function s(a){for(var i=["{\\rtf1\\ansi"],o=Ue(a["!ref"]),l,c=Array.isArray(a),h=o.s.r;h<=o.e.r;++h){i.push("\\trowd\\trautofit1");for(var d=o.s.c;d<=o.e.c;++d)i.push("\\cellx"+(d+1));for(i.push("\\pard\\intbl"),d=o.s.c;d<=o.e.c;++d){var f=Le({r:h,c:d});l=c?(a[h]||[])[d]:a[f],!(!l||l.v==null&&(!l.f||l.F))&&(i.push(" "+(l.w||(lr(l),l.w))),i.push("\\cell"))}i.push("\\pard\\intbl\\row")}return i.join("")+"}"}return{to_workbook:e,to_sheet:t,from_sheet:s}}();function qi(t){for(var r=0,e=1;r!=3;++r)e=e*256+(t[r]>255?255:t[r]<0?0:t[r]);return e.toString(16).toUpperCase().slice(1)}var ou=6,ir=ou;function Nn(t){return Math.floor((t+Math.round(128/ir)/256)*ir)}function jn(t){return Math.floor((t-5)/ir*100+.5)/100}function Ea(t){return Math.round((t*ir+5)/ir*256)/256}function Ja(t){t.width?(t.wpx=Nn(t.width),t.wch=jn(t.wpx),t.MDW=ir):t.wpx?(t.wch=jn(t.wpx),t.width=Ea(t.wch),t.MDW=ir):typeof t.wch=="number"&&(t.width=Ea(t.wch),t.wpx=Nn(t.width),t.MDW=ir),t.customWidth&&delete t.customWidth}var lu=96,Tl=lu;function En(t){return t*96/Tl}function Cl(t){return t*Tl/96}function cu(t){var r=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(e){for(var s=e[0];s<=e[1];++s)t[s]!=null&&(r[r.length]=ae("numFmt",null,{numFmtId:s,formatCode:Pe(t[s])}))}),r.length===1?"":(r[r.length]="</numFmts>",r[0]=ae("numFmts",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function du(t){var r=[];return r[r.length]=ae("cellXfs",null),t.forEach(function(e){r[r.length]=ae("xf",null,e)}),r[r.length]="</cellXfs>",r.length===2?"":(r[0]=ae("cellXfs",null,{count:r.length-2}).replace("/>",">"),r.join(""))}function kl(t,r){var e=[Qe,ae("styleSheet",null,{xmlns:os[0],"xmlns:vt":rt.vt})],s;return t.SSF&&(s=cu(t.SSF))!=null&&(e[e.length]=s),e[e.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',e[e.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',e[e.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',e[e.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(s=du(r.cellXfs))&&(e[e.length]=s),e[e.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',e[e.length]='<dxfs count="0"/>',e[e.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',e.length>2&&(e[e.length]="</styleSheet>",e[1]=e[1].replace("/>",">")),e.join("")}function hu(t,r){var e=t.read_shift(2),s=xt(t);return[e,s]}function fu(t,r,e){e||(e=q(6+4*r.length)),e.write_shift(2,t),nt(r,e);var s=e.length>e.l?e.slice(0,e.l):e;return e.l==null&&(e.l=e.length),s}function uu(t,r,e){var s={};s.sz=t.read_shift(2)/20;var a=Zh(t);a.fItalic&&(s.italic=1),a.fCondense&&(s.condense=1),a.fExtend&&(s.extend=1),a.fShadow&&(s.shadow=1),a.fOutline&&(s.outline=1),a.fStrikeout&&(s.strike=1);var i=t.read_shift(2);switch(i===700&&(s.bold=1),t.read_shift(2)){case 1:s.vertAlign="superscript";break;case 2:s.vertAlign="subscript";break}var o=t.read_shift(1);o!=0&&(s.underline=o);var l=t.read_shift(1);l>0&&(s.family=l);var c=t.read_shift(1);switch(c>0&&(s.charset=c),t.l++,s.color=Qh(t),t.read_shift(1)){case 1:s.scheme="major";break;case 2:s.scheme="minor";break}return s.name=xt(t),s}function xu(t,r){r||(r=q(25+4*32)),r.write_shift(2,t.sz*20),ef(t,r),r.write_shift(2,t.bold?700:400);var e=0;t.vertAlign=="superscript"?e=1:t.vertAlign=="subscript"&&(e=2),r.write_shift(2,e),r.write_shift(1,t.underline||0),r.write_shift(1,t.family||0),r.write_shift(1,t.charset||0),r.write_shift(1,0),_n(t.color,r);var s=0;return s=2,r.write_shift(1,s),nt(t.name,r),r.length>r.l?r.slice(0,r.l):r}var mu=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],ia,pu=Jt;function Ji(t,r){r||(r=q(4*3+8*7+16*1)),ia||(ia=Ma(mu));var e=ia[t.patternType];e==null&&(e=40),r.write_shift(4,e);var s=0;if(e!=40)for(_n({auto:1},r),_n({auto:1},r);s<12;++s)r.write_shift(4,0);else{for(;s<4;++s)r.write_shift(4,0);for(;s<12;++s)r.write_shift(4,0)}return r.length>r.l?r.slice(0,r.l):r}function gu(t,r){var e=t.l+r,s=t.read_shift(2),a=t.read_shift(2);return t.l=e,{ixfe:s,numFmtId:a}}function Al(t,r,e){e||(e=q(16)),e.write_shift(2,r||0),e.write_shift(2,t.numFmtId||0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);var s=0;return e.write_shift(1,s),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(1,0),e}function vs(t,r){return r||(r=q(10)),r.write_shift(1,0),r.write_shift(1,0),r.write_shift(4,0),r.write_shift(4,0),r}var vu=Jt;function yu(t,r){return r||(r=q(51)),r.write_shift(1,0),vs(null,r),vs(null,r),vs(null,r),vs(null,r),vs(null,r),r.length>r.l?r.slice(0,r.l):r}function bu(t,r){return r||(r=q(12+4*10)),r.write_shift(4,t.xfId),r.write_shift(2,1),r.write_shift(1,0),r.write_shift(1,0),wn(t.name||"",r),r.length>r.l?r.slice(0,r.l):r}function wu(t,r,e){var s=q(2052);return s.write_shift(4,t),wn(r,s),wn(e,s),s.length>s.l?s.slice(0,s.l):s}function _u(t,r){if(r){var e=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&++e}),e!=0&&(ee(t,615,Gt(e)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&ee(t,44,fu(a,r[a]))}),ee(t,616))}}function Su(t){var r=1;ee(t,611,Gt(r)),ee(t,43,xu({sz:12,color:{theme:1},name:"Calibri",family:2})),ee(t,612)}function Nu(t){var r=2;ee(t,603,Gt(r)),ee(t,45,Ji({patternType:"none"})),ee(t,45,Ji({patternType:"gray125"})),ee(t,604)}function ju(t){var r=1;ee(t,613,Gt(r)),ee(t,46,yu()),ee(t,614)}function Eu(t){var r=1;ee(t,626,Gt(r)),ee(t,47,Al({numFmtId:0},65535)),ee(t,627)}function Tu(t,r){ee(t,617,Gt(r.length)),r.forEach(function(e){ee(t,47,Al(e,0))}),ee(t,618)}function Cu(t){var r=1;ee(t,619,Gt(r)),ee(t,48,bu({xfId:0,name:"Normal"})),ee(t,620)}function ku(t){var r=0;ee(t,505,Gt(r)),ee(t,506)}function Au(t){var r=0;ee(t,508,wu(r,"TableStyleMedium9","PivotStyleMedium4")),ee(t,509)}function Ru(t,r){var e=Nt();return ee(e,278),_u(e,t.SSF),Su(e),Nu(e),ju(e),Eu(e),Tu(e,r.cellXfs),Cu(e),ku(e),Au(e),ee(e,279),e.end()}function Rl(t,r){if(r&&r.themeXLSX)return r.themeXLSX;if(t&&typeof t.raw=="string")return t.raw;var e=[Qe];return e[e.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',e[e.length]="<a:themeElements>",e[e.length]='<a:clrScheme name="Office">',e[e.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',e[e.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',e[e.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',e[e.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',e[e.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',e[e.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',e[e.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',e[e.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',e[e.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',e[e.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',e[e.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',e[e.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',e[e.length]="</a:clrScheme>",e[e.length]='<a:fontScheme name="Office">',e[e.length]="<a:majorFont>",e[e.length]='<a:latin typeface="Cambria"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Times New Roman"/>',e[e.length]='<a:font script="Hebr" typeface="Times New Roman"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="MoolBoran"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Times New Roman"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:majorFont>",e[e.length]="<a:minorFont>",e[e.length]='<a:latin typeface="Calibri"/>',e[e.length]='<a:ea typeface=""/>',e[e.length]='<a:cs typeface=""/>',e[e.length]='<a:font script="Jpan" typeface=" "/>',e[e.length]='<a:font script="Hang" typeface=" "/>',e[e.length]='<a:font script="Hans" typeface=""/>',e[e.length]='<a:font script="Hant" typeface=""/>',e[e.length]='<a:font script="Arab" typeface="Arial"/>',e[e.length]='<a:font script="Hebr" typeface="Arial"/>',e[e.length]='<a:font script="Thai" typeface="Tahoma"/>',e[e.length]='<a:font script="Ethi" typeface="Nyala"/>',e[e.length]='<a:font script="Beng" typeface="Vrinda"/>',e[e.length]='<a:font script="Gujr" typeface="Shruti"/>',e[e.length]='<a:font script="Khmr" typeface="DaunPenh"/>',e[e.length]='<a:font script="Knda" typeface="Tunga"/>',e[e.length]='<a:font script="Guru" typeface="Raavi"/>',e[e.length]='<a:font script="Cans" typeface="Euphemia"/>',e[e.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',e[e.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',e[e.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',e[e.length]='<a:font script="Thaa" typeface="MV Boli"/>',e[e.length]='<a:font script="Deva" typeface="Mangal"/>',e[e.length]='<a:font script="Telu" typeface="Gautami"/>',e[e.length]='<a:font script="Taml" typeface="Latha"/>',e[e.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',e[e.length]='<a:font script="Orya" typeface="Kalinga"/>',e[e.length]='<a:font script="Mlym" typeface="Kartika"/>',e[e.length]='<a:font script="Laoo" typeface="DokChampa"/>',e[e.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',e[e.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',e[e.length]='<a:font script="Viet" typeface="Arial"/>',e[e.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',e[e.length]='<a:font script="Geor" typeface="Sylfaen"/>',e[e.length]="</a:minorFont>",e[e.length]="</a:fontScheme>",e[e.length]='<a:fmtScheme name="Office">',e[e.length]="<a:fillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="1"/>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:lin ang="16200000" scaled="0"/>',e[e.length]="</a:gradFill>",e[e.length]="</a:fillStyleLst>",e[e.length]="<a:lnStyleLst>",e[e.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',e[e.length]="</a:lnStyleLst>",e[e.length]="<a:effectStyleLst>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]="</a:effectStyle>",e[e.length]="<a:effectStyle>",e[e.length]="<a:effectLst>",e[e.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',e[e.length]="</a:effectLst>",e[e.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',e[e.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',e[e.length]="</a:effectStyle>",e[e.length]="</a:effectStyleLst>",e[e.length]="<a:bgFillStyleLst>",e[e.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]='<a:gradFill rotWithShape="1">',e[e.length]="<a:gsLst>",e[e.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',e[e.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',e[e.length]="</a:gsLst>",e[e.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',e[e.length]="</a:gradFill>",e[e.length]="</a:bgFillStyleLst>",e[e.length]="</a:fmtScheme>",e[e.length]="</a:themeElements>",e[e.length]="<a:objectDefaults>",e[e.length]="<a:spDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',e[e.length]="</a:spDef>",e[e.length]="<a:lnDef>",e[e.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',e[e.length]="</a:lnDef>",e[e.length]="</a:objectDefaults>",e[e.length]="<a:extraClrSchemeLst/>",e[e.length]="</a:theme>",e.join("")}function Fu(t,r){return{flags:t.read_shift(4),version:t.read_shift(4),name:xt(t)}}function Du(t){var r=q(12+2*t.name.length);return r.write_shift(4,t.flags),r.write_shift(4,t.version),nt(t.name,r),r.slice(0,r.l)}function Ou(t){for(var r=[],e=t.read_shift(4);e-- >0;)r.push([t.read_shift(4),t.read_shift(4)]);return r}function Iu(t){var r=q(4+8*t.length);r.write_shift(4,t.length);for(var e=0;e<t.length;++e)r.write_shift(4,t[e][0]),r.write_shift(4,t[e][1]);return r}function Pu(t,r){var e=q(8+2*r.length);return e.write_shift(4,t),nt(r,e),e.slice(0,e.l)}function Lu(t){return t.l+=4,t.read_shift(4)!=0}function Bu(t,r){var e=q(8);return e.write_shift(4,t),e.write_shift(4,1),e}function Mu(){var t=Nt();return ee(t,332),ee(t,334,Gt(1)),ee(t,335,Du({name:"XLDAPR",version:12e4,flags:3496657072})),ee(t,336),ee(t,339,Pu(1,"XLDAPR")),ee(t,52),ee(t,35,Gt(514)),ee(t,4096,Gt(0)),ee(t,4097,Lt(1)),ee(t,36),ee(t,53),ee(t,340),ee(t,337,Bu(1)),ee(t,51,Iu([[1,0]])),ee(t,338),ee(t,333),t.end()}function Fl(){var t=[Qe];return t.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),t.join("")}function zu(t){var r={};r.i=t.read_shift(4);var e={};e.r=t.read_shift(4),e.c=t.read_shift(4),r.r=Le(e);var s=t.read_shift(1);return s&2&&(r.l="1"),s&8&&(r.a="1"),r}var Kr=1024;function Dl(t,r){for(var e=[21600,21600],s=["m0,0l0",e[1],e[0],e[1],e[0],"0xe"].join(","),a=[ae("xml",null,{"xmlns:v":kt.v,"xmlns:o":kt.o,"xmlns:x":kt.x,"xmlns:mv":kt.mv}).replace(/\/>/,">"),ae("o:shapelayout",ae("o:idmap",null,{"v:ext":"edit",data:t}),{"v:ext":"edit"}),ae("v:shapetype",[ae("v:stroke",null,{joinstyle:"miter"}),ae("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:e.join(","),path:s})];Kr<t*1e3;)Kr+=1e3;return r.forEach(function(i){var o=st(i[0]),l={color2:"#BEFF82",type:"gradient"};l.type=="gradient"&&(l.angle="-180");var c=l.type=="gradient"?ae("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,h=ae("v:fill",c,l),d={on:"t",obscured:"t"};++Kr,a=a.concat(["<v:shape"+Os({id:"_x0000_s"+Kr,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(i[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",h,ae("v:shadow",null,d),ae("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",lt("x:Anchor",[o.c+1,0,o.r+1,0,o.c+3,20,o.r+5,20].join(",")),lt("x:AutoFill","False"),lt("x:Row",String(o.r)),lt("x:Column",String(o.c)),i[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),a.push("</xml>"),a.join("")}function Ol(t){var r=[Qe,ae("comments",null,{xmlns:os[0]})],e=[];return r.push("<authors>"),t.forEach(function(s){s[1].forEach(function(a){var i=Pe(a.a);e.indexOf(i)==-1&&(e.push(i),r.push("<author>"+i+"</author>")),a.T&&a.ID&&e.indexOf("tc="+a.ID)==-1&&(e.push("tc="+a.ID),r.push("<author>tc="+a.ID+"</author>"))})}),e.length==0&&(e.push("SheetJ5"),r.push("<author>SheetJ5</author>")),r.push("</authors>"),r.push("<commentList>"),t.forEach(function(s){var a=0,i=[];if(s[1][0]&&s[1][0].T&&s[1][0].ID?a=e.indexOf("tc="+s[1][0].ID):s[1].forEach(function(c){c.a&&(a=e.indexOf(Pe(c.a))),i.push(c.t||"")}),r.push('<comment ref="'+s[0]+'" authorId="'+a+'"><text>'),i.length<=1)r.push(lt("t",Pe(i[0]||"")));else{for(var o=`Comment:
    `+i[0]+`
`,l=1;l<i.length;++l)o+=`Reply:
    `+i[l]+`
`;r.push(lt("t",Pe(o)))}r.push("</text></comment>")}),r.push("</commentList>"),r.length>2&&(r[r.length]="</comments>",r[1]=r[1].replace("/>",">")),r.join("")}function Uu(t,r,e){var s=[Qe,ae("ThreadedComments",null,{xmlns:rt.TCMNT}).replace(/[\/]>/,">")];return t.forEach(function(a){var i="";(a[1]||[]).forEach(function(o,l){if(!o.T){delete o.ID;return}o.a&&r.indexOf(o.a)==-1&&r.push(o.a);var c={ref:a[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+e.tcid++).slice(-12)+"}"};l==0?i=c.id:c.parentId=i,o.ID=c.id,o.a&&(c.personId="{54EE7950-7262-4200-6969-"+("000000000000"+r.indexOf(o.a)).slice(-12)+"}"),s.push(ae("threadedComment",lt("text",o.t||""),c))})}),s.push("</ThreadedComments>"),s.join("")}function $u(t){var r=[Qe,ae("personList",null,{xmlns:rt.TCMNT,"xmlns:x":os[0]}).replace(/[\/]>/,">")];return t.forEach(function(e,s){r.push(ae("person",null,{displayName:e,id:"{54EE7950-7262-4200-6969-"+("000000000000"+s).slice(-12)+"}",userId:e,providerId:"None"}))}),r.push("</personList>"),r.join("")}function Hu(t){var r={};r.iauthor=t.read_shift(4);var e=zr(t);return r.rfx=e.s,r.ref=Le(e.s),t.l+=16,r}function Wu(t,r){return r==null&&(r=q(36)),r.write_shift(4,t[1].iauthor),cs(t[0],r),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r.write_shift(4,0),r}var Gu=xt;function Vu(t){return nt(t.slice(0,54))}function Xu(t){var r=Nt(),e=[];return ee(r,628),ee(r,630),t.forEach(function(s){s[1].forEach(function(a){e.indexOf(a.a)>-1||(e.push(a.a.slice(0,54)),ee(r,632,Vu(a.a)))})}),ee(r,631),ee(r,633),t.forEach(function(s){s[1].forEach(function(a){a.iauthor=e.indexOf(a.a);var i={s:st(s[0]),e:st(s[0])};ee(r,635,Wu([i,a])),a.t&&a.t.length>0&&ee(r,637,Kh(a)),ee(r,636),delete a.iauthor})}),ee(r,634),ee(r,629),r.end()}function Ku(t,r){r.FullPaths.forEach(function(e,s){if(s!=0){var a=e.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");a.slice(-1)!=="/"&&Me.utils.cfb_add(t,a,r.FileIndex[s].content)}})}var Il=["xlsb","xlsm","xlam","biff8","xla"],Yu=function(){var t=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,r={r:0,c:0};function e(s,a,i,o){var l=!1,c=!1;i.length==0?c=!0:i.charAt(0)=="["&&(c=!0,i=i.slice(1,-1)),o.length==0?l=!0:o.charAt(0)=="["&&(l=!0,o=o.slice(1,-1));var h=i.length>0?parseInt(i,10)|0:0,d=o.length>0?parseInt(o,10)|0:0;return l?d+=r.c:--d,c?h+=r.r:--h,a+(l?"":"$")+ut(d)+(c?"":"$")+ct(h)}return function(a,i){return r=i,a.replace(t,e)}}(),Qa=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,Za=function(){return function(r,e){return r.replace(Qa,function(s,a,i,o,l,c){var h=Va(o)-(i?0:e.c),d=Ga(c)-(l?0:e.r),f=d==0?"":l?d+1:"["+d+"]",u=h==0?"":i?h+1:"["+h+"]";return a+"R"+f+"C"+u})}}();function qu(t,r){return t.replace(Qa,function(e,s,a,i,o,l){return s+(a=="$"?a+i:ut(Va(i)+r.c))+(o=="$"?o+l:ct(Ga(l)+r.r))})}function Ju(t){return t.length!=1}function qe(t){t.l+=1}function gr(t,r){var e=t.read_shift(2);return[e&16383,e>>14&1,e>>15&1]}function Pl(t,r,e){var s=2;if(e){if(e.biff>=2&&e.biff<=5)return Ll(t);e.biff==12&&(s=4)}var a=t.read_shift(s),i=t.read_shift(s),o=gr(t),l=gr(t);return{s:{r:a,c:o[0],cRel:o[1],rRel:o[2]},e:{r:i,c:l[0],cRel:l[1],rRel:l[2]}}}function Ll(t){var r=gr(t),e=gr(t),s=t.read_shift(1),a=t.read_shift(1);return{s:{r:r[0],c:s,cRel:r[1],rRel:r[2]},e:{r:e[0],c:a,cRel:e[1],rRel:e[2]}}}function Qu(t,r,e){if(e.biff<8)return Ll(t);var s=t.read_shift(e.biff==12?4:2),a=t.read_shift(e.biff==12?4:2),i=gr(t),o=gr(t);return{s:{r:s,c:i[0],cRel:i[1],rRel:i[2]},e:{r:a,c:o[0],cRel:o[1],rRel:o[2]}}}function Bl(t,r,e){if(e&&e.biff>=2&&e.biff<=5)return Zu(t);var s=t.read_shift(e&&e.biff==12?4:2),a=gr(t);return{r:s,c:a[0],cRel:a[1],rRel:a[2]}}function Zu(t){var r=gr(t),e=t.read_shift(1);return{r:r[0],c:e,cRel:r[1],rRel:r[2]}}function ex(t){var r=t.read_shift(2),e=t.read_shift(2);return{r,c:e&255,fQuoted:!!(e&16384),cRel:e>>15,rRel:e>>15}}function tx(t,r,e){var s=e&&e.biff?e.biff:8;if(s>=2&&s<=5)return rx(t);var a=t.read_shift(s>=12?4:2),i=t.read_shift(2),o=(i&16384)>>14,l=(i&32768)>>15;if(i&=16383,l==1)for(;a>524287;)a-=1048576;if(o==1)for(;i>8191;)i=i-16384;return{r:a,c:i,cRel:o,rRel:l}}function rx(t){var r=t.read_shift(2),e=t.read_shift(1),s=(r&32768)>>15,a=(r&16384)>>14;return r&=16383,s==1&&r>=8192&&(r=r-16384),a==1&&e>=128&&(e=e-256),{r,c:e,cRel:a,rRel:s}}function sx(t,r,e){var s=(t[t.l++]&96)>>5,a=Pl(t,e.biff>=2&&e.biff<=5?6:8,e);return[s,a]}function nx(t,r,e){var s=(t[t.l++]&96)>>5,a=t.read_shift(2,"i"),i=8;if(e)switch(e.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}var o=Pl(t,i,e);return[s,a,o]}function ax(t,r,e){var s=(t[t.l++]&96)>>5;return t.l+=e&&e.biff>8?12:e.biff<8?6:8,[s]}function ix(t,r,e){var s=(t[t.l++]&96)>>5,a=t.read_shift(2),i=8;if(e)switch(e.biff){case 5:t.l+=12,i=6;break;case 12:i=12;break}return t.l+=i,[s,a]}function ox(t,r,e){var s=(t[t.l++]&96)>>5,a=Qu(t,r-1,e);return[s,a]}function lx(t,r,e){var s=(t[t.l++]&96)>>5;return t.l+=e.biff==2?6:e.biff==12?14:7,[s]}function Qi(t){var r=t[t.l+1]&1,e=1;return t.l+=4,[r,e]}function cx(t,r,e){t.l+=2;for(var s=t.read_shift(e&&e.biff==2?1:2),a=[],i=0;i<=s;++i)a.push(t.read_shift(e&&e.biff==2?1:2));return a}function dx(t,r,e){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(e&&e.biff==2?1:2)]}function hx(t,r,e){var s=t[t.l+1]&255?1:0;return t.l+=2,[s,t.read_shift(e&&e.biff==2?1:2)]}function fx(t){var r=t[t.l+1]&255?1:0;return t.l+=2,[r,t.read_shift(2)]}function ux(t,r,e){var s=t[t.l+1]&255?1:0;return t.l+=e&&e.biff==2?3:4,[s]}function Ml(t){var r=t.read_shift(1),e=t.read_shift(1);return[r,e]}function xx(t){return t.read_shift(2),Ml(t)}function mx(t){return t.read_shift(2),Ml(t)}function px(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var a=Bl(t,0,e);return[s,a]}function gx(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var a=tx(t,0,e);return[s,a]}function vx(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(2);e&&e.biff==5&&(t.l+=12);var i=Bl(t,0,e);return[s,a,i]}function yx(t,r,e){var s=(t[t.l]&96)>>5;t.l+=1;var a=t.read_shift(e&&e.biff<=3?1:2);return[ym[a],$l[a],s]}function bx(t,r,e){var s=t[t.l++],a=t.read_shift(1),i=e&&e.biff<=3?[s==88?-1:0,t.read_shift(1)]:wx(t);return[a,(i[0]===0?$l:vm)[i[1]]]}function wx(t){return[t[t.l+1]>>7,t.read_shift(2)&32767]}function _x(t,r,e){t.l+=e&&e.biff==2?3:4}function Sx(t,r,e){if(t.l++,e&&e.biff==12)return[t.read_shift(4,"i"),0];var s=t.read_shift(2),a=t.read_shift(e&&e.biff==2?1:2);return[s,a]}function Nx(t){return t.l++,Hs[t.read_shift(1)]}function jx(t){return t.l++,t.read_shift(2)}function Ex(t){return t.l++,t.read_shift(1)!==0}function Tx(t){return t.l++,ds(t)}function Cx(t,r,e){return t.l++,wl(t,r-1,e)}function kx(t,r){var e=[t.read_shift(1)];if(r==12)switch(e[0]){case 2:e[0]=4;break;case 4:e[0]=16;break;case 0:e[0]=1;break;case 1:e[0]=2;break}switch(e[0]){case 4:e[1]=vf(t,1)?"TRUE":"FALSE",r!=12&&(t.l+=7);break;case 37:case 16:e[1]=Hs[t[t.l]],t.l+=r==12?4:8;break;case 0:t.l+=8;break;case 1:e[1]=ds(t);break;case 2:e[1]=_f(t,0,{biff:r>0&&r<8?2:r});break;default:throw new Error("Bad SerAr: "+e[0])}return e}function Ax(t,r,e){for(var s=t.read_shift(e.biff==12?4:2),a=[],i=0;i!=s;++i)a.push((e.biff==12?zr:jf)(t));return a}function Rx(t,r,e){var s=0,a=0;e.biff==12?(s=t.read_shift(4),a=t.read_shift(4)):(a=1+t.read_shift(1),s=1+t.read_shift(2)),e.biff>=2&&e.biff<8&&(--s,--a==0&&(a=256));for(var i=0,o=[];i!=s&&(o[i]=[]);++i)for(var l=0;l!=a;++l)o[i][l]=kx(t,e.biff);return o}function Fx(t,r,e){var s=t.read_shift(1)>>>5&3,a=!e||e.biff>=8?4:2,i=t.read_shift(a);switch(e.biff){case 2:t.l+=5;break;case 3:case 4:t.l+=8;break;case 5:t.l+=12;break}return[s,0,i]}function Dx(t,r,e){if(e.biff==5)return Ox(t);var s=t.read_shift(1)>>>5&3,a=t.read_shift(2),i=t.read_shift(4);return[s,a,i]}function Ox(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2,"i");t.l+=8;var s=t.read_shift(2);return t.l+=12,[r,e,s]}function Ix(t,r,e){var s=t.read_shift(1)>>>5&3;t.l+=e&&e.biff==2?3:4;var a=t.read_shift(e&&e.biff==2?1:2);return[s,a]}function Px(t,r,e){var s=t.read_shift(1)>>>5&3,a=t.read_shift(e&&e.biff==2?1:2);return[s,a]}function Lx(t,r,e){var s=t.read_shift(1)>>>5&3;return t.l+=4,e.biff<8&&t.l--,e.biff==12&&(t.l+=2),[s]}function Bx(t,r,e){var s=(t[t.l++]&96)>>5,a=t.read_shift(2),i=4;if(e)switch(e.biff){case 5:i=15;break;case 12:i=6;break}return t.l+=i,[s,a]}var Mx=Jt,zx=Jt,Ux=Jt;function Ws(t,r,e){return t.l+=2,[ex(t)]}function ei(t){return t.l+=6,[]}var $x=Ws,Hx=ei,Wx=ei,Gx=Ws;function zl(t){return t.l+=2,[yl(t),t.read_shift(2)&1]}var Vx=Ws,Xx=zl,Kx=ei,Yx=Ws,qx=Ws,Jx=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Qx(t){t.l+=2;var r=t.read_shift(2),e=t.read_shift(2),s=t.read_shift(4),a=t.read_shift(2),i=t.read_shift(2),o=Jx[e>>2&31];return{ixti:r,coltype:e&3,rt:o,idx:s,c:a,C:i}}function Zx(t){return t.l+=2,[t.read_shift(4)]}function em(t,r,e){return t.l+=5,t.l+=2,t.l+=e.biff==2?1:4,["PTGSHEET"]}function tm(t,r,e){return t.l+=e.biff==2?4:5,["PTGENDSHEET"]}function rm(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function sm(t){var r=t.read_shift(1)>>>5&3,e=t.read_shift(2);return[r,e]}function nm(t){return t.l+=4,[0,0]}var Zi={1:{n:"PtgExp",f:Sx},2:{n:"PtgTbl",f:Ux},3:{n:"PtgAdd",f:qe},4:{n:"PtgSub",f:qe},5:{n:"PtgMul",f:qe},6:{n:"PtgDiv",f:qe},7:{n:"PtgPower",f:qe},8:{n:"PtgConcat",f:qe},9:{n:"PtgLt",f:qe},10:{n:"PtgLe",f:qe},11:{n:"PtgEq",f:qe},12:{n:"PtgGe",f:qe},13:{n:"PtgGt",f:qe},14:{n:"PtgNe",f:qe},15:{n:"PtgIsect",f:qe},16:{n:"PtgUnion",f:qe},17:{n:"PtgRange",f:qe},18:{n:"PtgUplus",f:qe},19:{n:"PtgUminus",f:qe},20:{n:"PtgPercent",f:qe},21:{n:"PtgParen",f:qe},22:{n:"PtgMissArg",f:qe},23:{n:"PtgStr",f:Cx},26:{n:"PtgSheet",f:em},27:{n:"PtgEndSheet",f:tm},28:{n:"PtgErr",f:Nx},29:{n:"PtgBool",f:Ex},30:{n:"PtgInt",f:jx},31:{n:"PtgNum",f:Tx},32:{n:"PtgArray",f:lx},33:{n:"PtgFunc",f:yx},34:{n:"PtgFuncVar",f:bx},35:{n:"PtgName",f:Fx},36:{n:"PtgRef",f:px},37:{n:"PtgArea",f:sx},38:{n:"PtgMemArea",f:Ix},39:{n:"PtgMemErr",f:Mx},40:{n:"PtgMemNoMem",f:zx},41:{n:"PtgMemFunc",f:Px},42:{n:"PtgRefErr",f:Lx},43:{n:"PtgAreaErr",f:ax},44:{n:"PtgRefN",f:gx},45:{n:"PtgAreaN",f:ox},46:{n:"PtgMemAreaN",f:rm},47:{n:"PtgMemNoMemN",f:sm},57:{n:"PtgNameX",f:Dx},58:{n:"PtgRef3d",f:vx},59:{n:"PtgArea3d",f:nx},60:{n:"PtgRefErr3d",f:Bx},61:{n:"PtgAreaErr3d",f:ix},255:{}},am={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},im={1:{n:"PtgElfLel",f:zl},2:{n:"PtgElfRw",f:Yx},3:{n:"PtgElfCol",f:$x},6:{n:"PtgElfRwV",f:qx},7:{n:"PtgElfColV",f:Gx},10:{n:"PtgElfRadical",f:Vx},11:{n:"PtgElfRadicalS",f:Kx},13:{n:"PtgElfColS",f:Hx},15:{n:"PtgElfColSV",f:Wx},16:{n:"PtgElfRadicalLel",f:Xx},25:{n:"PtgList",f:Qx},29:{n:"PtgSxName",f:Zx},255:{}},om={0:{n:"PtgAttrNoop",f:nm},1:{n:"PtgAttrSemi",f:ux},2:{n:"PtgAttrIf",f:hx},4:{n:"PtgAttrChoose",f:cx},8:{n:"PtgAttrGoto",f:dx},16:{n:"PtgAttrSum",f:_x},32:{n:"PtgAttrBaxcel",f:Qi},33:{n:"PtgAttrBaxcel",f:Qi},64:{n:"PtgAttrSpace",f:xx},65:{n:"PtgAttrSpaceSemi",f:mx},128:{n:"PtgAttrIfError",f:fx},255:{}};function lm(t,r,e,s){if(s.biff<8)return Jt(t,r);for(var a=t.l+r,i=[],o=0;o!==e.length;++o)switch(e[o][0]){case"PtgArray":e[o][1]=Rx(t,0,s),i.push(e[o][1]);break;case"PtgMemArea":e[o][2]=Ax(t,e[o][1],s),i.push(e[o][2]);break;case"PtgExp":s&&s.biff==12&&(e[o][1][1]=t.read_shift(4),i.push(e[o][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+e[o][0]}return r=a-t.l,r!==0&&i.push(Jt(t,r)),i}function cm(t,r,e){for(var s=t.l+r,a,i,o=[];s!=t.l;)r=s-t.l,i=t[t.l],a=Zi[i]||Zi[am[i]],(i===24||i===25)&&(a=(i===24?im:om)[t[t.l+1]]),!a||!a.f?Jt(t,r):o.push([a.n,a.f(t,r,e)]);return o}function dm(t){for(var r=[],e=0;e<t.length;++e){for(var s=t[e],a=[],i=0;i<s.length;++i){var o=s[i];if(o)switch(o[0]){case 2:a.push('"'+o[1].replace(/"/g,'""')+'"');break;default:a.push(o[1])}else a.push("")}r.push(a.join(","))}return r.join(";")}var hm={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function fm(t,r){if(!t&&!(r&&r.biff<=5&&r.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(t)?"'"+t+"'":t}function Ul(t,r,e){if(!t)return"SH33TJSERR0";if(e.biff>8&&(!t.XTI||!t.XTI[r]))return t.SheetNames[r];if(!t.XTI)return"SH33TJSERR6";var s=t.XTI[r];if(e.biff<8)return r>1e4&&(r-=65536),r<0&&(r=-r),r==0?"":t.XTI[r-1];if(!s)return"SH33TJSERR1";var a="";if(e.biff>8)switch(t[s[0]][0]){case 357:return a=s[1]==-1?"#REF":t.SheetNames[s[1]],s[1]==s[2]?a:a+":"+t.SheetNames[s[2]];case 358:return e.SID!=null?t.SheetNames[e.SID]:"SH33TJSSAME"+t[s[0]][0];case 355:default:return"SH33TJSSRC"+t[s[0]][0]}switch(t[s[0]][0][0]){case 1025:return a=s[1]==-1?"#REF":t.SheetNames[s[1]]||"SH33TJSERR3",s[1]==s[2]?a:a+":"+t.SheetNames[s[2]];case 14849:return t[s[0]].slice(1).map(function(i){return i.Name}).join(";;");default:return t[s[0]][0][3]?(a=s[1]==-1?"#REF":t[s[0]][0][3][s[1]]||"SH33TJSERR4",s[1]==s[2]?a:a+":"+t[s[0]][0][3][s[2]]):"SH33TJSERR2"}}function eo(t,r,e){var s=Ul(t,r,e);return s=="#REF"?s:fm(s,e)}function rs(t,r,e,s,a){var i=a&&a.biff||8,o={s:{c:0,r:0}},l=[],c,h,d,f=0,u=0,m,p="";if(!t[0]||!t[0][0])return"";for(var x=-1,g="",T=0,b=t[0].length;T<b;++T){var w=t[0][T];switch(w[0]){case"PtgUminus":l.push("-"+l.pop());break;case"PtgUplus":l.push("+"+l.pop());break;case"PtgPercent":l.push(l.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(c=l.pop(),h=l.pop(),x>=0){switch(t[0][x][1][0]){case 0:g=Xe(" ",t[0][x][1][1]);break;case 1:g=Xe("\r",t[0][x][1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}h=h+g,x=-1}l.push(h+hm[w[0]]+c);break;case"PtgIsect":c=l.pop(),h=l.pop(),l.push(h+" "+c);break;case"PtgUnion":c=l.pop(),h=l.pop(),l.push(h+","+c);break;case"PtgRange":c=l.pop(),h=l.pop(),l.push(h+":"+c);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":d=Ns(w[1][1],o,a),l.push(js(d,i));break;case"PtgRefN":d=e?Ns(w[1][1],e,a):w[1][1],l.push(js(d,i));break;case"PtgRef3d":f=w[1][1],d=Ns(w[1][2],o,a),p=eo(s,f,a),l.push(p+"!"+js(d,i));break;case"PtgFunc":case"PtgFuncVar":var A=w[1][0],_=w[1][1];A||(A=0),A&=127;var L=A==0?[]:l.slice(-A);l.length-=A,_==="User"&&(_=L.shift()),l.push(_+"("+L.join(",")+")");break;case"PtgBool":l.push(w[1]?"TRUE":"FALSE");break;case"PtgInt":l.push(w[1]);break;case"PtgNum":l.push(String(w[1]));break;case"PtgStr":l.push('"'+w[1].replace(/"/g,'""')+'"');break;case"PtgErr":l.push(w[1]);break;case"PtgAreaN":m=Bi(w[1][1],e?{s:e}:o,a),l.push(na(m,a));break;case"PtgArea":m=Bi(w[1][1],o,a),l.push(na(m,a));break;case"PtgArea3d":f=w[1][1],m=w[1][2],p=eo(s,f,a),l.push(p+"!"+na(m,a));break;case"PtgAttrSum":l.push("SUM("+l.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":u=w[1][2];var E=(s.names||[])[u-1]||(s[0]||[])[u],O=E?E.Name:"SH33TJSNAME"+String(u);O&&O.slice(0,6)=="_xlfn."&&!a.xlfn&&(O=O.slice(6)),l.push(O);break;case"PtgNameX":var F=w[1][1];u=w[1][2];var M;if(a.biff<=5)F<0&&(F=-F),s[F]&&(M=s[F][u]);else{var U="";if(((s[F]||[])[0]||[])[0]==14849||(((s[F]||[])[0]||[])[0]==1025?s[F][u]&&s[F][u].itab>0&&(U=s.SheetNames[s[F][u].itab-1]+"!"):U=s.SheetNames[u-1]+"!"),s[F]&&s[F][u])U+=s[F][u].Name;else if(s[0]&&s[0][u])U+=s[0][u].Name;else{var H=(Ul(s,F,a)||"").split(";;");H[u-1]?U=H[u-1]:U+="SH33TJSERRX"}l.push(U);break}M||(M={Name:"SH33TJSERRY"}),l.push(M.Name);break;case"PtgParen":var J="(",ge=")";if(x>=0){switch(g="",t[0][x][1][0]){case 2:J=Xe(" ",t[0][x][1][1])+J;break;case 3:J=Xe("\r",t[0][x][1][1])+J;break;case 4:ge=Xe(" ",t[0][x][1][1])+ge;break;case 5:ge=Xe("\r",t[0][x][1][1])+ge;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+t[0][x][1][0])}x=-1}l.push(J+l.pop()+ge);break;case"PtgRefErr":l.push("#REF!");break;case"PtgRefErr3d":l.push("#REF!");break;case"PtgExp":d={c:w[1][1],r:w[1][0]};var xe={c:e.c,r:e.r};if(s.sharedf[Le(d)]){var Ee=s.sharedf[Le(d)];l.push(rs(Ee,o,xe,s,a))}else{var be=!1;for(c=0;c!=s.arrayf.length;++c)if(h=s.arrayf[c],!(d.c<h[0].s.c||d.c>h[0].e.c)&&!(d.r<h[0].s.r||d.r>h[0].e.r)){l.push(rs(h[1],o,xe,s,a)),be=!0;break}be||l.push(w[1])}break;case"PtgArray":l.push("{"+dm(w[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=T;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":l.push("");break;case"PtgAreaErr":l.push("#REF!");break;case"PtgAreaErr3d":l.push("#REF!");break;case"PtgList":l.push("Table"+w[1].idx+"[#"+w[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(w));default:throw new Error("Unrecognized Formula Token: "+String(w))}var Te=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&x>=0&&Te.indexOf(t[0][T][0])==-1){w=t[0][x];var le=!0;switch(w[1][0]){case 4:le=!1;case 0:g=Xe(" ",w[1][1]);break;case 5:le=!1;case 1:g=Xe("\r",w[1][1]);break;default:if(g="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+w[1][0])}l.push((le?g:"")+l.pop()+(le?"":g)),x=-1}}if(l.length>1&&a.WTF)throw new Error("bad formula stack");return l[0]}function um(t){if(t==null){var r=q(8);return r.write_shift(1,3),r.write_shift(1,0),r.write_shift(2,0),r.write_shift(2,0),r.write_shift(2,65535),r}else if(typeof t=="number")return Dr(t);return Dr(0)}function xm(t,r,e,s,a){var i=Or(r,e,a),o=um(t.v),l=q(6),c=33;l.write_shift(2,c),l.write_shift(4,0);for(var h=q(t.bf.length),d=0;d<t.bf.length;++d)h[d]=t.bf[d];var f=ot([i,o,l,h]);return f}function Hn(t,r,e){var s=t.read_shift(4),a=cm(t,s,e),i=t.read_shift(4),o=i>0?lm(t,i,a,e):null;return[a,o]}var mm=Hn,Wn=Hn,pm=Hn,gm=Hn,vm={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},$l={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},ym={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function bm(t){var r="of:="+t.replace(Qa,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return r.replace(/;/g,"|").replace(/,/g,";")}function wm(t){return t.replace(/\./,"!")}var Es=typeof Map<"u";function ti(t,r,e){var s=0,a=t.length;if(e){if(Es?e.has(r):Object.prototype.hasOwnProperty.call(e,r)){for(var i=Es?e.get(r):e[r];s<i.length;++s)if(t[i[s]].t===r)return t.Count++,i[s]}}else for(;s<a;++s)if(t[s].t===r)return t.Count++,s;return t[a]={t:r},t.Count++,t.Unique++,e&&(Es?(e.has(r)||e.set(r,[]),e.get(r).push(a)):(Object.prototype.hasOwnProperty.call(e,r)||(e[r]=[]),e[r].push(a))),a}function Gn(t,r){var e={min:t+1,max:t+1},s=-1;return r.MDW&&(ir=r.MDW),r.width!=null?e.customWidth=1:r.wpx!=null?s=jn(r.wpx):r.wch!=null&&(s=r.wch),s>-1?(e.width=Ea(s),e.customWidth=1):r.width!=null&&(e.width=r.width),r.hidden&&(e.hidden=!0),r.level!=null&&(e.outlineLevel=e.level=r.level),e}function Hl(t,r){if(t){var e=[.7,.7,.75,.75,.3,.3];t.left==null&&(t.left=e[0]),t.right==null&&(t.right=e[1]),t.top==null&&(t.top=e[2]),t.bottom==null&&(t.bottom=e[3]),t.header==null&&(t.header=e[4]),t.footer==null&&(t.footer=e[5])}}function br(t,r,e){var s=e.revssf[r.z!=null?r.z:"General"],a=60,i=t.length;if(s==null&&e.ssf){for(;a<392;++a)if(e.ssf[a]==null){Bo(r.z,a),e.ssf[a]=r.z,e.revssf[r.z]=s=a;break}}for(a=0;a!=i;++a)if(t[a].numFmtId===s)return a;return t[i]={numFmtId:s,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},i}function _m(t,r,e){if(t&&t["!ref"]){var s=Ue(t["!ref"]);if(s.e.c<s.s.c||s.e.r<s.s.r)throw new Error("Bad range ("+e+"): "+t["!ref"])}}function Sm(t){if(t.length===0)return"";for(var r='<mergeCells count="'+t.length+'">',e=0;e!=t.length;++e)r+='<mergeCell ref="'+Je(t[e])+'"/>';return r+"</mergeCells>"}function Nm(t,r,e,s,a){var i=!1,o={},l=null;if(s.bookType!=="xlsx"&&r.vbaraw){var c=r.SheetNames[e];try{r.Workbook&&(c=r.Workbook.Sheets[e].CodeName||c)}catch{}i=!0,o.codeName=Ds(Pe(c))}if(t&&t["!outline"]){var h={summaryBelow:1,summaryRight:1};t["!outline"].above&&(h.summaryBelow=0),t["!outline"].left&&(h.summaryRight=0),l=(l||"")+ae("outlinePr",null,h)}!i&&!l||(a[a.length]=ae("sheetPr",l,o))}var jm=["objects","scenarios","selectLockedCells","selectUnlockedCells"],Em=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function Tm(t){var r={sheet:1};return jm.forEach(function(e){t[e]!=null&&t[e]&&(r[e]="1")}),Em.forEach(function(e){t[e]!=null&&!t[e]&&(r[e]="0")}),t.password&&(r.password=El(t.password).toString(16).toUpperCase()),ae("sheetProtection",null,r)}function Cm(t){return Hl(t),ae("pageMargins",null,t)}function km(t,r){for(var e=["<cols>"],s,a=0;a!=r.length;++a)(s=r[a])&&(e[e.length]=ae("col",null,Gn(a,s)));return e[e.length]="</cols>",e.join("")}function Am(t,r,e,s){var a=typeof t.ref=="string"?t.ref:Je(t.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var i=e.Workbook.Names,o=Rt(a);o.s.r==o.e.r&&(o.e.r=Rt(r["!ref"]).e.r,a=Je(o));for(var l=0;l<i.length;++l){var c=i[l];if(c.Name=="_xlnm._FilterDatabase"&&c.Sheet==s){c.Ref="'"+e.SheetNames[s]+"'!"+a;break}}return l==i.length&&i.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+e.SheetNames[s]+"'!"+a}),ae("autoFilter",null,{ref:a})}function Rm(t,r,e,s){var a={workbookViewId:"0"};return(((s||{}).Workbook||{}).Views||[])[0]&&(a.rightToLeft=s.Workbook.Views[0].RTL?"1":"0"),ae("sheetViews",ae("sheetView",null,a),{})}function Fm(t,r,e,s){if(t.c&&e["!comments"].push([r,t.c]),t.v===void 0&&typeof t.f!="string"||t.t==="z"&&!t.f)return"";var a="",i=t.t,o=t.v;if(t.t!=="z")switch(t.t){case"b":a=t.v?"1":"0";break;case"n":a=""+t.v;break;case"e":a=Hs[t.v];break;case"d":s&&s.cellDates?a=wt(t.v,-1).toISOString():(t=Et(t),t.t="n",a=""+(t.v=jt(wt(t.v)))),typeof t.z>"u"&&(t.z=Ke[14]);break;default:a=t.v;break}var l=lt("v",Pe(a)),c={r},h=br(s.cellXfs,t,s);switch(h!==0&&(c.s=h),t.t){case"n":break;case"d":c.t="d";break;case"b":c.t="b";break;case"e":c.t="e";break;case"z":break;default:if(t.v==null){delete t.t;break}if(t.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(s&&s.bookSST){l=lt("v",""+ti(s.Strings,t.v,s.revStrings)),c.t="s";break}c.t="str";break}if(t.t!=i&&(t.t=i,t.v=o),typeof t.f=="string"&&t.f){var d=t.F&&t.F.slice(0,r.length)==r?{t:"array",ref:t.F}:null;l=ae("f",Pe(t.f),d)+(t.v!=null?l:"")}return t.l&&e["!links"].push([r,t.l]),t.D&&(c.cm=1),ae("c",l,c)}function Dm(t,r,e,s){var a=[],i=[],o=Ue(t["!ref"]),l="",c,h="",d=[],f=0,u=0,m=t["!rows"],p=Array.isArray(t),x={r:h},g,T=-1;for(u=o.s.c;u<=o.e.c;++u)d[u]=ut(u);for(f=o.s.r;f<=o.e.r;++f){for(i=[],h=ct(f),u=o.s.c;u<=o.e.c;++u){c=d[u]+h;var b=p?(t[f]||[])[u]:t[c];b!==void 0&&(l=Fm(b,c,t,r))!=null&&i.push(l)}(i.length>0||m&&m[f])&&(x={r:h},m&&m[f]&&(g=m[f],g.hidden&&(x.hidden=1),T=-1,g.hpx?T=En(g.hpx):g.hpt&&(T=g.hpt),T>-1&&(x.ht=T,x.customHeight=1),g.level&&(x.outlineLevel=g.level)),a[a.length]=ae("row",i.join(""),x))}if(m)for(;f<m.length;++f)m&&m[f]&&(x={r:f+1},g=m[f],g.hidden&&(x.hidden=1),T=-1,g.hpx?T=En(g.hpx):g.hpt&&(T=g.hpt),T>-1&&(x.ht=T,x.customHeight=1),g.level&&(x.outlineLevel=g.level),a[a.length]=ae("row","",x));return a.join("")}function Wl(t,r,e,s){var a=[Qe,ae("worksheet",null,{xmlns:os[0],"xmlns:r":rt.r})],i=e.SheetNames[t],o=0,l="",c=e.Sheets[i];c==null&&(c={});var h=c["!ref"]||"A1",d=Ue(h);if(d.e.c>16383||d.e.r>1048575){if(r.WTF)throw new Error("Range "+h+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575),h=Je(d)}s||(s={}),c["!comments"]=[];var f=[];Nm(c,e,t,r,a),a[a.length]=ae("dimension",null,{ref:h}),a[a.length]=Rm(c,r,t,e),r.sheetFormat&&(a[a.length]=ae("sheetFormatPr",null,{defaultRowHeight:r.sheetFormat.defaultRowHeight||"16",baseColWidth:r.sheetFormat.baseColWidth||"10",outlineLevelRow:r.sheetFormat.outlineLevelRow||"7"})),c["!cols"]!=null&&c["!cols"].length>0&&(a[a.length]=km(c,c["!cols"])),a[o=a.length]="<sheetData/>",c["!links"]=[],c["!ref"]!=null&&(l=Dm(c,r),l.length>0&&(a[a.length]=l)),a.length>o+1&&(a[a.length]="</sheetData>",a[o]=a[o].replace("/>",">")),c["!protect"]&&(a[a.length]=Tm(c["!protect"])),c["!autofilter"]!=null&&(a[a.length]=Am(c["!autofilter"],c,e,t)),c["!merges"]!=null&&c["!merges"].length>0&&(a[a.length]=Sm(c["!merges"]));var u=-1,m,p=-1;return c["!links"].length>0&&(a[a.length]="<hyperlinks>",c["!links"].forEach(function(x){x[1].Target&&(m={ref:x[0]},x[1].Target.charAt(0)!="#"&&(p=Ie(s,-1,Pe(x[1].Target).replace(/#.*$/,""),Ce.HLINK),m["r:id"]="rId"+p),(u=x[1].Target.indexOf("#"))>-1&&(m.location=Pe(x[1].Target.slice(u+1))),x[1].Tooltip&&(m.tooltip=Pe(x[1].Tooltip)),a[a.length]=ae("hyperlink",null,m))}),a[a.length]="</hyperlinks>"),delete c["!links"],c["!margins"]!=null&&(a[a.length]=Cm(c["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&(a[a.length]=lt("ignoredErrors",ae("ignoredError",null,{numberStoredAsText:1,sqref:h}))),f.length>0&&(p=Ie(s,-1,"../drawings/drawing"+(t+1)+".xml",Ce.DRAW),a[a.length]=ae("drawing",null,{"r:id":"rId"+p}),c["!drawing"]=f),c["!comments"].length>0&&(p=Ie(s,-1,"../drawings/vmlDrawing"+(t+1)+".vml",Ce.VML),a[a.length]=ae("legacyDrawing",null,{"r:id":"rId"+p}),c["!legacy"]=p),a.length>1&&(a[a.length]="</worksheet>",a[1]=a[1].replace("/>",">")),a.join("")}function Om(t,r){var e={},s=t.l+r;e.r=t.read_shift(4),t.l+=4;var a=t.read_shift(2);t.l+=1;var i=t.read_shift(1);return t.l=s,i&7&&(e.level=i&7),i&16&&(e.hidden=!0),i&32&&(e.hpt=a/20),e}function Im(t,r,e){var s=q(145),a=(e["!rows"]||[])[t]||{};s.write_shift(4,t),s.write_shift(4,0);var i=320;a.hpx?i=En(a.hpx)*20:a.hpt&&(i=a.hpt*20),s.write_shift(2,i),s.write_shift(1,0);var o=0;a.level&&(o|=a.level),a.hidden&&(o|=16),(a.hpx||a.hpt)&&(o|=32),s.write_shift(1,o),s.write_shift(1,0);var l=0,c=s.l;s.l+=4;for(var h={r:t,c:0},d=0;d<16;++d)if(!(r.s.c>d+1<<10||r.e.c<d<<10)){for(var f=-1,u=-1,m=d<<10;m<d+1<<10;++m){h.c=m;var p=Array.isArray(e)?(e[h.r]||[])[h.c]:e[Le(h)];p&&(f<0&&(f=m),u=m)}f<0||(++l,s.write_shift(4,f),s.write_shift(4,u))}var x=s.l;return s.l=c,s.write_shift(4,l),s.l=x,s.length>s.l?s.slice(0,s.l):s}function Pm(t,r,e,s){var a=Im(s,e,r);(a.length>17||(r["!rows"]||[])[s])&&ee(t,0,a)}var Lm=zr,Bm=cs;function Mm(){}function zm(t,r){var e={},s=t[t.l];return++t.l,e.above=!(s&64),e.left=!(s&128),t.l+=18,e.name=Yh(t),e}function Um(t,r,e){e==null&&(e=q(84+4*t.length));var s=192;r&&(r.above&&(s&=-65),r.left&&(s&=-129)),e.write_shift(1,s);for(var a=1;a<3;++a)e.write_shift(1,0);return _n({auto:1},e),e.write_shift(-4,-1),e.write_shift(-4,-1),al(t,e),e.slice(0,e.l)}function $m(t){var r=Bt(t);return[r]}function Hm(t,r,e){return e==null&&(e=q(8)),Lr(r,e)}function Wm(t){var r=Br(t);return[r]}function Gm(t,r,e){return e==null&&(e=q(4)),Mr(r,e)}function Vm(t){var r=Bt(t),e=t.read_shift(1);return[r,e,"b"]}function Xm(t,r,e){return e==null&&(e=q(9)),Lr(r,e),e.write_shift(1,t.v?1:0),e}function Km(t){var r=Br(t),e=t.read_shift(1);return[r,e,"b"]}function Ym(t,r,e){return e==null&&(e=q(5)),Mr(r,e),e.write_shift(1,t.v?1:0),e}function qm(t){var r=Bt(t),e=t.read_shift(1);return[r,e,"e"]}function Jm(t,r,e){return e==null&&(e=q(9)),Lr(r,e),e.write_shift(1,t.v),e}function Qm(t){var r=Br(t),e=t.read_shift(1);return[r,e,"e"]}function Zm(t,r,e){return e==null&&(e=q(8)),Mr(r,e),e.write_shift(1,t.v),e.write_shift(2,0),e.write_shift(1,0),e}function ep(t){var r=Bt(t),e=t.read_shift(4);return[r,e,"s"]}function tp(t,r,e){return e==null&&(e=q(12)),Lr(r,e),e.write_shift(4,r.v),e}function rp(t){var r=Br(t),e=t.read_shift(4);return[r,e,"s"]}function sp(t,r,e){return e==null&&(e=q(8)),Mr(r,e),e.write_shift(4,r.v),e}function np(t){var r=Bt(t),e=ds(t);return[r,e,"n"]}function ap(t,r,e){return e==null&&(e=q(16)),Lr(r,e),Dr(t.v,e),e}function ip(t){var r=Br(t),e=ds(t);return[r,e,"n"]}function op(t,r,e){return e==null&&(e=q(12)),Mr(r,e),Dr(t.v,e),e}function lp(t){var r=Bt(t),e=il(t);return[r,e,"n"]}function cp(t,r,e){return e==null&&(e=q(12)),Lr(r,e),ol(t.v,e),e}function dp(t){var r=Br(t),e=il(t);return[r,e,"n"]}function hp(t,r,e){return e==null&&(e=q(8)),Mr(r,e),ol(t.v,e),e}function fp(t){var r=Bt(t),e=Xa(t);return[r,e,"is"]}function up(t){var r=Bt(t),e=xt(t);return[r,e,"str"]}function xp(t,r,e){return e==null&&(e=q(12+4*t.v.length)),Lr(r,e),nt(t.v,e),e.length>e.l?e.slice(0,e.l):e}function mp(t){var r=Br(t),e=xt(t);return[r,e,"str"]}function pp(t,r,e){return e==null&&(e=q(8+4*t.v.length)),Mr(r,e),nt(t.v,e),e.length>e.l?e.slice(0,e.l):e}function gp(t,r,e){var s=t.l+r,a=Bt(t);a.r=e["!row"];var i=t.read_shift(1),o=[a,i,"b"];if(e.cellFormula){t.l+=2;var l=Wn(t,s-t.l,e);o[3]=rs(l,null,a,e.supbooks,e)}else t.l=s;return o}function vp(t,r,e){var s=t.l+r,a=Bt(t);a.r=e["!row"];var i=t.read_shift(1),o=[a,i,"e"];if(e.cellFormula){t.l+=2;var l=Wn(t,s-t.l,e);o[3]=rs(l,null,a,e.supbooks,e)}else t.l=s;return o}function yp(t,r,e){var s=t.l+r,a=Bt(t);a.r=e["!row"];var i=ds(t),o=[a,i,"n"];if(e.cellFormula){t.l+=2;var l=Wn(t,s-t.l,e);o[3]=rs(l,null,a,e.supbooks,e)}else t.l=s;return o}function bp(t,r,e){var s=t.l+r,a=Bt(t);a.r=e["!row"];var i=xt(t),o=[a,i,"str"];if(e.cellFormula){t.l+=2;var l=Wn(t,s-t.l,e);o[3]=rs(l,null,a,e.supbooks,e)}else t.l=s;return o}var wp=zr,_p=cs;function Sp(t,r){return r==null&&(r=q(4)),r.write_shift(4,t),r}function Np(t,r){var e=t.l+r,s=zr(t),a=Ka(t),i=xt(t),o=xt(t),l=xt(t);t.l=e;var c={rfx:s,relId:a,loc:i,display:l};return o&&(c.Tooltip=o),c}function jp(t,r){var e=q(50+4*(t[1].Target.length+(t[1].Tooltip||"").length));cs({s:st(t[0]),e:st(t[0])},e),Ya("rId"+r,e);var s=t[1].Target.indexOf("#"),a=s==-1?"":t[1].Target.slice(s+1);return nt(a||"",e),nt(t[1].Tooltip||"",e),nt("",e),e.slice(0,e.l)}function Ep(){}function Tp(t,r,e){var s=t.l+r,a=ll(t),i=t.read_shift(1),o=[a];if(o[2]=i,e.cellFormula){var l=mm(t,s-t.l,e);o[1]=l}else t.l=s;return o}function Cp(t,r,e){var s=t.l+r,a=zr(t),i=[a];if(e.cellFormula){var o=gm(t,s-t.l,e);i[1]=o,t.l=s}else t.l=s;return i}function kp(t,r,e){e==null&&(e=q(18));var s=Gn(t,r);e.write_shift(-4,t),e.write_shift(-4,t),e.write_shift(4,(s.width||10)*256),e.write_shift(4,0);var a=0;return r.hidden&&(a|=1),typeof s.width=="number"&&(a|=2),r.level&&(a|=r.level<<8),e.write_shift(2,a),e}var Gl=["left","right","top","bottom","header","footer"];function Ap(t){var r={};return Gl.forEach(function(e){r[e]=ds(t)}),r}function Rp(t,r){return r==null&&(r=q(6*8)),Hl(t),Gl.forEach(function(e){Dr(t[e],r)}),r}function Fp(t){var r=t.read_shift(2);return t.l+=28,{RTL:r&32}}function Dp(t,r,e){e==null&&(e=q(30));var s=924;return(((r||{}).Views||[])[0]||{}).RTL&&(s|=32),e.write_shift(2,s),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,100),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(4,0),e}function Op(t){var r=q(24);return r.write_shift(4,4),r.write_shift(4,1),cs(t,r),r}function Ip(t,r){return r==null&&(r=q(16*4+2)),r.write_shift(2,t.password?El(t.password):0),r.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(e){e[1]?r.write_shift(4,t[e[0]]!=null&&!t[e[0]]?1:0):r.write_shift(4,t[e[0]]!=null&&t[e[0]]?0:1)}),r}function Pp(){}function Lp(){}function Bp(t,r,e,s,a,i,o){if(r.v===void 0)return!1;var l="";switch(r.t){case"b":l=r.v?"1":"0";break;case"d":r=Et(r),r.z=r.z||Ke[14],r.v=jt(wt(r.v)),r.t="n";break;case"n":case"e":l=""+r.v;break;default:l=r.v;break}var c={r:e,c:s};switch(c.s=br(a.cellXfs,r,a),r.l&&i["!links"].push([Le(c),r.l]),r.c&&i["!comments"].push([Le(c),r.c]),r.t){case"s":case"str":return a.bookSST?(l=ti(a.Strings,r.v,a.revStrings),c.t="s",c.v=l,o?ee(t,18,sp(r,c)):ee(t,7,tp(r,c))):(c.t="str",o?ee(t,17,pp(r,c)):ee(t,6,xp(r,c))),!0;case"n":return r.v==(r.v|0)&&r.v>-1e3&&r.v<1e3?o?ee(t,13,hp(r,c)):ee(t,2,cp(r,c)):o?ee(t,16,op(r,c)):ee(t,5,ap(r,c)),!0;case"b":return c.t="b",o?ee(t,15,Ym(r,c)):ee(t,4,Xm(r,c)),!0;case"e":return c.t="e",o?ee(t,14,Zm(r,c)):ee(t,3,Jm(r,c)),!0}return o?ee(t,12,Gm(r,c)):ee(t,1,Hm(r,c)),!0}function Mp(t,r,e,s){var a=Ue(r["!ref"]||"A1"),i,o="",l=[];ee(t,145);var c=Array.isArray(r),h=a.e.r;r["!rows"]&&(h=Math.max(a.e.r,r["!rows"].length-1));for(var d=a.s.r;d<=h;++d){o=ct(d),Pm(t,r,a,d);var f=!1;if(d<=a.e.r)for(var u=a.s.c;u<=a.e.c;++u){d===a.s.r&&(l[u]=ut(u)),i=l[u]+o;var m=c?(r[d]||[])[u]:r[i];if(!m){f=!1;continue}f=Bp(t,m,d,u,s,r,f)}}ee(t,146)}function zp(t,r){!r||!r["!merges"]||(ee(t,177,Sp(r["!merges"].length)),r["!merges"].forEach(function(e){ee(t,176,_p(e))}),ee(t,178))}function Up(t,r){!r||!r["!cols"]||(ee(t,390),r["!cols"].forEach(function(e,s){e&&ee(t,60,kp(s,e))}),ee(t,391))}function $p(t,r){!r||!r["!ref"]||(ee(t,648),ee(t,649,Op(Ue(r["!ref"]))),ee(t,650))}function Hp(t,r,e){r["!links"].forEach(function(s){if(s[1].Target){var a=Ie(e,-1,s[1].Target.replace(/#.*$/,""),Ce.HLINK);ee(t,494,jp(s,a))}}),delete r["!links"]}function Wp(t,r,e,s){if(r["!comments"].length>0){var a=Ie(s,-1,"../drawings/vmlDrawing"+(e+1)+".vml",Ce.VML);ee(t,551,Ya("rId"+a)),r["!legacy"]=a}}function Gp(t,r,e,s){if(r["!autofilter"]){var a=r["!autofilter"],i=typeof a.ref=="string"?a.ref:Je(a.ref);e.Workbook||(e.Workbook={Sheets:[]}),e.Workbook.Names||(e.Workbook.Names=[]);var o=e.Workbook.Names,l=Rt(i);l.s.r==l.e.r&&(l.e.r=Rt(r["!ref"]).e.r,i=Je(l));for(var c=0;c<o.length;++c){var h=o[c];if(h.Name=="_xlnm._FilterDatabase"&&h.Sheet==s){h.Ref="'"+e.SheetNames[s]+"'!"+i;break}}c==o.length&&o.push({Name:"_xlnm._FilterDatabase",Sheet:s,Ref:"'"+e.SheetNames[s]+"'!"+i}),ee(t,161,cs(Ue(i))),ee(t,162)}}function Vp(t,r,e){ee(t,133),ee(t,137,Dp(r,e)),ee(t,138),ee(t,134)}function Xp(t,r){r["!protect"]&&ee(t,535,Ip(r["!protect"]))}function Kp(t,r,e,s){var a=Nt(),i=e.SheetNames[t],o=e.Sheets[i]||{},l=i;try{e&&e.Workbook&&(l=e.Workbook.Sheets[t].CodeName||l)}catch{}var c=Ue(o["!ref"]||"A1");if(c.e.c>16383||c.e.r>1048575){if(r.WTF)throw new Error("Range "+(o["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575)}return o["!links"]=[],o["!comments"]=[],ee(a,129),(e.vbaraw||o["!outline"])&&ee(a,147,Um(l,o["!outline"])),ee(a,148,Bm(c)),Vp(a,o,e.Workbook),Up(a,o),Mp(a,o,t,r),Xp(a,o),Gp(a,o,e,t),zp(a,o),Hp(a,o,s),o["!margins"]&&ee(a,476,Rp(o["!margins"])),(!r||r.ignoreEC||r.ignoreEC==null)&&$p(a,o),Wp(a,o,t,s),ee(a,130),a.end()}function Yp(t,r){t.l+=10;var e=xt(t);return{name:e}}var qp=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function Jp(t){return!t.Workbook||!t.Workbook.WBProps?"false":Th(t.Workbook.WBProps.date1904)?"true":"false"}var Qp="][*?/\\".split("");function Vl(t,r){if(t.length>31)throw new Error("Sheet names cannot exceed 31 chars");var e=!0;return Qp.forEach(function(s){if(t.indexOf(s)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),e}function Zp(t,r,e){t.forEach(function(s,a){Vl(s);for(var i=0;i<a;++i)if(s==t[i])throw new Error("Duplicate Sheet Name: "+s);if(e){var o=r&&r[a]&&r[a].CodeName||s;if(o.charCodeAt(0)==95&&o.length>22)throw new Error("Bad Code Name: Worksheet"+o)}})}function eg(t){if(!t||!t.SheetNames||!t.Sheets)throw new Error("Invalid Workbook");if(!t.SheetNames.length)throw new Error("Workbook is empty");var r=t.Workbook&&t.Workbook.Sheets||[];Zp(t.SheetNames,r,!!t.vbaraw);for(var e=0;e<t.SheetNames.length;++e)_m(t.Sheets[t.SheetNames[e]],t.SheetNames[e],e)}function Xl(t){var r=[Qe];r[r.length]=ae("workbook",null,{xmlns:os[0],"xmlns:r":rt.r});var e=t.Workbook&&(t.Workbook.Names||[]).length>0,s={codeName:"ThisWorkbook"};t.Workbook&&t.Workbook.WBProps&&(qp.forEach(function(l){t.Workbook.WBProps[l[0]]!=null&&t.Workbook.WBProps[l[0]]!=l[1]&&(s[l[0]]=t.Workbook.WBProps[l[0]])}),t.Workbook.WBProps.CodeName&&(s.codeName=t.Workbook.WBProps.CodeName,delete s.CodeName)),r[r.length]=ae("workbookPr",null,s);var a=t.Workbook&&t.Workbook.Sheets||[],i=0;if(a&&a[0]&&a[0].Hidden){for(r[r.length]="<bookViews>",i=0;i!=t.SheetNames.length&&!(!a[i]||!a[i].Hidden);++i);i==t.SheetNames.length&&(i=0),r[r.length]='<workbookView firstSheet="'+i+'" activeTab="'+i+'"/>',r[r.length]="</bookViews>"}for(r[r.length]="<sheets>",i=0;i!=t.SheetNames.length;++i){var o={name:Pe(t.SheetNames[i].slice(0,31))};if(o.sheetId=""+(i+1),o["r:id"]="rId"+(i+1),a[i])switch(a[i].Hidden){case 1:o.state="hidden";break;case 2:o.state="veryHidden";break}r[r.length]=ae("sheet",null,o)}return r[r.length]="</sheets>",e&&(r[r.length]="<definedNames>",t.Workbook&&t.Workbook.Names&&t.Workbook.Names.forEach(function(l){var c={name:l.Name};l.Comment&&(c.comment=l.Comment),l.Sheet!=null&&(c.localSheetId=""+l.Sheet),l.Hidden&&(c.hidden="1"),l.Ref&&(r[r.length]=ae("definedName",Pe(l.Ref),c))}),r[r.length]="</definedNames>"),r.length>2&&(r[r.length]="</workbook>",r[1]=r[1].replace("/>",">")),r.join("")}function tg(t,r){var e={};return e.Hidden=t.read_shift(4),e.iTabID=t.read_shift(4),e.strRelID=ja(t),e.name=xt(t),e}function rg(t,r){return r||(r=q(127)),r.write_shift(4,t.Hidden),r.write_shift(4,t.iTabID),Ya(t.strRelID,r),nt(t.name.slice(0,31),r),r.length>r.l?r.slice(0,r.l):r}function sg(t,r){var e={},s=t.read_shift(4);e.defaultThemeVersion=t.read_shift(4);var a=r>8?xt(t):"";return a.length>0&&(e.CodeName=a),e.autoCompressPictures=!!(s&65536),e.backupFile=!!(s&64),e.checkCompatibility=!!(s&4096),e.date1904=!!(s&1),e.filterPrivacy=!!(s&8),e.hidePivotFieldList=!!(s&1024),e.promptedSolutions=!!(s&16),e.publishItems=!!(s&2048),e.refreshAllConnections=!!(s&262144),e.saveExternalLinkValues=!!(s&128),e.showBorderUnselectedTables=!!(s&4),e.showInkAnnotation=!!(s&32),e.showObjects=["all","placeholders","none"][s>>13&3],e.showPivotChartFilter=!!(s&32768),e.updateLinks=["userSet","never","always"][s>>8&3],e}function ng(t,r){r||(r=q(72));var e=0;return t&&t.filterPrivacy&&(e|=8),r.write_shift(4,e),r.write_shift(4,0),al(t&&t.CodeName||"ThisWorkbook",r),r.slice(0,r.l)}function ag(t,r,e){var s=t.l+r;t.l+=4,t.l+=1;var a=t.read_shift(4),i=qh(t),o=pm(t,0,e),l=Ka(t);t.l=s;var c={Name:i,Ptg:o};return a<268435455&&(c.Sheet=a),l&&(c.Comment=l),c}function ig(t,r){ee(t,143);for(var e=0;e!=r.SheetNames.length;++e){var s=r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[e]&&r.Workbook.Sheets[e].Hidden||0,a={Hidden:s,iTabID:e+1,strRelID:"rId"+(e+1),name:r.SheetNames[e]};ee(t,156,rg(a))}ee(t,144)}function og(t,r){r||(r=q(127));for(var e=0;e!=4;++e)r.write_shift(4,0);return nt("SheetJS",r),nt(xn.version,r),nt(xn.version,r),nt("7262",r),r.length>r.l?r.slice(0,r.l):r}function lg(t,r){r||(r=q(29)),r.write_shift(-4,0),r.write_shift(-4,460),r.write_shift(4,28800),r.write_shift(4,17600),r.write_shift(4,500),r.write_shift(4,t),r.write_shift(4,t);var e=120;return r.write_shift(1,e),r.length>r.l?r.slice(0,r.l):r}function cg(t,r){if(!(!r.Workbook||!r.Workbook.Sheets)){for(var e=r.Workbook.Sheets,s=0,a=-1,i=-1;s<e.length;++s)!e[s]||!e[s].Hidden&&a==-1?a=s:e[s].Hidden==1&&i==-1&&(i=s);i>a||(ee(t,135),ee(t,158,lg(a)),ee(t,136))}}function dg(t,r){var e=Nt();return ee(e,131),ee(e,128,og()),ee(e,153,ng(t.Workbook&&t.Workbook.WBProps||null)),cg(e,t),ig(e,t),ee(e,132),e.end()}function hg(t,r,e){return(r.slice(-4)===".bin"?dg:Xl)(t)}function fg(t,r,e,s,a){return(r.slice(-4)===".bin"?Kp:Wl)(t,e,s,a)}function ug(t,r,e){return(r.slice(-4)===".bin"?Ru:kl)(t,e)}function xg(t,r,e){return(r.slice(-4)===".bin"?nu:jl)(t,e)}function mg(t,r,e){return(r.slice(-4)===".bin"?Xu:Ol)(t)}function pg(t){return(t.slice(-4)===".bin"?Mu:Fl)()}function gg(t,r){var e=[];return t.Props&&e.push(uf(t.Props,r)),t.Custprops&&e.push(xf(t.Props,t.Custprops)),e.join("")}function vg(){return""}function yg(t,r){var e=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return r.cellXfs.forEach(function(s,a){var i=[];i.push(ae("NumberFormat",null,{"ss:Format":Pe(Ke[s.numFmtId])}));var o={"ss:ID":"s"+(21+a)};e.push(ae("Style",i.join(""),o))}),ae("Styles",e.join(""))}function Kl(t){return ae("NamedRange",null,{"ss:Name":t.Name,"ss:RefersTo":"="+Za(t.Ref,{r:0,c:0})})}function bg(t){if(!((t||{}).Workbook||{}).Names)return"";for(var r=t.Workbook.Names,e=[],s=0;s<r.length;++s){var a=r[s];a.Sheet==null&&(a.Name.match(/^_xlfn\./)||e.push(Kl(a)))}return ae("Names",e.join(""))}function wg(t,r,e,s){if(!t||!((s||{}).Workbook||{}).Names)return"";for(var a=s.Workbook.Names,i=[],o=0;o<a.length;++o){var l=a[o];l.Sheet==e&&(l.Name.match(/^_xlfn\./)||i.push(Kl(l)))}return i.join("")}function _g(t,r,e,s){if(!t)return"";var a=[];if(t["!margins"]&&(a.push("<PageSetup>"),t["!margins"].header&&a.push(ae("Header",null,{"x:Margin":t["!margins"].header})),t["!margins"].footer&&a.push(ae("Footer",null,{"x:Margin":t["!margins"].footer})),a.push(ae("PageMargins",null,{"x:Bottom":t["!margins"].bottom||"0.75","x:Left":t["!margins"].left||"0.7","x:Right":t["!margins"].right||"0.7","x:Top":t["!margins"].top||"0.75"})),a.push("</PageSetup>")),s&&s.Workbook&&s.Workbook.Sheets&&s.Workbook.Sheets[e])if(s.Workbook.Sheets[e].Hidden)a.push(ae("Visible",s.Workbook.Sheets[e].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var i=0;i<e&&!(s.Workbook.Sheets[i]&&!s.Workbook.Sheets[i].Hidden);++i);i==e&&a.push("<Selected/>")}return((((s||{}).Workbook||{}).Views||[])[0]||{}).RTL&&a.push("<DisplayRightToLeft/>"),t["!protect"]&&(a.push(lt("ProtectContents","True")),t["!protect"].objects&&a.push(lt("ProtectObjects","True")),t["!protect"].scenarios&&a.push(lt("ProtectScenarios","True")),t["!protect"].selectLockedCells!=null&&!t["!protect"].selectLockedCells?a.push(lt("EnableSelection","NoSelection")):t["!protect"].selectUnlockedCells!=null&&!t["!protect"].selectUnlockedCells&&a.push(lt("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(o){t["!protect"][o[0]]&&a.push("<"+o[1]+"/>")})),a.length==0?"":ae("WorksheetOptions",a.join(""),{xmlns:kt.x})}function Sg(t){return t.map(function(r){var e=Eh(r.t||""),s=ae("ss:Data",e,{xmlns:"http://www.w3.org/TR/REC-html40"});return ae("Comment",s,{"ss:Author":r.a})}).join("")}function Ng(t,r,e,s,a,i,o){if(!t||t.v==null&&t.f==null)return"";var l={};if(t.f&&(l["ss:Formula"]="="+Pe(Za(t.f,o))),t.F&&t.F.slice(0,r.length)==r){var c=st(t.F.slice(r.length+1));l["ss:ArrayRange"]="RC:R"+(c.r==o.r?"":"["+(c.r-o.r)+"]")+"C"+(c.c==o.c?"":"["+(c.c-o.c)+"]")}if(t.l&&t.l.Target&&(l["ss:HRef"]=Pe(t.l.Target),t.l.Tooltip&&(l["x:HRefScreenTip"]=Pe(t.l.Tooltip))),e["!merges"])for(var h=e["!merges"],d=0;d!=h.length;++d)h[d].s.c!=o.c||h[d].s.r!=o.r||(h[d].e.c>h[d].s.c&&(l["ss:MergeAcross"]=h[d].e.c-h[d].s.c),h[d].e.r>h[d].s.r&&(l["ss:MergeDown"]=h[d].e.r-h[d].s.r));var f="",u="";switch(t.t){case"z":if(!s.sheetStubs)return"";break;case"n":f="Number",u=String(t.v);break;case"b":f="Boolean",u=t.v?"1":"0";break;case"e":f="Error",u=Hs[t.v];break;case"d":f="DateTime",u=new Date(t.v).toISOString(),t.z==null&&(t.z=t.z||Ke[14]);break;case"s":f="String",u=jh(t.v||"");break}var m=br(s.cellXfs,t,s);l["ss:StyleID"]="s"+(21+m),l["ss:Index"]=o.c+1;var p=t.v!=null?u:"",x=t.t=="z"?"":'<Data ss:Type="'+f+'">'+p+"</Data>";return(t.c||[]).length>0&&(x+=Sg(t.c)),ae("Cell",x,l)}function jg(t,r){var e='<Row ss:Index="'+(t+1)+'"';return r&&(r.hpt&&!r.hpx&&(r.hpx=Cl(r.hpt)),r.hpx&&(e+=' ss:AutoFitHeight="0" ss:Height="'+r.hpx+'"'),r.hidden&&(e+=' ss:Hidden="1"')),e+">"}function Eg(t,r,e,s){if(!t["!ref"])return"";var a=Ue(t["!ref"]),i=t["!merges"]||[],o=0,l=[];t["!cols"]&&t["!cols"].forEach(function(g,T){Ja(g);var b=!!g.width,w=Gn(T,g),A={"ss:Index":T+1};b&&(A["ss:Width"]=Nn(w.width)),g.hidden&&(A["ss:Hidden"]="1"),l.push(ae("Column",null,A))});for(var c=Array.isArray(t),h=a.s.r;h<=a.e.r;++h){for(var d=[jg(h,(t["!rows"]||[])[h])],f=a.s.c;f<=a.e.c;++f){var u=!1;for(o=0;o!=i.length;++o)if(!(i[o].s.c>f)&&!(i[o].s.r>h)&&!(i[o].e.c<f)&&!(i[o].e.r<h)){(i[o].s.c!=f||i[o].s.r!=h)&&(u=!0);break}if(!u){var m={r:h,c:f},p=Le(m),x=c?(t[h]||[])[f]:t[p];d.push(Ng(x,p,t,r,e,s,m))}}d.push("</Row>"),d.length>2&&l.push(d.join(""))}return l.join("")}function Tg(t,r,e){var s=[],a=e.SheetNames[t],i=e.Sheets[a],o=i?wg(i,r,t,e):"";return o.length>0&&s.push("<Names>"+o+"</Names>"),o=i?Eg(i,r,t,e):"",o.length>0&&s.push("<Table>"+o+"</Table>"),s.push(_g(i,r,t,e)),s.join("")}function Cg(t,r){r||(r={}),t.SSF||(t.SSF=Et(Ke)),t.SSF&&(zn(),Mn(t.SSF),r.revssf=Un(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF,r.cellXfs=[],br(r.cellXfs,{},{revssf:{General:0}}));var e=[];e.push(gg(t,r)),e.push(vg()),e.push(""),e.push("");for(var s=0;s<t.SheetNames.length;++s)e.push(ae("Worksheet",Tg(s,r,t),{"ss:Name":Pe(t.SheetNames[s])}));return e[2]=yg(t,r),e[3]=bg(t),Qe+ae("Workbook",e.join(""),{xmlns:kt.ss,"xmlns:o":kt.o,"xmlns:x":kt.x,"xmlns:ss":kt.ss,"xmlns:dt":kt.dt,"xmlns:html":kt.html})}var oa={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function kg(t,r){var e=[],s=[],a=[],i=0,o,l=Ti(zi,"n"),c=Ti(Ui,"n");if(t.Props)for(o=dt(t.Props),i=0;i<o.length;++i)(Object.prototype.hasOwnProperty.call(l,o[i])?e:Object.prototype.hasOwnProperty.call(c,o[i])?s:a).push([o[i],t.Props[o[i]]]);if(t.Custprops)for(o=dt(t.Custprops),i=0;i<o.length;++i)Object.prototype.hasOwnProperty.call(t.Props||{},o[i])||(Object.prototype.hasOwnProperty.call(l,o[i])?e:Object.prototype.hasOwnProperty.call(c,o[i])?s:a).push([o[i],t.Custprops[o[i]]]);var h=[];for(i=0;i<a.length;++i)vl.indexOf(a[i][0])>-1||ml.indexOf(a[i][0])>-1||a[i][1]!=null&&h.push(a[i]);s.length&&Me.utils.cfb_add(r,"/SummaryInformation",Vi(s,oa.SI,c,Ui)),(e.length||h.length)&&Me.utils.cfb_add(r,"/DocumentSummaryInformation",Vi(e,oa.DSI,l,zi,h.length?h:null,oa.UDI))}function Ag(t,r){var e=r||{},s=Me.utils.cfb_new({root:"R"}),a="/Workbook";switch(e.bookType||"xls"){case"xls":e.bookType="biff8";case"xla":e.bookType||(e.bookType="xla");case"biff8":a="/Workbook",e.biff=8;break;case"biff5":a="/Book",e.biff=5;break;default:throw new Error("invalid type "+e.bookType+" for XLS CFB")}return Me.utils.cfb_add(s,a,Yl(t,e)),e.biff==8&&(t.Props||t.Custprops)&&kg(t,s),e.biff==8&&t.vbaraw&&Ku(s,Me.read(t.vbaraw,{type:typeof t.vbaraw=="string"?"binary":"buffer"})),s}var Rg={0:{f:Om},1:{f:$m},2:{f:lp},3:{f:qm},4:{f:Vm},5:{f:np},6:{f:up},7:{f:ep},8:{f:bp},9:{f:yp},10:{f:gp},11:{f:vp},12:{f:Wm},13:{f:dp},14:{f:Qm},15:{f:Km},16:{f:ip},17:{f:mp},18:{f:rp},19:{f:Xa},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:ag},40:{},42:{},43:{f:uu},44:{f:hu},45:{f:pu},46:{f:vu},47:{f:gu},48:{},49:{f:Hh},50:{},51:{f:Ou},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:Gf},62:{f:fp},63:{f:zu},64:{f:Pp},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:Jt,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Fp},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:zm},148:{f:Lm,p:16},151:{f:Ep},152:{},153:{f:sg},154:{},155:{},156:{f:tg},157:{},158:{},159:{T:1,f:tu},160:{T:-1},161:{T:1,f:zr},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:wp},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:Fu},336:{T:-1},337:{f:Lu,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:ja},357:{},358:{},359:{},360:{T:1},361:{},362:{f:Mf},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Tp},427:{f:Cp},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Ap},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:Mm},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:Np},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:ja},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Gu},633:{T:1},634:{T:-1},635:{T:1,f:Hu},636:{T:-1},637:{f:Xh},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Yp},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Lp},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function ie(t,r,e,s){var a=r;if(!isNaN(a)){var i=s||(e||[]).length||0,o=t.next(4);o.write_shift(2,a),o.write_shift(2,i),i>0&&Wa(e)&&t.push(e)}}function Fg(t,r,e,s){var a=(e||[]).length||0;if(a<=8224)return ie(t,r,e,a);var i=r;if(!isNaN(i)){for(var o=e.parts||[],l=0,c=0,h=0;h+(o[l]||8224)<=8224;)h+=o[l]||8224,l++;var d=t.next(4);for(d.write_shift(2,i),d.write_shift(2,h),t.push(e.slice(c,c+h)),c+=h;c<a;){for(d=t.next(4),d.write_shift(2,60),h=0;h+(o[l]||8224)<=8224;)h+=o[l]||8224,l++;d.write_shift(2,h),t.push(e.slice(c,c+h)),c+=h}}}function Gs(t,r,e){return t||(t=q(7)),t.write_shift(2,r),t.write_shift(2,e),t.write_shift(2,0),t.write_shift(1,0),t}function Dg(t,r,e,s){var a=q(9);return Gs(a,t,r),bl(e,s||"b",a),a}function Og(t,r,e){var s=q(8+2*e.length);return Gs(s,t,r),s.write_shift(1,e.length),s.write_shift(e.length,e,"sbcs"),s.l<s.length?s.slice(0,s.l):s}function Ig(t,r,e,s){if(r.v!=null)switch(r.t){case"d":case"n":var a=r.t=="d"?jt(wt(r.v)):r.v;a==(a|0)&&a>=0&&a<65536?ie(t,2,Yf(e,s,a)):ie(t,3,Kf(e,s,a));return;case"b":case"e":ie(t,5,Dg(e,s,r.v,r.t));return;case"s":case"str":ie(t,4,Og(e,s,(r.v||"").slice(0,255)));return}ie(t,1,Gs(null,e,s))}function Pg(t,r,e,s){var a=Array.isArray(r),i=Ue(r["!ref"]||"A1"),o,l="",c=[];if(i.e.c>255||i.e.r>16383){if(s.WTF)throw new Error("Range "+(r["!ref"]||"A1")+" exceeds format limit A1:IV16384");i.e.c=Math.min(i.e.c,255),i.e.r=Math.min(i.e.c,16383),o=Je(i)}for(var h=i.s.r;h<=i.e.r;++h){l=ct(h);for(var d=i.s.c;d<=i.e.c;++d){h===i.s.r&&(c[d]=ut(d)),o=c[d]+l;var f=a?(r[h]||[])[d]:r[o];f&&Ig(t,f,h,d)}}}function Lg(t,r){for(var e=r||{},s=Nt(),a=0,i=0;i<t.SheetNames.length;++i)t.SheetNames[i]==e.sheet&&(a=i);if(a==0&&e.sheet&&t.SheetNames[0]!=e.sheet)throw new Error("Sheet not found: "+e.sheet);return ie(s,e.biff==4?1033:e.biff==3?521:9,qa(t,16,e)),Pg(s,t.Sheets[t.SheetNames[a]],a,e),ie(s,10),s.end()}function Bg(t,r,e){ie(t,49,Rf({sz:12,name:"Arial"},e))}function Mg(t,r,e){r&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(s){for(var a=s[0];a<=s[1];++a)r[a]!=null&&ie(t,1054,Of(a,r[a],e))})}function zg(t,r){var e=q(19);e.write_shift(4,2151),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,1),e.write_shift(4,0),ie(t,2151,e),e=q(39),e.write_shift(4,2152),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(2,3),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(2,1),e.write_shift(4,4),e.write_shift(2,0),Sl(Ue(r["!ref"]||"A1"),e),e.write_shift(4,4),ie(t,2152,e)}function Ug(t,r){for(var e=0;e<16;++e)ie(t,224,Ki({numFmtId:0,style:!0},0,r));r.cellXfs.forEach(function(s){ie(t,224,Ki(s,0,r))})}function $g(t,r){for(var e=0;e<r["!links"].length;++e){var s=r["!links"][e];ie(t,440,$f(s)),s[1].Tooltip&&ie(t,2048,Hf(s))}delete r["!links"]}function Hg(t,r){if(r){var e=0;r.forEach(function(s,a){++e<=256&&s&&ie(t,125,Vf(Gn(a,s),a))})}}function Wg(t,r,e,s,a){var i=16+br(a.cellXfs,r,a);if(r.v==null&&!r.bf){ie(t,513,Or(e,s,i));return}if(r.bf)ie(t,6,xm(r,e,s,a,i));else switch(r.t){case"d":case"n":var o=r.t=="d"?jt(wt(r.v)):r.v;ie(t,515,Bf(e,s,o,i));break;case"b":case"e":ie(t,517,Lf(e,s,r.v,i,a,r.t));break;case"s":case"str":if(a.bookSST){var l=ti(a.Strings,r.v,a.revStrings);ie(t,253,Ff(e,s,l,i))}else ie(t,516,Df(e,s,(r.v||"").slice(0,255),i,a));break;default:ie(t,513,Or(e,s,i))}}function Gg(t,r,e){var s=Nt(),a=e.SheetNames[t],i=e.Sheets[a]||{},o=(e||{}).Workbook||{},l=(o.Sheets||[])[t]||{},c=Array.isArray(i),h=r.biff==8,d,f="",u=[],m=Ue(i["!ref"]||"A1"),p=h?65536:16384;if(m.e.c>255||m.e.r>=p){if(r.WTF)throw new Error("Range "+(i["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,p-1)}ie(s,2057,qa(e,16,r)),ie(s,13,Lt(1)),ie(s,12,Lt(100)),ie(s,15,bt(!0)),ie(s,17,bt(!1)),ie(s,16,Dr(.001)),ie(s,95,bt(!0)),ie(s,42,bt(!1)),ie(s,43,bt(!1)),ie(s,130,Lt(1)),ie(s,128,Pf()),ie(s,131,bt(!1)),ie(s,132,bt(!1)),h&&Hg(s,i["!cols"]),ie(s,512,If(m,r)),h&&(i["!links"]=[]);for(var x=m.s.r;x<=m.e.r;++x){f=ct(x);for(var g=m.s.c;g<=m.e.c;++g){x===m.s.r&&(u[g]=ut(g)),d=u[g]+f;var T=c?(i[x]||[])[g]:i[d];T&&(Wg(s,T,x,g,r),h&&T.l&&i["!links"].push([d,T.l]))}}var b=l.CodeName||l.name||a;return h&&ie(s,574,Af((o.Views||[])[0])),h&&(i["!merges"]||[]).length&&ie(s,229,Uf(i["!merges"])),h&&$g(s,i),ie(s,442,_l(b)),h&&zg(s,i),ie(s,10),s.end()}function Vg(t,r,e){var s=Nt(),a=(t||{}).Workbook||{},i=a.Sheets||[],o=a.WBProps||{},l=e.biff==8,c=e.biff==5;if(ie(s,2057,qa(t,5,e)),e.bookType=="xla"&&ie(s,135),ie(s,225,l?Lt(1200):null),ie(s,193,gf(2)),c&&ie(s,191),c&&ie(s,192),ie(s,226),ie(s,92,Ef("SheetJS",e)),ie(s,66,Lt(l?1200:1252)),l&&ie(s,353,Lt(0)),l&&ie(s,448),ie(s,317,Xf(t.SheetNames.length)),l&&t.vbaraw&&ie(s,211),l&&t.vbaraw){var h=o.CodeName||"ThisWorkbook";ie(s,442,_l(h))}ie(s,156,Lt(17)),ie(s,25,bt(!1)),ie(s,18,bt(!1)),ie(s,19,Lt(0)),l&&ie(s,431,bt(!1)),l&&ie(s,444,Lt(0)),ie(s,61,kf()),ie(s,64,bt(!1)),ie(s,141,Lt(0)),ie(s,34,bt(Jp(t)=="true")),ie(s,14,bt(!0)),l&&ie(s,439,bt(!1)),ie(s,218,Lt(0)),Bg(s,t,e),Mg(s,t.SSF,e),Ug(s,e),l&&ie(s,352,bt(!1));var d=s.end(),f=Nt();l&&ie(f,140,Wf()),l&&e.Strings&&Fg(f,252,Cf(e.Strings)),ie(f,10);var u=f.end(),m=Nt(),p=0,x=0;for(x=0;x<t.SheetNames.length;++x)p+=(l?12:11)+(l?2:1)*t.SheetNames[x].length;var g=d.length+p+u.length;for(x=0;x<t.SheetNames.length;++x){var T=i[x]||{};ie(m,133,Tf({pos:g,hs:T.Hidden||0,dt:0,name:t.SheetNames[x]},e)),g+=r[x].length}var b=m.end();if(p!=b.length)throw new Error("BS8 "+p+" != "+b.length);var w=[];return d.length&&w.push(d),b.length&&w.push(b),u.length&&w.push(u),ot(w)}function Xg(t,r){var e=r||{},s=[];t&&!t.SSF&&(t.SSF=Et(Ke)),t&&t.SSF&&(zn(),Mn(t.SSF),e.revssf=Un(t.SSF),e.revssf[t.SSF[65535]]=0,e.ssf=t.SSF),e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,ri(e),e.cellXfs=[],br(e.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={});for(var a=0;a<t.SheetNames.length;++a)s[s.length]=Gg(a,e,t);return s.unshift(Vg(t,s,e)),ot(s)}function Yl(t,r){for(var e=0;e<=t.SheetNames.length;++e){var s=t.Sheets[t.SheetNames[e]];if(!(!s||!s["!ref"])){var a=Rt(s["!ref"]);a.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+t.SheetNames[e]+"' extends beyond column IV (255).  Data may be lost.")}}var i=r||{};switch(i.biff||2){case 8:case 5:return Xg(t,r);case 4:case 3:case 2:return Lg(t,r)}throw new Error("invalid type "+i.bookType+" for BIFF")}function Kg(t,r,e,s){for(var a=t["!merges"]||[],i=[],o=r.s.c;o<=r.e.c;++o){for(var l=0,c=0,h=0;h<a.length;++h)if(!(a[h].s.r>e||a[h].s.c>o)&&!(a[h].e.r<e||a[h].e.c<o)){if(a[h].s.r<e||a[h].s.c<o){l=-1;break}l=a[h].e.r-a[h].s.r+1,c=a[h].e.c-a[h].s.c+1;break}if(!(l<0)){var d=Le({r:e,c:o}),f=s.dense?(t[e]||[])[o]:t[d],u=f&&f.v!=null&&(f.h||Nh(f.w||(lr(f),f.w)||""))||"",m={};l>1&&(m.rowspan=l),c>1&&(m.colspan=c),s.editable?u='<span contenteditable="true">'+u+"</span>":f&&(m["data-t"]=f&&f.t||"z",f.v!=null&&(m["data-v"]=f.v),f.z!=null&&(m["data-z"]=f.z),f.l&&(f.l.Target||"#").charAt(0)!="#"&&(u='<a href="'+f.l.Target+'">'+u+"</a>")),m.id=(s.id||"sjs")+"-"+d,i.push(ae("td",u,m))}}var p="<tr>";return p+i.join("")+"</tr>"}var Yg='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',qg="</body></html>";function Jg(t,r,e){var s=[];return s.join("")+"<table"+(e&&e.id?' id="'+e.id+'"':"")+">"}function ql(t,r){var e=r||{},s=e.header!=null?e.header:Yg,a=e.footer!=null?e.footer:qg,i=[s],o=Rt(t["!ref"]);e.dense=Array.isArray(t),i.push(Jg(t,o,e));for(var l=o.s.r;l<=o.e.r;++l)i.push(Kg(t,o,l,e));return i.push("</table>"+a),i.join("")}function Jl(t,r,e){var s=e||{},a=0,i=0;if(s.origin!=null)if(typeof s.origin=="number")a=s.origin;else{var o=typeof s.origin=="string"?st(s.origin):s.origin;a=o.r,i=o.c}var l=r.getElementsByTagName("tr"),c=Math.min(s.sheetRows||1e7,l.length),h={s:{r:0,c:0},e:{r:a,c:i}};if(t["!ref"]){var d=Rt(t["!ref"]);h.s.r=Math.min(h.s.r,d.s.r),h.s.c=Math.min(h.s.c,d.s.c),h.e.r=Math.max(h.e.r,d.e.r),h.e.c=Math.max(h.e.c,d.e.c),a==-1&&(h.e.r=a=d.e.r+1)}var f=[],u=0,m=t["!rows"]||(t["!rows"]=[]),p=0,x=0,g=0,T=0,b=0,w=0;for(t["!cols"]||(t["!cols"]=[]);p<l.length&&x<c;++p){var A=l[p];if(to(A)){if(s.display)continue;m[x]={hidden:!0}}var _=A.children;for(g=T=0;g<_.length;++g){var L=_[g];if(!(s.display&&to(L))){var E=L.hasAttribute("data-v")?L.getAttribute("data-v"):L.hasAttribute("v")?L.getAttribute("v"):Ch(L.innerHTML),O=L.getAttribute("data-z")||L.getAttribute("z");for(u=0;u<f.length;++u){var F=f[u];F.s.c==T+i&&F.s.r<x+a&&x+a<=F.e.r&&(T=F.e.c+1-i,u=-1)}w=+L.getAttribute("colspan")||1,((b=+L.getAttribute("rowspan")||1)>1||w>1)&&f.push({s:{r:x+a,c:T+i},e:{r:x+a+(b||1)-1,c:T+i+(w||1)-1}});var M={t:"s",v:E},U=L.getAttribute("data-t")||L.getAttribute("t")||"";E!=null&&(E.length==0?M.t=U||"z":s.raw||E.trim().length==0||U=="s"||(E==="TRUE"?M={t:"b",v:!0}:E==="FALSE"?M={t:"b",v:!1}:isNaN(ar(E))?isNaN(Fs(E).getDate())||(M={t:"d",v:wt(E)},s.cellDates||(M={t:"n",v:jt(M.v)}),M.z=s.dateNF||Ke[14]):M={t:"n",v:ar(E)})),M.z===void 0&&O!=null&&(M.z=O);var H="",J=L.getElementsByTagName("A");if(J&&J.length)for(var ge=0;ge<J.length&&!(J[ge].hasAttribute("href")&&(H=J[ge].getAttribute("href"),H.charAt(0)!="#"));++ge);H&&H.charAt(0)!="#"&&(M.l={Target:H}),s.dense?(t[x+a]||(t[x+a]=[]),t[x+a][T+i]=M):t[Le({c:T+i,r:x+a})]=M,h.e.c<T+i&&(h.e.c=T+i),T+=w}}++x}return f.length&&(t["!merges"]=(t["!merges"]||[]).concat(f)),h.e.r=Math.max(h.e.r,x-1+a),t["!ref"]=Je(h),x>=c&&(t["!fullref"]=Je((h.e.r=l.length-p+x-1+a,h))),t}function Ql(t,r){var e=r||{},s=e.dense?[]:{};return Jl(s,t,r)}function Qg(t,r){return Pr(Ql(t,r),r)}function to(t){var r="",e=Zg(t);return e&&(r=e(t).getPropertyValue("display")),r||(r=t.style&&t.style.display),r==="none"}function Zg(t){return t.ownerDocument.defaultView&&typeof t.ownerDocument.defaultView.getComputedStyle=="function"?t.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var e1=function(){var t=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),r="<office:document-styles "+Os({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+t+"</office:document-styles>";return function(){return Qe+r}}(),ro=function(){var t=function(i){return Pe(i).replace(/  +/g,function(o){return'<text:s text:c="'+o.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},r=`          <table:table-cell />
`,e=`          <table:covered-table-cell/>
`,s=function(i,o,l){var c=[];c.push('      <table:table table:name="'+Pe(o.SheetNames[l])+`" table:style-name="ta1">
`);var h=0,d=0,f=Rt(i["!ref"]||"A1"),u=i["!merges"]||[],m=0,p=Array.isArray(i);if(i["!cols"])for(d=0;d<=f.e.c;++d)c.push("        <table:table-column"+(i["!cols"][d]?' table:style-name="co'+i["!cols"][d].ods+'"':"")+`></table:table-column>
`);var x="",g=i["!rows"]||[];for(h=0;h<f.s.r;++h)x=g[h]?' table:style-name="ro'+g[h].ods+'"':"",c.push("        <table:table-row"+x+`></table:table-row>
`);for(;h<=f.e.r;++h){for(x=g[h]?' table:style-name="ro'+g[h].ods+'"':"",c.push("        <table:table-row"+x+`>
`),d=0;d<f.s.c;++d)c.push(r);for(;d<=f.e.c;++d){var T=!1,b={},w="";for(m=0;m!=u.length;++m)if(!(u[m].s.c>d)&&!(u[m].s.r>h)&&!(u[m].e.c<d)&&!(u[m].e.r<h)){(u[m].s.c!=d||u[m].s.r!=h)&&(T=!0),b["table:number-columns-spanned"]=u[m].e.c-u[m].s.c+1,b["table:number-rows-spanned"]=u[m].e.r-u[m].s.r+1;break}if(T){c.push(e);continue}var A=Le({r:h,c:d}),_=p?(i[h]||[])[d]:i[A];if(_&&_.f&&(b["table:formula"]=Pe(bm(_.f)),_.F&&_.F.slice(0,A.length)==A)){var L=Rt(_.F);b["table:number-matrix-columns-spanned"]=L.e.c-L.s.c+1,b["table:number-matrix-rows-spanned"]=L.e.r-L.s.r+1}if(!_){c.push(r);continue}switch(_.t){case"b":w=_.v?"TRUE":"FALSE",b["office:value-type"]="boolean",b["office:boolean-value"]=_.v?"true":"false";break;case"n":w=_.w||String(_.v||0),b["office:value-type"]="float",b["office:value"]=_.v||0;break;case"s":case"str":w=_.v==null?"":_.v,b["office:value-type"]="string";break;case"d":w=_.w||wt(_.v).toISOString(),b["office:value-type"]="date",b["office:date-value"]=wt(_.v).toISOString(),b["table:style-name"]="ce1";break;default:c.push(r);continue}var E=t(w);if(_.l&&_.l.Target){var O=_.l.Target;O=O.charAt(0)=="#"?"#"+wm(O.slice(1)):O,O.charAt(0)!="#"&&!O.match(/^\w+:/)&&(O="../"+O),E=ae("text:a",E,{"xlink:href":O.replace(/&/g,"&amp;")})}c.push("          "+ae("table:table-cell",ae("text:p",E,{}),b)+`
`)}c.push(`        </table:table-row>
`)}return c.push(`      </table:table>
`),c.join("")},a=function(i,o){i.push(` <office:automatic-styles>
`),i.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),i.push(`   <number:month number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:day number:style="long"/>
`),i.push(`   <number:text>/</number:text>
`),i.push(`   <number:year/>
`),i.push(`  </number:date-style>
`);var l=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!cols"]){for(var d=0;d<h["!cols"].length;++d)if(h["!cols"][d]){var f=h["!cols"][d];if(f.width==null&&f.wpx==null&&f.wch==null)continue;Ja(f),f.ods=l;var u=h["!cols"][d].wpx+"px";i.push('  <style:style style:name="co'+l+`" style:family="table-column">
`),i.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+u+`"/>
`),i.push(`  </style:style>
`),++l}}});var c=0;o.SheetNames.map(function(h){return o.Sheets[h]}).forEach(function(h){if(h&&h["!rows"]){for(var d=0;d<h["!rows"].length;++d)if(h["!rows"][d]){h["!rows"][d].ods=c;var f=h["!rows"][d].hpx+"px";i.push('  <style:style style:name="ro'+c+`" style:family="table-row">
`),i.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+f+`"/>
`),i.push(`  </style:style>
`),++c}}}),i.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),i.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),i.push(`  </style:style>
`),i.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),i.push(` </office:automatic-styles>
`)};return function(o,l){var c=[Qe],h=Os({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),d=Os({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});l.bookType=="fods"?(c.push("<office:document"+h+d+`>
`),c.push(ul().replace(/office:document-meta/g,"office:meta"))):c.push("<office:document-content"+h+`>
`),a(c,o),c.push(`  <office:body>
`),c.push(`    <office:spreadsheet>
`);for(var f=0;f!=o.SheetNames.length;++f)c.push(s(o.Sheets[o.SheetNames[f]],o,f));return c.push(`    </office:spreadsheet>
`),c.push(`  </office:body>
`),l.bookType=="fods"?c.push("</office:document>"):c.push("</office:document-content>"),c.join("")}}();function Zl(t,r){if(r.bookType=="fods")return ro(t,r);var e=za(),s="",a=[],i=[];return s="mimetype",Se(e,s,"application/vnd.oasis.opendocument.spreadsheet"),s="content.xml",Se(e,s,ro(t,r)),a.push([s,"text/xml"]),i.push([s,"ContentFile"]),s="styles.xml",Se(e,s,e1(t,r)),a.push([s,"text/xml"]),i.push([s,"StylesFile"]),s="meta.xml",Se(e,s,Qe+ul()),a.push([s,"text/xml"]),i.push([s,"MetadataFile"]),s="manifest.rdf",Se(e,s,ff(i)),a.push([s,"application/rdf+xml"]),s="META-INF/manifest.xml",Se(e,s,df(a)),e}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Tn(t){return new DataView(t.buffer,t.byteOffset,t.byteLength)}function t1(t){return typeof TextEncoder<"u"?new TextEncoder().encode(t):Ht(Ds(t))}function r1(t,r){e:for(var e=0;e<=t.length-r.length;++e){for(var s=0;s<r.length;++s)if(t[e+s]!=r[s])continue e;return!0}return!1}function vr(t){var r=t.reduce(function(a,i){return a+i.length},0),e=new Uint8Array(r),s=0;return t.forEach(function(a){e.set(a,s),s+=a.length}),e}function s1(t,r,e){var s=Math.floor(e==0?0:Math.LOG10E*Math.log(Math.abs(e)))+6176-20,a=e/Math.pow(10,s-6176);t[r+15]|=s>>7,t[r+14]|=(s&127)<<1;for(var i=0;a>=1;++i,a/=256)t[r+i]=a&255;t[r+15]|=e>=0?0:128}function Is(t,r){var e=r?r[0]:0,s=t[e]&127;e:if(t[e++]>=128&&(s|=(t[e]&127)<<7,t[e++]<128||(s|=(t[e]&127)<<14,t[e++]<128)||(s|=(t[e]&127)<<21,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,28),++e,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,35),++e,t[e++]<128)||(s+=(t[e]&127)*Math.pow(2,42),++e,t[e++]<128)))break e;return r&&(r[0]=e),s}function Oe(t){var r=new Uint8Array(7);r[0]=t&127;var e=1;e:if(t>127){if(r[e-1]|=128,r[e]=t>>7&127,++e,t<=16383||(r[e-1]|=128,r[e]=t>>14&127,++e,t<=2097151)||(r[e-1]|=128,r[e]=t>>21&127,++e,t<=268435455)||(r[e-1]|=128,r[e]=t/256>>>21&127,++e,t<=34359738367)||(r[e-1]|=128,r[e]=t/65536>>>21&127,++e,t<=4398046511103))break e;r[e-1]|=128,r[e]=t/16777216>>>21&127,++e}return r.slice(0,e)}function Qr(t){var r=0,e=t[r]&127;e:if(t[r++]>=128){if(e|=(t[r]&127)<<7,t[r++]<128||(e|=(t[r]&127)<<14,t[r++]<128)||(e|=(t[r]&127)<<21,t[r++]<128))break e;e|=(t[r]&127)<<28}return e}function Ze(t){for(var r=[],e=[0];e[0]<t.length;){var s=e[0],a=Is(t,e),i=a&7;a=Math.floor(a/8);var o=0,l;if(a==0)break;switch(i){case 0:{for(var c=e[0];t[e[0]++]>=128;);l=t.slice(c,e[0])}break;case 5:o=4,l=t.slice(e[0],e[0]+o),e[0]+=o;break;case 1:o=8,l=t.slice(e[0],e[0]+o),e[0]+=o;break;case 2:o=Is(t,e),l=t.slice(e[0],e[0]+o),e[0]+=o;break;case 3:case 4:default:throw new Error("PB Type ".concat(i," for Field ").concat(a," at offset ").concat(s))}var h={data:l,type:i};r[a]==null?r[a]=[h]:r[a].push(h)}return r}function at(t){var r=[];return t.forEach(function(e,s){e.forEach(function(a){a.data&&(r.push(Oe(s*8+a.type)),a.type==2&&r.push(Oe(a.data.length)),r.push(a.data))})}),vr(r)}function zt(t){for(var r,e=[],s=[0];s[0]<t.length;){var a=Is(t,s),i=Ze(t.slice(s[0],s[0]+a));s[0]+=a;var o={id:Qr(i[1][0].data),messages:[]};i[2].forEach(function(l){var c=Ze(l.data),h=Qr(c[3][0].data);o.messages.push({meta:c,data:t.slice(s[0],s[0]+h)}),s[0]+=h}),(r=i[3])!=null&&r[0]&&(o.merge=Qr(i[3][0].data)>>>0>0),e.push(o)}return e}function Wr(t){var r=[];return t.forEach(function(e){var s=[];s[1]=[{data:Oe(e.id),type:0}],s[2]=[],e.merge!=null&&(s[3]=[{data:Oe(+!!e.merge),type:0}]);var a=[];e.messages.forEach(function(o){a.push(o.data),o.meta[3]=[{type:0,data:Oe(o.data.length)}],s[2].push({data:at(o.meta),type:2})});var i=at(s);r.push(Oe(i.length)),r.push(i),a.forEach(function(o){return r.push(o)})}),vr(r)}function n1(t,r){if(t!=0)throw new Error("Unexpected Snappy chunk type ".concat(t));for(var e=[0],s=Is(r,e),a=[];e[0]<r.length;){var i=r[e[0]]&3;if(i==0){var o=r[e[0]++]>>2;if(o<60)++o;else{var l=o-59;o=r[e[0]],l>1&&(o|=r[e[0]+1]<<8),l>2&&(o|=r[e[0]+2]<<16),l>3&&(o|=r[e[0]+3]<<24),o>>>=0,o++,e[0]+=l}a.push(r.slice(e[0],e[0]+o)),e[0]+=o;continue}else{var c=0,h=0;if(i==1?(h=(r[e[0]]>>2&7)+4,c=(r[e[0]++]&224)<<3,c|=r[e[0]++]):(h=(r[e[0]++]>>2)+1,i==2?(c=r[e[0]]|r[e[0]+1]<<8,e[0]+=2):(c=(r[e[0]]|r[e[0]+1]<<8|r[e[0]+2]<<16|r[e[0]+3]<<24)>>>0,e[0]+=4)),a=[vr(a)],c==0)throw new Error("Invalid offset 0");if(c>a[0].length)throw new Error("Invalid offset beyond length");if(h>=c)for(a.push(a[0].slice(-c)),h-=c;h>=a[a.length-1].length;)a.push(a[a.length-1]),h-=a[a.length-1].length;a.push(a[0].slice(-c,-c+h))}}var d=vr(a);if(d.length!=s)throw new Error("Unexpected length: ".concat(d.length," != ").concat(s));return d}function Ut(t){for(var r=[],e=0;e<t.length;){var s=t[e++],a=t[e]|t[e+1]<<8|t[e+2]<<16;e+=3,r.push(n1(s,t.slice(e,e+a))),e+=a}if(e!==t.length)throw new Error("data is not a valid framed stream!");return vr(r)}function Gr(t){for(var r=[],e=0;e<t.length;){var s=Math.min(t.length-e,268435455),a=new Uint8Array(4);r.push(a);var i=Oe(s),o=i.length;r.push(i),s<=60?(o++,r.push(new Uint8Array([s-1<<2]))):s<=256?(o+=2,r.push(new Uint8Array([240,s-1&255]))):s<=65536?(o+=3,r.push(new Uint8Array([244,s-1&255,s-1>>8&255]))):s<=16777216?(o+=4,r.push(new Uint8Array([248,s-1&255,s-1>>8&255,s-1>>16&255]))):s<=4294967296&&(o+=5,r.push(new Uint8Array([252,s-1&255,s-1>>8&255,s-1>>16&255,s-1>>>24&255]))),r.push(t.slice(e,e+s)),o+=s,a[0]=0,a[1]=o&255,a[2]=o>>8&255,a[3]=o>>16&255,e+=s}return vr(r)}function la(t,r){var e=new Uint8Array(32),s=Tn(e),a=12,i=0;switch(e[0]=5,t.t){case"n":e[1]=2,s1(e,a,t.v),i|=1,a+=16;break;case"b":e[1]=6,s.setFloat64(a,t.v?1:0,!0),i|=2,a+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[1]=3,s.setUint32(a,r.indexOf(t.v),!0),i|=8,a+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(8,i,!0),e.slice(0,a)}function ca(t,r){var e=new Uint8Array(32),s=Tn(e),a=12,i=0;switch(e[0]=3,t.t){case"n":e[2]=2,s.setFloat64(a,t.v,!0),i|=32,a+=8;break;case"b":e[2]=6,s.setFloat64(a,t.v?1:0,!0),i|=32,a+=8;break;case"s":if(r.indexOf(t.v)==-1)throw new Error("Value ".concat(t.v," missing from SST!"));e[2]=3,s.setUint32(a,r.indexOf(t.v),!0),i|=16,a+=4;break;default:throw"unsupported cell type "+t.t}return s.setUint32(4,i,!0),e.slice(0,a)}function fr(t){var r=Ze(t);return Is(r[1][0].data)}function a1(t,r,e){var s,a,i,o;if(!((s=t[6])!=null&&s[0])||!((a=t[7])!=null&&a[0]))throw"Mutation only works on post-BNC storages!";var l=((o=(i=t[8])==null?void 0:i[0])==null?void 0:o.data)&&Qr(t[8][0].data)>0||!1;if(l)throw"Math only works with normal offsets";for(var c=0,h=Tn(t[7][0].data),d=0,f=[],u=Tn(t[4][0].data),m=0,p=[],x=0;x<r.length;++x){if(r[x]==null){h.setUint16(x*2,65535,!0),u.setUint16(x*2,65535);continue}h.setUint16(x*2,d,!0),u.setUint16(x*2,m,!0);var g,T;switch(typeof r[x]){case"string":g=la({t:"s",v:r[x]},e),T=ca({t:"s",v:r[x]},e);break;case"number":g=la({t:"n",v:r[x]},e),T=ca({t:"n",v:r[x]},e);break;case"boolean":g=la({t:"b",v:r[x]},e),T=ca({t:"b",v:r[x]},e);break;default:throw new Error("Unsupported value "+r[x])}f.push(g),d+=g.length,p.push(T),m+=T.length,++c}for(t[2][0].data=Oe(c);x<t[7][0].data.length/2;++x)h.setUint16(x*2,65535,!0),u.setUint16(x*2,65535,!0);return t[6][0].data=vr(f),t[3][0].data=vr(p),c}function i1(t,r){if(!r||!r.numbers)throw new Error("Must pass a `numbers` option -- check the README");var e=t.Sheets[t.SheetNames[0]];t.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var s=Rt(e["!ref"]);s.s.r=s.s.c=0;var a=!1;s.e.c>9&&(a=!0,s.e.c=9),s.e.r>49&&(a=!0,s.e.r=49),a&&console.error("The Numbers writer is currently limited to ".concat(Je(s)));var i=Cn(e,{range:s,header:1}),o=["~Sh33tJ5~"];i.forEach(function(I){return I.forEach(function(D){typeof D=="string"&&o.push(D)})});var l={},c=[],h=Me.read(r.numbers,{type:"base64"});h.FileIndex.map(function(I,D){return[I,h.FullPaths[D]]}).forEach(function(I){var D=I[0],y=I[1];if(D.type==2&&D.name.match(/\.iwa/)){var z=D.content,B=Ut(z),Q=zt(B);Q.forEach(function(te){c.push(te.id),l[te.id]={deps:[],location:y,type:Qr(te.messages[0].meta[1][0].data)}})}}),c.sort(function(I,D){return I-D});var d=c.filter(function(I){return I>1}).map(function(I){return[I,Oe(I)]});h.FileIndex.map(function(I,D){return[I,h.FullPaths[D]]}).forEach(function(I){var D=I[0];if(I[1],!!D.name.match(/\.iwa/)){var y=zt(Ut(D.content));y.forEach(function(z){z.messages.forEach(function(B){d.forEach(function(Q){z.messages.some(function(te){return Qr(te.meta[1][0].data)!=11006&&r1(te.data,Q[1])})&&l[Q[0]].deps.push(z.id)})})})}});for(var f=Me.find(h,l[1].location),u=zt(Ut(f.content)),m,p=0;p<u.length;++p){var x=u[p];x.id==1&&(m=x)}var g=fr(Ze(m.messages[0].data)[1][0].data);for(f=Me.find(h,l[g].location),u=zt(Ut(f.content)),p=0;p<u.length;++p)x=u[p],x.id==g&&(m=x);for(g=fr(Ze(m.messages[0].data)[2][0].data),f=Me.find(h,l[g].location),u=zt(Ut(f.content)),p=0;p<u.length;++p)x=u[p],x.id==g&&(m=x);for(g=fr(Ze(m.messages[0].data)[2][0].data),f=Me.find(h,l[g].location),u=zt(Ut(f.content)),p=0;p<u.length;++p)x=u[p],x.id==g&&(m=x);var T=Ze(m.messages[0].data);{T[6][0].data=Oe(s.e.r+1),T[7][0].data=Oe(s.e.c+1);var b=fr(T[46][0].data),w=Me.find(h,l[b].location),A=zt(Ut(w.content));{for(var _=0;_<A.length&&A[_].id!=b;++_);if(A[_].id!=b)throw"Bad ColumnRowUIDMapArchive";var L=Ze(A[_].messages[0].data);L[1]=[],L[2]=[],L[3]=[];for(var E=0;E<=s.e.c;++E){var O=[];O[1]=O[2]=[{type:0,data:Oe(E+420690)}],L[1].push({type:2,data:at(O)}),L[2].push({type:0,data:Oe(E)}),L[3].push({type:0,data:Oe(E)})}L[4]=[],L[5]=[],L[6]=[];for(var F=0;F<=s.e.r;++F)O=[],O[1]=O[2]=[{type:0,data:Oe(F+726270)}],L[4].push({type:2,data:at(O)}),L[5].push({type:0,data:Oe(F)}),L[6].push({type:0,data:Oe(F)});A[_].messages[0].data=at(L)}w.content=Gr(Wr(A)),w.size=w.content.length,delete T[46];var M=Ze(T[4][0].data);{M[7][0].data=Oe(s.e.r+1);var U=Ze(M[1][0].data),H=fr(U[2][0].data);w=Me.find(h,l[H].location),A=zt(Ut(w.content));{if(A[0].id!=H)throw"Bad HeaderStorageBucket";var J=Ze(A[0].messages[0].data);for(F=0;F<i.length;++F){var ge=Ze(J[2][0].data);ge[1][0].data=Oe(F),ge[4][0].data=Oe(i[F].length),J[2][F]={type:J[2][0].type,data:at(ge)}}A[0].messages[0].data=at(J)}w.content=Gr(Wr(A)),w.size=w.content.length;var xe=fr(M[2][0].data);w=Me.find(h,l[xe].location),A=zt(Ut(w.content));{if(A[0].id!=xe)throw"Bad HeaderStorageBucket";for(J=Ze(A[0].messages[0].data),E=0;E<=s.e.c;++E)ge=Ze(J[2][0].data),ge[1][0].data=Oe(E),ge[4][0].data=Oe(s.e.r+1),J[2][E]={type:J[2][0].type,data:at(ge)};A[0].messages[0].data=at(J)}w.content=Gr(Wr(A)),w.size=w.content.length;var Ee=fr(M[4][0].data);(function(){for(var I=Me.find(h,l[Ee].location),D=zt(Ut(I.content)),y,z=0;z<D.length;++z){var B=D[z];B.id==Ee&&(y=B)}var Q=Ze(y.messages[0].data);{Q[3]=[];var te=[];o.forEach(function(V,pe){te[1]=[{type:0,data:Oe(pe)}],te[2]=[{type:0,data:Oe(1)}],te[3]=[{type:2,data:t1(V)}],Q[3].push({type:2,data:at(te)})})}y.messages[0].data=at(Q);var re=Wr(D),ve=Gr(re);I.content=ve,I.size=I.content.length})();var be=Ze(M[3][0].data);{var Te=be[1][0];delete be[2];var le=Ze(Te.data);{var ue=fr(le[2][0].data);(function(){for(var I=Me.find(h,l[ue].location),D=zt(Ut(I.content)),y,z=0;z<D.length;++z){var B=D[z];B.id==ue&&(y=B)}var Q=Ze(y.messages[0].data);{delete Q[6],delete be[7];var te=new Uint8Array(Q[5][0].data);Q[5]=[];for(var re=0,ve=0;ve<=s.e.r;++ve){var V=Ze(te);re+=a1(V,i[ve],o),V[1][0].data=Oe(ve),Q[5].push({data:at(V),type:2})}Q[1]=[{type:0,data:Oe(s.e.c+1)}],Q[2]=[{type:0,data:Oe(s.e.r+1)}],Q[3]=[{type:0,data:Oe(re)}],Q[4]=[{type:0,data:Oe(s.e.r+1)}]}y.messages[0].data=at(Q);var pe=Wr(D),he=Gr(pe);I.content=he,I.size=I.content.length})()}Te.data=at(le)}M[3][0].data=at(be)}T[4][0].data=at(M)}m.messages[0].data=at(T);var _e=Wr(u),S=Gr(_e);return f.content=S,f.size=f.content.length,h}function o1(t){return function(e){for(var s=0;s!=t.length;++s){var a=t[s];e[a[0]]===void 0&&(e[a[0]]=a[1]),a[2]==="n"&&(e[a[0]]=Number(e[a[0]]))}}}function ri(t){o1([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(t)}function l1(t,r){return r.bookType=="ods"?Zl(t,r):r.bookType=="numbers"?i1(t,r):r.bookType=="xlsb"?c1(t,r):d1(t,r)}function c1(t,r){Kr=1024,t&&!t.SSF&&(t.SSF=Et(Ke)),t&&t.SSF&&(zn(),Mn(t.SSF),r.revssf=Un(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Es?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e=r.bookType=="xlsb"?"bin":"xml",s=Il.indexOf(r.bookType)>-1,a=dl();ri(r=r||{});var i=za(),o="",l=0;if(r.cellXfs=[],br(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Se(i,o,xl(t.Props,r)),a.coreprops.push(o),Ie(r.rels,2,o,Ce.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&c.push(t.SheetNames[h]);t.Props.SheetNames=c}for(t.Props.Worksheets=t.Props.SheetNames.length,Se(i,o,pl(t.Props)),a.extprops.push(o),Ie(r.rels,3,o,Ce.EXT_PROPS),t.Custprops!==t.Props&&dt(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Se(i,o,gl(t.Custprops)),a.custprops.push(o),Ie(r.rels,4,o,Ce.CUST_PROPS)),l=1;l<=t.SheetNames.length;++l){var d={"!id":{}},f=t.Sheets[t.SheetNames[l-1]],u=(f||{})["!type"]||"sheet";switch(u){case"chart":default:o="xl/worksheets/sheet"+l+"."+e,Se(i,o,fg(l-1,o,r,t,d)),a.sheets.push(o),Ie(r.wbrels,-1,"worksheets/sheet"+l+"."+e,Ce.WS[0])}if(f){var m=f["!comments"],p=!1,x="";m&&m.length>0&&(x="xl/comments"+l+"."+e,Se(i,x,mg(m,x)),a.comments.push(x),Ie(d,-1,"../comments"+l+"."+e,Ce.CMNT),p=!0),f["!legacy"]&&p&&Se(i,"xl/drawings/vmlDrawing"+l+".vml",Dl(l,f["!comments"])),delete f["!comments"],delete f["!legacy"]}d["!id"].rId1&&Se(i,fl(o),qr(d))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+e,Se(i,o,xg(r.Strings,o,r)),a.strs.push(o),Ie(r.wbrels,-1,"sharedStrings."+e,Ce.SST)),o="xl/workbook."+e,Se(i,o,hg(t,o)),a.workbooks.push(o),Ie(r.rels,1,o,Ce.WB),o="xl/theme/theme1.xml",Se(i,o,Rl(t.Themes,r)),a.themes.push(o),Ie(r.wbrels,-1,"theme/theme1.xml",Ce.THEME),o="xl/styles."+e,Se(i,o,ug(t,o,r)),a.styles.push(o),Ie(r.wbrels,-1,"styles."+e,Ce.STY),t.vbaraw&&s&&(o="xl/vbaProject.bin",Se(i,o,t.vbaraw),a.vba.push(o),Ie(r.wbrels,-1,"vbaProject.bin",Ce.VBA)),o="xl/metadata."+e,Se(i,o,pg(o)),a.metadata.push(o),Ie(r.wbrels,-1,"metadata."+e,Ce.XLMETA),Se(i,"[Content_Types].xml",hl(a,r)),Se(i,"_rels/.rels",qr(r.rels)),Se(i,"xl/_rels/workbook."+e+".rels",qr(r.wbrels)),delete r.revssf,delete r.ssf,i}function d1(t,r){Kr=1024,t&&!t.SSF&&(t.SSF=Et(Ke)),t&&t.SSF&&(zn(),Mn(t.SSF),r.revssf=Un(t.SSF),r.revssf[t.SSF[65535]]=0,r.ssf=t.SSF),r.rels={},r.wbrels={},r.Strings=[],r.Strings.Count=0,r.Strings.Unique=0,Es?r.revStrings=new Map:(r.revStrings={},r.revStrings.foo=[],delete r.revStrings.foo);var e="xml",s=Il.indexOf(r.bookType)>-1,a=dl();ri(r=r||{});var i=za(),o="",l=0;if(r.cellXfs=[],br(r.cellXfs,{},{revssf:{General:0}}),t.Props||(t.Props={}),o="docProps/core.xml",Se(i,o,xl(t.Props,r)),a.coreprops.push(o),Ie(r.rels,2,o,Ce.CORE_PROPS),o="docProps/app.xml",!(t.Props&&t.Props.SheetNames))if(!t.Workbook||!t.Workbook.Sheets)t.Props.SheetNames=t.SheetNames;else{for(var c=[],h=0;h<t.SheetNames.length;++h)(t.Workbook.Sheets[h]||{}).Hidden!=2&&c.push(t.SheetNames[h]);t.Props.SheetNames=c}t.Props.Worksheets=t.Props.SheetNames.length,Se(i,o,pl(t.Props)),a.extprops.push(o),Ie(r.rels,3,o,Ce.EXT_PROPS),t.Custprops!==t.Props&&dt(t.Custprops||{}).length>0&&(o="docProps/custom.xml",Se(i,o,gl(t.Custprops)),a.custprops.push(o),Ie(r.rels,4,o,Ce.CUST_PROPS));var d=["SheetJ5"];for(r.tcid=0,l=1;l<=t.SheetNames.length;++l){var f={"!id":{}},u=t.Sheets[t.SheetNames[l-1]],m=(u||{})["!type"]||"sheet";switch(m){case"chart":default:o="xl/worksheets/sheet"+l+"."+e,Se(i,o,Wl(l-1,r,t,f)),a.sheets.push(o),Ie(r.wbrels,-1,"worksheets/sheet"+l+"."+e,Ce.WS[0])}if(u){var p=u["!comments"],x=!1,g="";if(p&&p.length>0){var T=!1;p.forEach(function(b){b[1].forEach(function(w){w.T==!0&&(T=!0)})}),T&&(g="xl/threadedComments/threadedComment"+l+"."+e,Se(i,g,Uu(p,d,r)),a.threadedcomments.push(g),Ie(f,-1,"../threadedComments/threadedComment"+l+"."+e,Ce.TCMNT)),g="xl/comments"+l+"."+e,Se(i,g,Ol(p)),a.comments.push(g),Ie(f,-1,"../comments"+l+"."+e,Ce.CMNT),x=!0}u["!legacy"]&&x&&Se(i,"xl/drawings/vmlDrawing"+l+".vml",Dl(l,u["!comments"])),delete u["!comments"],delete u["!legacy"]}f["!id"].rId1&&Se(i,fl(o),qr(f))}return r.Strings!=null&&r.Strings.length>0&&(o="xl/sharedStrings."+e,Se(i,o,jl(r.Strings,r)),a.strs.push(o),Ie(r.wbrels,-1,"sharedStrings."+e,Ce.SST)),o="xl/workbook."+e,Se(i,o,Xl(t)),a.workbooks.push(o),Ie(r.rels,1,o,Ce.WB),o="xl/theme/theme1.xml",Se(i,o,Rl(t.Themes,r)),a.themes.push(o),Ie(r.wbrels,-1,"theme/theme1.xml",Ce.THEME),o="xl/styles."+e,Se(i,o,kl(t,r)),a.styles.push(o),Ie(r.wbrels,-1,"styles."+e,Ce.STY),t.vbaraw&&s&&(o="xl/vbaProject.bin",Se(i,o,t.vbaraw),a.vba.push(o),Ie(r.wbrels,-1,"vbaProject.bin",Ce.VBA)),o="xl/metadata."+e,Se(i,o,Fl()),a.metadata.push(o),Ie(r.wbrels,-1,"metadata."+e,Ce.XLMETA),d.length>1&&(o="xl/persons/person.xml",Se(i,o,$u(d)),a.people.push(o),Ie(r.wbrels,-1,"persons/person.xml",Ce.PEOPLE)),Se(i,"[Content_Types].xml",hl(a,r)),Se(i,"_rels/.rels",qr(r.rels)),Se(i,"xl/_rels/workbook."+e+".rels",qr(r.wbrels)),delete r.revssf,delete r.ssf,i}function h1(t,r){var e="";switch((r||{}).type||"base64"){case"buffer":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];case"base64":e=or(t.slice(0,12));break;case"binary":e=t;break;case"array":return[t[0],t[1],t[2],t[3],t[4],t[5],t[6],t[7]];default:throw new Error("Unrecognized type "+(r&&r.type||"undefined"))}return[e.charCodeAt(0),e.charCodeAt(1),e.charCodeAt(2),e.charCodeAt(3),e.charCodeAt(4),e.charCodeAt(5),e.charCodeAt(6),e.charCodeAt(7)]}function ec(t,r){switch(r.type){case"base64":case"binary":break;case"buffer":case"array":r.type="";break;case"file":return Us(r.file,Me.write(t,{type:Re?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");default:throw new Error("Unrecognized type "+r.type)}return Me.write(t,r)}function f1(t,r){var e=Et(r||{}),s=l1(t,e);return u1(s,e)}function u1(t,r){var e={},s=Re?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(r.compression&&(e.compression="DEFLATE"),r.password)e.type=s;else switch(r.type){case"base64":e.type="base64";break;case"binary":e.type="string";break;case"string":throw new Error("'string' output type invalid for '"+r.bookType+"' files");case"buffer":case"file":e.type=s;break;default:throw new Error("Unrecognized type "+r.type)}var a=t.FullPaths?Me.write(t,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[e.type]||e.type,compression:!!r.compression}):t.generate(e);if(typeof Deno<"u"&&typeof a=="string"){if(r.type=="binary"||r.type=="base64")return a;a=new Uint8Array(Bn(a))}return r.password&&typeof encrypt_agile<"u"?ec(encrypt_agile(a,r.password),r):r.type==="file"?Us(r.file,a):r.type=="string"?_s(a):a}function x1(t,r){var e=r||{},s=Ag(t,e);return ec(s,e)}function qt(t,r,e){e||(e="");var s=e+t;switch(r.type){case"base64":return Rs(Ds(s));case"binary":return Ds(s);case"string":return t;case"file":return Us(r.file,s,"utf8");case"buffer":return Re?cr(s,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(s):qt(s,{type:"binary"}).split("").map(function(a){return a.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function m1(t,r){switch(r.type){case"base64":return Rs(t);case"binary":return t;case"string":return t;case"file":return Us(r.file,t,"binary");case"buffer":return Re?cr(t,"binary"):t.split("").map(function(e){return e.charCodeAt(0)})}throw new Error("Unrecognized type "+r.type)}function nn(t,r){switch(r.type){case"string":case"base64":case"binary":for(var e="",s=0;s<t.length;++s)e+=String.fromCharCode(t[s]);return r.type=="base64"?Rs(e):r.type=="string"?_s(e):e;case"file":return Us(r.file,t);case"buffer":return t;default:throw new Error("Unrecognized type "+r.type)}}function tc(t,r){$d(),eg(t);var e=Et(r||{});if(e.cellStyles&&(e.cellNF=!0,e.sheetStubs=!0),e.type=="array"){e.type="binary";var s=tc(t,e);return e.type="array",Bn(s)}var a=0;if(e.sheet&&(typeof e.sheet=="number"?a=e.sheet:a=t.SheetNames.indexOf(e.sheet),!t.SheetNames[a]))throw new Error("Sheet not found: "+e.sheet+" : "+typeof e.sheet);switch(e.bookType||"xlsb"){case"xml":case"xlml":return qt(Cg(t,e),e);case"slk":case"sylk":return qt(Jf.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"htm":case"html":return qt(ql(t.Sheets[t.SheetNames[a]],e),e);case"txt":return m1(sc(t.Sheets[t.SheetNames[a]],e),e);case"csv":return qt(si(t.Sheets[t.SheetNames[a]],e),e,"\uFEFF");case"dif":return qt(Qf.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"dbf":return nn(qf.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"prn":return qt(Zf.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"rtf":return qt(iu.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"eth":return qt(Nl.from_sheet(t.Sheets[t.SheetNames[a]],e),e);case"fods":return qt(Zl(t,e),e);case"wk1":return nn(Yi.sheet_to_wk1(t.Sheets[t.SheetNames[a]],e),e);case"wk3":return nn(Yi.book_to_wk3(t,e),e);case"biff2":e.biff||(e.biff=2);case"biff3":e.biff||(e.biff=3);case"biff4":return e.biff||(e.biff=4),nn(Yl(t,e),e);case"biff5":e.biff||(e.biff=5);case"biff8":case"xla":case"xls":return e.biff||(e.biff=8),x1(t,e);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return f1(t,e);default:throw new Error("Unrecognized bookType |"+e.bookType+"|")}}function p1(t){if(!t.bookType){var r={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},e=t.file.slice(t.file.lastIndexOf(".")).toLowerCase();e.match(/^\.[a-z]+$/)&&(t.bookType=e.slice(1)),t.bookType=r[t.bookType]||t.bookType}}function rc(t,r,e){var s={};return s.type="file",s.file=r,p1(s),tc(t,s)}function g1(t,r,e,s,a,i,o,l){var c=ct(e),h=l.defval,d=l.raw||!Object.prototype.hasOwnProperty.call(l,"raw"),f=!0,u=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(u,"__rowNum__",{value:e,enumerable:!1})}catch{u.__rowNum__=e}else u.__rowNum__=e;if(!o||t[e])for(var m=r.s.c;m<=r.e.c;++m){var p=o?t[e][m]:t[s[m]+c];if(p===void 0||p.t===void 0){if(h===void 0)continue;i[m]!=null&&(u[i[m]]=h);continue}var x=p.v;switch(p.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+p.t)}if(i[m]!=null){if(x==null)if(p.t=="e"&&x===null)u[i[m]]=null;else if(h!==void 0)u[i[m]]=h;else if(d&&x===null)u[i[m]]=null;else continue;else u[i[m]]=d&&(p.t!=="n"||p.t==="n"&&l.rawNumbers!==!1)?x:lr(p,x,l);x!=null&&(f=!1)}}return{row:u,isempty:f}}function Cn(t,r){if(t==null||t["!ref"]==null)return[];var e={t:"n",v:0},s=0,a=1,i=[],o=0,l="",c={s:{r:0,c:0},e:{r:0,c:0}},h=r||{},d=h.range!=null?h.range:t["!ref"];switch(h.header===1?s=1:h.header==="A"?s=2:Array.isArray(h.header)?s=3:h.header==null&&(s=0),typeof d){case"string":c=Ue(d);break;case"number":c=Ue(t["!ref"]),c.s.r=d;break;default:c=d}s>0&&(a=0);var f=ct(c.s.r),u=[],m=[],p=0,x=0,g=Array.isArray(t),T=c.s.r,b=0,w={};g&&!t[T]&&(t[T]=[]);var A=h.skipHidden&&t["!cols"]||[],_=h.skipHidden&&t["!rows"]||[];for(b=c.s.c;b<=c.e.c;++b)if(!(A[b]||{}).hidden)switch(u[b]=ut(b),e=g?t[T][b]:t[u[b]+f],s){case 1:i[b]=b-c.s.c;break;case 2:i[b]=u[b];break;case 3:i[b]=h.header[b-c.s.c];break;default:if(e==null&&(e={w:"__EMPTY",t:"s"}),l=o=lr(e,null,h),x=w[o]||0,!x)w[o]=1;else{do l=o+"_"+x++;while(w[l]);w[o]=x,w[l]=1}i[b]=l}for(T=c.s.r+a;T<=c.e.r;++T)if(!(_[T]||{}).hidden){var L=g1(t,c,T,u,s,i,g,h);(L.isempty===!1||(s===1?h.blankrows!==!1:h.blankrows))&&(m[p++]=L.row)}return m.length=p,m}var so=/"/g;function v1(t,r,e,s,a,i,o,l){for(var c=!0,h=[],d="",f=ct(e),u=r.s.c;u<=r.e.c;++u)if(s[u]){var m=l.dense?(t[e]||[])[u]:t[s[u]+f];if(m==null)d="";else if(m.v!=null){c=!1,d=""+(l.rawNumbers&&m.t=="n"?m.v:lr(m,null,l));for(var p=0,x=0;p!==d.length;++p)if((x=d.charCodeAt(p))===a||x===i||x===34||l.forceQuotes){d='"'+d.replace(so,'""')+'"';break}d=="ID"&&(d='"ID"')}else m.f!=null&&!m.F?(c=!1,d="="+m.f,d.indexOf(",")>=0&&(d='"'+d.replace(so,'""')+'"')):d="";h.push(d)}return l.blankrows===!1&&c?null:h.join(o)}function si(t,r){var e=[],s=r??{};if(t==null||t["!ref"]==null)return"";var a=Ue(t["!ref"]),i=s.FS!==void 0?s.FS:",",o=i.charCodeAt(0),l=s.RS!==void 0?s.RS:`
`,c=l.charCodeAt(0),h=new RegExp((i=="|"?"\\|":i)+"+$"),d="",f=[];s.dense=Array.isArray(t);for(var u=s.skipHidden&&t["!cols"]||[],m=s.skipHidden&&t["!rows"]||[],p=a.s.c;p<=a.e.c;++p)(u[p]||{}).hidden||(f[p]=ut(p));for(var x=0,g=a.s.r;g<=a.e.r;++g)(m[g]||{}).hidden||(d=v1(t,a,g,f,o,c,i,s),d!=null&&(s.strip&&(d=d.replace(h,"")),(d||s.blankrows!==!1)&&e.push((x++?l:"")+d)));return delete s.dense,e.join("")}function sc(t,r){r||(r={}),r.FS="	",r.RS=`
`;var e=si(t,r);return e}function y1(t){var r="",e,s="";if(t==null||t["!ref"]==null)return[];var a=Ue(t["!ref"]),i="",o=[],l,c=[],h=Array.isArray(t);for(l=a.s.c;l<=a.e.c;++l)o[l]=ut(l);for(var d=a.s.r;d<=a.e.r;++d)for(i=ct(d),l=a.s.c;l<=a.e.c;++l)if(r=o[l]+i,e=h?(t[d]||[])[l]:t[r],s="",e!==void 0){if(e.F!=null){if(r=e.F,!e.f)continue;s=e.f,r.indexOf(":")==-1&&(r=r+":"+r)}if(e.f!=null)s=e.f;else{if(e.t=="z")continue;if(e.t=="n"&&e.v!=null)s=""+e.v;else if(e.t=="b")s=e.v?"TRUE":"FALSE";else if(e.w!==void 0)s="'"+e.w;else{if(e.v===void 0)continue;e.t=="s"?s="'"+e.v:s=""+e.v}}c[c.length]=r+"="+s}return c}function nc(t,r,e){var s=e||{},a=+!s.skipHeader,i=t||{},o=0,l=0;if(i&&s.origin!=null)if(typeof s.origin=="number")o=s.origin;else{var c=typeof s.origin=="string"?st(s.origin):s.origin;o=c.r,l=c.c}var h,d={s:{c:0,r:0},e:{c:l,r:o+r.length-1+a}};if(i["!ref"]){var f=Ue(i["!ref"]);d.e.c=Math.max(d.e.c,f.e.c),d.e.r=Math.max(d.e.r,f.e.r),o==-1&&(o=f.e.r+1,d.e.r=o+r.length-1+a)}else o==-1&&(o=0,d.e.r=r.length-1+a);var u=s.header||[],m=0;r.forEach(function(x,g){dt(x).forEach(function(T){(m=u.indexOf(T))==-1&&(u[m=u.length]=T);var b=x[T],w="z",A="",_=Le({c:l+m,r:o+g+a});h=Ps(i,_),b&&typeof b=="object"&&!(b instanceof Date)?i[_]=b:(typeof b=="number"?w="n":typeof b=="boolean"?w="b":typeof b=="string"?w="s":b instanceof Date?(w="d",s.cellDates||(w="n",b=jt(b)),A=s.dateNF||Ke[14]):b===null&&s.nullError&&(w="e",b=0),h?(h.t=w,h.v=b,delete h.w,delete h.R,A&&(h.z=A)):i[_]=h={t:w,v:b},A&&(h.z=A))})}),d.e.c=Math.max(d.e.c,l+u.length-1);var p=ct(o);if(a)for(m=0;m<u.length;++m)i[ut(m+l)+p]={t:"s",v:u[m]};return i["!ref"]=Je(d),i}function b1(t,r){return nc(null,t,r)}function Ps(t,r,e){if(typeof r=="string"){if(Array.isArray(t)){var s=st(r);return t[s.r]||(t[s.r]=[]),t[s.r][s.c]||(t[s.r][s.c]={t:"z"})}return t[r]||(t[r]={t:"z"})}return typeof r!="number"?Ps(t,Le(r)):Ps(t,Le({r,c:e||0}))}function w1(t,r){if(typeof r=="number"){if(r>=0&&t.SheetNames.length>r)return r;throw new Error("Cannot find sheet # "+r)}else if(typeof r=="string"){var e=t.SheetNames.indexOf(r);if(e>-1)return e;throw new Error("Cannot find sheet name |"+r+"|")}else throw new Error("Cannot find sheet |"+r+"|")}function _1(){return{SheetNames:[],Sheets:{}}}function S1(t,r,e,s){var a=1;if(!e)for(;a<=65535&&t.SheetNames.indexOf(e="Sheet"+a)!=-1;++a,e=void 0);if(!e||t.SheetNames.length>=65535)throw new Error("Too many worksheets");if(s&&t.SheetNames.indexOf(e)>=0){var i=e.match(/(^.*?)(\d+)$/);a=i&&+i[2]||0;var o=i&&i[1]||e;for(++a;a<=65535&&t.SheetNames.indexOf(e=o+a)!=-1;++a);}if(Vl(e),t.SheetNames.indexOf(e)>=0)throw new Error("Worksheet with name |"+e+"| already exists!");return t.SheetNames.push(e),t.Sheets[e]=r,e}function N1(t,r,e){t.Workbook||(t.Workbook={}),t.Workbook.Sheets||(t.Workbook.Sheets=[]);var s=w1(t,r);switch(t.Workbook.Sheets[s]||(t.Workbook.Sheets[s]={}),e){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+e)}t.Workbook.Sheets[s].Hidden=e}function j1(t,r){return t.z=r,t}function ac(t,r,e){return r?(t.l={Target:r},e&&(t.l.Tooltip=e)):delete t.l,t}function E1(t,r,e){return ac(t,"#"+r,e)}function T1(t,r,e){t.c||(t.c=[]),t.c.push({t:r,a:e||"SheetJS"})}function C1(t,r,e,s){for(var a=typeof r!="string"?r:Ue(r),i=typeof r=="string"?r:Je(r),o=a.s.r;o<=a.e.r;++o)for(var l=a.s.c;l<=a.e.c;++l){var c=Ps(t,o,l);c.t="n",c.F=i,delete c.v,o==a.s.r&&l==a.s.c&&(c.f=e,s&&(c.D=!0))}return t}var Zr={encode_col:ut,encode_row:ct,encode_cell:Le,encode_range:Je,decode_col:Va,decode_row:Ga,split_cell:$h,decode_cell:st,decode_range:Rt,format_cell:lr,sheet_add_aoa:nl,sheet_add_json:nc,sheet_add_dom:Jl,aoa_to_sheet:ls,json_to_sheet:b1,table_to_sheet:Ql,table_to_book:Qg,sheet_to_csv:si,sheet_to_txt:sc,sheet_to_json:Cn,sheet_to_html:ql,sheet_to_formulae:y1,sheet_to_row_object_array:Cn,sheet_get_cell:Ps,book_new:_1,book_append_sheet:S1,book_set_sheet_visibility:N1,cell_set_number_format:j1,cell_set_hyperlink:ac,cell_set_internal_link:E1,cell_add_comment:T1,sheet_set_array_formula:C1,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function k1({user:t,onNavigate:r}){const[e,s]=P.useState([]),[a,i]=P.useState([]),[o,l]=P.useState(!1),[c,h]=P.useState(""),[d,f]=P.useState(""),[u,m]=P.useState("all"),[p,x]=P.useState(""),[g,T]=P.useState(""),[b,w]=P.useState([]),[A,_]=P.useState(!1),[L,E]=P.useState(30),[O,F]=P.useState(1),[M,U]=P.useState({name:"",branch:"",phone:"",user_type:""});P.useEffect(()=>{H(),J()},[]);const H=async()=>{try{const{data:y,error:z}=await ce.from("branches").select("*").order("name",{ascending:!0});if(z)throw z;i(y||[])}catch(y){console.error("   :",y)}},J=async()=>{l(!0);try{let y=ce.from("users").select("*").order("created_at",{ascending:!1});ts(t)||(y=y.eq("branch",t.branch));const{data:z,error:B}=await y;if(B)throw B;s(z||[])}catch(y){console.error("  :",y),alert("   .")}finally{l(!1)}},ge=async(y,z)=>{const B=z?"":"";if(window.confirm(`  ${B}?`))try{const Q={status:z?"approved":"rejected"};if(z){const{data:re}=await ce.from("users").select("referral_code").eq("id",y).single();if(!re?.referral_code){const{data:ve}=await ce.from("users").select("referral_code").not("referral_code","is",null).order("referral_code",{ascending:!1}).limit(1),V=ve?.[0]?.referral_code||"LAS0000",he=parseInt(V.replace("LAS",""))+1;Q.referral_code=`LAS${String(he).padStart(4,"0")}`}}const{error:te}=await ce.from("users").update(Q).eq("id",y);if(te)throw te;alert(`${B}.`),J()}catch(Q){console.error("/ :",Q),alert(`${B}  .`)}},xe=async y=>{if(window.confirm("   ?"))try{const{error:z}=await ce.from("users").delete().eq("id",y);if(z)throw z;alert("."),J()}catch(z){console.error(" :",z),alert(" .")}},Ee=y=>{U({id:y.id,name:y.name,branch:y.branch,phone:y.phone,user_type:y.user_type}),_(!0)},be=async()=>{if(M.id&&window.confirm("  ?"))try{const{error:y}=await ce.from("users").update({name:M.name,phone:M.phone,branch:M.branch,user_type:M.user_type}).eq("id",M.id);if(y)throw y;alert("."),_(!1),J()}catch(y){console.error(" :",y),alert(" .")}},Te=y=>{w(z=>z.includes(y)?z.filter(B=>B!==y):[...z,y])},le=async()=>{if(b.length===0){alert("  .");return}try{l(!0);const y=e.filter(ve=>b.includes(ve.id)),z=await Promise.all(y.map(async ve=>{const V=p||new Date(ve.created_at).toISOString().split("T")[0],pe=g||new Date().toISOString().split("T")[0],{data:he,error:De}=await ce.from("work_diaries").select("work_hours").eq("user_id",ve.id).gte("work_date",V).lte("work_date",pe);De&&console.error(`   (user_id: ${ve.id}):`,De);const Ne=he?.reduce((ht,_t)=>ht+(parseFloat(_t.work_hours)||0),0)||0,de=ve.ssn?ve.ssn.substring(0,6)+"-*******":"-",je=ve.account_number?ve.account_number.substring(0,ve.account_number.length-4)+"****":"-";return{:ve.branch||"-",:ve.name||"-",:ve.phone||"-",:ve.user_type||"-",:new Date(V).toLocaleDateString("ko-KR"),:new Date(pe).toLocaleDateString("ko-KR"),:`${Ne.toFixed(1)}`,:de,:ve.account_holder||"-",:ve.bank_name||"-",:je}})),B=Zr.json_to_sheet(z),Q=Zr.book_new();Zr.book_append_sheet(Q,B,"");const re=`_${(p&&g?`${p}_${g}`:`_${new Date().toISOString().split("T")[0]}`).replace(/-/g,"")}.xlsx`;rc(Q,re)}catch(y){console.error("  :",y),alert("     .")}finally{l(!1)}},ue=e.filter(y=>{const z=y.name?.toLowerCase().includes(c.toLowerCase())||y.email?.toLowerCase().includes(c.toLowerCase()),B=!d||y.branch===d,Q=u==="all"||y.user_type===u;let te=!0;if(p||g){const re=new Date(y.created_at);p&&(te=te&&re>=new Date(p)),g&&(te=te&&re<=new Date(g))}return z&&B&&Q&&te}),_e=Math.ceil(ue.length/L),S=(O-1)*L,I=S+L,D=ue.slice(S,I);return P.useEffect(()=>{F(1)},[c,d,u,p,g,L]),n.jsxs("div",{className:"min-h-screen bg-white",children:[n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[n.jsx("div",{className:"bg-white border-b pb-4 mb-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("button",{onClick:()=>r("AdminDashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",style:{fontSize:"15px"},children:[n.jsx(Ft,{size:20}),""]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Book",className:"h-10"}),n.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:""})]}),n.jsx("div",{className:"w-24"})]})}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:""}),n.jsx("input",{type:"text",placeholder:"  ",value:c,onChange:y=>h(y.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"}})]}),ts(t)&&n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:""}),n.jsxs("select",{value:d,onChange:y=>f(y.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"},children:[n.jsx("option",{value:"",children:""}),a.map(y=>n.jsx("option",{value:y.name,children:y.name},y.id))]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:""}),n.jsxs("select",{value:u,onChange:y=>m(y.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"},children:[n.jsx("option",{value:"all",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:""}),n.jsx("input",{type:"date",value:p,onChange:y=>x(y.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"}})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:""}),n.jsx("input",{type:"date",value:g,onChange:y=>T(y.target.value),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"14px"}})]}),n.jsx("div",{className:"flex-1 flex items-end",children:n.jsxs("button",{onClick:le,className:"w-full py-2 flex items-center justify-center gap-2 text-white font-bold rounded-lg hover:opacity-90",style:{backgroundColor:"#5B7FC8",fontSize:"15px",borderRadius:"10px",height:"42px"},children:[n.jsx(Rr,{size:18}),"(",ue.length.toString().padStart(2,"0"),")"]})})]}),n.jsxs("div",{className:"mt-4 flex justify-start items-center gap-4",children:[n.jsxs("div",{className:"text-gray-600",style:{fontSize:"15px"},children:[" ",n.jsx("strong",{style:{color:"#249689",fontSize:"16px"},children:ue.length}),""]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm text-gray-600",children:":"}),n.jsxs("select",{value:L,onChange:y=>E(Number(y.target.value)),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm",style:{fontSize:"14px"},children:[n.jsx("option",{value:30,children:"30"}),n.jsx("option",{value:50,children:"50"}),n.jsx("option",{value:100,children:"100"})]})]})]})]}),o?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"inline-block w-8 h-8 border-4 border-gray-200 border-t-[#249689] rounded-full animate-spin"}),n.jsx("p",{className:"mt-4 text-gray-600",children:" ..."})]}):ue.length===0?n.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm border",children:n.jsx("p",{className:"text-gray-500",style:{fontSize:"15px"},children:"   ."})}):n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left",children:n.jsx("input",{type:"checkbox",onChange:y=>{y.target.checked?w(ue.map(z=>z.id)):w([])},checked:b.length===ue.length&&ue.length>0,className:"rounded border-gray-300"})}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-center font-bold",style:{fontSize:"14px"},children:""})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:D.map(y=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"checkbox",checked:b.includes(y.id),onChange:()=>Te(y.id),className:"rounded border-gray-300"})}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:y.name}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:y.email}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:y.phone}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:y.branch}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:y.user_type}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold",style:{backgroundColor:y.status==="approved"?"#D1FAE5":y.status==="pending"?"#FEF3C7":"#FEE2E2",color:y.status==="approved"?"#065F46":y.status==="pending"?"#92400E":"#991B1B"},children:y.status==="approved"?"":y.status==="pending"?"":""})}),n.jsx("td",{className:"px-4 py-3",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[y.status==="pending"&&n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>ge(y.id,!0),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"",children:n.jsx(fo,{size:18})}),n.jsx("button",{onClick:()=>ge(y.id,!1),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"",children:n.jsx(uo,{size:18})})]}),n.jsx("button",{onClick:()=>Ee(y),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"",children:n.jsx(Oa,{size:18})}),n.jsx("button",{onClick:()=>xe(y.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"",children:n.jsx(yr,{size:18})})]})})]},y.id))})]})}),_e>1&&n.jsxs("div",{className:"mt-4 flex justify-center items-center gap-2",children:[n.jsx("button",{onClick:()=>F(y=>Math.max(1,y-1)),disabled:O===1,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:""}),n.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,_e)},(y,z)=>{let B;return _e<=5||O<=3?B=z+1:O>=_e-2?B=_e-4+z:B=O-2+z,n.jsx("button",{onClick:()=>F(B),className:`px-3 py-1 border rounded ${O===B?"text-white font-bold":"hover:bg-gray-50"}`,style:{fontSize:"14px",backgroundColor:O===B?"#249689":"white",borderColor:O===B?"#249689":"#d1d5db"},children:B},B)})}),n.jsx("button",{onClick:()=>F(y=>Math.min(_e,y+1)),disabled:O===_e,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:""}),n.jsxs("span",{className:"ml-4 text-sm text-gray-600",children:[O," / ",_e," "]})]})]})]}),A&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl p-6 w-full max-w-md",children:[n.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:y=>y.target.style.display="none"}),n.jsx("h2",{className:"text-xl font-bold",style:{color:"#249689"},children:""})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:""}),n.jsx("input",{type:"text",value:M.name,onChange:y=>U({...M,name:y.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:""}),n.jsxs("select",{value:M.branch,onChange:y=>U({...M,branch:y.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:""}),a.map(y=>n.jsx("option",{value:y.name,children:y.name},y.name))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:""}),n.jsx("input",{type:"text",value:M.phone,onChange:y=>U({...M,phone:y.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{fontSize:"15px"},children:""}),n.jsxs("select",{value:M.user_type,onChange:y=>U({...M,user_type:y.target.value}),className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]})]})]}),n.jsxs("div",{className:"flex gap-2 mt-6",children:[n.jsx("button",{onClick:be,className:"flex-1 py-2 text-white font-bold rounded-lg hover:opacity-90",style:{backgroundColor:"#249689",fontSize:"15px"},children:""}),n.jsx("button",{onClick:()=>_(!1),className:"flex-1 py-2 font-bold rounded-lg hover:bg-gray-50",style:{border:"2px solid #7f95eb",backgroundColor:"white",fontSize:"15px"},children:""})]})]})})]})}function A1({user:t,onNavigate:r}){const[e,s]=P.useState([]),[a,i]=P.useState(null),[o,l]=P.useState(!1),[c,h]=P.useState("date"),[d,f]=P.useState(""),[u,m]=P.useState(""),[p,x]=P.useState("");P.useEffect(()=>{g()},[]);const g=async()=>{l(!0);try{let O=ce.from("work_diaries").select("*").order("created_at",{ascending:!1});ts(t)||(O=O.eq("branch_name",t.branch));const{data:F,error:M}=await O;if(M)throw M;s(F||[]),F&&F.length>0&&i(F[0])}catch(O){console.error("  :",O),alert("  .")}finally{l(!1)}},T=()=>{g()},b=()=>{f(""),m(""),x(""),g()},A=[...e.filter(O=>{const F=!d.trim()||O.user_name?.toLowerCase().includes(d.toLowerCase());let M=!0;if(u||p){const U=new Date(O.work_date);if(u){const H=new Date(u);H.setHours(0,0,0,0),U<H&&(M=!1)}if(p){const H=new Date(p);H.setHours(23,59,59,999),U>H&&(M=!1)}}return F&&M})].sort((O,F)=>{if(c==="date"){const M=new Date(O.created_at);return new Date(F.created_at)-M}else{const M=new Date(O.created_at),U=new Date(F.created_at);return M-U}}),L=(O=>O.reduce((F,M)=>{const U=parseFloat(M.work_hours)||0;return F+U},0))(A),E=O=>O?new Date(O).toLocaleDateString("ko-KR",{year:"numeric",month:"long",day:"numeric",weekday:"short"}).replace("",""):"-";return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsx("div",{className:"bg-white shadow-md p-6",children:n.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[n.jsxs("button",{onClick:()=>r("AdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[n.jsx(Ft,{size:20}),""]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:O=>O.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:ts(t)?" ":" "})]}),n.jsx("div",{style:{width:"100px"}})]})}),n.jsx("div",{className:"max-w-7xl mx-auto p-6",children:n.jsxs("div",{className:"flex gap-6",style:{height:"calc(100vh - 200px)"},children:[n.jsxs("div",{className:"w-80 bg-white rounded-lg shadow-lg overflow-hidden flex flex-col",children:[n.jsxs("div",{className:"p-4 border-b bg-gray-50 space-y-3",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:[n.jsx(hn,{size:12,className:"inline mr-1"})," "]}),n.jsx("input",{type:"text",value:d,onChange:O=>f(O.target.value),placeholder:" ",className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg text-sm"})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:[n.jsx(fn,{size:12,className:"inline mr-1"}),""]}),n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx("input",{type:"date",value:u,onChange:O=>m(O.target.value),className:"flex-1 px-2 py-1.5 border border-gray-300 rounded-lg text-xs"}),n.jsx("span",{className:"text-xs",children:"~"}),n.jsx("input",{type:"date",value:p,onChange:O=>x(O.target.value),className:"flex-1 px-2 py-1.5 border border-gray-300 rounded-lg text-xs"})]})]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:T,className:"flex-1 px-3 py-1.5 bg-teal-600 text-white rounded-lg hover:bg-teal-700 text-sm font-bold",children:[n.jsx(Ir,{size:14,className:"inline mr-1"}),""]}),n.jsx("button",{onClick:b,className:"px-3 py-1.5 bg-gray-200 rounded-lg hover:bg-gray-300 text-sm",children:""})]}),n.jsxs("div",{className:"pt-2 border-t",children:[n.jsx("label",{className:"block text-xs font-bold mb-1 text-gray-600",children:""}),n.jsxs("select",{value:c,onChange:O=>h(O.target.value),className:"w-full px-3 py-1.5 border border-gray-300 rounded-lg text-sm",children:[n.jsx("option",{value:"date",children:" "}),n.jsx("option",{value:"old",children:" "})]})]}),n.jsxs("div",{className:"text-xs text-gray-600 text-center pt-2 border-t space-y-1",children:[n.jsxs("div",{children:[" ",n.jsx("strong",{className:"text-teal-600",children:A.length}),""]}),n.jsxs("div",{className:"font-bold text-teal-600",children:[" : ",L.toFixed(1),""]})]})]}),n.jsx("div",{className:"flex-1 overflow-y-auto",children:o?n.jsx("div",{className:"p-8 text-center text-gray-500",children:" ..."}):A.length===0?n.jsx("div",{className:"p-8 text-center text-gray-500",children:d||u||p?"  .":" ."}):A.map(O=>n.jsxs("div",{onClick:()=>i(O),className:`p-4 border-b cursor-pointer hover:bg-gray-50 transition-colors ${a?.id===O.id?"bg-teal-50 border-l-4 border-teal-500":""}`,children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[n.jsx(hn,{size:16,style:{color:"#249689"}}),n.jsx("span",{className:"font-bold",style:{fontSize:"15px"},children:O.branch_name||"-"})]}),n.jsx("div",{className:"text-sm text-gray-600 mb-1",children:O.user_name||" "}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:[n.jsx(fn,{size:12}),O.work_date||"-"]}),n.jsxs("div",{className:"flex items-center gap-1 text-xs text-gray-500 mt-1",children:[n.jsx($c,{size:12}),O.start_time," - ",O.end_time," (",O.work_hours,"h)"]})]},O.id))})]}),n.jsx("div",{className:"flex-1 bg-white rounded-lg shadow-lg overflow-hidden",children:a?n.jsx("div",{className:"h-full overflow-y-auto p-6",children:n.jsxs("div",{className:"max-w-2xl mx-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(Hc,{size:28,style:{color:"#249689"}}),n.jsx("h2",{className:"text-2xl font-bold",style:{color:"#249689"},children:" "})]}),n.jsxs("div",{className:"text-lg font-bold",style:{color:"#249689"},children:["( ",L.toFixed(1),")"]})]}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:""}),n.jsx("p",{className:"font-medium",children:a.branch_name||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:""}),n.jsx("p",{className:"font-medium",children:a.user_name||"-"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:""}),n.jsx("p",{className:"font-medium",children:E(a.work_date)})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-bold text-gray-600 mb-1",children:""}),n.jsxs("p",{className:"font-medium",children:[a.start_time," - ",a.end_time,n.jsxs("span",{className:"ml-2 text-teal-600",children:["(",a.work_hours,")"]})]})]})]})}),(a.daily_check_clean||a.daily_check_training||a.daily_check_list)&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:" "}),n.jsxs("div",{className:"space-y-2 bg-gray-50 rounded-lg p-4",children:[a.daily_check_clean&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-green-600",children:""}),n.jsx("span",{children:" "})]}),a.daily_check_training&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-green-600",children:""}),n.jsx("span",{children:" "})]}),a.daily_check_list&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-green-600",children:""}),n.jsx("span",{children:"  "})]})]})]}),a.out_content&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"  "}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsx("p",{className:"whitespace-pre-wrap",children:a.out_content})})]}),a.exemplary_content&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:" "}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsx("p",{className:"whitespace-pre-wrap",children:a.exemplary_content})})]}),a.memorable_customer&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:"  "}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsx("p",{className:"whitespace-pre-wrap",children:a.memorable_customer})})]}),a.suggestions&&n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"font-bold mb-3",style:{fontSize:"17px"},children:""}),n.jsx("div",{className:"bg-gray-50 rounded-lg p-4",children:n.jsx("p",{className:"whitespace-pre-wrap",children:a.suggestions})})]}),n.jsxs("div",{className:"text-sm text-gray-500 text-right mt-8",children:[": ",new Date(a.created_at).toLocaleString("ko-KR")]})]})}):n.jsx("div",{className:"h-full flex items-center justify-center text-gray-500",children:"   ."})})]})})]})}function R1({user:t,onNavigate:r}){const[e,s]=P.useState([]),[a,i]=P.useState(!1),[o,l]=P.useState(""),[c,h]=P.useState(""),[d,f]=P.useState([]);P.useEffect(()=>{u(),m()},[]);const u=async()=>{try{const{data:b,error:w}=await ce.from("branches").select("*").eq("is_active",!0).order("name",{ascending:!0});if(w)throw w;f(b||[])}catch(b){console.error("   :",b)}},m=async()=>{i(!0);try{console.log("   ...");let b=ce.from("sales").select("*").order("created_at",{ascending:!1});ts(t)||(console.log("   :",t.branch),b=b.eq("branch_name",t.branch));const{data:w,error:A}=await b;if(A)throw console.error(" Supabase :",A),A;console.log("  :",w),s(w||[])}catch(b){console.error("    :",b),alert(`   .
: ${b.message}`)}finally{i(!1)}},p=b=>{if(!b)return"-";const w=b.replace(/[^\d]/g,"");return w.length===11?`${w.slice(0,3)}-${w.slice(3,7)}-${w.slice(7)}`:w.length===10?`${w.slice(0,3)}-${w.slice(3,6)}-${w.slice(6)}`:b},x=b=>b?b.replace(/[^\d]/g,""):"",T=e.filter(b=>{const w=b.customer_name?.toLowerCase().includes(o.toLowerCase())||b.phone?.includes(o)||b.customer_phone?.includes(o)||b.email?.toLowerCase().includes(o.toLowerCase())||b.customer_email?.toLowerCase().includes(o.toLowerCase()),A=!c||b.branch_name===c;return w&&A}).reduce((b,w)=>{const A=x(w.phone||w.customer_phone||""),L=`${w.customer_name||""}-${A}`;return b.some(E=>{const O=x(E.phone||E.customer_phone||"");return`${E.customer_name||""}-${O}`===L})||b.push(w),b},[]);return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsx("div",{className:"bg-white shadow-md p-6",children:n.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[n.jsxs("button",{onClick:()=>r("AdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[n.jsx(Ft,{size:20}),""]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:b=>b.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:""})]}),n.jsx("div",{style:{width:"100px"}})]})}),n.jsx("div",{className:"max-w-7xl mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg overflow-hidden",children:[n.jsxs("div",{className:"p-4 border-b flex items-center gap-2",children:[n.jsx("div",{className:"flex-1 flex items-center gap-2",children:n.jsx("input",{type:"text",value:o,onChange:b=>l(b.target.value),placeholder:", , ",className:"flex-1 px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})}),ts(t)&&n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsxs("label",{className:"font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(Rn,{size:18,className:"inline mr-1"}),""]}),n.jsxs("select",{value:c,onChange:b=>h(b.target.value),className:"px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:""}),d.map(b=>n.jsx("option",{value:b.name,children:b.name},b.id))]})]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsxs("button",{onClick:m,className:"px-4 py-2 flex items-center gap-2 font-bold text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#249689",fontSize:"15px",borderRadius:"10px",width:"120px",justifyContent:"center"},title:"",children:[n.jsx(Ir,{size:18}),""]}),n.jsxs("button",{onClick:()=>{l(""),h("")},className:"px-4 py-2 flex items-center gap-2 font-bold hover:bg-gray-50",style:{backgroundColor:"white",border:"2px solid #249689",borderRadius:"10px",color:"#249689",fontSize:"15px",width:"120px",justifyContent:"center"},title:"  ",children:[n.jsx(es,{size:18}),""]})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{color:"#000000",fontSize:"15px"},children:""})]})}),n.jsx("tbody",{children:a?n.jsx("tr",{children:n.jsx("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:" ..."})}):T.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:"8",className:"text-center py-8 text-gray-500",children:"  ."})}):T.map(b=>n.jsxs("tr",{className:"border-t hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:b.branch_name||b.user_branch||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:b.customer_name||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:p(b.phone||b.customer_phone)}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:b.email||b.customer_email||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm text-gray-600",children:b.address||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:b.payment_method||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:b.quantity||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"15px"},children:b.created_at?new Date(b.created_at).toLocaleDateString("ko-KR"):"-"})]},b.id))})]})})]})})]})}const F1=()=>{const t=[];for(let i=8;i<=22;i++){for(let o=0;o<60;o+=30){if(i===8&&o<30)continue;if(i===22&&o>30)break;const l=`${String(i).padStart(2,"0")}:${String(o).padStart(2,"0")}`;t.push(l)}if(i===22&&t.includes(`${String(22).padStart(2,"0")}:${String(30).padStart(2,"0")}`))break}return t},no=F1();function D1({user:t,onNavigate:r}){const[e,s]=P.useState({workDate:"",startTime:"",endTime:"",dailyCheckClean:!1,dailyCheckTraining:!1,dailyCheckList:!1,outContent:"",exemplaryContent:"",memorableCustomer:"",suggestions:""}),[a,i]=P.useState(0),[o,l]=P.useState(!1),c=t?.user_type===""||t?.user_type===""||t?.userType===""||t?.userType==="",h=u=>{const{name:m,value:p,type:x,checked:g}=u.target;s({...e,[m]:x==="checkbox"?g:p})};P.useEffect(()=>{if(!e.workDate||!e.startTime||!e.endTime){i(0);return}try{const u=new Date(`${e.workDate}T${e.startTime}:00`),m=new Date(`${e.workDate}T${e.endTime}:00`);if(isNaN(u.getTime())||isNaN(m.getTime())){i(0);return}const x=(m-u)/(1e3*60*60);i(x>0?parseFloat(x.toFixed(1)):0)}catch(u){console.error("  :",u),i(0)}},[e.workDate,e.startTime,e.endTime]);const d=async u=>{if(u.preventDefault(),!e.workDate){alert(" ");return}if(!e.startTime){alert(" ");return}if(!e.endTime){alert(" ");return}if(a<=0){alert("   ");return}l(!0);try{const m={user_id:t.id,user_name:t.name,branch_name:t.branch,work_date:e.workDate,start_time:e.startTime,end_time:e.endTime,work_hours:a,daily_check_clean:e.dailyCheckClean,daily_check_training:e.dailyCheckTraining,daily_check_list:e.dailyCheckList,out_content:e.outContent.trim()||null,exemplary_content:e.exemplaryContent.trim()||null,memorable_customer:e.memorableCustomer.trim()||null,suggestions:e.suggestions.trim()||null};console.log("  :",m),alert(" !"),r&&r("dashboard")}catch(m){console.error("  :",m),alert("    : "+m.message)}finally{l(!1)}},f=()=>{e.workDate||e.startTime||e.endTime||e.outContent||e.exemplaryContent||e.memorableCustomer||e.suggestions||e.dailyCheckClean||e.dailyCheckTraining||e.dailyCheckList?window.confirm("   . ?")&&r&&r("Dashboard"):r&&r("Dashboard")};return n.jsx("div",{className:"min-h-screen bg-gray-50 p-2",children:n.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg p-4",children:[n.jsx("div",{className:"flex flex-col items-center justify-center mb-2",children:n.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:u=>u.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:c?"SM ":""})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("input",{type:"text",value:t?.branch||"Current User's brname",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("input",{type:"text",value:t?.name||"Current User's name",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"border-t pt-2",children:[n.jsx("h3",{className:"font-bold mb-2",style:{color:"#000000",fontSize:"15px"},children:"   "}),n.jsxs("div",{className:"mb-2",children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("input",{type:"date",name:"workDate",value:e.workDate,onChange:h,required:!0,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-3 mb-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsxs("select",{name:"startTime",value:e.startTime,onChange:h,required:!0,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:""}),no.map(u=>n.jsx("option",{value:u,children:u},`start-${u}`))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsxs("select",{name:"endTime",value:e.endTime,onChange:h,required:!0,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:""}),no.map(u=>n.jsx("option",{value:u,children:u},`end-${u}`))]})]})]}),n.jsx("div",{className:"p-2 rounded-lg",style:{backgroundColor:"#d1fae5",border:"2px solid #10b981"},children:n.jsxs("p",{className:"font-bold text-center",style:{color:"#059669",fontSize:"16px"},children:[" : ",a," "]})})]}),c&&n.jsxs("div",{className:"border-t pt-2",children:[n.jsx("h3",{className:"font-bold mb-2",style:{color:"#000000",fontSize:"15px"},children:" "}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"dailyCheckClean",checked:e.dailyCheckClean,onChange:h,className:"w-5 h-5"}),n.jsx("span",{style:{color:"#000000",fontSize:"15px"},children:" "})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"dailyCheckTraining",checked:e.dailyCheckTraining,onChange:h,className:"w-5 h-5"}),n.jsx("span",{style:{color:"#000000",fontSize:"15px"},children:" "})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"dailyCheckList",checked:e.dailyCheckList,onChange:h,className:"w-5 h-5"}),n.jsx("span",{style:{color:"#000000",fontSize:"15px"},children:"  "})]})]})]}),n.jsxs("div",{className:"border-t pt-2",children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"   "}),n.jsx("textarea",{name:"outContent",value:e.outContent,onChange:h,placeholder:"   ",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"  "}),n.jsx("textarea",{name:"exemplaryContent",value:e.exemplaryContent,onChange:h,placeholder:"  ",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"    "}),n.jsx("textarea",{name:"memorableCustomer",value:e.memorableCustomer,onChange:h,placeholder:"    ",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"  "}),n.jsx("textarea",{name:"suggestions",value:e.suggestions,onChange:h,placeholder:"  ",rows:3,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{className:"flex gap-2 pt-2",children:[n.jsx("button",{type:"button",onClick:d,disabled:o,className:"flex-1 py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:o?" ...":""}),n.jsx("button",{type:"button",onClick:f,disabled:o,className:"flex-1 py-2.5 font-bold rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:""})]})]})]})})}function O1({user:t,onNavigate:r}){const[e,s]=P.useState({customerName:"",age:"",address:"",phone:"",email:"",paymentMethod:"",quantity:"",depositor:"",depositAmount:"",orderDetails:"",needsShipping:!1,privacyAgreed:!1,marketingAgreed:!1}),[a,i]=P.useState(!1),[o,l]=P.useState(!1),c=m=>{const p=m.replace(/[^\d]/g,"");return p.length<=3?p:p.length<=7?`${p.slice(0,3)}-${p.slice(3)}`:`${p.slice(0,3)}-${p.slice(3,7)}-${p.slice(7,11)}`},h=m=>{const p=m.replace(/[^\d]/g,"");return p?p.replace(/\B(?=(\d{3})+(?!\d))/g,",")+"":""},d=m=>{const{name:p,value:x,type:g,checked:T}=m.target;let b=g==="checkbox"?T:x;p==="phone"&&(b=c(x)),p==="depositAmount"&&(b=h(x)),s({...e,[p]:b})},f=()=>{if(!e.quantity||e.quantity<1)return alert(" "),!1;if(!e.depositAmount?.trim())return alert(" "),!1;if(e.needsShipping){if(!e.customerName?.trim())return alert("    "),!1;if(!e.address?.trim())return alert("   "),!1;if(!e.phone?.trim())return alert("   "),!1}return e.paymentMethod===""&&!e.depositor?.trim()?(alert(" "),!1):e.privacyAgreed?!0:(alert("    "),!1)},u=async()=>{if(f()){i(!0),console.log("===   ===");try{const m={user_id:t?.id||null,branch_name:t?.branch||null,user_name:t?.name||null,user_branch:t?.branch||null,customer_name:e.customerName?.trim()||null,phone:e.phone?.trim()||null,customer_email:e.email?.trim()||null,address:e.address?.trim()||null,payment_method:e.paymentMethod||null,quantity:parseInt(e.quantity),depositor:e.depositor?.trim()||null,deposit_amount:e.depositAmount?.replace(/[,]/g,"")||null,order_details:e.orderDetails?.trim()||null,age:e.age?parseInt(e.age):null,needs_shipping:e.needsShipping,privacy_agreed:e.privacyAgreed,marketing_agreed:e.marketingAgreed};console.log("Insert Data:",m);const{data:p,error:x}=await ce.from("sales").insert([m]).select();if(x)throw x;console.log(" :",p),alert("!"),s({customerName:"",age:"",address:"",phone:"",email:"",paymentMethod:"",quantity:"",depositor:"",depositAmount:"",orderDetails:"",needsShipping:!1,privacyAgreed:!1,marketingAgreed:!1})}catch(m){console.error("===    ==="),console.error("Error:",m),alert("   : "+m.message)}finally{i(!1)}}};return n.jsxs("div",{className:"min-h-screen bg-gray-50 p-2",children:[n.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg",style:{padding:"12px",paddingBottom:"24px"},children:[n.jsx("div",{className:"flex flex-col items-center justify-center mb-2",children:n.jsxs("div",{className:"flex items-center gap-1.5 mb-1",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:m=>m.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"LAS Book Store"})]})}),n.jsxs("div",{className:"grid grid-cols-2 gap-1 mb-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-2 py-1.5 border border-gray-300 bg-gray-50",style:{borderRadius:"8px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-2 py-1.5 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2 bg-gray-50",children:[n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"needsShipping",checked:e.needsShipping,onChange:d,className:"w-4 h-4"}),n.jsx("span",{className:"font-bold",style:{color:"#249689",fontSize:"16px"},children:"  "})]}),n.jsx("p",{className:"text-xs text-gray-600 mt-1 ml-6",children:e.needsShipping?"  : , ,  ":"     "})]}),n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[n.jsx("h3",{className:"font-bold mb-2 text-lg",style:{color:"#249689",fontSize:"18px"},children:" "}),n.jsxs("div",{className:"space-y-1.5",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:[" ",e.needsShipping&&n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",name:"customerName",value:e.customerName,onChange:d,placeholder:"  ",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("input",{type:"text",name:"age",value:e.age,onChange:d,placeholder:"  ",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:[" ",e.needsShipping&&n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",name:"address",value:e.address,onChange:d,placeholder:"  ",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:[" ",e.needsShipping&&n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"tel",name:"phone",value:e.phone,onChange:d,placeholder:"  ",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("input",{type:"email",name:"email",value:e.email,onChange:d,placeholder:"  ",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]})]})]}),n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[n.jsx("h3",{className:"font-bold mb-2 text-lg",style:{color:"#249689",fontSize:"18px"},children:""}),n.jsxs("div",{className:"space-y-2",children:[n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("label",{className:"flex items-center gap-1 cursor-pointer",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"",checked:e.paymentMethod==="",onChange:d,className:"w-3.5 h-3.5"}),n.jsx("span",{style:{color:"#000000",fontSize:"15px",fontWeight:"bold"},children:""})]}),n.jsxs("label",{className:"flex items-center gap-1.5 cursor-pointer",children:[n.jsx("input",{type:"radio",name:"paymentMethod",value:"",checked:e.paymentMethod==="",onChange:d,className:"w-3.5 h-3.5"}),n.jsx("span",{style:{color:"#000000",fontSize:"15px",fontWeight:"bold"},children:""})]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-1.5",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:[" ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"number",name:"quantity",value:e.quantity,onChange:d,placeholder:"",min:"1",className:"w-full px-3 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:[" ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",name:"depositAmount",value:e.depositAmount,onChange:d,placeholder:"",className:"w-full px-2 py-1.5 border border-gray-300",style:{borderRadius:"8px",fontSize:"15px",textAlign:"right"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:[" ",e.paymentMethod===""&&n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",name:"depositor",value:e.depositor,onChange:d,placeholder:"",disabled:e.paymentMethod==="",className:"w-full px-2 py-1.5 border border-gray-300 disabled:bg-gray-100 disabled:text-gray-400",style:{borderRadius:"8px",fontSize:"15px"}})]})]})]})]}),n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[n.jsx("h3",{className:"font-bold mb-1.5 text-lg",style:{color:"#249689",fontSize:"18px"},children:""}),n.jsx("textarea",{name:"orderDetails",value:e.orderDetails,onChange:d,placeholder:"  ",rows:3,className:"w-full px-2 py-1.5 border border-gray-300",style:{borderRadius:"8px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-2.5 bg-gray-50",children:[n.jsx("h3",{className:"font-bold mb-1.5 text-lg",style:{color:"#249689",fontSize:"18px"},children:"    "}),n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"privacyAgreed",checked:e.privacyAgreed,onChange:d,className:"w-4 h-4 mt-0.5"}),n.jsxs("span",{style:{color:"#000000",fontSize:"14px"},children:["     ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]})]}),n.jsx("button",{type:"button",onClick:()=>l(!0),className:"text-sm underline whitespace-nowrap",style:{color:"#249689"},children:" "})]}),n.jsx("div",{className:"pt-2 border-t border-gray-300",children:n.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"marketingAgreed",checked:e.marketingAgreed,onChange:d,className:"w-4 h-4 mt-0.5"}),n.jsxs("span",{style:{fontSize:"14px",flex:1},children:[n.jsx("span",{className:"font-bold",children:"()"}),"      "]})]})})]}),n.jsxs("div",{className:"flex gap-2",style:{marginTop:"20px",marginBottom:"24px"},children:[n.jsx("button",{onClick:u,disabled:a,className:"flex-1 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:a?" ...":""}),n.jsx("button",{onClick:()=>r?.("Dashboard"),disabled:a,className:"flex-1 py-2 font-bold rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:""})]})]})]}),o&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-2xl w-full max-h-[80vh] overflow-y-auto p-6",children:[n.jsx("h2",{className:"font-bold mb-4",style:{color:"#249689",fontSize:"24px"},children:"    "}),n.jsxs("div",{className:"space-y-4 text-sm",style:{color:"#333"},children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"1.     "}),n.jsx("p",{className:"ml-4",children:"-    "}),n.jsx("p",{className:"ml-4",children:"-     "}),n.jsx("p",{className:"ml-4",children:"-      "})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"2.   "}),n.jsx("p",{className:"ml-4",children:"- : , , ( )"}),n.jsx("p",{className:"ml-4",children:"- : , "})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"3.     "}),n.jsx("p",{className:"ml-4",children:"-        ."}),n.jsx("p",{className:"ml-4",children:"- ,           ."})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",style:{fontSize:"16px"},children:"4.       "}),n.jsx("p",{className:"ml-4",children:"-        ."}),n.jsx("p",{className:"ml-4",children:"- ,          ."})]})]}),n.jsx("button",{onClick:()=>l(!1),className:"w-full mt-6 py-3 text-white font-bold rounded-lg",style:{backgroundColor:"#249689"},children:""})]})})]})}function ic({user:t,onNavigate:r,config:e}){const[s,a]=P.useState(""),[i,o]=P.useState(""),[l,c]=P.useState(""),[h,d]=P.useState([]),[f,u]=P.useState([]),[m,p]=P.useState(!1),[x,g]=P.useState([]),[T,b]=P.useState("all"),[w,A]=P.useState(!1),[_,L]=P.useState(null),E=t?.user_type==="";P.useEffect(()=>{e.showBranchFilter&&O(),F()},[]);const O=async()=>{try{const{data:S,error:I}=await ce.from("branches").select("*").order("name",{ascending:!0});if(I)throw I;u(S||[])}catch(S){console.error("  :",S)}},F=async()=>{p(!0);try{let S=ce.from("sales").select("*").order("created_at",{ascending:!1});e.filterByBranch&&t?.branch&&(S=S.eq("branch_name",t.branch));const{data:I,error:D}=await S;if(D){console.error("   :",D),alert("    : "+D.message);return}console.log(" :",I),d(I||[])}catch(S){console.error("  :",S),alert("    : "+S.message)}finally{p(!1)}},M=async()=>{p(!0);try{let S=ce.from("sales").select("*").order("created_at",{ascending:!1});if(e.filterByBranch&&t?.branch&&(S=S.eq("branch_name",t.branch)),e.showBranchFilter&&T!=="all"&&(S=S.eq("branch_name",T)),s.trim()){const y=e.searchFields.map(z=>`${z}.ilike.%${s}%`).join(",");S=S.or(y)}if(i){const y=new Date(i);y.setHours(0,0,0,0),S=S.gte("created_at",y.toISOString())}if(l){const y=new Date(l);y.setHours(23,59,59,999),S=S.lte("created_at",y.toISOString())}const{data:I,error:D}=await S;if(D){console.error(" :",D),alert("   : "+D.message);return}console.log(" :",I),d(I||[]),(!I||I.length===0)&&alert("  ")}catch(S){console.error(" :",S),alert("   : "+S.message)}finally{p(!1)}},U=()=>{a(""),o(""),c(""),b("all"),g([]),F()},H=S=>{g(I=>I.some(y=>y.id===S.id)?I.filter(y=>y.id!==S.id):[...I,S])},J=S=>{S.target.checked?g([...h]):g([])},ge=S=>new Date(S).toLocaleDateString("ko-KR",{year:"numeric",month:"2-digit",day:"2-digit"}),xe=S=>{if(!S)return"-";const I=S.replace(/[^\d]/g,"");return I.length===11?`${I.slice(0,3)}-${I.slice(3,7)}-${I.slice(7)}`:I.length===10?`${I.slice(0,3)}-${I.slice(3,6)}-${I.slice(6)}`:S},Ee=(S,I)=>{I&&I.stopPropagation(),L(S),A(!0)},be=async()=>{if(_)try{const{error:S}=await ce.from("sales").delete().eq("id",_.id);if(S)throw S;alert("."),A(!1),L(null),g(I=>I.filter(D=>D.id!==_.id)),F()}catch(S){console.error(" :",S),alert(" .")}},Te=()=>{if(x.length===0){alert("  ");return}const S=window.open("","_blank");if(!S){alert(" .   .");return}const I=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>${e.printTitle}</title>
        <style>
          * { margin: 0; padding: 0; box-sizing: border-box; }
          body { font-family: 'Malgun Gothic', sans-serif; padding: 0; line-height: 1.4; }
          @page { size: A4; margin: 10mm; }
          .page { width: 100%; display: grid; grid-template-columns: 1fr 1fr; grid-template-rows: 1fr 1fr; gap: 5mm; page-break-after: always; padding: 5mm; }
          .page:last-child { page-break-after: auto; }
          .invoice { border: 2px solid #249689; padding: 5mm; background: white; border-radius: 3mm; display: flex; flex-direction: column; height: 100%; }
          .invoice-header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 3mm; margin-bottom: 3mm; }
          .invoice-header h1 { font-size: 14pt; font-weight: bold; margin-bottom: 1mm; }
          .invoice-number { font-size: 9pt; color: #666; }
          .section { margin-bottom: 3mm; }
          .section-title { font-size: 10pt; font-weight: bold; background-color: #f0f0f0; padding: 1.5mm; margin-bottom: 1.5mm; border-left: 3mm solid #249689; }
          .field { display: flex; padding: 1mm 0; font-size: 9pt; }
          .field-label { font-weight: bold; width: 18mm; flex-shrink: 0; }
          .field-value { flex: 1; word-break: break-all; }
          .order-box { border: 1px solid #ddd; padding: 2mm; background-color: #fafafa; min-height: 15mm; max-height: 25mm; font-size: 8pt; white-space: pre-wrap; word-break: break-word; overflow: hidden; }
          .footer { margin-top: auto; padding-top: 2mm; border-top: 1px dashed #ccc; text-align: center; font-size: 7pt; color: #666; }
          @media print { body { margin: 0; padding: 0; } .page { page-break-after: always; } .page:last-child { page-break-after: auto; } }
        </style>
      </head>
      <body>
        ${(()=>{let D="";for(let y=0;y<x.length;y+=4){D+='<div class="page">';for(let z=y;z<Math.min(y+4,x.length);z++){const B=x[z];D+=`
                <div class="invoice">
                  <div class="invoice-header">
                    <h1>${e.printHeaderTitle}</h1>
                    <div class="invoice-number">No. ${String(z+1).padStart(4,"0")}</div>
                  </div>
                  <div class="section">
                    <div class="section-title">${e.printSectionTitle}</div>
                    <div class="field"><div class="field-label"></div><div class="field-value">${B.customer_name||"-"}</div></div>
                    <div class="field"><div class="field-label"></div><div class="field-value">${xe(B.customer_phone||B.phone)}</div></div>
                    <div class="field"><div class="field-label"></div><div class="field-value">${B.address||"-"}</div></div>
                  </div>
                  <div class="section">
                    <div class="section-title"> </div>
                    <div class="field"><div class="field-label"></div><div class="field-value">${ge(B.created_at)}</div></div>
                    ${e.showBranchInPrint?`<div class="field"><div class="field-label"></div><div class="field-value">${B.branch_name||"-"}</div></div>`:""}
                    <div class="field"><div class="field-label"></div><div class="field-value">${B.quantity||"-"}${e.quantityUnit}</div></div>
                    <div style="margin-top: 1.5mm;"><div class="field-label" style="margin-bottom: 1mm;"></div><div class="order-box">${B.order_details||"  "}</div></div>
                  </div>
                  <div class="footer">${e.printFooter}<br/>: ${new Date().toLocaleDateString("ko-KR")}</div>
                </div>
              `}D+="</div>"}return D})()}
        <script>
          window.onload = function() { setTimeout(function() { window.print(); }, 500); }
          window.onafterprint = function() { window.close(); };
        <\/script>
      </body>
      </html>
    `;S.document.write(I),S.document.close(),S.focus()},le=()=>{if(x.length===0){alert("  ");return}const S=x.map((te,re)=>e.excelColumns.map(ve=>{switch(ve){case"":return re+1;case"":return ge(te.created_at);case"":return te.branch_name||"";case"":return te.customer_name||"";case"":return xe(te.customer_phone||te.phone);case"":return te.address||"";case"":return te.quantity||"";case"":return(te.order_details||"").replace(/\n/g," ");default:return""}}));let I="\uFEFF";I+=e.excelColumns.join(",")+`
`,S.forEach(te=>{const re=te.map(ve=>{const V=String(ve);return V.includes(",")||V.includes('"')||V.includes(`
`)?'"'+V.replace(/"/g,'""')+'"':V});I+=re.join(",")+`
`});const D=new Blob([I],{type:"text/csv;charset=utf-8;"}),y=document.createElement("a"),z=URL.createObjectURL(D),B=new Date().toISOString().slice(0,10),Q=e.getFileName(t,B);y.setAttribute("href",z),y.setAttribute("download",Q),y.style.visibility="hidden",document.body.appendChild(y),y.click(),document.body.removeChild(y)},ue=S=>x.some(I=>I.id===S.id),_e=h.length>0&&x.length===h.length;return n.jsxs("div",{className:"min-h-screen bg-white",children:[n.jsx("div",{className:e.containerClass,children:n.jsxs("div",{className:e.cardClass,children:[n.jsxs("div",{className:e.headerClass,children:[e.showBackButton&&n.jsxs("button",{onClick:()=>r(e.backNavigation),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[n.jsx("span",{style:{fontSize:"18px"},children:""}),e.backButtonText]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:S=>S.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:e.title})]}),n.jsx("div",{style:{width:"100px"}})]}),e.showBranchInfo&&t?.user_type===""&&n.jsx("div",{className:"mb-4 p-3 bg-purple-50 border border-purple-200 rounded-lg",children:n.jsxs("p",{className:"text-sm",style:{color:"#8b5cf6"},children:[" ",n.jsx("strong",{children:t.branch}),"   "]})}),n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"flex gap-2 items-center",children:[e.showBranchFilter&&n.jsxs("select",{value:T,onChange:S=>b(S.target.value),className:"px-3 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px",width:"150px"},children:[n.jsx("option",{value:"all",children:" "}),f.map(S=>n.jsx("option",{value:S.name,children:S.name},S.id))]}),n.jsx("label",{className:"font-bold whitespace-nowrap",style:{color:"#000000",fontSize:"15px"},children:" "}),n.jsx("input",{type:"date",value:i,onChange:S=>o(S.target.value),className:"px-3 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px",width:"150px"}}),n.jsx("span",{className:"font-bold",style:{color:"#000000",fontSize:"15px"},children:"~"}),n.jsx("input",{type:"date",value:l,onChange:S=>c(S.target.value),className:"px-3 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px",width:"150px"}}),n.jsx("input",{type:"text",value:s,onChange:S=>a(S.target.value),onKeyPress:S=>S.key==="Enter"&&M(),placeholder:e.searchPlaceholder,className:"flex-1 px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}}),n.jsxs("button",{onClick:M,disabled:m,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50 whitespace-nowrap",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px",width:"120px",justifyContent:"center"},children:[n.jsx(Ir,{size:18}),m?" ...":""]}),n.jsxs("button",{onClick:U,disabled:m,className:"px-6 py-2 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50 whitespace-nowrap flex items-center gap-2",style:{border:"2px solid #249689",backgroundColor:"white",borderRadius:"10px",fontSize:"15px",color:"#249689",width:"120px",justifyContent:"center"},children:[n.jsx(es,{size:18}),""]})]})}),x.length>0&&n.jsxs("div",{className:"mb-4 p-4 rounded-lg flex items-center justify-between",style:{backgroundColor:"#f0fffe",border:"2px solid #249689"},children:[n.jsxs("span",{className:"font-bold",style:{color:"#249689",fontSize:"15px"},children:["  : ",x.length,""]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:le,className:"px-6 py-2 font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2",style:{backgroundColor:"#5B7FD4",color:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Rr,{size:18}),"(",x.length.toString().padStart(2,"0"),")"]}),n.jsxs("button",{onClick:Te,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Wc,{size:18}),""]})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[n.jsx("th",{className:"px-2 py-3 text-center font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689",width:"50px"},children:n.jsx("input",{type:"checkbox",checked:_e,onChange:J,className:"w-4 h-4"})}),e.tableColumns.map((S,I)=>n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:S},I)),E&&n.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689",width:"80px"},children:""})]})}),n.jsx("tbody",{children:m?n.jsx("tr",{children:n.jsx("td",{colSpan:e.tableColumns.length+(E?2:1),className:"px-4 py-8 text-center",style:{fontSize:"16px"},children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2",style:{borderColor:"#249689"}})," ..."]})})}):h.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:e.tableColumns.length+(E?2:1),className:"px-4 py-8 text-center text-gray-500",style:{fontSize:"16px"},children:n.jsxs("div",{children:[n.jsx("p",{className:"mb-2",children:"   "}),n.jsx("p",{className:"text-sm",children:"   "})]})})}):h.map(S=>n.jsxs("tr",{className:`border-b border-gray-200 hover:bg-gray-50 transition-colors ${ue(S)?"bg-blue-50":""}`,children:[n.jsx("td",{className:"px-2 py-3 text-center",children:n.jsx("input",{type:"checkbox",checked:ue(S),onChange:()=>H(S),className:"w-4 h-4"})}),e.renderTableRow(S,ge,xe),E&&n.jsx("td",{className:"px-3 py-3 text-center",children:n.jsx("button",{onClick:I=>Ee(S,I),className:"p-2 text-red-500 hover:text-red-600 hover:bg-red-50 rounded inline-flex items-center justify-center transition-colors",title:"",children:n.jsx(yr,{size:18})})})]},S.id))})]})}),h.length>0&&n.jsxs("div",{className:"mt-4 text-right text-gray-600",style:{fontSize:"13px"},children:[" ",n.jsx("strong",{style:{color:"#249689"},children:h.length}),""]})]})}),w&&_&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",style:{borderRadius:"10px"},children:[n.jsx("h2",{className:"text-xl font-bold mb-4 text-center text-red-600",children:"  "}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700 mb-4",children:"    ?"}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2 text-sm",children:[n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",_.customer_name]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",ge(_.created_at)]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",_.branch_name||"-"]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",_.order_details||"-"]})]}),n.jsx("p",{className:"text-red-600 text-sm mt-4 font-semibold",children:"     ."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>{A(!1),L(null)},className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",style:{borderRadius:"10px"},children:""}),n.jsx("button",{onClick:be,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 font-medium",style:{borderRadius:"10px"},children:""})]})]})})]})}function I1({user:t,onNavigate:r}){const e={containerClass:"max-w-5xl mx-auto p-6",cardClass:"bg-white rounded-lg shadow-lg p-6",headerClass:"flex items-center justify-between mb-8",title:"",showBackButton:!0,backNavigation:"Dashboard",backButtonText:"",showBranchInfo:!0,showBranchFilter:!1,filterByBranch:!0,searchPlaceholder:", ,  ",searchFields:["customer_name","phone","email"],tableColumns:["","","","",""],renderTableRow:(s,a,i)=>n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:s.customer_name}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:i(s.phone)}),n.jsxs("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:[s.address?.substring(0,30),s.address?.length>30?"...":""]}),n.jsxs("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:[s.order_details?.substring(0,20),s.order_details?.length>20?"...":""]}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:a(s.created_at)})]}),printTitle:" ",printHeaderTitle:"  ",printSectionTitle:"  ",printFooter:"LAS Book Store   ",showBranchInPrint:!1,quantityUnit:"",excelColumns:["","","","","","",""],getFileName:(s,a)=>{const i=s?.branch||"",o=s?.name||"";return`_${i}_${o}_${a}.csv`}};return n.jsx(ic,{user:t,onNavigate:r,config:e})}function oc({user:t,onNavigate:r,isAdminView:e=!1,title:s="",showBranchFilter:a=!1,navigateBack:i="Dashboard"}){const[o,l]=P.useState([]),[c,h]=P.useState([]),[d,f]=P.useState([]),[u,m]=P.useState(!1),[p,x]=P.useState("all"),[g,T]=P.useState(""),[b,w]=P.useState(""),[A,_]=P.useState(""),[L,E]=P.useState(!1),[O,F]=P.useState(null),[M,U]=P.useState(!1),[H,J]=P.useState(null),ge=d.length,xe=d.reduce((B,Q)=>B+(Q.quantity||0),0),Ee=e?p==="all"?"":p:t?.branch||"-";P.useEffect(()=>{a&&be(),Te()},[]),P.useEffect(()=>{le()},[o,p,g,b,A]);const be=async()=>{try{const{data:B,error:Q}=await ce.from("users").select("branch").not("branch","is",null).order("branch");if(Q)throw Q;const te=[...new Set(B.map(re=>re.branch))];h(te.map(re=>({branch_name:re})))}catch(B){console.error("  :",B),alert("   .")}},Te=async()=>{m(!0);try{let B=ce.from("sales").select("*").order("created_at",{ascending:!1});!e&&t?.branch&&(B=B.eq("user_branch",t.branch));const{data:Q,error:te}=await B;if(te)throw te;l(Q||[]),f(Q||[])}catch(B){console.error("  :",B),alert("  .")}finally{m(!1)}},le=()=>{let B=[...o];if(a&&p!=="all"&&(B=B.filter(Q=>Q.user_branch===p)),g&&(B=B.filter(Q=>new Date(Q.created_at).toISOString().split("T")[0]>=g)),b&&(B=B.filter(Q=>new Date(Q.created_at).toISOString().split("T")[0]<=b)),A.trim()){const Q=A.toLowerCase().trim();B=B.filter(te=>te.customer_name?.toLowerCase().includes(Q)||te.phone?.includes(Q)||te.depositor?.toLowerCase().includes(Q))}f(B)},ue=()=>{le()},_e=()=>{x("all"),T(""),w(""),_("")},S=B=>{J(B),U(!0)},I=async()=>{if(H)try{const{error:B}=await ce.from("sales").delete().eq("id",H.id);if(B)throw B;alert("."),U(!1),J(null),Te()}catch(B){console.error(" :",B),alert(" .")}},D=t?.user_type==="",y=B=>{if(!B)return"-";const Q=new Date(B);return`${Q.getFullYear()}.${String(Q.getMonth()+1).padStart(2,"0")}.${String(Q.getDate()).padStart(2,"0")}`},z=B=>{if(!B)return"-";const Q=B.toString().replace(/\D/g,"");return Q.length===11?Q.replace(/(\d{3})(\d{4})(\d{4})/,"$1-$2-$3"):Q.length===10?Q.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"):B};return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsx("div",{className:"bg-white shadow-sm",children:n.jsx("div",{className:"max-w-7xl mx-auto px-4 py-4",children:n.jsxs("div",{className:"flex items-center justify-between relative",children:[n.jsxs("button",{onClick:()=>{console.log(""),console.log(" PurchaseHistoryBase -   "),console.log(" navigateBack  :",i),console.log(" navigateBack :",typeof i),console.log(" navigateBack :",i?.length),console.log(" navigateBack :",[...i].map(B=>B.charCodeAt(0))),console.log(" isAdminView:",e),console.log(" title:",s),console.log(" showBranchFilter:",a),console.log(""),r(i)},className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800",children:[n.jsx(Ft,{size:20}),n.jsx("span",{children:""})]}),n.jsxs("div",{className:"absolute left-1/2 transform -translate-x-1/2 flex items-center gap-2",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10",onError:B=>B.target.style.display="none"}),n.jsx("h1",{className:"text-4xl font-bold",style:{color:"#249689"},children:s})]}),n.jsx("div",{style:{width:"120px"}})]})})}),n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[n.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 border-2 border-blue-200",children:[n.jsx("div",{className:"text-sm text-blue-600 mb-1",children:"  "}),n.jsxs("div",{className:"text-2xl font-bold text-blue-700",children:[ge,""]})]}),n.jsxs("div",{className:"bg-green-50 rounded-lg p-4 border-2 border-green-200",children:[n.jsx("div",{className:"text-sm text-green-600 mb-1",children:"  "}),n.jsxs("div",{className:"text-2xl font-bold text-green-700",children:[xe,""]})]}),n.jsxs("div",{className:"bg-yellow-50 rounded-lg p-4 border-2 border-yellow-200",children:[n.jsx("div",{className:"text-sm text-yellow-600 mb-1",children:" "}),n.jsx("div",{className:"text-2xl font-bold text-yellow-700",children:Ee})]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:n.jsxs("div",{className:"flex items-center gap-3",children:[a?n.jsxs("select",{value:p,onChange:B=>x(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500",children:[n.jsx("option",{value:"all",children:" "}),c.map(B=>n.jsx("option",{value:B.branch_name,children:B.branch_name},B.branch_name))]}):n.jsx("div",{className:"px-3 py-2 bg-gray-50 border border-gray-300 rounded-lg font-medium",style:{color:"#249689"},children:t?.branch||"-"}),n.jsx("span",{className:"text-sm font-medium text-gray-700 whitespace-nowrap",children:""}),n.jsx("input",{type:"date",value:g,onChange:B=>T(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"}),n.jsx("span",{className:"text-gray-500",children:"~"}),n.jsx("input",{type:"date",value:b,onChange:B=>w(B.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"}),n.jsx("input",{type:"text",value:A,onChange:B=>_(B.target.value),onKeyPress:B=>B.key==="Enter"&&ue(),placeholder:", ,  ",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-teal-500"}),n.jsxs("button",{onClick:ue,className:"px-4 py-2 bg-teal-600 text-white rounded-lg hover:bg-teal-700 flex items-center gap-2 whitespace-nowrap",children:[n.jsx(Ir,{size:18}),""]}),n.jsxs("button",{onClick:_e,className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 flex items-center gap-2 whitespace-nowrap",children:[n.jsx(es,{size:18}),""]})]})}),n.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:u?n.jsx("div",{className:"text-center py-12",children:n.jsx("p",{className:"text-gray-500",children:" ..."})}):d.length===0?n.jsx("div",{className:"text-center py-12",children:n.jsx("p",{className:"text-gray-500",children:"  ."})}):n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:""}),n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:""}),n.jsx("th",{className:"px-4 py-3 text-left text-sm font-semibold text-gray-700",children:""}),D&&n.jsx("th",{className:"px-4 py-3 text-center text-sm font-semibold text-gray-700",children:""})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:d.map((B,Q)=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3 text-sm",children:B.customer_name||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:y(B.created_at)}),n.jsx("td",{className:"px-4 py-3 text-sm",children:B.user_branch||"-"}),n.jsx("td",{className:"px-4 py-3 text-sm",children:z(B.phone)}),n.jsxs("td",{className:"px-4 py-3 text-sm text-center",children:[B.quantity||0,""]}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:B.payment_method||"-"}),B.payment_method===""&&n.jsxs("div",{className:"text-gray-600 text-xs",children:[B.depositor&&`${B.depositor} / `,B.deposit_amount&&`${B.deposit_amount.toLocaleString()}`]})]})}),n.jsx("td",{className:"px-4 py-3 text-sm",children:n.jsx("div",{className:"max-w-xs truncate text-gray-600",children:B.order_details||"-"})}),D&&n.jsx("td",{className:"px-4 py-3 text-sm text-center",children:n.jsx("button",{onClick:()=>S(B),className:"p-2 text-red-500 hover:text-red-600 hover:bg-red-50 rounded inline-flex items-center justify-center transition-colors",title:"",children:n.jsx(yr,{size:18})})})]},B.id||Q))})]})}),n.jsx("div",{className:"mt-4 flex items-center justify-between",children:n.jsxs("div",{className:"text-lg font-bold",style:{color:"#249689"},children:[": ",d.length.toLocaleString(),""]})})]}),L&&O&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:n.jsxs("div",{className:"p-6",children:[n.jsx("h2",{className:"text-2xl font-bold mb-6 text-center",style:{color:"#249689"},children:" "}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-bold mb-3 text-gray-800",children:"  "}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:""}),n.jsx("p",{className:"font-medium",children:y(O.created_at)})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:" "}),n.jsx("p",{className:"font-medium",children:O.user_branch||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:""}),n.jsxs("p",{className:"font-medium",children:[O.quantity||0,""]})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:""}),n.jsx("p",{className:"font-medium",children:O.order_details||"-"})]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-bold mb-3 text-gray-800",children:"  "}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:""}),n.jsx("p",{className:"font-medium",children:O.customer_name||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:""}),n.jsx("p",{className:"font-medium",children:z(O.phone)})]})]})]}),n.jsxs("div",{className:"mb-6",children:[n.jsx("h3",{className:"text-lg font-bold mb-3 text-gray-800",children:"  "}),n.jsxs("div",{className:"grid grid-cols-2 gap-4 bg-gray-50 p-4 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:" "}),n.jsx("p",{className:"font-medium",children:O.payment_method||"-"})]}),O.payment_method===""&&n.jsxs(n.Fragment,{children:[n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:""}),n.jsx("p",{className:"font-medium",children:O.depositor||"-"})]}),n.jsxs("div",{children:[n.jsx("span",{className:"text-sm text-gray-600",children:""}),n.jsx("p",{className:"font-bold text-lg",style:{color:"#249689"},children:O.deposit_amount?`${O.deposit_amount.toLocaleString()}`:"-"})]})]})]})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>window.print(),className:"flex-1 px-4 py-3 bg-teal-600 text-white rounded-lg hover:bg-teal-700 font-medium",children:" "}),n.jsx("button",{onClick:()=>E(!1),className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:" "})]})]})})}),M&&H&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",children:[n.jsx("h2",{className:"text-xl font-bold mb-4 text-center text-red-600",children:"  "}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700 mb-4",children:"   ?"}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2 text-sm",children:[n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",H.customer_name]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",y(H.created_at)]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",H.user_branch]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",H.order_details||"-"]})]}),n.jsx("p",{className:"text-red-600 text-sm mt-4 font-semibold",children:"     ."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>{U(!1),J(null)},className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",children:""}),n.jsx("button",{onClick:I,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 font-medium",children:""})]})]})})]})}function P1({user:t,onNavigate:r}){return n.jsx(oc,{user:t,onNavigate:r,isAdminView:!1,title:"",showBranchFilter:!1,navigateBack:"Dashboard"})}function L1({user:t,onNavigate:r,onLogout:e}){return n.jsx("div",{className:"min-h-screen bg-white",children:n.jsx("div",{className:"max-w-md mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:s=>s.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:""})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:" "}),n.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:" "}),n.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("button",{onClick:()=>r("SystemAdminUsers"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Da,{size:20}),""]}),n.jsxs("button",{onClick:()=>r("SystemAdminBranches"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Rn,{size:20}),""]}),n.jsxs("button",{onClick:()=>r("MathLetterManager"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Gc,{size:20}),""]}),n.jsxs("button",{onClick:()=>r("SystemAdminShipping"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(co,{size:20}),""]}),n.jsxs("button",{onClick:()=>r("SystemAdminPurchases"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(ho,{size:20}),""]}),n.jsxs("button",{onClick:()=>r("SystemAdminCustomers"),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(dn,{size:20}),""]}),n.jsxs("button",{onClick:()=>{console.log(" Navigate to: AdminEventMenu"),r("AdminEventMenu")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#dc2626",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ra,{size:20}),""]}),n.jsxs("button",{onClick:e,className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Fa,{size:20}),"LogOut"]})]})]})})})}function B1({user:t,onNavigate:r}){const[e,s]=P.useState([]),[a,i]=P.useState(!1),[o,l]=P.useState(!1),[c,h]=P.useState("create"),[d,f]=P.useState(null),[u,m]=P.useState({name:"",address:"",manager_name:"",phone:""});P.useEffect(()=>{p()},[]);const p=async()=>{i(!0);try{console.log("Fetching branches...");const{data:_,error:L}=await ce.from("branches").select("*").order("created_at",{ascending:!1});if(L)throw console.error("Supabase error:",L),L;console.log("Branches loaded:",_),console.log("Number of branches:",_?.length),_&&_.length>0&&(console.log("First branch:",_[0]),console.log("Branch columns:",Object.keys(_[0]))),s(_||[])}catch(_){console.error("Load branches error:",_),alert("     : "+_.message)}finally{i(!1)}},x=_=>{const{name:L,value:E}=_.target;console.log(`Form change: ${L} = ${E}`),m({...u,[L]:E})},g=()=>{console.log("Opening create modal"),h("create"),m({name:"",address:"",manager_name:"",phone:""}),l(!0)},T=_=>{console.log("Opening edit modal for:",_),h("edit"),f(_),m({name:_.name||"",address:_.address||"",manager_name:_.manager_name||"",phone:_.phone||""}),l(!0)},b=async()=>{if(!u.name.trim()){alert(" ");return}i(!0);try{if(c==="create"){console.log("Creating branch:",u);const _={name:u.name.trim(),manager_name:u.manager_name.trim()||null};u.address.trim()&&(_.address=u.address.trim()),u.phone.trim()&&(_.phone=u.phone.trim());const{data:L,error:E}=await ce.from("branches").insert([_]).select();if(E)throw console.error("Insert error:",E),E;console.log("Branch created successfully:",L),alert(" !")}else{console.log("Updating branch:",u);const _={name:u.name.trim(),manager_name:u.manager_name.trim()||null};u.address.trim()&&(_.address=u.address.trim()),u.phone.trim()&&(_.phone=u.phone.trim());const{data:L,error:E}=await ce.from("branches").update(_).eq("id",d.id).select();if(E)throw console.error("Update error:",E),E;console.log("Branch updated successfully:",L),alert("  !")}l(!1),p()}catch(_){console.error("Save branch error:",_),alert(`    .
: ${_.message}`)}finally{i(!1)}},w=async _=>{if(window.confirm(`"${_.name}"  ?

      .`)){i(!0);try{console.log("Deleting branch:",_.id);const{error:L}=await ce.from("branches").delete().eq("id",_.id);if(L)throw console.error("Delete error:",L),L;console.log("Branch deleted successfully"),alert(" !"),p()}catch(L){console.error("Delete branch error:",L),alert("    : "+L.message)}finally{i(!1)}}},A=()=>{if(e.length===0){alert("   .");return}try{const L=[["","","",""].join(","),...e.map(U=>[U.name||"",U.address||"",U.manager_name||"",U.phone||""].map(H=>`"${H}"`).join(","))].join(`
`),E="\uFEFF",O=new Blob([E+L],{type:"text/csv;charset=utf-8;"}),F=document.createElement("a"),M=URL.createObjectURL(O);F.setAttribute("href",M),F.setAttribute("download",`_${new Date().toISOString().split("T")[0]}.csv`),F.style.visibility="hidden",document.body.appendChild(F),F.click(),document.body.removeChild(F)}catch(_){console.error("Excel download error:",_),alert("    .")}};return n.jsxs("div",{className:"min-h-screen bg-white",children:[n.jsx("div",{className:"max-w-5xl mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("button",{onClick:()=>r("SystemAdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[n.jsx(Ft,{size:20}),""]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:_=>_.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:""})]}),n.jsx("div",{style:{width:"100px"}})]}),n.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[n.jsxs("div",{className:"font-bold",style:{color:"#249689",fontSize:"15px"},children:[" ",e.length.toString().padStart(2,"0")]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsxs("button",{onClick:A,disabled:a,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50",style:{backgroundColor:"#5B7FD4",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Rr,{size:18}),"(",e.length.toString().padStart(2,"0"),")"]}),n.jsxs("button",{onClick:g,disabled:a,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Fn,{size:18})," "]})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:""}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:""}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:""}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689"},children:""}),n.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"16px",borderBottom:"2px solid #249689",width:"120px"},children:""})]})}),n.jsx("tbody",{children:a?n.jsx("tr",{children:n.jsx("td",{colSpan:"5",className:"px-4 py-8 text-center",style:{fontSize:"16px"},children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2",style:{borderColor:"#249689"}})," ..."]})})}):e.length===0?n.jsx("tr",{children:n.jsx("td",{colSpan:"5",className:"px-4 py-8 text-center text-gray-500",style:{fontSize:"16px"},children:n.jsxs("div",{children:[n.jsx(Rn,{size:48,className:"mx-auto mb-2 opacity-30"}),n.jsx("p",{className:"mb-2",children:"  "}),n.jsx("p",{className:"text-sm",children:' " "    '})]})})}):e.map(_=>n.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors",children:[n.jsx("td",{className:"px-3 py-3 font-bold",style:{fontSize:"14px",color:"#249689"},children:_.name}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:_.address||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:_.manager_name||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"14px"},children:_.phone||"-"}),n.jsx("td",{className:"px-3 py-3 text-center",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("button",{onClick:()=>T(_),className:"p-2 rounded-lg hover:bg-blue-50 transition-colors",style:{color:"#2563eb"},title:"",children:n.jsx(Oa,{size:18})}),n.jsx("button",{onClick:()=>w(_),className:"p-2 rounded-lg hover:bg-red-50 transition-colors",style:{color:"#dc2626"},title:"",children:n.jsx(yr,{size:18})})]})})]},_.id))})]})}),e.length>0&&n.jsxs("div",{className:"mt-4 text-right text-gray-600",style:{fontSize:"13px"},children:[" ",n.jsx("strong",{style:{color:"#249689"},children:e.length})," "]})]})}),o&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>l(!1),children:n.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-md w-full",onClick:_=>_.stopPropagation(),style:{borderRadius:"10px"},children:[n.jsx("h3",{className:"font-bold mb-4",style:{color:"#249689",fontSize:"20px"},children:c==="create"?" ":""}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[" ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),c==="create"?n.jsx("input",{type:"text",name:"name",value:u.name,onChange:x,placeholder:"",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}}):n.jsxs("select",{name:"name",value:u.name,onChange:x,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:""}),e.map(_=>n.jsx("option",{value:_.name,children:_.name},_.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("input",{type:"text",name:"address",value:u.address,onChange:x,placeholder:" ...",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("input",{type:"text",name:"manager_name",value:u.manager_name,onChange:x,placeholder:"",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("input",{type:"tel",name:"phone",value:u.phone,onChange:x,placeholder:"010-1234-5678",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"flex gap-2 mt-6",children:[n.jsx("button",{onClick:b,disabled:a,className:"flex-1 py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:a?" ...":c==="create"?"":""}),n.jsx("button",{onClick:()=>l(!1),disabled:a,className:"flex-1 py-2.5 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50",style:{border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:""})]})]})})]})}const M1=async t=>{try{let r="LAS";if(t===""||t===""||t==="")r="LAS1";else if(t==="")r="LAS3";else return null;const{data:e,error:s}=await ce.from("users").select("referral_code").like("referral_code",`${r}%`).order("referral_code",{ascending:!1}).limit(1);if(s)throw s;let a=1;return e&&e.length>0&&e[0].referral_code&&(a=parseInt(e[0].referral_code.slice(4))+1),r+String(a).padStart(3,"0")}catch(r){return console.error("   :",r),null}},an=t=>{if(!t)return"";const r=t.replace(/[^0-9]/g,"");return r.length<=3?r:r.length<=7?`${r.slice(0,3)}-${r.slice(3)}`:r.length<=11?`${r.slice(0,3)}-${r.slice(3,7)}-${r.slice(7)}`:`${r.slice(0,3)}-${r.slice(3,7)}-${r.slice(7,11)}`};function z1({user:t,onNavigate:r}){const[e,s]=P.useState([]),[a,i]=P.useState([]),[o,l]=P.useState(!1),[c,h]=P.useState(""),[d,f]=P.useState(""),[u,m]=P.useState("all"),[p,x]=P.useState(""),[g,T]=P.useState(""),[b,w]=P.useState([]),[A,_]=P.useState(!1),[L,E]=P.useState(null),[O,F]=P.useState(null),[M,U]=P.useState(30),[H,J]=P.useState(1),[ge,xe]=P.useState({name:"",branch:"",phone:"",user_type:""});P.useEffect(()=>{Ee(),be()},[]);const Ee=async()=>{try{const{data:V,error:pe}=await ce.from("branches").select("*").order("name",{ascending:!0});if(pe)throw pe;i(V||[])}catch(V){console.error("  :",V)}},be=async()=>{l(!0);try{const{data:V,error:pe}=await ce.from("users").select("*").order("created_at",{ascending:!1});if(pe)throw pe;s(V||[])}catch(V){console.error("  :",V),alert("     .")}finally{l(!1)}},Te=async V=>{if(window.confirm("  ?")){l(!0);try{const pe=e.find(de=>de.id===V);let he=null;pe&&(he=await M1(pe.user_type));const De={status:"approved",approved_at:new Date().toISOString()};he&&(De.referral_code=he);const{error:Ne}=await ce.from("users").update(De).eq("id",V);if(Ne)throw Ne;alert(he?` !
: ${he}`:" !"),be()}catch(pe){console.error(" :",pe),alert("    .")}finally{l(!1)}}},le=async V=>{if(window.confirm(`  ?
  .`)){l(!0);try{const{error:pe}=await ce.from("users").delete().eq("id",V);if(pe)throw pe;alert(" !"),be()}catch(pe){console.error(" :",pe),alert("    .")}finally{l(!1)}}},ue=async V=>{const pe="las0000";if(window.confirm(`${V.name}(${V.email})  ?

 : ${pe}

   .`)){F(V.id);try{const{error:he}=await ce.from("users").update({password:pe}).eq("id",V.id);if(he)throw he;alert(` !

 : ${pe}

     ,
     .`)}catch(he){console.error("  :",he),alert("  .")}finally{F(null)}}},_e=V=>{E(V),xe({name:V.name,branch:V.branch,phone:an(V.phone),user_type:V.user_type}),_(!0)},S=V=>{const{name:pe,value:he}=V.target;xe(pe==="phone"?{...ge,[pe]:an(he)}:{...ge,[pe]:he})},I=async()=>{if(!ge.name.trim()){alert(" .");return}if(window.confirm("?")){l(!0);try{const{error:V}=await ce.from("users").update({name:ge.name,phone:ge.phone,branch:ge.branch,user_type:ge.user_type}).eq("id",L.id);if(V)throw V;alert("!"),_(!1),be()}catch(V){console.error(" :",V),alert("    .")}finally{l(!1)}}},D=async(V,pe)=>{if(window.confirm(`${pe} ?`)){l(!0);try{const{error:he}=await ce.from("users").delete().eq("id",V);if(he)throw he;alert("!"),be()}catch(he){console.error(" :",he),alert("    .")}finally{l(!1)}}},y=V=>{w(pe=>pe.includes(V)?pe.filter(he=>he!==V):[...pe,V])},z=async()=>{if(b.length===0){alert("  .");return}try{l(!0);const V=e.filter(je=>b.includes(je.id)),pe=await Promise.all(V.map(async je=>{const ht=p||new Date(je.created_at).toISOString().split("T")[0],_t=g||new Date().toISOString().split("T")[0],{data:Vt,error:_r}=await ce.from("work_diaries").select("work_hours").eq("user_id",je.id).gte("work_date",ht).lte("work_date",_t);_r&&console.error(`   (user_id: ${je.id}):`,_r);const Sr=Vt?.reduce((ye,Fe)=>ye+(parseFloat(Fe.work_hours)||0),0)||0,mt=je.ssn?je.ssn.substring(0,6)+"-*******":"-",Y=je.account_number?je.account_number.substring(0,je.account_number.length-4)+"****":"-";return{:je.branch||"-",:je.name||"-",:an(je.phone)||"-",:je.user_type||"-",:new Date(ht).toLocaleDateString("ko-KR"),:new Date(_t).toLocaleDateString("ko-KR"),:`${Sr.toFixed(1)}`,:mt,:je.account_holder||"-",:je.bank_name||"-",:Y}})),he=Zr.json_to_sheet(pe),De=Zr.book_new();Zr.book_append_sheet(De,he,"");const de=`_${(p&&g?`${p}_${g}`:`_${new Date().toISOString().split("T")[0]}`).replace(/-/g,"")}.xlsx`;rc(De,de)}catch(V){console.error("  :",V),alert("     .")}finally{l(!1)}},B=e.filter(V=>{const pe=V.name?.toLowerCase().includes(c.toLowerCase())||V.email?.toLowerCase().includes(c.toLowerCase()),he=!d||V.branch===d,De=u==="all"||V.user_type===u;let Ne=!0;if(p||g){const de=new Date(V.created_at);p&&(Ne=Ne&&de>=new Date(p)),g&&(Ne=Ne&&de<=new Date(g))}return pe&&he&&De&&Ne}),Q=Math.ceil(B.length/M),te=(H-1)*M,re=te+M,ve=B.slice(te,re);return P.useEffect(()=>{J(1)},[c,d,u,p,g,M]),n.jsxs("div",{className:"min-h-screen bg-white",children:[n.jsxs("div",{className:"max-w-7xl mx-auto px-4 py-6",children:[n.jsx("div",{className:"bg-white border-b pb-4 mb-6",children:n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("button",{onClick:()=>r("SystemAdminDashboard"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900",style:{fontSize:"15px"},children:[n.jsx(Ft,{size:20}),""]}),n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Book",className:"h-10"}),n.jsx("h1",{className:"text-2xl font-bold",style:{color:"#249689"},children:""})]}),n.jsx("div",{className:"w-24"})]})}),n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6 mb-6",children:[n.jsx("h2",{className:"text-lg font-bold mb-4",style:{color:"#249689"},children:" "}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:" / "}),n.jsxs("div",{className:"relative",children:[n.jsx("input",{type:"text",value:c,onChange:V=>h(V.target.value),placeholder:" ",className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"}}),n.jsx(Ir,{className:"absolute left-3 top-2.5 text-gray-400",size:18})]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:""}),n.jsxs("select",{value:d,onChange:V=>f(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"},children:[n.jsx("option",{value:"",children:" "}),a.map(V=>n.jsx("option",{value:V.name,children:V.name},V.name))]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:""}),n.jsxs("select",{value:u,onChange:V=>m(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"},children:[n.jsx("option",{value:"all",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:" "}),n.jsx("input",{type:"date",value:p,onChange:V=>x(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"}})]}),n.jsxs("div",{className:"flex-1",children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"14px"},children:" "}),n.jsx("input",{type:"date",value:g,onChange:V=>T(V.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{fontSize:"14px"}})]})]}),n.jsxs("div",{className:"mt-4 flex justify-between items-center",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("div",{className:"text-gray-600",style:{fontSize:"15px"},children:[" ",n.jsx("strong",{style:{color:"#249689",fontSize:"16px"},children:B.length}),""]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm text-gray-600",children:":"}),n.jsxs("select",{value:M,onChange:V=>U(Number(V.target.value)),className:"px-3 py-1.5 border border-gray-300 rounded-lg text-sm",style:{fontSize:"14px"},children:[n.jsx("option",{value:30,children:"30"}),n.jsx("option",{value:50,children:"50"}),n.jsx("option",{value:100,children:"100"})]})]})]}),n.jsxs("button",{onClick:z,className:"flex items-center gap-2 px-6 py-2 text-white rounded-lg hover:opacity-90 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#249689",fontSize:"15px",borderRadius:"10px"},children:[n.jsx(Rr,{size:18}),"(",b.length,")"]})]})]}),o?n.jsxs("div",{className:"text-center py-12",children:[n.jsx("div",{className:"inline-block w-8 h-8 border-4 border-gray-200 border-t-[#249689] rounded-full animate-spin"}),n.jsx("p",{className:"mt-4 text-gray-600",children:" ..."})]}):B.length===0?n.jsx("div",{className:"text-center py-12 bg-white rounded-lg shadow-sm border",children:n.jsx("p",{className:"text-gray-500",style:{fontSize:"15px"},children:"   ."})}):n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden",children:[n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{className:"bg-gray-50 border-b",children:n.jsxs("tr",{children:[n.jsx("th",{className:"px-4 py-3 text-left",children:n.jsx("input",{type:"checkbox",onChange:V=>{V.target.checked?w(B.map(pe=>pe.id)):w([])},checked:b.length===B.length&&B.length>0,className:"rounded border-gray-300"})}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-left font-bold",style:{fontSize:"14px"},children:""}),n.jsx("th",{className:"px-4 py-3 text-center font-bold",style:{fontSize:"14px"},children:""})]})}),n.jsx("tbody",{className:"divide-y divide-gray-200",children:ve.map(V=>n.jsxs("tr",{className:"hover:bg-gray-50",children:[n.jsx("td",{className:"px-4 py-3",children:n.jsx("input",{type:"checkbox",checked:b.includes(V.id),onChange:()=>y(V.id),className:"rounded border-gray-300"})}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:V.name}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:V.email}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:an(V.phone)||"-"}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:V.branch}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px"},children:V.user_type}),n.jsx("td",{className:"px-4 py-3",style:{fontSize:"14px",fontWeight:"bold",color:"#249689"},children:V.referral_code||"-"}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-semibold",style:{backgroundColor:V.status==="approved"?"#D1FAE5":V.status==="pending"?"#FEF3C7":"#FEE2E2",color:V.status==="approved"?"#065F46":V.status==="pending"?"#92400E":"#991B1B"},children:V.status==="approved"?"":V.status==="pending"?"":""})}),n.jsx("td",{className:"px-4 py-3",children:n.jsx("div",{className:"flex items-center justify-center gap-2",children:V.status==="pending"?n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>Te(V.id),className:"p-1 text-green-600 hover:bg-green-50 rounded",title:"",children:n.jsx(fo,{size:18})}),n.jsx("button",{onClick:()=>le(V.id),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"",children:n.jsx(uo,{size:18})})]}):n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:()=>_e(V),className:"p-1 text-blue-600 hover:bg-blue-50 rounded",title:"",children:n.jsx(Oa,{size:18})}),V.id!==t.id&&n.jsx("button",{onClick:()=>ue(V),disabled:O===V.id,className:"p-1 hover:bg-purple-50 rounded disabled:opacity-50",style:{color:"#7f95eb"},title:" ",children:n.jsx(Vc,{size:18})}),n.jsx("button",{onClick:()=>D(V.id,V.name),className:"p-1 text-red-600 hover:bg-red-50 rounded",title:"",children:n.jsx(yr,{size:18})})]})})})]},V.id))})]})}),Q>1&&n.jsxs("div",{className:"mt-4 flex justify-center items-center gap-2",children:[n.jsx("button",{onClick:()=>J(V=>Math.max(1,V-1)),disabled:H===1,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:""}),n.jsx("div",{className:"flex gap-1",children:Array.from({length:Math.min(5,Q)},(V,pe)=>{let he;return Q<=5||H<=3?he=pe+1:H>=Q-2?he=Q-4+pe:he=H-2+pe,n.jsx("button",{onClick:()=>J(he),className:`px-3 py-1 border rounded ${H===he?"text-white font-bold":"hover:bg-gray-50"}`,style:{fontSize:"14px",backgroundColor:H===he?"#249689":"white",borderColor:H===he?"#249689":"#d1d5db"},children:he},he)})}),n.jsx("button",{onClick:()=>J(V=>Math.min(Q,V+1)),disabled:H===Q,className:"px-3 py-1 border rounded hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",style:{fontSize:"14px"},children:""}),n.jsxs("span",{className:"ml-4 text-sm text-gray-600",children:[H," / ",Q," "]})]})]})]}),A&&L&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>_(!1),children:n.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-md w-full",onClick:V=>V.stopPropagation(),style:{borderRadius:"10px"},children:[n.jsx("div",{className:"flex flex-col items-center mb-6",children:n.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:V=>V.target.style.display="none"}),n.jsx("h3",{className:"font-bold",style:{color:"#249689",fontSize:"24px"},children:""})]})}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold text-sm text-gray-600",children:" ()"}),n.jsx("input",{type:"text",value:L.email,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-100",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:[" ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]}),n.jsx("input",{type:"text",name:"name",value:ge.name,onChange:S,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:""}),n.jsx("input",{type:"tel",name:"phone",value:ge.phone,onChange:S,placeholder:"010-1234-5678",maxLength:"13",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:""}),n.jsxs("select",{name:"branch",value:ge.branch,onChange:S,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:""}),a.map(V=>n.jsx("option",{value:V.name,children:V.name},V.id))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{fontSize:"15px"},children:""}),n.jsxs("select",{name:"user_type",value:ge.user_type,onChange:S,className:"w-full px-4 py-2 border border-gray-300 bg-white",style:{borderRadius:"10px",fontSize:"15px"},children:[n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""}),n.jsx("option",{value:"",children:""})]})]})]}),n.jsxs("div",{className:"flex gap-2 mt-6",children:[n.jsx("button",{onClick:I,disabled:o,className:"flex-1 py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:o?" ...":n.jsxs(n.Fragment,{children:[n.jsx(ma,{size:18}),""]})}),n.jsxs("button",{onClick:()=>_(!1),disabled:o,className:"flex-1 py-2.5 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",style:{border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Cs,{size:18}),""]})]})]})})]})}function U1({user:t,onNavigate:r}){const[e,s]=P.useState([]),[a,i]=P.useState(!1),[o,l]=P.useState(""),[c,h]=P.useState(!1),[d,f]=P.useState(null),[u,m]=P.useState(!1),[p,x]=P.useState(null),g=t?.user_type==="";P.useEffect(()=>{T()},[]);const T=async()=>{i(!0);try{const{data:E,error:O}=await ce.from("sales").select("customer_name, phone, email, address, age").order("created_at",{ascending:!1});if(O)throw O;console.log("   :",E);const F=[],M=new Set;E.forEach(U=>{let H;if(U.customer_name&&U.phone)H=`${U.customer_name}-${U.phone}`;else if(U.email)H=`email-${U.email}`;else if(U.phone)H=`phone-${U.phone}`;else if(U.customer_name)H=`name-${U.customer_name}`;else return;M.has(H)||(M.add(H),F.push(U))}),console.log("     :",F),s(F)}catch(E){console.error("   :",E),alert("     : "+E.message)}finally{i(!1)}},b=async()=>{if(!o.trim()){T();return}i(!0);try{const{data:E,error:O}=await ce.from("sales").select("customer_name, phone, email, address, age").or(`customer_name.ilike.%${o}%,phone.ilike.%${o}%,email.ilike.%${o}%`).order("created_at",{ascending:!1});if(O)throw O;const F=[],M=new Set;E.forEach(U=>{let H;if(U.customer_name&&U.phone)H=`${U.customer_name}-${U.phone}`;else if(U.email)H=`email-${U.email}`;else if(U.phone)H=`phone-${U.phone}`;else if(U.customer_name)H=`name-${U.customer_name}`;else return;M.has(H)||(M.add(H),F.push(U))}),s(F),F.length===0&&alert("  ")}catch(E){console.error("  :",E),alert("   : "+E.message)}finally{i(!1)}},w=()=>{l(""),T()},A=E=>{f(E),h(!0)},_=(E,O)=>{O.stopPropagation(),x(E),m(!0)},L=async()=>{if(p)try{const{error:E}=await ce.from("sales").delete().eq("customer_name",p.customer_name).eq("phone",p.phone);if(E)throw E;alert("."),m(!1),x(null),o.trim()?b():T()}catch(E){console.error(" :",E),alert(" .")}};return n.jsxs("div",{className:"min-h-screen bg-white",children:[n.jsx("div",{className:"max-w-6xl mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("button",{onClick:()=>r("SystemAdminDashboard"),className:"flex items-center gap-2 font-bold hover:opacity-70 transition-opacity",style:{color:"#249689",fontSize:"15px"},children:[n.jsx(Ft,{size:20}),""]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:E=>E.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:""})]}),n.jsx("div",{style:{width:"100px"}})]}),n.jsx("div",{className:"mb-6 p-3 rounded-lg",style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6"},children:n.jsxs("p",{className:"text-sm",style:{color:"#1e40af"},children:["   ",n.jsx("strong",{children:" "}),"   ."]})}),n.jsx("div",{className:"mb-6",children:n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:o,onChange:E=>l(E.target.value),onKeyPress:E=>E.key==="Enter"&&b(),placeholder:", ,  ",disabled:a,className:"flex-1 px-4 py-2 border border-gray-300 disabled:bg-gray-100",style:{borderRadius:"10px",fontSize:"15px"}}),n.jsxs("button",{onClick:b,disabled:a,className:"px-6 py-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center gap-2 disabled:opacity-50 whitespace-nowrap",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px",width:"120px",justifyContent:"center"},children:[n.jsx(Ir,{size:18}),""]}),n.jsxs("button",{onClick:w,disabled:a,className:"px-6 py-2 font-bold rounded-lg hover:bg-gray-100 transition-colors disabled:opacity-50 flex items-center gap-2 whitespace-nowrap",style:{border:"2px solid #249689",backgroundColor:"white",borderRadius:"10px",fontSize:"15px",color:"#249689",width:"120px",justifyContent:"center"},children:[n.jsx(es,{size:18}),""]})]})}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full border-collapse",children:[n.jsx("thead",{children:n.jsxs("tr",{style:{backgroundColor:"#f3f4f6"},children:[n.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689",width:"80px"},children:""}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:""}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:""}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:""}),n.jsx("th",{className:"px-3 py-3 text-left font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689"},children:""}),g&&n.jsx("th",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"15px",borderBottom:"2px solid #249689",width:"80px"},children:""})]})}),n.jsx("tbody",{children:a?n.jsx("tr",{children:n.jsx("td",{colSpan:g?"6":"5",className:"px-4 py-8 text-center",children:n.jsxs("div",{className:"flex items-center justify-center gap-2",children:[n.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2",style:{borderColor:"#249689"}})," ..."]})})}):e.length===0?n.jsx("tr",{children:n.jsxs("td",{colSpan:g?"6":"5",className:"px-4 py-8 text-center text-gray-500",children:[n.jsx(Da,{size:48,className:"mx-auto mb-2 opacity-30"}),n.jsx("p",{className:"mb-2",children:"   "}),n.jsx("p",{className:"text-sm",children:"    "})]})}):e.map((E,O)=>n.jsxs("tr",{className:"border-b border-gray-200 hover:bg-gray-50 transition-colors cursor-pointer",onClick:()=>A(E),children:[n.jsx("td",{className:"px-3 py-3 text-center",children:n.jsx("button",{onClick:F=>{F.stopPropagation(),A(E)},className:"p-2 rounded-full hover:bg-gray-200 transition-colors",style:{color:"#249689"},title:"",children:n.jsx(xo,{size:16})})}),n.jsx("td",{className:"px-3 py-3 font-bold",style:{fontSize:"15px"},children:E.customer_name||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:E.phone||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:E.address?E.address.length>30?E.address.substring(0,30)+"...":E.address:"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:E.email||"-"}),g&&n.jsx("td",{className:"px-3 py-3 text-center",children:n.jsx("button",{onClick:F=>_(E,F),className:"p-2 text-red-500 hover:text-red-600 hover:bg-red-50 rounded inline-flex items-center justify-center transition-colors",title:"",children:n.jsx(yr,{size:18})})})]},O))})]})}),e.length>0&&n.jsxs("div",{className:"mt-4 text-right text-gray-600",style:{fontSize:"13px"},children:[" ",n.jsx("strong",{style:{color:"#249689"},children:e.length}),""]})]})}),c&&d&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:()=>h(!1),children:n.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[85vh] overflow-y-auto",onClick:E=>E.stopPropagation(),style:{borderRadius:"10px"},children:[n.jsx("div",{className:"flex items-center justify-between mb-4",children:n.jsx("h3",{className:"font-bold",style:{color:"#249689",fontSize:"20px"},children:"  "})}),n.jsxs("div",{className:"p-4 rounded-lg",style:{backgroundColor:"#f0fffe",border:"2px solid #249689"},children:[n.jsx("h4",{className:"font-bold mb-3",style:{color:"#249689",fontSize:"16px"},children:""}),n.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:""}),n.jsx("p",{className:"text-sm",children:d.customer_name||"-"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:""}),n.jsx("p",{className:"text-sm",children:d.age?`${d.age}`:"-"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:""}),n.jsx("p",{className:"text-sm",children:d.phone||"-"})]}),n.jsxs("div",{children:[n.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:""}),n.jsx("p",{className:"text-sm break-all",children:d.email||"-"})]}),n.jsxs("div",{className:"col-span-2",children:[n.jsx("p",{className:"text-xs font-bold text-gray-600 mb-1",children:""}),n.jsx("p",{className:"text-sm",children:d.address||"-"})]})]})]}),n.jsx("div",{className:"mt-4 flex justify-end",children:n.jsxs("button",{onClick:()=>h(!1),className:"px-6 py-2 font-bold rounded-lg hover:bg-gray-100 transition-colors flex items-center gap-2",style:{border:"2px solid #249689",backgroundColor:"white",borderRadius:"10px",fontSize:"15px",color:"#249689"},children:[n.jsx(Cs,{size:18}),""]})})]})}),u&&p&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full p-6",style:{borderRadius:"10px"},children:[n.jsx("h2",{className:"text-xl font-bold mb-4 text-center text-red-600",children:"  "}),n.jsxs("div",{className:"mb-6",children:[n.jsx("p",{className:"text-gray-700 mb-4",children:"      ?"}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2 text-sm",children:[n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",p.customer_name]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",p.phone]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",p.email||"-"]}),n.jsxs("p",{children:[n.jsx("span",{className:"font-semibold",children:":"})," ",p.address||"-"]})]}),n.jsx("p",{className:"text-red-600 text-sm mt-4 font-semibold",children:"     ."})]}),n.jsxs("div",{className:"flex gap-3",children:[n.jsx("button",{onClick:()=>{m(!1),x(null)},className:"flex-1 px-4 py-3 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 font-medium",style:{borderRadius:"10px"},children:""}),n.jsx("button",{onClick:L,className:"flex-1 px-4 py-3 bg-red-500 text-white rounded-lg hover:bg-red-600 font-medium",style:{borderRadius:"10px"},children:""})]})]})})]})}function $1({user:t,onNavigate:r}){return n.jsx(oc,{user:t,onNavigate:r,isAdminView:!0,title:"",showBranchFilter:!0,navigateBack:"SystemAdminDashboard"})}function H1({user:t,onNavigate:r}){const e={containerClass:"max-w-6xl mx-auto p-6",cardClass:"bg-white rounded-lg shadow-lg p-6",headerClass:"flex items-center justify-between mb-8",title:"",showBackButton:!0,backNavigation:"system-admin",backButtonText:"",showBranchInfo:!1,showBranchFilter:!0,filterByBranch:!1,searchPlaceholder:", ,  ",searchFields:["customer_name","phone","customer_phone","email","address"],tableColumns:["","","","","","",""],renderTableRow:(s,a,i)=>n.jsxs(n.Fragment,{children:[n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:a(s.created_at)}),n.jsx("td",{className:"px-3 py-3 font-bold",style:{fontSize:"15px",color:"#249689"},children:s.branch_name||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:s.customer_name||"-"}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:i(s.customer_phone||s.phone)}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:s.address?s.address.length>30?s.address.substring(0,30)+"...":s.address:"-"}),n.jsxs("td",{className:"px-3 py-3 text-center font-bold",style:{fontSize:"15px"},children:[s.quantity||0,""]}),n.jsx("td",{className:"px-3 py-3",style:{fontSize:"15px"},children:s.order_details?s.order_details.length>20?s.order_details.substring(0,20)+"...":s.order_details:"-"})]}),printTitle:"",printHeaderTitle:"",printSectionTitle:" ",printFooter:"LAS Book Store  ",showBranchInPrint:!0,quantityUnit:"",excelColumns:["","","","","","","",""],getFileName:(s,a)=>`__${a}.csv`};return n.jsx(ic,{user:t,onNavigate:r,config:e})}function W1({user:t,onBack:r,onNavigate:e}){const[s,a]=P.useState(null),[i,o]=P.useState(!0),[l,c]=P.useState(!1),[h,d]=P.useState(!1),[f,u]=P.useState({name:"",phone:""}),[m,p]=P.useState({currentPassword:"",newPassword:"",confirmPassword:""});P.useEffect(()=>{x()},[t]);const x=async()=>{o(!0);try{const{data:_,error:L}=await ce.from("users").select("*").eq("id",t.id).single();if(L)throw L;console.log("   :",_),a(_),u({name:_.name||"",phone:_.phone||""})}catch(_){console.error("    :",_),alert("   .")}finally{o(!1)}},g=_=>{u({...f,[_.target.name]:_.target.value})},T=_=>{p({...m,[_.target.name]:_.target.value})},b=async()=>{if(!f.name.trim()){alert(" .");return}o(!0);try{const{error:_}=await ce.from("users").update({name:f.name,phone:f.phone}).eq("id",t.id);if(_)throw _;alert(" ."),c(!1),x()}catch(_){console.error("  :",_),alert("  .")}finally{o(!1)}},w=async()=>{const{currentPassword:_,newPassword:L,confirmPassword:E}=m;if(!_||!L||!E){alert("   .");return}if(L.length<6){alert("  6  .");return}if(L!==E){alert("   .");return}o(!0);try{const{data:O,error:F}=await ce.from("users").select("password").eq("id",t.id).single();if(F)throw F;if(O.password!==_){alert("   ."),o(!1);return}const{error:M}=await ce.from("users").update({password:L}).eq("id",t.id);if(M)throw M;alert(" ."),d(!1),p({currentPassword:"",newPassword:"",confirmPassword:""})}catch(O){console.error("  :",O),alert("  .")}finally{o(!1)}},A=()=>{d(!1),p({currentPassword:"",newPassword:"",confirmPassword:""})};return i&&!s?n.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:"#249689"}}),n.jsx("p",{className:"text-gray-600",children:" ..."})]})}):n.jsx("div",{className:"flex items-start justify-center min-h-screen bg-gray-50 p-2",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-md mt-10",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-4",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:_=>_.target.style.display="none"}),n.jsx("h1",{className:"font-bold",style:{color:"#249689",fontSize:"28px"},children:" "})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(pa,{size:18}),""]}),n.jsx("input",{type:"text",value:s?.email||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(hn,{size:18}),""]}),l?n.jsx("input",{type:"text",name:"name",value:f.name,onChange:g,className:"w-full px-4 py-2 border border-gray-300 focus:border-teal-500 focus:outline-none",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}}):n.jsx("input",{type:"text",value:s?.name||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(Xc,{size:18}),""]}),l?n.jsx("input",{type:"tel",name:"phone",value:f.phone,onChange:g,className:"w-full px-4 py-2 border border-gray-300 focus:border-teal-500 focus:outline-none",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}}):n.jsx("input",{type:"text",value:s?.phone||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(Rn,{size:18}),""]}),n.jsx("input",{type:"text",value:s?.branch||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(Kc,{size:18}),""]}),n.jsx("input",{type:"text",value:s?.user_type||"-",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),s?.referral_code&&n.jsxs("div",{children:[n.jsxs("label",{className:"flex items-center gap-1.5 mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(ci,{size:18}),""]}),n.jsx("div",{className:"w-full px-4 py-3 border-2 font-bold",style:{borderRadius:"10px",backgroundColor:"#D1FAE5",borderColor:"#14B8A6",color:"#0D9488",fontSize:"16px",letterSpacing:"0.5px"},children:s.referral_code}),n.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"*       "}),n.jsx("div",{className:"mt-2 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:n.jsxs("p",{className:"text-xs leading-relaxed",style:{color:"#92400E"},children:[" ",n.jsx("span",{className:"font-bold",children:":"}),"      .  ()      "]})})]}),n.jsx("div",{className:"mt-6 space-y-2.5",children:l?n.jsxs(n.Fragment,{children:[n.jsx("button",{onClick:b,disabled:i,className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:i?" ...":""}),n.jsx("button",{onClick:()=>{c(!1),u({name:s.name||"",phone:s.phone||""})},className:"w-full py-3 font-bold rounded-lg transition-colors",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:""})]}):h?n.jsxs("div",{className:"space-y-2.5",children:[n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-3",children:n.jsxs("h3",{className:"font-bold mb-2 flex items-center gap-2",style:{color:"#000000",fontSize:"15px"},children:[n.jsx(di,{size:18})," "]})}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"14px"},children:"  *"}),n.jsx("input",{type:"password",name:"currentPassword",value:m.currentPassword,onChange:T,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},placeholder:""})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"14px"},children:"  *"}),n.jsx("input",{type:"password",name:"newPassword",value:m.newPassword,onChange:T,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},placeholder:"  (6 )"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"14px"},children:"   *"}),n.jsx("input",{type:"password",name:"confirmPassword",value:m.confirmPassword,onChange:T,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"},placeholder:"   "})]}),n.jsx("button",{onClick:w,disabled:i,className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:i?" ...":" "}),n.jsx("button",{onClick:A,className:"w-full py-3 font-bold rounded-lg transition-colors",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:""})]}):n.jsxs(n.Fragment,{children:[n.jsxs("button",{onClick:()=>c(!0),className:"w-full py-3 flex items-center justify-center gap-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ia,{size:18})," "]}),s?.referral_code&&n.jsxs("button",{onClick:()=>e("MyQRCode"),className:"w-full py-3 flex items-center justify-center gap-2 font-bold rounded-lg hover:opacity-90 transition-opacity",style:{color:"white",border:"none",backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(ci,{size:18})," QR "]}),n.jsxs("button",{onClick:()=>d(!0),className:"w-full py-3 flex items-center justify-center gap-2 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#8B8FD9",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(di,{size:18})," "]}),n.jsxs("button",{onClick:r,className:"w-full py-3 flex items-center justify-center gap-2 font-bold rounded-lg hover:bg-gray-50 transition-colors",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ft,{size:18}),""]})]})})]})]})})}var Vs={},G1=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then},lc={},Dt={};let ni;const V1=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];Dt.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17};Dt.getSymbolTotalCodewords=function(r){return V1[r]};Dt.getBCHDigit=function(t){let r=0;for(;t!==0;)r++,t>>>=1;return r};Dt.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');ni=r};Dt.isKanjiModeEnabled=function(){return typeof ni<"u"};Dt.toSJIS=function(r){return ni(r)};var Vn={};(function(t){t.L={bit:1},t.M={bit:0},t.Q={bit:3},t.H={bit:2};function r(e){if(typeof e!="string")throw new Error("Param is not a string");switch(e.toLowerCase()){case"l":case"low":return t.L;case"m":case"medium":return t.M;case"q":case"quartile":return t.Q;case"h":case"high":return t.H;default:throw new Error("Unknown EC Level: "+e)}}t.isValid=function(s){return s&&typeof s.bit<"u"&&s.bit>=0&&s.bit<4},t.from=function(s,a){if(t.isValid(s))return s;try{return r(s)}catch{return a}}})(Vn);function cc(){this.buffer=[],this.length=0}cc.prototype={get:function(t){const r=Math.floor(t/8);return(this.buffer[r]>>>7-t%8&1)===1},put:function(t,r){for(let e=0;e<r;e++)this.putBit((t>>>r-e-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(t){const r=Math.floor(this.length/8);this.buffer.length<=r&&this.buffer.push(0),t&&(this.buffer[r]|=128>>>this.length%8),this.length++}};var X1=cc;function Xs(t){if(!t||t<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=t,this.data=new Uint8Array(t*t),this.reservedBit=new Uint8Array(t*t)}Xs.prototype.set=function(t,r,e,s){const a=t*this.size+r;this.data[a]=e,s&&(this.reservedBit[a]=!0)};Xs.prototype.get=function(t,r){return this.data[t*this.size+r]};Xs.prototype.xor=function(t,r,e){this.data[t*this.size+r]^=e};Xs.prototype.isReserved=function(t,r){return this.reservedBit[t*this.size+r]};var K1=Xs,dc={};(function(t){const r=Dt.getSymbolSize;t.getRowColCoords=function(s){if(s===1)return[];const a=Math.floor(s/7)+2,i=r(s),o=i===145?26:Math.ceil((i-13)/(2*a-2))*2,l=[i-7];for(let c=1;c<a-1;c++)l[c]=l[c-1]-o;return l.push(6),l.reverse()},t.getPositions=function(s){const a=[],i=t.getRowColCoords(s),o=i.length;for(let l=0;l<o;l++)for(let c=0;c<o;c++)l===0&&c===0||l===0&&c===o-1||l===o-1&&c===0||a.push([i[l],i[c]]);return a}})(dc);var hc={};const Y1=Dt.getSymbolSize,ao=7;hc.getPositions=function(r){const e=Y1(r);return[[0,0],[e-ao,0],[0,e-ao]]};var fc={};(function(t){t.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const r={N1:3,N2:3,N3:40,N4:10};t.isValid=function(a){return a!=null&&a!==""&&!isNaN(a)&&a>=0&&a<=7},t.from=function(a){return t.isValid(a)?parseInt(a,10):void 0},t.getPenaltyN1=function(a){const i=a.size;let o=0,l=0,c=0,h=null,d=null;for(let f=0;f<i;f++){l=c=0,h=d=null;for(let u=0;u<i;u++){let m=a.get(f,u);m===h?l++:(l>=5&&(o+=r.N1+(l-5)),h=m,l=1),m=a.get(u,f),m===d?c++:(c>=5&&(o+=r.N1+(c-5)),d=m,c=1)}l>=5&&(o+=r.N1+(l-5)),c>=5&&(o+=r.N1+(c-5))}return o},t.getPenaltyN2=function(a){const i=a.size;let o=0;for(let l=0;l<i-1;l++)for(let c=0;c<i-1;c++){const h=a.get(l,c)+a.get(l,c+1)+a.get(l+1,c)+a.get(l+1,c+1);(h===4||h===0)&&o++}return o*r.N2},t.getPenaltyN3=function(a){const i=a.size;let o=0,l=0,c=0;for(let h=0;h<i;h++){l=c=0;for(let d=0;d<i;d++)l=l<<1&2047|a.get(h,d),d>=10&&(l===1488||l===93)&&o++,c=c<<1&2047|a.get(d,h),d>=10&&(c===1488||c===93)&&o++}return o*r.N3},t.getPenaltyN4=function(a){let i=0;const o=a.data.length;for(let c=0;c<o;c++)i+=a.data[c];return Math.abs(Math.ceil(i*100/o/5)-10)*r.N4};function e(s,a,i){switch(s){case t.Patterns.PATTERN000:return(a+i)%2===0;case t.Patterns.PATTERN001:return a%2===0;case t.Patterns.PATTERN010:return i%3===0;case t.Patterns.PATTERN011:return(a+i)%3===0;case t.Patterns.PATTERN100:return(Math.floor(a/2)+Math.floor(i/3))%2===0;case t.Patterns.PATTERN101:return a*i%2+a*i%3===0;case t.Patterns.PATTERN110:return(a*i%2+a*i%3)%2===0;case t.Patterns.PATTERN111:return(a*i%3+(a+i)%2)%2===0;default:throw new Error("bad maskPattern:"+s)}}t.applyMask=function(a,i){const o=i.size;for(let l=0;l<o;l++)for(let c=0;c<o;c++)i.isReserved(c,l)||i.xor(c,l,e(a,c,l))},t.getBestMask=function(a,i){const o=Object.keys(t.Patterns).length;let l=0,c=1/0;for(let h=0;h<o;h++){i(h),t.applyMask(h,a);const d=t.getPenaltyN1(a)+t.getPenaltyN2(a)+t.getPenaltyN3(a)+t.getPenaltyN4(a);t.applyMask(h,a),d<c&&(c=d,l=h)}return l}})(fc);var Xn={};const mr=Vn,on=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],ln=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];Xn.getBlocksCount=function(r,e){switch(e){case mr.L:return on[(r-1)*4+0];case mr.M:return on[(r-1)*4+1];case mr.Q:return on[(r-1)*4+2];case mr.H:return on[(r-1)*4+3];default:return}};Xn.getTotalCodewordsCount=function(r,e){switch(e){case mr.L:return ln[(r-1)*4+0];case mr.M:return ln[(r-1)*4+1];case mr.Q:return ln[(r-1)*4+2];case mr.H:return ln[(r-1)*4+3];default:return}};var uc={},Kn={};const Ts=new Uint8Array(512),kn=new Uint8Array(256);(function(){let r=1;for(let e=0;e<255;e++)Ts[e]=r,kn[r]=e,r<<=1,r&256&&(r^=285);for(let e=255;e<512;e++)Ts[e]=Ts[e-255]})();Kn.log=function(r){if(r<1)throw new Error("log("+r+")");return kn[r]};Kn.exp=function(r){return Ts[r]};Kn.mul=function(r,e){return r===0||e===0?0:Ts[kn[r]+kn[e]]};(function(t){const r=Kn;t.mul=function(s,a){const i=new Uint8Array(s.length+a.length-1);for(let o=0;o<s.length;o++)for(let l=0;l<a.length;l++)i[o+l]^=r.mul(s[o],a[l]);return i},t.mod=function(s,a){let i=new Uint8Array(s);for(;i.length-a.length>=0;){const o=i[0];for(let c=0;c<a.length;c++)i[c]^=r.mul(a[c],o);let l=0;for(;l<i.length&&i[l]===0;)l++;i=i.slice(l)}return i},t.generateECPolynomial=function(s){let a=new Uint8Array([1]);for(let i=0;i<s;i++)a=t.mul(a,new Uint8Array([1,r.exp(i)]));return a}})(uc);const xc=uc;function ai(t){this.genPoly=void 0,this.degree=t,this.degree&&this.initialize(this.degree)}ai.prototype.initialize=function(r){this.degree=r,this.genPoly=xc.generateECPolynomial(this.degree)};ai.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const e=new Uint8Array(r.length+this.degree);e.set(r);const s=xc.mod(e,this.genPoly),a=this.degree-s.length;if(a>0){const i=new Uint8Array(this.degree);return i.set(s,a),i}return s};var q1=ai,mc={},wr={},ii={};ii.isValid=function(r){return!isNaN(r)&&r>=1&&r<=40};var Qt={};const pc="[0-9]+",J1="[A-Z $%*+\\-./:]+";let Ls="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";Ls=Ls.replace(/u/g,"\\u");const Q1="(?:(?![A-Z0-9 $%*+\\-./:]|"+Ls+`)(?:.|[\r
]))+`;Qt.KANJI=new RegExp(Ls,"g");Qt.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g");Qt.BYTE=new RegExp(Q1,"g");Qt.NUMERIC=new RegExp(pc,"g");Qt.ALPHANUMERIC=new RegExp(J1,"g");const Z1=new RegExp("^"+Ls+"$"),ev=new RegExp("^"+pc+"$"),tv=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");Qt.testKanji=function(r){return Z1.test(r)};Qt.testNumeric=function(r){return ev.test(r)};Qt.testAlphanumeric=function(r){return tv.test(r)};(function(t){const r=ii,e=Qt;t.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},t.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},t.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},t.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},t.MIXED={bit:-1},t.getCharCountIndicator=function(i,o){if(!i.ccBits)throw new Error("Invalid mode: "+i);if(!r.isValid(o))throw new Error("Invalid version: "+o);return o>=1&&o<10?i.ccBits[0]:o<27?i.ccBits[1]:i.ccBits[2]},t.getBestModeForData=function(i){return e.testNumeric(i)?t.NUMERIC:e.testAlphanumeric(i)?t.ALPHANUMERIC:e.testKanji(i)?t.KANJI:t.BYTE},t.toString=function(i){if(i&&i.id)return i.id;throw new Error("Invalid mode")},t.isValid=function(i){return i&&i.bit&&i.ccBits};function s(a){if(typeof a!="string")throw new Error("Param is not a string");switch(a.toLowerCase()){case"numeric":return t.NUMERIC;case"alphanumeric":return t.ALPHANUMERIC;case"kanji":return t.KANJI;case"byte":return t.BYTE;default:throw new Error("Unknown mode: "+a)}}t.from=function(i,o){if(t.isValid(i))return i;try{return s(i)}catch{return o}}})(wr);(function(t){const r=Dt,e=Xn,s=Vn,a=wr,i=ii,o=7973,l=r.getBCHDigit(o);function c(u,m,p){for(let x=1;x<=40;x++)if(m<=t.getCapacity(x,p,u))return x}function h(u,m){return a.getCharCountIndicator(u,m)+4}function d(u,m){let p=0;return u.forEach(function(x){const g=h(x.mode,m);p+=g+x.getBitsLength()}),p}function f(u,m){for(let p=1;p<=40;p++)if(d(u,p)<=t.getCapacity(p,m,a.MIXED))return p}t.from=function(m,p){return i.isValid(m)?parseInt(m,10):p},t.getCapacity=function(m,p,x){if(!i.isValid(m))throw new Error("Invalid QR Code version");typeof x>"u"&&(x=a.BYTE);const g=r.getSymbolTotalCodewords(m),T=e.getTotalCodewordsCount(m,p),b=(g-T)*8;if(x===a.MIXED)return b;const w=b-h(x,m);switch(x){case a.NUMERIC:return Math.floor(w/10*3);case a.ALPHANUMERIC:return Math.floor(w/11*2);case a.KANJI:return Math.floor(w/13);case a.BYTE:default:return Math.floor(w/8)}},t.getBestVersionForData=function(m,p){let x;const g=s.from(p,s.M);if(Array.isArray(m)){if(m.length>1)return f(m,g);if(m.length===0)return 1;x=m[0]}else x=m;return c(x.mode,x.getLength(),g)},t.getEncodedBits=function(m){if(!i.isValid(m)||m<7)throw new Error("Invalid QR Code version");let p=m<<12;for(;r.getBCHDigit(p)-l>=0;)p^=o<<r.getBCHDigit(p)-l;return m<<12|p}})(mc);var gc={};const Ta=Dt,vc=1335,rv=21522,io=Ta.getBCHDigit(vc);gc.getEncodedBits=function(r,e){const s=r.bit<<3|e;let a=s<<10;for(;Ta.getBCHDigit(a)-io>=0;)a^=vc<<Ta.getBCHDigit(a)-io;return(s<<10|a)^rv};var yc={};const sv=wr;function ss(t){this.mode=sv.NUMERIC,this.data=t.toString()}ss.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)};ss.prototype.getLength=function(){return this.data.length};ss.prototype.getBitsLength=function(){return ss.getBitsLength(this.data.length)};ss.prototype.write=function(r){let e,s,a;for(e=0;e+3<=this.data.length;e+=3)s=this.data.substr(e,3),a=parseInt(s,10),r.put(a,10);const i=this.data.length-e;i>0&&(s=this.data.substr(e),a=parseInt(s,10),r.put(a,i*3+1))};var nv=ss;const av=wr,da=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function ns(t){this.mode=av.ALPHANUMERIC,this.data=t}ns.getBitsLength=function(r){return 11*Math.floor(r/2)+6*(r%2)};ns.prototype.getLength=function(){return this.data.length};ns.prototype.getBitsLength=function(){return ns.getBitsLength(this.data.length)};ns.prototype.write=function(r){let e;for(e=0;e+2<=this.data.length;e+=2){let s=da.indexOf(this.data[e])*45;s+=da.indexOf(this.data[e+1]),r.put(s,11)}this.data.length%2&&r.put(da.indexOf(this.data[e]),6)};var iv=ns;const ov=wr;function as(t){this.mode=ov.BYTE,typeof t=="string"?this.data=new TextEncoder().encode(t):this.data=new Uint8Array(t)}as.getBitsLength=function(r){return r*8};as.prototype.getLength=function(){return this.data.length};as.prototype.getBitsLength=function(){return as.getBitsLength(this.data.length)};as.prototype.write=function(t){for(let r=0,e=this.data.length;r<e;r++)t.put(this.data[r],8)};var lv=as;const cv=wr,dv=Dt;function is(t){this.mode=cv.KANJI,this.data=t}is.getBitsLength=function(r){return r*13};is.prototype.getLength=function(){return this.data.length};is.prototype.getBitsLength=function(){return is.getBitsLength(this.data.length)};is.prototype.write=function(t){let r;for(r=0;r<this.data.length;r++){let e=dv.toSJIS(this.data[r]);if(e>=33088&&e<=40956)e-=33088;else if(e>=57408&&e<=60351)e-=49472;else throw new Error("Invalid SJIS character: "+this.data[r]+`
Make sure your charset is UTF-8`);e=(e>>>8&255)*192+(e&255),t.put(e,13)}};var hv=is,bc={exports:{}};(function(t){var r={single_source_shortest_paths:function(e,s,a){var i={},o={};o[s]=0;var l=r.PriorityQueue.make();l.push(s,0);for(var c,h,d,f,u,m,p,x,g;!l.empty();){c=l.pop(),h=c.value,f=c.cost,u=e[h]||{};for(d in u)u.hasOwnProperty(d)&&(m=u[d],p=f+m,x=o[d],g=typeof o[d]>"u",(g||x>p)&&(o[d]=p,l.push(d,p),i[d]=h))}if(typeof a<"u"&&typeof o[a]>"u"){var T=["Could not find a path from ",s," to ",a,"."].join("");throw new Error(T)}return i},extract_shortest_path_from_predecessor_list:function(e,s){for(var a=[],i=s;i;)a.push(i),e[i],i=e[i];return a.reverse(),a},find_path:function(e,s,a){var i=r.single_source_shortest_paths(e,s,a);return r.extract_shortest_path_from_predecessor_list(i,a)},PriorityQueue:{make:function(e){var s=r.PriorityQueue,a={},i;e=e||{};for(i in s)s.hasOwnProperty(i)&&(a[i]=s[i]);return a.queue=[],a.sorter=e.sorter||s.default_sorter,a},default_sorter:function(e,s){return e.cost-s.cost},push:function(e,s){var a={value:e,cost:s};this.queue.push(a),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};t.exports=r})(bc);var fv=bc.exports;(function(t){const r=wr,e=nv,s=iv,a=lv,i=hv,o=Qt,l=Dt,c=fv;function h(T){return unescape(encodeURIComponent(T)).length}function d(T,b,w){const A=[];let _;for(;(_=T.exec(w))!==null;)A.push({data:_[0],index:_.index,mode:b,length:_[0].length});return A}function f(T){const b=d(o.NUMERIC,r.NUMERIC,T),w=d(o.ALPHANUMERIC,r.ALPHANUMERIC,T);let A,_;return l.isKanjiModeEnabled()?(A=d(o.BYTE,r.BYTE,T),_=d(o.KANJI,r.KANJI,T)):(A=d(o.BYTE_KANJI,r.BYTE,T),_=[]),b.concat(w,A,_).sort(function(E,O){return E.index-O.index}).map(function(E){return{data:E.data,mode:E.mode,length:E.length}})}function u(T,b){switch(b){case r.NUMERIC:return e.getBitsLength(T);case r.ALPHANUMERIC:return s.getBitsLength(T);case r.KANJI:return i.getBitsLength(T);case r.BYTE:return a.getBitsLength(T)}}function m(T){return T.reduce(function(b,w){const A=b.length-1>=0?b[b.length-1]:null;return A&&A.mode===w.mode?(b[b.length-1].data+=w.data,b):(b.push(w),b)},[])}function p(T){const b=[];for(let w=0;w<T.length;w++){const A=T[w];switch(A.mode){case r.NUMERIC:b.push([A,{data:A.data,mode:r.ALPHANUMERIC,length:A.length},{data:A.data,mode:r.BYTE,length:A.length}]);break;case r.ALPHANUMERIC:b.push([A,{data:A.data,mode:r.BYTE,length:A.length}]);break;case r.KANJI:b.push([A,{data:A.data,mode:r.BYTE,length:h(A.data)}]);break;case r.BYTE:b.push([{data:A.data,mode:r.BYTE,length:h(A.data)}])}}return b}function x(T,b){const w={},A={start:{}};let _=["start"];for(let L=0;L<T.length;L++){const E=T[L],O=[];for(let F=0;F<E.length;F++){const M=E[F],U=""+L+F;O.push(U),w[U]={node:M,lastCount:0},A[U]={};for(let H=0;H<_.length;H++){const J=_[H];w[J]&&w[J].node.mode===M.mode?(A[J][U]=u(w[J].lastCount+M.length,M.mode)-u(w[J].lastCount,M.mode),w[J].lastCount+=M.length):(w[J]&&(w[J].lastCount=M.length),A[J][U]=u(M.length,M.mode)+4+r.getCharCountIndicator(M.mode,b))}}_=O}for(let L=0;L<_.length;L++)A[_[L]].end=0;return{map:A,table:w}}function g(T,b){let w;const A=r.getBestModeForData(T);if(w=r.from(b,A),w!==r.BYTE&&w.bit<A.bit)throw new Error('"'+T+'" cannot be encoded with mode '+r.toString(w)+`.
 Suggested mode is: `+r.toString(A));switch(w===r.KANJI&&!l.isKanjiModeEnabled()&&(w=r.BYTE),w){case r.NUMERIC:return new e(T);case r.ALPHANUMERIC:return new s(T);case r.KANJI:return new i(T);case r.BYTE:return new a(T)}}t.fromArray=function(b){return b.reduce(function(w,A){return typeof A=="string"?w.push(g(A,null)):A.data&&w.push(g(A.data,A.mode)),w},[])},t.fromString=function(b,w){const A=f(b,l.isKanjiModeEnabled()),_=p(A),L=x(_,w),E=c.find_path(L.map,"start","end"),O=[];for(let F=1;F<E.length-1;F++)O.push(L.table[E[F]].node);return t.fromArray(m(O))},t.rawSplit=function(b){return t.fromArray(f(b,l.isKanjiModeEnabled()))}})(yc);const Yn=Dt,ha=Vn,uv=X1,xv=K1,mv=dc,pv=hc,Ca=fc,ka=Xn,gv=q1,An=mc,vv=gc,yv=wr,fa=yc;function bv(t,r){const e=t.size,s=pv.getPositions(r);for(let a=0;a<s.length;a++){const i=s[a][0],o=s[a][1];for(let l=-1;l<=7;l++)if(!(i+l<=-1||e<=i+l))for(let c=-1;c<=7;c++)o+c<=-1||e<=o+c||(l>=0&&l<=6&&(c===0||c===6)||c>=0&&c<=6&&(l===0||l===6)||l>=2&&l<=4&&c>=2&&c<=4?t.set(i+l,o+c,!0,!0):t.set(i+l,o+c,!1,!0))}}function wv(t){const r=t.size;for(let e=8;e<r-8;e++){const s=e%2===0;t.set(e,6,s,!0),t.set(6,e,s,!0)}}function _v(t,r){const e=mv.getPositions(r);for(let s=0;s<e.length;s++){const a=e[s][0],i=e[s][1];for(let o=-2;o<=2;o++)for(let l=-2;l<=2;l++)o===-2||o===2||l===-2||l===2||o===0&&l===0?t.set(a+o,i+l,!0,!0):t.set(a+o,i+l,!1,!0)}}function Sv(t,r){const e=t.size,s=An.getEncodedBits(r);let a,i,o;for(let l=0;l<18;l++)a=Math.floor(l/3),i=l%3+e-8-3,o=(s>>l&1)===1,t.set(a,i,o,!0),t.set(i,a,o,!0)}function ua(t,r,e){const s=t.size,a=vv.getEncodedBits(r,e);let i,o;for(i=0;i<15;i++)o=(a>>i&1)===1,i<6?t.set(i,8,o,!0):i<8?t.set(i+1,8,o,!0):t.set(s-15+i,8,o,!0),i<8?t.set(8,s-i-1,o,!0):i<9?t.set(8,15-i-1+1,o,!0):t.set(8,15-i-1,o,!0);t.set(s-8,8,1,!0)}function Nv(t,r){const e=t.size;let s=-1,a=e-1,i=7,o=0;for(let l=e-1;l>0;l-=2)for(l===6&&l--;;){for(let c=0;c<2;c++)if(!t.isReserved(a,l-c)){let h=!1;o<r.length&&(h=(r[o]>>>i&1)===1),t.set(a,l-c,h),i--,i===-1&&(o++,i=7)}if(a+=s,a<0||e<=a){a-=s,s=-s;break}}}function jv(t,r,e){const s=new uv;e.forEach(function(c){s.put(c.mode.bit,4),s.put(c.getLength(),yv.getCharCountIndicator(c.mode,t)),c.write(s)});const a=Yn.getSymbolTotalCodewords(t),i=ka.getTotalCodewordsCount(t,r),o=(a-i)*8;for(s.getLengthInBits()+4<=o&&s.put(0,4);s.getLengthInBits()%8!==0;)s.putBit(0);const l=(o-s.getLengthInBits())/8;for(let c=0;c<l;c++)s.put(c%2?17:236,8);return Ev(s,t,r)}function Ev(t,r,e){const s=Yn.getSymbolTotalCodewords(r),a=ka.getTotalCodewordsCount(r,e),i=s-a,o=ka.getBlocksCount(r,e),l=s%o,c=o-l,h=Math.floor(s/o),d=Math.floor(i/o),f=d+1,u=h-d,m=new gv(u);let p=0;const x=new Array(o),g=new Array(o);let T=0;const b=new Uint8Array(t.buffer);for(let E=0;E<o;E++){const O=E<c?d:f;x[E]=b.slice(p,p+O),g[E]=m.encode(x[E]),p+=O,T=Math.max(T,O)}const w=new Uint8Array(s);let A=0,_,L;for(_=0;_<T;_++)for(L=0;L<o;L++)_<x[L].length&&(w[A++]=x[L][_]);for(_=0;_<u;_++)for(L=0;L<o;L++)w[A++]=g[L][_];return w}function Tv(t,r,e,s){let a;if(Array.isArray(t))a=fa.fromArray(t);else if(typeof t=="string"){let h=r;if(!h){const d=fa.rawSplit(t);h=An.getBestVersionForData(d,e)}a=fa.fromString(t,h||40)}else throw new Error("Invalid data");const i=An.getBestVersionForData(a,e);if(!i)throw new Error("The amount of data is too big to be stored in a QR Code");if(!r)r=i;else if(r<i)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+i+`.
`);const o=jv(r,e,a),l=Yn.getSymbolSize(r),c=new xv(l);return bv(c,r),wv(c),_v(c,r),ua(c,e,0),r>=7&&Sv(c,r),Nv(c,o),isNaN(s)&&(s=Ca.getBestMask(c,ua.bind(null,c,e))),Ca.applyMask(s,c),ua(c,e,s),{modules:c,version:r,errorCorrectionLevel:e,maskPattern:s,segments:a}}lc.create=function(r,e){if(typeof r>"u"||r==="")throw new Error("No input text");let s=ha.M,a,i;return typeof e<"u"&&(s=ha.from(e.errorCorrectionLevel,ha.M),a=An.from(e.version),i=Ca.from(e.maskPattern),e.toSJISFunc&&Yn.setToSJISFunction(e.toSJISFunc)),Tv(r,a,s,i)};var wc={},oi={};(function(t){function r(e){if(typeof e=="number"&&(e=e.toString()),typeof e!="string")throw new Error("Color should be defined as hex string");let s=e.slice().replace("#","").split("");if(s.length<3||s.length===5||s.length>8)throw new Error("Invalid hex color: "+e);(s.length===3||s.length===4)&&(s=Array.prototype.concat.apply([],s.map(function(i){return[i,i]}))),s.length===6&&s.push("F","F");const a=parseInt(s.join(""),16);return{r:a>>24&255,g:a>>16&255,b:a>>8&255,a:a&255,hex:"#"+s.slice(0,6).join("")}}t.getOptions=function(s){s||(s={}),s.color||(s.color={});const a=typeof s.margin>"u"||s.margin===null||s.margin<0?4:s.margin,i=s.width&&s.width>=21?s.width:void 0,o=s.scale||4;return{width:i,scale:i?4:o,margin:a,color:{dark:r(s.color.dark||"#000000ff"),light:r(s.color.light||"#ffffffff")},type:s.type,rendererOpts:s.rendererOpts||{}}},t.getScale=function(s,a){return a.width&&a.width>=s+a.margin*2?a.width/(s+a.margin*2):a.scale},t.getImageWidth=function(s,a){const i=t.getScale(s,a);return Math.floor((s+a.margin*2)*i)},t.qrToImageData=function(s,a,i){const o=a.modules.size,l=a.modules.data,c=t.getScale(o,i),h=Math.floor((o+i.margin*2)*c),d=i.margin*c,f=[i.color.light,i.color.dark];for(let u=0;u<h;u++)for(let m=0;m<h;m++){let p=(u*h+m)*4,x=i.color.light;if(u>=d&&m>=d&&u<h-d&&m<h-d){const g=Math.floor((u-d)/c),T=Math.floor((m-d)/c);x=f[l[g*o+T]?1:0]}s[p++]=x.r,s[p++]=x.g,s[p++]=x.b,s[p]=x.a}}})(oi);(function(t){const r=oi;function e(a,i,o){a.clearRect(0,0,i.width,i.height),i.style||(i.style={}),i.height=o,i.width=o,i.style.height=o+"px",i.style.width=o+"px"}function s(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}t.render=function(i,o,l){let c=l,h=o;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),o||(h=s()),c=r.getOptions(c);const d=r.getImageWidth(i.modules.size,c),f=h.getContext("2d"),u=f.createImageData(d,d);return r.qrToImageData(u.data,i,c),e(f,h,d),f.putImageData(u,0,0),h},t.renderToDataURL=function(i,o,l){let c=l;typeof c>"u"&&(!o||!o.getContext)&&(c=o,o=void 0),c||(c={});const h=t.render(i,o,c),d=c.type||"image/png",f=c.rendererOpts||{};return h.toDataURL(d,f.quality)}})(wc);var _c={};const Cv=oi;function oo(t,r){const e=t.a/255,s=r+'="'+t.hex+'"';return e<1?s+" "+r+'-opacity="'+e.toFixed(2).slice(1)+'"':s}function xa(t,r,e){let s=t+r;return typeof e<"u"&&(s+=" "+e),s}function kv(t,r,e){let s="",a=0,i=!1,o=0;for(let l=0;l<t.length;l++){const c=Math.floor(l%r),h=Math.floor(l/r);!c&&!i&&(i=!0),t[l]?(o++,l>0&&c>0&&t[l-1]||(s+=i?xa("M",c+e,.5+h+e):xa("m",a,0),a=0,i=!1),c+1<r&&t[l+1]||(s+=xa("h",o),o=0)):a++}return s}_c.render=function(r,e,s){const a=Cv.getOptions(e),i=r.modules.size,o=r.modules.data,l=i+a.margin*2,c=a.color.light.a?"<path "+oo(a.color.light,"fill")+' d="M0 0h'+l+"v"+l+'H0z"/>':"",h="<path "+oo(a.color.dark,"stroke")+' d="'+kv(o,i,a.margin)+'"/>',d='viewBox="0 0 '+l+" "+l+'"',u='<svg xmlns="http://www.w3.org/2000/svg" '+(a.width?'width="'+a.width+'" height="'+a.width+'" ':"")+d+' shape-rendering="crispEdges">'+c+h+`</svg>
`;return typeof s=="function"&&s(null,u),u};const Av=G1,Aa=lc,Sc=wc,Rv=_c;function li(t,r,e,s,a){const i=[].slice.call(arguments,1),o=i.length,l=typeof i[o-1]=="function";if(!l&&!Av())throw new Error("Callback required as last argument");if(l){if(o<2)throw new Error("Too few arguments provided");o===2?(a=e,e=r,r=s=void 0):o===3&&(r.getContext&&typeof a>"u"?(a=s,s=void 0):(a=s,s=e,e=r,r=void 0))}else{if(o<1)throw new Error("Too few arguments provided");return o===1?(e=r,r=s=void 0):o===2&&!r.getContext&&(s=e,e=r,r=void 0),new Promise(function(c,h){try{const d=Aa.create(e,s);c(t(d,r,s))}catch(d){h(d)}})}try{const c=Aa.create(e,s);a(null,t(c,r,s))}catch(c){a(c)}}Vs.create=Aa.create;Vs.toCanvas=li.bind(null,Sc.render);Vs.toDataURL=li.bind(null,Sc.renderToDataURL);Vs.toString=li.bind(null,function(t,r,e){return Rv.render(t,e)});function Fv({user:t,onBack:r}){const[e,s]=P.useState([]),[a,i]=P.useState(null),[o,l]=P.useState(!0),[c,h]=P.useState(!1),[d,f]=P.useState(null),[u,m]=P.useState(!1),[p,x]=P.useState(""),g=P.useRef(null),T=t?.name||"",b=t?.branch||"",w=t?.referral_code||"LAS0000",A=a?`${a.landing_url}?ref=${w}`:p||`https://lasmanager.vercel.app/event?ref=${w}`;P.useEffect(()=>{_();try{const F=localStorage.getItem(`lastQRLink_${t?.id}`);if(F){const M=JSON.parse(F);x(M.url||"")}}catch(F){console.log("  :",F)}},[]);const _=async()=>{try{l(!0);const{data:F,error:M}=await ce.from("events").select("*").eq("status","active").order("created_at",{ascending:!1});if(M)throw M;s(F||[])}catch(F){console.error("  :",F)}finally{l(!1)}},L=async F=>{try{h(!0),console.log(" QR   ");const M=g.current;if(!M)throw new Error("Canvas not found");const U=M.getContext("2d"),H=new Image;H.crossOrigin="anonymous",await new Promise((S,I)=>{H.onload=S,H.onerror=I,H.src=F.template_image_url}),console.log("   :",H.width,"x",H.height),M.width=H.width,M.height=H.height,U.drawImage(H,0,0);const J=await Vs.toDataURL(A,{width:1e3,margin:1,color:{dark:"#000000",light:"#FFFFFF"}}),ge=new Image;await new Promise((S,I)=>{ge.onload=S,ge.onerror=I,ge.src=J});const xe=F.qr_position,Ee=xe.x/100*M.width,be=xe.y/100*M.height,Te=xe.width/100*M.width,le=xe.height/100*M.height;console.log(" QR :",{qrX:Ee,qrY:be,qrWidth:Te,qrHeight:le}),U.drawImage(ge,Ee,be,Te,le);const ue=M.toDataURL("image/png");f(ue),i(F);const _e=`${F.landing_url}?ref=${w}`;try{const S={url:_e,eventId:F.id,eventName:F.name,timestamp:new Date().toISOString()};localStorage.setItem(`lastQRLink_${t?.id}`,JSON.stringify(S)),x(_e)}catch(S){console.log("  :",S)}console.log(" QR   ")}catch(M){console.error("QR  :",M),alert("QR   .")}finally{h(!1)}},E=()=>{if(!d)return;const F=document.createElement("a");F.href=d,F.download=`QR_${w}.png`,document.body.appendChild(F),F.click(),document.body.removeChild(F)},O=()=>{navigator.clipboard.writeText(A),m(!0),setTimeout(()=>m(!1),2e3)};return n.jsxs("div",{className:"min-h-screen bg-gradient-to-b from-blue-50 to-cyan-50 p-2 sm:p-2",children:[n.jsxs("div",{className:"max-w-md mx-auto",children:[n.jsxs("div",{className:"bg-white rounded-xl shadow-lg p-2 sm:p-2 mb-2 sm:mb-3",style:{borderRadius:"15px"},children:[n.jsxs("div",{className:"grid grid-cols-3 items-center mb-2",children:[n.jsx("div",{className:"flex justify-start",children:n.jsxs("button",{onClick:()=>{a?(i(null),f(null)):r()},className:"flex items-center gap-1.5 font-bold hover:opacity-70 transition-opacity text-sm sm:text-base",style:{color:"#4A9B8E"},children:[n.jsx(Ft,{size:18,className:"sm:w-5 sm:h-5"}),""]})}),n.jsxs("div",{className:"flex items-center justify-center gap-1.5 sm:gap-2",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-8 h-8 sm:w-10 sm:h-10 object-contain",onError:F=>F.target.style.display="none"}),n.jsx("h1",{className:"text-base sm:text-lg font-bold",style:{color:"#249689",whiteSpace:"nowrap"},children:" QR "})]}),n.jsx("div",{})]}),n.jsx("div",{className:"p-2 rounded-lg text-center",style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:"10px"},children:n.jsx("p",{className:"text-xs font-medium",style:{color:"#1e40af"},children:a?"   !":"    QR  "})}),!a&&n.jsxs("div",{className:"mt-4 p-3 bg-gray-50 rounded-lg space-y-3",style:{borderRadius:"10px"},children:[n.jsxs("div",{className:"flex flex-wrap items-center justify-between gap-x-6 gap-y-2 text-sm font-medium text-gray-700 px-2",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-gray-600",children:" :"}),n.jsx("span",{className:"font-bold text-gray-900",children:T})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-gray-600",children:" :"}),n.jsx("span",{className:"font-bold text-gray-900",children:b})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("span",{className:"text-gray-600",children:" :"}),n.jsx("span",{className:"font-mono font-bold text-gray-900",children:w})]})]}),n.jsxs("div",{className:"flex gap-2",style:{width:"100%"},children:[n.jsx("input",{type:"text",value:A,readOnly:!0,className:"flex-1 px-3 py-2 text-xs bg-white border border-gray-300 rounded-lg",style:{borderRadius:"8px",minWidth:0},placeholder:"  "}),n.jsx("button",{onClick:O,className:"flex items-center gap-1 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-all text-xs font-medium whitespace-nowrap",style:{backgroundColor:u?"#10B981":"#4A9B8E",borderRadius:"8px"},children:u?n.jsxs(n.Fragment,{children:[n.jsx(ma,{size:14}),n.jsx("span",{children:""})]}):n.jsxs(n.Fragment,{children:[n.jsx(hi,{size:14}),n.jsx("span",{children:""})]})})]})]})]}),n.jsx("div",{className:"bg-white rounded-xl shadow-lg p-2 sm:p-2",style:{borderRadius:"15px"},children:o?n.jsx("div",{className:"flex justify-center items-center py-8",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2",style:{borderColor:"#4A9B8E"}})}):a?n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[n.jsx("h2",{className:"text-base sm:text-lg font-bold",style:{color:"#4A9B8E"},children:"  QR "}),n.jsx("button",{onClick:()=>{i(null),f(null)},className:"text-xs text-gray-600 hover:text-gray-900 font-medium",children:"   "})]}),c?n.jsxs("div",{className:"text-center py-2 sm:py-6",children:[n.jsx("div",{className:"animate-spin rounded-full h-8 w-8 sm:h-10 sm:w-10 border-b-2 mx-auto mb-2",style:{borderColor:"#4A9B8E"}}),n.jsx("p",{className:"text-sm sm:text-base text-gray-600 font-medium",children:"QR   ..."}),n.jsx("p",{className:"text-xs text-gray-400 mt-2",children:" "})]}):d?n.jsxs("div",{className:"space-y-2 sm:space-y-3",children:[n.jsx("div",{className:"border-4 rounded-xl overflow-hidden shadow-lg",style:{borderColor:"#4A9B8E",borderRadius:"12px"},children:n.jsx("img",{src:d,alt:" QR ",className:"w-full h-auto",style:{maxWidth:"300px",margin:"0 auto"}})}),n.jsx("div",{className:"p-2 bg-gradient-to-r from-blue-50 to-cyan-50 rounded-lg",style:{borderRadius:"10px"},children:n.jsxs("div",{className:"text-sm space-y-2",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:" "}),n.jsx("span",{className:"font-medium",children:T})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:" "}),n.jsx("span",{className:"font-medium",children:b})]}),n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("span",{className:"text-gray-600",children:" "}),n.jsx("span",{className:"font-mono font-medium",children:w})]})]})}),n.jsxs("button",{onClick:E,className:"w-full py-2 flex items-center justify-center gap-2 text-white rounded-xl hover:opacity-90 font-bold text-base sm:text-lg shadow-lg hover:shadow-xl transition-all",style:{backgroundColor:"#5B9BD5",borderRadius:"12px"},children:[n.jsx(Rr,{size:22})," QR "]}),n.jsxs("div",{className:"space-y-3 pt-4 border-t border-gray-200",children:[n.jsxs("div",{children:[n.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"   "}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx("input",{type:"text",value:A,readOnly:!0,className:"flex-1 px-3 py-2 text-xs bg-gray-50 border border-gray-300 rounded-lg",style:{borderRadius:"8px"}}),n.jsxs("button",{onClick:O,className:"flex items-center gap-1.5 px-4 py-2 text-white rounded-lg hover:opacity-90 transition-all text-sm font-medium",style:{backgroundColor:u?"#10B981":"#4A9B8E",borderRadius:"8px"},children:[u?n.jsx(ma,{size:16}):n.jsx(hi,{size:16}),u?"":""]})]})]}),n.jsxs("div",{className:"p-2 bg-yellow-50 rounded-lg border border-yellow-200",style:{borderRadius:"8px"},children:[n.jsx("p",{className:"text-xs text-yellow-800 font-medium mb-1",children:"  :"}),n.jsxs("ul",{className:"text-xs text-yellow-700 space-y-1 ml-4",children:[n.jsx("li",{children:" QR    "}),n.jsx("li",{children:"  QR      "}),n.jsx("li",{children:"   /   "})]})]})]})]}):null]}):n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"flex items-center justify-between mb-2 sm:mb-3",children:[n.jsx("h2",{className:"text-base sm:text-lg font-bold",style:{color:"#4A9B8E"},children:"  "}),e.length>0&&n.jsxs("span",{className:"text-xs text-gray-500",children:[" ",e.length,""]})]}),e.length===0?n.jsxs("div",{className:"text-center py-16 sm:py-8",children:[n.jsx("div",{className:"text-5xl sm:text-6xl mb-2",children:""}),n.jsx("p",{className:"text-sm sm:text-base text-gray-600 mb-2",children:"  "}),n.jsx("p",{className:"text-xs text-gray-400",children:" "})]}):n.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2 sm:gap-2",children:e.map(F=>n.jsxs("div",{onClick:()=>L(F),className:"group cursor-pointer border-2 rounded-xl overflow-hidden hover:shadow-xl hover:scale-105 transition-all duration-300",style:{borderColor:"#E0E0E0",borderRadius:"12px"},children:[F.template_image_url&&n.jsxs("div",{className:"relative overflow-hidden",style:{backgroundColor:"#f5f5f5"},children:[n.jsx("img",{src:F.template_image_url,alt:F.name,className:"w-full h-auto object-cover group-hover:opacity-90 transition-opacity",style:{maxHeight:"100px"}}),n.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-20 transition-all duration-300 flex items-center justify-center",children:n.jsx("span",{className:"text-white font-bold text-sm sm:text-base opacity-0 group-hover:opacity-100 transition-opacity bg-black bg-opacity-50 px-4 py-2 rounded-lg",children:""})})]}),n.jsxs("div",{className:"p-2 sm:p-2",children:[n.jsx("h3",{className:"font-bold mb-1 text-sm sm:text-base",style:{color:"#249689"},children:F.name}),F.description&&n.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:F.description})]})]},F.id))})]})})]}),n.jsx("canvas",{ref:g,style:{display:"none"}})]})}function Dv(){const[t,r]=P.useState(""),[e,s]=P.useState(!1),a=lo(),i=c=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(c),o=()=>{document.getElementById("subscribe")?.scrollIntoView({behavior:"smooth",block:"start"})},l=async c=>{c.preventDefault();const h=t.trim();if(!i(h)){alert("   .");return}try{const f=new URLSearchParams(window.location.search).get("ref"),{data:u,error:m}=await ce.from("event_participants").insert([{email:h,referrer_code:f||null,event_name:" ",privacy_agreed:!0,marketing_agreed:!0}]).select();if(m){console.error("  :",m),alert(`    .

${m.message}`);return}console.log("   :",u),localStorage.setItem("mathLetterEmail",h),a(f?`/event?ref=${encodeURIComponent(f)}`:"/event")}catch(d){console.error(" :",d),alert(` .

${d.message}`)}};return n.jsxs("div",{style:{fontFamily:"'Noto Sans KR', sans-serif"},children:[n.jsx("style",{children:`
        * {
          margin: 0;
          padding: 0;
          box-sizing: border-box;
        }

        :root {
          --primary: #2D7C8E;
          --primary-light: #4BA5B8;
          --primary-dark: #1E5A6A;
          --accent: #5CC0CE;
          --accent-light: #8FD9E3;
          --text-dark: #1a1a1a;
          --text-gray: #4a4a4a;
          --text-light: #6a6a6a;
          --bg-light: #f8fafb;
          --bg-white: #ffffff;
          --gradient-1: linear-gradient(135deg, #2D7C8E 0%, #4BA5B8 100%);
          --gradient-2: linear-gradient(135deg, #5CC0CE 0%, #8FD9E3 100%);
          --shadow-sm: 0 2px 8px rgba(45, 124, 142, 0.08);
          --shadow-md: 0 4px 16px rgba(45, 124, 142, 0.12);
          --shadow-lg: 0 8px 32px rgba(45, 124, 142, 0.16);
        }

        body {
          color: var(--text-dark);
          line-height: 1.7;
          overflow-x: hidden;
          background: var(--bg-white);
        }

        .container {
          max-width: 1200px;
          margin: 0 auto;
          padding: 0 24px;
        }

        /* Navigation */
        .navbar {
          position: fixed;
          top: 0;
          left: 0;
          right: 0;
          background: rgba(255, 255, 255, 0.95);
          backdrop-filter: blur(10px);
          box-shadow: var(--shadow-sm);
          z-index: 1000;
          transition: all 0.3s ease;
        }

        .nav-content {
          display: flex;
          justify-content: space-between;
          align-items: center;
          padding: 16px 0;
        }

        .logo {
          display: flex;
          align-items: center;
          gap: 12px;
          text-decoration: none;
          color: var(--primary);
          font-weight: 700;
          font-size: 1.5rem;
          transition: transform 0.3s ease;
          cursor: pointer;
        }

        .logo:hover {
          transform: translateY(-2px);
        }

        .logo img {
          height: 40px;
          width: auto;
        }

        .cta-btn-nav {
          background: var(--gradient-1);
          color: white;
          border: none;
          padding: 12px 28px;
          border-radius: 50px;
          font-weight: 600;
          font-size: 0.95rem;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: var(--shadow-sm);
        }

        .cta-btn-nav:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-md);
        }

        /* Hero Section */
        .hero {
          position: relative;
          min-height: 100vh;
          display: flex;
          align-items: center;
          justify-content: center;
          padding: 120px 0 80px;
          overflow: hidden;
          background: linear-gradient(135deg, #f8fafb 0%, #e8f4f7 100%);
        }

        .hero-background {
          position: absolute;
          top: 0;
          left: 0;
          right: 0;
          bottom: 0;
          overflow: hidden;
          z-index: 0;
        }

        .floating-shape {
          position: absolute;
          border-radius: 50%;
          opacity: 0.1;
          animation: float 20s infinite ease-in-out;
        }

        .shape-1 {
          width: 400px;
          height: 400px;
          background: var(--gradient-1);
          top: -100px;
          right: -100px;
          animation-delay: 0s;
        }

        .shape-2 {
          width: 300px;
          height: 300px;
          background: var(--gradient-2);
          bottom: -50px;
          left: -50px;
          animation-delay: 7s;
        }

        .shape-3 {
          width: 200px;
          height: 200px;
          background: var(--accent);
          top: 50%;
          left: 10%;
          animation-delay: 14s;
        }

        @keyframes float {
          0%, 100% { transform: translate(0, 0) rotate(0deg); }
          33% { transform: translate(30px, -30px) rotate(120deg); }
          66% { transform: translate(-20px, 20px) rotate(240deg); }
        }

        .hero-content {
          position: relative;
          z-index: 1;
          text-align: center;
          max-width: 800px;
          margin: 0 auto;
          animation: fadeInUp 1s ease-out;
        }

        @keyframes fadeInUp {
          from {
            opacity: 0;
            transform: translateY(30px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }

        .hero-title {
          font-family: 'Playfair Display', serif;
          font-size: 3.5rem;
          font-weight: 700;
          line-height: 1.2;
          margin-bottom: 24px;
          color: var(--text-dark);
        }

        .hero-title .highlight {
          background: var(--gradient-1);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
        }

        .hero-subtitle {
          font-size: 1.25rem;
          line-height: 1.8;
          color: var(--text-gray);
          margin-bottom: 40px;
        }

        .hero-subtitle strong {
          color: var(--primary);
          font-weight: 700;
        }

        .cta-btn-primary {
          background: var(--gradient-1);
          color: white;
          border: none;
          padding: 18px 48px;
          border-radius: 50px;
          font-size: 1.15rem;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: var(--shadow-md);
          display: inline-flex;
          align-items: center;
          gap: 12px;
        }

        .cta-btn-primary:hover {
          transform: translateY(-3px);
          box-shadow: var(--shadow-lg);
        }

        .hero-note {
          margin-top: 20px;
          font-size: 1.1rem;
          color: var(--text-light);
        }

        .scroll-indicator {
          position: absolute;
          bottom: 40px;
          left: 50%;
          transform: translateX(-50%);
          animation: bounce 2s infinite;
          color: var(--primary);
          font-size: 1.5rem;
          cursor: pointer;
        }

        @keyframes bounce {
          0%, 100% { transform: translate(-50%, 0); }
          50% { transform: translate(-50%, 10px); }
        }

        /* Section Styles */
        section {
          padding: 100px 0;
        }

        .section-header {
          text-align: center;
          margin-bottom: 60px;
        }

        .section-title {
          font-family: 'Playfair Display', serif;
          font-size: 2.5rem;
          font-weight: 700;
          color: var(--text-dark);
          margin-bottom: 16px;
          position: relative;
          display: inline-block;
        }

        .section-title::after {
          content: '';
          position: absolute;
          bottom: -10px;
          left: 50%;
          transform: translateX(-50%);
          width: 60px;
          height: 4px;
          background: var(--gradient-1);
          border-radius: 2px;
        }

        /* About Section */
        .about {
          background: var(--bg-white);
        }

        .about-content {
          max-width: 900px;
          margin: 0 auto;
        }

        .lead-text {
          font-size: 1.2rem;
          line-height: 1.9;
          color: var(--text-gray);
          text-align: center;
          margin-bottom: 60px;
        }

        .lead-text strong {
          color: var(--primary);
          font-weight: 700;
        }

        .about-features {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
          gap: 40px;
        }

        .feature-item {
          display: flex;
          align-items: flex-start;
          gap: 20px;
          padding: 30px;
          background: var(--bg-light);
          border-radius: 16px;
          transition: all 0.3s ease;
        }

        .feature-item:hover {
          transform: translateY(-5px);
          box-shadow: var(--shadow-md);
        }

        .feature-icon {
          font-size: 3rem;
          flex-shrink: 0;
        }

        .feature-text h3 {
          font-size: 1.15rem;
          font-weight: 700;
          color: var(--primary);
          margin-bottom: 8px;
        }

        .feature-text p {
          color: var(--text-gray);
          line-height: 1.6;
        }

        /* Why Section */
        .why {
          background: var(--bg-light);
        }

        .why-content {
          display: grid;
          grid-template-columns: 1fr 1.2fr;
          gap: 60px;
          align-items: center;
        }

        .why-visual {
          position: relative;
        }

        .pattern-grid {
          display: grid;
          grid-template-columns: repeat(3, 1fr);
          gap: 12px;
          padding: 20px;
          background: white;
          border-radius: 20px;
          box-shadow: var(--shadow-md);
          max-width: 280px;
          margin: 0 auto;
        }

        .pattern-item {
          font-size: 2.5rem;
          text-align: center;
          padding: 12px;
          background: var(--bg-light);
          border-radius: 12px;
          transition: transform 0.3s ease;
        }

        .pattern-item:hover {
          transform: scale(1.1) rotate(5deg);
        }

        .why-text {
          padding: 20px;
        }

        .why-lead {
          font-size: 1.15rem;
          color: var(--text-gray);
          margin-bottom: 24px;
        }

        .why-emphasis {
          font-size: 1.3rem;
          line-height: 1.6;
          color: var(--text-dark);
          margin-bottom: 24px;
        }

        .highlight-text {
          background: var(--gradient-1);
          -webkit-background-clip: text;
          -webkit-text-fill-color: transparent;
          background-clip: text;
          font-weight: 600;
        }

        .why-description {
          font-size: 1.15rem;
          line-height: 1.8;
          color: var(--text-gray);
        }

        .why-description strong {
          color: var(--primary);
          font-weight: 700;
        }

        /* How Section */
        .how {
          background: var(--bg-white);
        }

        .how-steps {
          display: flex;
          justify-content: center;
          align-items: center;
          gap: 30px;
          flex-wrap: wrap;
        }

        .step-item {
          flex: 1;
          min-width: 250px;
          max-width: 300px;
          padding: 40px 30px;
          text-align: center;
          background: var(--bg-light);
          border-radius: 20px;
          position: relative;
          transition: all 0.3s ease;
        }

        .step-item:hover {
          transform: translateY(-10px);
          box-shadow: var(--shadow-lg);
          background: white;
        }

        .step-number {
          position: absolute;
          top: -20px;
          left: 50%;
          transform: translateX(-50%);
          width: 50px;
          height: 50px;
          background: var(--gradient-1);
          color: white;
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          font-size: 1.5rem;
          font-weight: 700;
          box-shadow: var(--shadow-md);
        }

        .step-icon {
          font-size: 3rem;
          color: var(--primary);
          margin: 20px 0;
        }

        .step-item h3 {
          font-size: 1.2rem;
          font-weight: 700;
          color: var(--text-dark);
          margin-bottom: 12px;
        }

        .step-item p {
          color: var(--text-gray);
          line-height: 1.6;
        }

        .step-arrow {
          font-size: 2rem;
          color: var(--accent);
          flex-shrink: 0;
        }

        /* Social Proof Section */
        .social-proof {
          background: linear-gradient(135deg, #2D7C8E 0%, #4BA5B8 100%);
          color: white;
        }

        .social-proof .section-title {
          color: white;
        }

        .social-proof .section-title::after {
          background: white;
        }

        .testimonials {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
          gap: 30px;
          margin-bottom: 60px;
        }

        .testimonial-item {
          background: rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(10px);
          padding: 40px 30px;
          border-radius: 20px;
          border: 1px solid rgba(255, 255, 255, 0.2);
          transition: all 0.3s ease;
        }

        .testimonial-item:hover {
          transform: translateY(-5px);
          background: rgba(255, 255, 255, 0.15);
        }

        .quote-icon {
          font-size: 4rem;
          font-family: Georgia, serif;
          color: var(--accent-light);
          line-height: 1;
          margin-bottom: 16px;
        }

        .testimonial-text {
          font-size: 1.3rem;
          line-height: 1.6;
          margin-bottom: 16px;
        }

        .testimonial-author {
          font-size: 1.1rem;
          color: var(--accent-light);
        }

        .stats {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 30px;
          padding: 40px;
          background: rgba(255, 255, 255, 0.1);
          backdrop-filter: blur(10px);
          border-radius: 20px;
          border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .stat-item {
          text-align: center;
        }

        .stat-number {
          font-size: 3rem;
          font-weight: 700;
          margin-bottom: 8px;
        }

        .stat-label {
          font-size: 1rem;
          color: var(--accent-light);
        }

        .stat-divider {
          display: none;
        }

        /* Final CTA Section */
        .final-cta {
          background: var(--bg-light);
          padding: 120px 0;
        }

        .cta-content {
          max-width: 900px;
          margin: 0 auto;
          display: grid;
          grid-template-columns: auto 1fr;
          gap: 60px;
          align-items: center;
        }

        .cta-visual {
          display: flex;
          justify-content: center;
          align-items: center;
        }

        .envelope-icon {
          width: 150px;
          height: 150px;
          background: var(--gradient-1);
          border-radius: 50%;
          display: flex;
          align-items: center;
          justify-content: center;
          box-shadow: var(--shadow-lg);
          animation: pulse 2s infinite;
        }

        .envelope-icon i {
          font-size: 4rem;
          color: white;
        }

        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.05); }
        }

        .cta-title {
          font-family: 'Playfair Display', serif;
          font-size: 2rem;
          font-weight: 700;
          line-height: 1.4;
          color: var(--text-dark);
          margin-bottom: 20px;
        }

        .cta-subtitle {
          font-size: 1.15rem;
          line-height: 1.8;
          color: var(--text-gray);
          margin-bottom: 40px;
        }

        .cta-subtitle strong {
          color: var(--primary);
          font-weight: 700;
        }

        /* Subscribe Form */
        .subscribe-form {
          margin-top: 40px;
        }

        .form-group {
          display: flex;
          gap: 12px;
          margin-bottom: 16px;
        }

        .email-input {
          flex: 1;
          padding: 16px 24px;
          border: 2px solid #e0e0e0;
          border-radius: 50px;
          font-size: 1rem;
          font-family: 'Noto Sans KR', sans-serif;
          transition: all 0.3s ease;
        }

        .email-input:focus {
          outline: none;
          border-color: var(--primary);
          box-shadow: 0 0 0 4px rgba(45, 124, 142, 0.1);
        }

        .submit-btn {
          background: var(--gradient-1);
          color: white;
          border: none;
          padding: 16px 36px;
          border-radius: 50px;
          font-size: 1rem;
          font-weight: 700;
          cursor: pointer;
          transition: all 0.3s ease;
          box-shadow: var(--shadow-md);
          display: inline-flex;
          align-items: center;
          gap: 10px;
          white-space: nowrap;
        }

        .submit-btn:hover {
          transform: translateY(-2px);
          box-shadow: var(--shadow-lg);
        }

       .form-note {
        font-size: 0.9rem;
        color: var(--text-light);
        display: flex;
        flex-direction: column;  /*  -    */
        align-items: center;      /*   -    */
        gap: 8px;
        text-align: center;       /*  -    */
      }

        .form-note i {
          color: var(--primary);
        }

        /* Footer */
        .footer {
          background: var(--text-dark);
          color: white;
          padding: 60px 0;
        }

        .footer-content {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 24px;
          text-align: center;
        }

        .footer-logo {
          display: flex;
          flex-direction: column;
          align-items: center;
          gap: 12px;
        }

        .footer-logo img {
          height: 50px;
          width: auto;
        }

        .footer-logo p {
          font-size: 1.1rem;
          font-weight: 600;
        }

        .footer-info {
          color: rgba(255, 255, 255, 0.7);
        }

        .footer-info p {
          margin: 8px 0;
          font-size: 0.95rem;
        }

        /* Responsive */
        @media (max-width: 1024px) {
          .why-content {
            grid-template-columns: 1fr;
            gap: 40px;
          }

          .step-arrow {
            display: none;
          }
        }

        @media (max-width: 768px) {
          .hero-title {
            font-size: 2.5rem;
          }

          .hero-subtitle {
            font-size: 1.3rem;
          }

          .section-title {
            font-size: 2rem;
          }

          .pattern-grid {
            max-width: 250px;
            padding: 18px;
            gap: 10px;
          }

          .pattern-item {
            font-size: 2rem;
            padding: 10px;
          }

          .cta-content {
            grid-template-columns: 1fr;
            text-align: center;
          }

          .cta-title {
            font-size: 1.75rem;
          }

          .form-group {
            flex-direction: column;
          }

          .submit-btn {
            width: 100%;
            justify-content: center;
          }

          .about-features {
            grid-template-columns: 1fr;
          }

          .stats {
            gap: 30px;
          }

          .stat-divider {
            display: none;
          }

          .how-steps {
            flex-direction: column;
          }

          .step-item {
            max-width: 100%;
          }
        }

        @media (max-width: 480px) {
          .container {
            padding: 0 16px;
          }

          .hero {
            padding: 100px 0 60px;
          }

          .hero-title {
            font-size: 2rem;
          }

          section {
            padding: 60px 0;
          }

          .cta-btn-primary {
            padding: 16px 32px;
            font-size: 1rem;
          }

          .logo span {
            font-size: 1.8rem;
          }

          .cta-btn-nav {
            padding: 10px 20px;
            font-size: 0.85rem;
          }

          .envelope-icon {
            width: 100px;
            height: 100px;
          }

          .envelope-icon i {
            font-size: 2.5rem;
          }

          .pattern-item {
            font-size: 1.8rem;
            padding: 8px;
          }

          .pattern-grid {
            max-width: 220px;
            padding: 15px;
            gap: 8px;
          }
        }
      `}),n.jsx("link",{rel:"preconnect",href:"https://fonts.googleapis.com"}),n.jsx("link",{rel:"preconnect",href:"https://fonts.gstatic.com",crossOrigin:"true"}),n.jsx("link",{href:"https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=Playfair+Display:wght@600;700&display=swap",rel:"stylesheet"}),n.jsx("link",{rel:"stylesheet",href:"https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css"}),n.jsx("nav",{className:"navbar",children:n.jsx("div",{className:"container",children:n.jsx("div",{className:"nav-content",children:n.jsxs("div",{className:"logo",onClick:()=>window.scrollTo({top:0,behavior:"smooth"}),children:[n.jsx("img",{src:"/images/logo.png",alt:" "}),n.jsx("span",{children:"LAS Book "})]})})})}),n.jsxs("section",{className:"hero",children:[n.jsxs("div",{className:"hero-background",children:[n.jsx("div",{className:"floating-shape shape-1"}),n.jsx("div",{className:"floating-shape shape-2"}),n.jsx("div",{className:"floating-shape shape-3"})]}),n.jsx("div",{className:"container",children:n.jsxs("div",{className:"hero-content",children:[n.jsxs("h1",{className:"hero-title",children:[" ,",n.jsx("br",{}),n.jsx("span",{className:"highlight",children:"  "}),"",n.jsx("br",{})," ."]}),n.jsxs("p",{className:"hero-subtitle",children:["   ",n.jsx("br",{})," ,",n.jsx("strong",{children:"' '"}),"",n.jsx("br",{}),"   ."]}),n.jsxs("button",{className:"cta-btn-primary",onClick:o,children:[n.jsx("i",{className:"fas fa-envelope"})," "]}),n.jsxs("p",{className:"hero-note",children:["    ",n.jsx("br",{}),"   ."]})]})}),n.jsx("div",{className:"scroll-indicator",onClick:o,children:n.jsx("i",{className:"fas fa-chevron-down"})})]}),n.jsx("section",{className:"about",children:n.jsxs("div",{className:"container",children:[n.jsx("div",{className:"section-header",children:n.jsxs("h2",{className:"section-title",children:[" ",n.jsx("br",{}),"?"]})}),n.jsxs("div",{className:"about-content",children:[n.jsxs("p",{className:"lead-text",children:[" ",n.jsx("strong",{children:"  "}),n.jsx("br",{}),n.jsx("strong",{children:"  "})," ,",n.jsx("br",{}),"  ",n.jsx("br",{}),n.jsx("strong",{children:"' '"})," ",n.jsx("br",{}),"   ."]}),n.jsxs("div",{className:"about-features",children:[n.jsxs("div",{className:"feature-item",children:[n.jsx("div",{className:"feature-icon",children:""}),n.jsxs("div",{className:"feature-text",children:[n.jsx("h3",{children:""}),n.jsx("p",{children:"  "})]})]}),n.jsxs("div",{className:"feature-item",children:[n.jsx("div",{className:"feature-icon",children:""}),n.jsxs("div",{className:"feature-text",children:[n.jsx("h3",{children:""}),n.jsx("p",{children:"  "})]})]}),n.jsxs("div",{className:"feature-item",children:[n.jsx("div",{className:"feature-icon",children:""}),n.jsxs("div",{className:"feature-text",children:[n.jsx("h3",{children:""}),n.jsx("p",{children:"   "})]})]})]})]})]})}),n.jsx("section",{className:"why",children:n.jsxs("div",{className:"container",children:[n.jsx("div",{className:"section-header",children:n.jsxs("h2",{className:"section-title",children:["   ",n.jsx("br",{})," ?"]})}),n.jsxs("div",{className:"why-content",children:[n.jsx("div",{className:"why-visual",children:n.jsxs("div",{className:"pattern-grid",children:[n.jsx("div",{className:"pattern-item",children:""}),n.jsx("div",{className:"pattern-item",children:""}),n.jsx("div",{className:"pattern-item",children:""}),n.jsx("div",{className:"pattern-item",children:""}),n.jsx("div",{className:"pattern-item",children:""}),n.jsx("div",{className:"pattern-item",children:""})]})}),n.jsxs("div",{className:"why-text",children:[n.jsxs("p",{className:"why-lead",children:["",n.jsx("br",{})," ",n.jsx("strong",{children:"''"}),"   ."]}),n.jsxs("p",{className:"why-emphasis",children:["    ",n.jsx("br",{}),n.jsx("span",{className:"highlight-text",children:"'   '"}),n.jsx("br",{}),"."]}),n.jsxs("p",{className:"why-description",children:[" ",n.jsx("br",{})," ",n.jsx("strong",{children:"  "})," ,",n.jsx("br",{}),"    ",n.jsx("br",{}),"."]})]})]})]})}),n.jsx("section",{className:"how",children:n.jsxs("div",{className:"container",children:[n.jsx("div",{className:"section-header",children:n.jsx("h2",{className:"section-title",children:" "})}),n.jsxs("div",{className:"how-steps",children:[n.jsxs("div",{className:"step-item",children:[n.jsx("div",{className:"step-number",children:"1"}),n.jsx("div",{className:"step-icon",children:n.jsx("i",{className:"fas fa-user-plus"})}),n.jsx("h3",{children:"  ()"}),n.jsx("p",{children:"  ."})]}),n.jsx("div",{className:"step-arrow",children:n.jsx("i",{className:"fas fa-arrow-right"})}),n.jsxs("div",{className:"step-item",children:[n.jsx("div",{className:"step-number",children:"2"}),n.jsx("div",{className:"step-icon",children:n.jsx("i",{className:"fas fa-envelope-open-text"})}),n.jsx("h3",{children:"    "}),n.jsx("p",{children:"      ."})]}),n.jsx("div",{className:"step-arrow",children:n.jsx("i",{className:"fas fa-arrow-right"})}),n.jsxs("div",{className:"step-item",children:[n.jsx("div",{className:"step-number",children:"3"}),n.jsx("div",{className:"step-icon",children:n.jsx("i",{className:"fas fa-comments"})}),n.jsx("h3",{children:"  "}),n.jsx("p",{children:", ,  '    '  ."})]})]})]})}),n.jsx("section",{className:"social-proof",children:n.jsxs("div",{className:"container",children:[n.jsx("div",{className:"section-header",children:n.jsx("h2",{className:"section-title",children:"  "})}),n.jsxs("div",{className:"testimonials",children:[n.jsxs("div",{className:"testimonial-item",children:[n.jsx("div",{className:"quote-icon",children:'"'}),n.jsx("p",{className:"testimonial-text",children:"  ."}),n.jsx("div",{className:"testimonial-author",children:"-  2 "})]}),n.jsxs("div",{className:"testimonial-item",children:[n.jsx("div",{className:"quote-icon",children:'"'}),n.jsx("p",{className:"testimonial-text",children:"   ."}),n.jsx("div",{className:"testimonial-author",children:"-  "})]}),n.jsxs("div",{className:"testimonial-item",children:[n.jsx("div",{className:"quote-icon",children:'"'}),n.jsx("p",{className:"testimonial-text",children:"   ."}),n.jsx("div",{className:"testimonial-author",children:"-  "})]})]}),n.jsxs("div",{className:"stats",children:[n.jsxs("div",{className:"stat-item",children:[n.jsx("div",{className:"stat-number",children:"10,000+"}),n.jsx("div",{className:"stat-label",children:" "})]}),n.jsx("div",{className:"stat-divider"}),n.jsxs("div",{className:"stat-item",children:[n.jsx("div",{className:"stat-number",children:""}),n.jsx("div",{className:"stat-label",children:"  "})]}),n.jsx("div",{className:"stat-divider"}),n.jsxs("div",{className:"stat-item",children:[n.jsx("div",{className:"stat-number",children:"100%"}),n.jsx("div",{className:"stat-label",children:""})]})]})]})}),n.jsx("section",{className:"final-cta",id:"subscribe",children:n.jsx("div",{className:"container",children:n.jsxs("div",{className:"cta-content",children:[n.jsx("div",{className:"cta-visual",children:n.jsx("div",{className:"envelope-icon",children:n.jsx("i",{className:"fas fa-envelope"})})}),n.jsxs("div",{className:"cta-text",children:[n.jsxs("h2",{className:"cta-title",children:["  ,",n.jsx("br",{}),"  ."]}),n.jsxs("p",{className:"cta-subtitle",children:[" ,   ",n.jsx("br",{}),n.jsx("strong",{children:"'   '"}),"",n.jsx("br",{}),"."]}),n.jsxs("form",{className:"subscribe-form",onSubmit:l,children:[n.jsxs("div",{className:"form-group",children:[n.jsx("input",{type:"email",value:t,onChange:c=>r(c.target.value),className:"email-input",placeholder:"  ",required:!0}),n.jsxs("button",{type:"submit",className:"submit-btn",children:[n.jsx("i",{className:"fas fa-paper-plane"})," "]})]}),n.jsxs("p",{className:"form-note",children:[n.jsx("i",{className:"fas fa-lock"}),"    .",n.jsx("br",{}),"  ."]})]})]})]})})}),n.jsx("footer",{className:"footer",children:n.jsx("div",{className:"container",children:n.jsxs("div",{className:"footer-content",children:[n.jsxs("div",{className:"footer-logo",children:[n.jsx("img",{src:"/images/logo.png",alt:" "}),n.jsx("p",{children:" "})]}),n.jsxs("div",{className:"footer-info",children:[n.jsx("p",{children:" 2024 . All rights reserved."}),n.jsx("p",{children:"     "})]})]})})})]})}function Ov({user:t,onBack:r}){const[e,s]=P.useState([]),[a,i]=P.useState(!0),[o,l]=P.useState(!1),[c,h]=P.useState(!1),[d,f]=P.useState(null),[u,m]=P.useState({day_number:"",title:"",video_url:"",thumbnail_url:"",description:"",duration:"",is_ready:!1});P.useEffect(()=>{p()},[]);const p=async()=>{try{i(!0);const{data:_,error:L}=await ce.from("math_letters").select("*").order("day_number",{ascending:!0});if(L)throw L;s(_||[])}catch(_){console.error("   :",_),alert("  .")}finally{i(!1)}},x=(_=null)=>{_?(f(_),m(_)):(f(null),m({day_number:"",title:"",video_url:"",thumbnail_url:"",description:"",duration:"",is_ready:!1})),l(!0)},g=async()=>{try{if(!u.day_number||!u.title){alert("  .");return}if(d){const{error:_}=await ce.from("math_letters").update(u).eq("id",d.id);if(_)throw _;alert(".")}else{const{error:_}=await ce.from("math_letters").insert([u]);if(_)throw _;alert(".")}l(!1),p()}catch(_){console.error(" :",_),alert(" .")}},T=async _=>{if(window.confirm(" ?"))try{const{error:L}=await ce.from("math_letters").delete().eq("id",_);if(L)throw L;alert("."),p()}catch(L){console.error(" :",L),alert(" .")}},b=async _=>{try{const L=JSON.parse(_);if(!Array.isArray(L)){alert("  JSON .");return}const{error:E}=await ce.from("math_letters").upsert(L,{onConflict:"day_number"});if(E)throw E;alert(`${L.length}  .`),h(!1),p()}catch(L){console.error("  :",L),alert(" .")}},w=Array.from({length:100},(_,L)=>L+1),A=e.reduce((_,L)=>(_[L.day_number]=L,_),{});return a?n.jsx("div",{className:"min-h-screen flex items-center justify-center bg-white",children:n.jsx("div",{className:"text-xl",children:" ..."})}):n.jsx("div",{className:"min-h-screen bg-white",children:n.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-cover",onError:_=>_.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:""})]}),n.jsxs("div",{className:"space-y-4 mb-8",children:[n.jsxs("button",{onClick:r,className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #7f95eb",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ft,{size:20}),""]}),n.jsxs("button",{onClick:()=>x(),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Fn,{size:20})," "]}),n.jsxs("button",{onClick:()=>h(!0),className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Yc,{size:20})," "]})]}),n.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-8",children:[n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[n.jsx("div",{className:"text-sm text-gray-600 mb-1",children:" "}),n.jsx("div",{className:"text-2xl font-bold",style:{color:"#249689"},children:"100"})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[n.jsx("div",{className:"text-sm text-gray-600 mb-1",children:" "}),n.jsxs("div",{className:"text-2xl font-bold",style:{color:"#70AD47"},children:[e.filter(_=>_.is_ready).length,""]})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 text-center",children:[n.jsx("div",{className:"text-sm text-gray-600 mb-1",children:" "}),n.jsxs("div",{className:"text-2xl font-bold",style:{color:"#FFA500"},children:[100-e.filter(_=>_.is_ready).length,""]})]})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"text-lg font-bold mb-4",style:{color:"#249689"},children:"  "}),n.jsx("div",{className:"grid grid-cols-5 md:grid-cols-10 gap-3",children:w.map(_=>{const L=A[_],E=L?.is_ready;return n.jsxs("div",{onClick:()=>L&&x(L),className:`p-3 rounded-lg text-center cursor-pointer transition-all ${E?"bg-green-50 border-2 border-green-500 hover:bg-green-100":L?"bg-orange-50 border-2 border-orange-400 hover:bg-orange-100":"bg-gray-50 border-2 border-gray-300 hover:bg-gray-100"}`,children:[n.jsxs("div",{className:"text-sm font-bold mb-1",children:[_,""]}),n.jsx("div",{className:"text-xl",children:E?"":L?"":""})]},_)})})]})]}),o&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-2xl font-bold",style:{color:"#249689"},children:d?"  ":"  "}),n.jsx("button",{onClick:()=>l(!1),className:"text-gray-400 hover:text-gray-600",children:n.jsx(Cs,{size:24})})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",children:" *"}),n.jsx("input",{type:"number",value:u.day_number,onChange:_=>m({...u,day_number:parseInt(_.target.value)}),className:"w-full px-3 py-2 border rounded-lg",style:{borderRadius:"10px"},disabled:!!d})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",children:" ()"}),n.jsx("input",{type:"number",value:u.duration,onChange:_=>m({...u,duration:parseInt(_.target.value)}),className:"w-full px-3 py-2 border rounded-lg",style:{borderRadius:"10px"}})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",children:" *"}),n.jsx("input",{type:"text",value:u.title,onChange:_=>m({...u,title:_.target.value}),className:"w-full px-3 py-2 border rounded-lg",style:{borderRadius:"10px"},placeholder:":  "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",children:" URL"}),n.jsx("input",{type:"text",value:u.video_url,onChange:_=>m({...u,video_url:_.target.value}),className:"w-full px-3 py-2 border rounded-lg",style:{borderRadius:"10px"},placeholder:"https://bucket.com/videos/day1.mp4"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",children:" URL"}),n.jsx("input",{type:"text",value:u.thumbnail_url,onChange:_=>m({...u,thumbnail_url:_.target.value}),className:"w-full px-3 py-2 border rounded-lg",style:{borderRadius:"10px"},placeholder:"https://bucket.com/thumbnails/day1.jpg"})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",children:""}),n.jsx("textarea",{value:u.description,onChange:_=>m({...u,description:_.target.value}),className:"w-full px-3 py-2 border rounded-lg",style:{borderRadius:"10px"},rows:"3",placeholder:"  "})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("input",{type:"checkbox",checked:u.is_ready,onChange:_=>m({...u,is_ready:_.target.checked}),className:"w-5 h-5"}),n.jsx("label",{className:"font-bold",children:" "})]})]}),n.jsxs("div",{className:"flex gap-4 mt-6",children:[d&&n.jsxs("button",{onClick:()=>{T(d.id),l(!1)},className:"px-6 py-3 border-2 border-red-500 text-red-500 rounded-lg font-bold hover:bg-red-50 flex items-center gap-2",style:{borderRadius:"10px"},children:[n.jsx(yr,{size:20}),""]}),n.jsx("button",{onClick:()=>l(!1),className:"flex-1 px-6 py-3 border-2 rounded-lg font-bold hover:bg-gray-50",style:{borderColor:"#249689",color:"#249689",borderRadius:"10px"},children:""}),n.jsx("button",{onClick:g,className:"flex-1 px-6 py-3 text-white rounded-lg font-bold hover:opacity-90",style:{backgroundColor:"#249689",borderRadius:"10px"},children:d?"":""})]})]})}),c&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-6 max-w-2xl w-full",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-2xl font-bold",style:{color:"#249689"},children:"  "}),n.jsx("button",{onClick:()=>h(!1),className:"text-gray-400 hover:text-gray-600",children:n.jsx(Cs,{size:24})})]}),n.jsxs("div",{className:"mb-4",children:[n.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"JSON   :"}),n.jsx("textarea",{id:"batchJson",className:"w-full px-3 py-2 border rounded-lg font-mono text-sm",style:{borderRadius:"10px"},rows:"15",placeholder:`[
  {
    "day_number": 1,
    "title": " ",
    "video_url": "https://...",
    "thumbnail_url": "https://...",
    "description": "...",
    "duration": 300,
    "is_ready": true
  }
]`})]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsx("button",{onClick:()=>h(!1),className:"flex-1 px-6 py-3 border-2 rounded-lg font-bold hover:bg-gray-50",style:{borderColor:"#249689",color:"#249689",borderRadius:"10px"},children:""}),n.jsx("button",{onClick:()=>{const _=document.getElementById("batchJson").value;b(_)},className:"flex-1 px-6 py-3 text-white rounded-lg font-bold hover:opacity-90",style:{backgroundColor:"#5B9BD5",borderRadius:"10px"},children:""})]})]})})]})})}function Iv(){const[t,r]=P.useState({parentName:"",phone:"",childGender:"",childAge:"",inquiry:"",referrerCode:"",privacyAgreed:!1,marketingAgreed:!1}),[e,s]=P.useState(!1),[a,i]=P.useState(!1),[o,l]=P.useState(!1),[c,h]=P.useState(!1),[d,f]=P.useState(""),[u,m]=P.useState(""),[p,x]=P.useState(!1),[g,T]=P.useState(""),[b,w]=P.useState(""),[A,_]=P.useState(!1),[L,E]=P.useState(""),[O,F]=P.useState(!1),[M,U]=P.useState(!0),H="/videos/mathletter.mp4";P.useEffect(()=>{(async()=>{try{const z=new URLSearchParams(window.location.search).get("ref"),B=window.location.hostname==="localhost"||window.location.hostname==="127.0.0.1";if(!z){if(B){console.log("  : ref   "),F(!1),U(!1);return}console.log("  : ref  "),F(!0),U(!1);return}console.log("    :",z);const Q=await ue(z);Q.exists&&Q.referrerName?(console.log("  :",Q.referrerName),r(te=>({...te,referrerCode:z})),w(Q.referrerName),x(!0),F(!1)):(console.log("  :    "),F(!0)),U(!1)}catch(y){console.error("   :",y),F(!0),U(!1)}})()},[]),P.useEffect(()=>{const D=localStorage.getItem("mathLetterEmail");D&&(E(D),console.log("  :",D))},[]),P.useEffect(()=>{if(O)return;const D=document.createElement("link");D.rel="preload",D.as="video",D.href=H,document.head.appendChild(D);const y=document.createElement("video");return y.src=H,y.preload="auto",y.muted=!0,y.style.display="none",y.style.position="absolute",y.style.pointerEvents="none",document.body.appendChild(y),y.load(),y.addEventListener("loadeddata",()=>{console.log("   ")}),y.addEventListener("error",z=>{console.error("   :",z),console.error(" :",H)}),()=>{document.head.removeChild(D),document.body.removeChild(y)}},[]);const J=D=>{const{name:y,value:z,type:B,checked:Q}=D.target;r({...t,[y]:B==="checkbox"?Q:z})},ge=D=>{const y=D.replace(/[^\d]/g,"");return y.length<=3?y:y.length<=7?`${y.slice(0,3)}-${y.slice(3)}`:`${y.slice(0,3)}-${y.slice(3,7)}-${y.slice(7,11)}`},xe=D=>{const y=ge(D.target.value);r({...t,phone:y})},Ee=()=>{navigator.clipboard.writeText(u).then(()=>{alert(" !")}).catch(()=>{prompt(" :",u)})},be=()=>{navigator.share?navigator.share({title:" ",text:"   !",url:u}).catch(D=>console.log(" :",D)):Ee()},Te=async()=>{try{const y=await(await fetch(d)).blob(),z=window.URL.createObjectURL(y),B=document.createElement("a");B.href=z,B.download=`QR_${t.referrerCode}.png`,document.body.appendChild(B),B.click(),document.body.removeChild(B),window.URL.revokeObjectURL(z)}catch(D){console.error("QR  :",D),alert("QR   .")}},le=()=>{if(!t.parentName.trim())return alert("  "),!1;if(!t.phone||t.phone.replace(/[^\d]/g,"").length!==11)return alert("   "),!1;if(!t.childGender)return alert("  "),!1;if(!t.childAge||t.childAge<1||t.childAge>20)return alert("    (1-20)"),!1;if(!t.privacyAgreed)return alert("    "),!1;if(t.referrerCode.trim()){const D=Od(t.referrerCode);if(!D.isValid)return alert(D.error),!1}return!0},ue=async D=>{if(!D||D.trim()==="")return{exists:!0,referrerId:null};try{const{data:y,error:z}=await ce.from("users").select("id, name, branch, referral_code").eq("referral_code",D.trim().toUpperCase()).maybeSingle();return z?(console.error("   :",z),{exists:!1,referrerId:null,error:"     "}):y?(console.log("  :",y.referral_code,"-",y.name,"(",y.branch,")"),{exists:!0,referrerId:y.id,referrerName:y.name,referrerBranch:y.branch}):{exists:!1,referrerId:null,error:"  "}}catch(y){return console.error("   :",y),{exists:!1,referrerId:null,error:"     "}}},_e=async D=>{if(D.preventDefault(),!!le()){s(!0);try{const y=t.phone.replace(/[^\d]/g,""),{data:z}=await ce.from("event_participants").select("id").eq("phone",y).maybeSingle();let B=null;if(t.referrerCode.trim()){const re=await ue(t.referrerCode);if(!re.exists){alert(re.error||"  "),s(!1);return}B=t.referrerCode.trim().toUpperCase()}const te={email:localStorage.getItem("mathLetterEmail")||null,event_name:" ",parent_name:t.parentName.trim(),phone:y,child_gender:t.childGender,child_age:parseInt(t.childAge),inquiry:t.inquiry.trim()||null,referrer_code:B,privacy_agreed:t.privacyAgreed,marketing_agreed:t.marketingAgreed,created_at:new Date().toISOString()};if(z){const{error:re}=await ce.from("event_participants").update(te).eq("id",z.id);if(re)throw re}else{const{error:re}=await ce.from("event_participants").insert([te]);if(re)throw re}l(!0),localStorage.removeItem("mathLetterEmail")}catch(y){console.error(" :",y),alert("   .  .")}finally{s(!1)}}},S=()=>{window.location.href="/"},I=()=>{const D=`${window.location.origin}${window.location.pathname}?ref=${t.referrerCode||"SHARE"}`;navigator.share?navigator.share({title:" ",text:"   !",url:D}).catch(y=>console.log(" :",y)):navigator.clipboard.writeText(D).then(()=>{alert(" !")}).catch(()=>{prompt(" :",D)})};return M?n.jsx("div",{className:"min-h-screen flex items-center justify-center",style:{backgroundColor:"#f0fffe"},children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 mx-auto mb-4",style:{borderColor:"#249689"}}),n.jsx("p",{style:{color:"#249689",fontSize:"16px"},children:"  ..."})]})}):O?n.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",style:{backgroundColor:"#f0fffe"},children:n.jsxs("div",{className:"bg-white rounded-2xl shadow-lg p-8 max-w-md w-full text-center",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("div",{className:"w-20 h-20 mx-auto mb-4 flex items-center justify-center rounded-full",style:{backgroundColor:"#fee"},children:n.jsx("svg",{className:"w-12 h-12",style:{color:"#dc2626"},fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),n.jsx("h2",{className:"font-bold mb-3",style:{color:"#249689",fontSize:"24px"},children:" "}),n.jsx("p",{className:"text-gray-600 mb-2",style:{fontSize:"15px"},children:"       ."}),n.jsx("p",{className:"text-gray-500 text-sm",children:"   QR   ."})]}),n.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 mb-6",children:[n.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"   "}),n.jsxs("ul",{className:"text-xs text-left space-y-1",style:{color:"#666"},children:[n.jsx("li",{children:"   QR "}),n.jsx("li",{children:"    "}),n.jsx("li",{children:"     "})]})]}),n.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:n.jsxs("p",{className:"text-xs text-yellow-800",children:[n.jsx("strong",{children:" :"}),"  URL     ."]})}),n.jsx("button",{onClick:()=>window.history.back(),className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689"},children:"  "})]})}):o?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:n.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-8 text-center",children:[n.jsxs("div",{className:"mb-6",children:[n.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:n.jsx("svg",{className:"w-10 h-10 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),n.jsx("h2",{className:"font-bold mb-2",style:{color:"#249689",fontSize:"24px"},children:" !"}),n.jsxs("p",{style:{color:"#666",fontSize:"15px"},children:["  .",n.jsx("br",{}),"   ''!"]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx("button",{onClick:I,className:"w-full py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689",fontSize:"16px"},children:" "}),n.jsx("button",{onClick:S,className:"w-full py-3 font-bold rounded-lg hover:bg-gray-50 transition-colors",style:{color:"#000000",border:"2px solid #d1d5db",backgroundColor:"white",fontSize:"16px"},children:""})]})]})}):n.jsxs("div",{className:"min-h-screen bg-gray-50 p-2",children:[n.jsxs("div",{className:"max-w-md mx-auto bg-white rounded-lg shadow-lg p-3",children:[n.jsxs("div",{className:"mb-3",children:[n.jsxs("div",{className:"bg-red-700 text-white text-center py-6 rounded-lg mb-1.5",children:[n.jsx("h1",{className:"font-bold mb-1.5",style:{fontSize:"20px"},children:" "}),n.jsx("h2",{className:"font-bold",style:{fontSize:"24px"},children:"  "})]}),n.jsx("div",{className:"text-center py-1",children:n.jsx("p",{className:"font-bold !mt-0",style:{color:"#249689",fontSize:"18px"},children:"   ''!"})})]}),n.jsxs("div",{className:"text-center mt-0 mb-2",style:{marginTop:"-4px"},children:[n.jsx("h2",{className:"font-bold",style:{color:"#dc2626",fontSize:"28px",fontFamily:"'Noto Sans KR', sans-serif",fontWeight:"900"},children:" "}),n.jsx("h3",{className:"font-bold",style:{color:"#249689",fontSize:"20px",fontFamily:"'Noto Sans KR', sans-serif",fontWeight:"900"},children:"(   !!)"})]}),n.jsx("div",{className:"text-center mb-4",children:n.jsxs("button",{onClick:()=>_(!0),className:"inline-flex items-center justify-center gap-2 px-6 py-3 rounded-lg font-bold transition-all hover:opacity-90 hover:scale-105",style:{backgroundColor:"#3b82f6",color:"white",fontSize:"17px",boxShadow:"0 4px 6px rgba(59, 130, 246, 0.3)"},children:[n.jsxs("svg",{width:"26",height:"26",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",style:{flexShrink:0},children:[n.jsx("circle",{cx:"12",cy:"12",r:"10",fill:"white",fillOpacity:"0.2"}),n.jsx("path",{d:"M10 8L16 12L10 16V8Z",fill:"white"})]}),n.jsx("span",{style:{fontSize:"17px"},children:" "})]})}),n.jsxs("div",{className:"space-y-2",style:{marginTop:"16px"},children:[L&&n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("input",{type:"email",value:L,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",fontSize:"15px",cursor:"not-allowed"}}),n.jsx("p",{style:{fontSize:"12px",color:"#666",marginTop:"4px"},children:"    "})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:" *"}),n.jsx("input",{type:"text",name:"parentName",value:t.parentName,onChange:J,placeholder:"  ",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:" *"}),n.jsx("input",{type:"tel",name:"phone",value:t.phone,onChange:xe,placeholder:"010-0000-0000",maxLength:13,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:" *"}),n.jsxs("div",{className:"flex gap-4",children:[n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer flex-1",children:[n.jsx("input",{type:"radio",name:"childGender",value:"",checked:t.childGender==="",onChange:J,className:"w-5 h-5"}),n.jsx("span",{style:{fontSize:"15px"},children:""})]}),n.jsxs("label",{className:"flex items-center gap-2 cursor-pointer flex-1",children:[n.jsx("input",{type:"radio",name:"childGender",value:"",checked:t.childGender==="",onChange:J,className:"w-5 h-5"}),n.jsx("span",{style:{fontSize:"15px"},children:""})]})]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:" *"}),n.jsx("input",{type:"number",name:"childAge",value:t.childAge,onChange:J,placeholder:" ",min:"1",max:"20",className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:""}),n.jsx("textarea",{name:"inquiry",value:t.inquiry,onChange:J,placeholder:"   ",rows:4,className:"w-full px-4 py-2 border border-gray-300",style:{borderRadius:"10px",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-1 font-bold",style:{color:"#000000",fontSize:"15px"},children:"()"}),p?n.jsxs(n.Fragment,{children:[n.jsx("input",{type:"text",name:"referrerCode",value:b?`${b}(${t.referrerCode})`:t.referrerCode,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",fontSize:"15px"}}),n.jsx("p",{className:"mt-1 text-xs",style:{color:"#249689"},children:"    "})]}):n.jsxs(n.Fragment,{children:[n.jsx("input",{type:"text",name:"referrerCode",value:t.referrerCode,readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",fontSize:"15px"}}),g&&n.jsx("p",{className:"mt-1 text-xs text-red-600",children:g})]})]}),n.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-3 bg-gray-50",children:[n.jsx("h3",{className:"font-bold mb-2 text-lg",style:{color:"#249689",fontSize:"18px"},children:"    "}),n.jsxs("div",{className:"flex items-center justify-between mb-2",children:[n.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"privacyAgreed",checked:t.privacyAgreed,onChange:J,className:"w-5 h-5 mt-0.5"}),n.jsxs("span",{style:{color:"#000000",fontSize:"14px"},children:["     ",n.jsx("span",{style:{color:"#ef4444"},children:"*"})]})]}),n.jsx("button",{type:"button",onClick:()=>i(!0),className:"text-sm underline whitespace-nowrap",style:{color:"#249689"},children:" "})]}),n.jsx("div",{className:"pt-2 border-t border-gray-300",children:n.jsxs("label",{className:"flex items-start gap-2 cursor-pointer",children:[n.jsx("input",{type:"checkbox",name:"marketingAgreed",checked:t.marketingAgreed,onChange:J,className:"w-5 h-5 mt-0.5"}),n.jsxs("span",{style:{fontSize:"14px",flex:1},children:[n.jsx("span",{className:"font-bold",children:"()"}),"      "]})]})})]}),n.jsx("div",{className:"flex gap-2 pt-2",children:n.jsx("button",{type:"button",onClick:_e,disabled:e,className:"flex-1 py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#dc2626",fontSize:"16px"},children:e?" ...":""})})]}),n.jsx("div",{className:"mt-3 text-center",children:n.jsx("p",{style:{fontSize:"13px",color:"#666"},children:" ."})})]}),c&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6",children:[n.jsx("h2",{className:"font-bold mb-4 text-center",style:{color:"#249689",fontSize:"22px"},children:"  !"}),n.jsx("div",{className:"flex justify-center mb-4",children:n.jsx("img",{src:d,alt:"QR Code",className:"w-64 h-64 border-2 border-gray-300 rounded-lg"})}),n.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg mb-4",children:[n.jsx("p",{className:"text-sm text-gray-600 mb-2",children:" :"}),n.jsx("div",{className:"bg-white p-3 rounded border border-gray-300 break-all text-sm",children:u})]}),n.jsxs("div",{className:"flex flex-col gap-2",children:[n.jsx("button",{onClick:Te,className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689"},children:" QR "}),n.jsx("button",{onClick:Ee,className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#2ca89f"},children:"  "}),n.jsx("button",{onClick:be,className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#3bb5ab"},children:" "}),n.jsx("button",{onClick:()=>h(!1),className:"w-full py-2.5 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#6b7280"},children:" "})]})]})}),a&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50 overflow-auto",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg max-w-md w-full p-6 my-8 max-h-[80vh] overflow-y-auto",children:[n.jsx("h2",{className:"font-bold mb-4 text-center",style:{color:"#249689",fontSize:"22px"},children:"    "}),n.jsxs("div",{className:"space-y-4 text-sm text-gray-700",children:[n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",children:"1.   "}),n.jsx("p",{children:" ,  ,  ,  , "})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",children:"2.     "}),n.jsx("p",{children:"  ,  ,  ,     "})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",children:"3.     "}),n.jsx("p",{children:"   3   "})]}),n.jsxs("div",{children:[n.jsx("h3",{className:"font-bold mb-2",children:"4.     "}),n.jsx("p",{children:"       ,       ."})]})]}),n.jsx("button",{onClick:()=>i(!1),className:"w-full mt-6 py-3 text-white font-bold rounded-lg hover:opacity-90 transition-opacity",style:{backgroundColor:"#249689"},children:""})]})}),A&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center p-4 z-50",onClick:()=>_(!1),children:n.jsxs("div",{className:"relative bg-black rounded-lg shadow-2xl max-w-4xl w-full",onClick:D=>D.stopPropagation(),style:{aspectRatio:"16/9"},children:[n.jsx("button",{onClick:()=>_(!1),className:"absolute -top-10 right-0 text-white hover:text-gray-300 transition-colors z-10",style:{fontSize:"32px",fontWeight:"bold"},children:""}),n.jsxs("video",{className:"w-full h-full rounded-lg",controls:!0,autoPlay:!0,playsInline:!0,controlsList:"nodownload",onError:D=>{console.error("  :",D),alert(`   .   .
: `+H)},onLoadedData:()=>console.log("  "),style:{border:"none",backgroundColor:"#000"},children:[n.jsx("source",{src:H,type:"video/mp4"}),"    ."]})]})})]})}function Pv({user:t,onBack:r,viewMode:e,from:s}){let a=e;a||(s==="/system-admin"||s==="SystemAdminDashboard"?a="system":s==="/admin"||s==="AdminDashboard"?a="admin":s==="/dashboard"||s==="Dashboard"?a="user":t?.user_type===""||t?.role==="system_admin"||t?.role==="SystemAdmin"?a="system":t?.role==="admin"||t?.role==="manager"||t?.role===""||t?.role===""?a="admin":a="user"),console.log(" ViewMode :",a,"| User Role:",t?.role,"| User Type:",t?.user_type,"| From:",s);const i=a==="admin"||a==="system",o=a==="admin"||a==="system",[l,c]=P.useState({total:0,thisWeek:0,male:0,female:0}),[h,d]=P.useState([]),[f,u]=P.useState([]),[m,p]=P.useState([]),[x,g]=P.useState([]),[T,b]=P.useState(!0),[w,A]=P.useState([]),[_,L]=P.useState(""),[E,O]=P.useState({branch:"",referrer:"",startDate:"",endDate:""}),[F,M]=P.useState([]),[U,H]=P.useState([]),[J,ge]=P.useState(1),[xe,Ee]=P.useState(30),[be,Te]=P.useState([]),[le,ue]=P.useState(!1),[_e,S]=P.useState(!1);P.useEffect(()=>{y()},[]),P.useEffect(()=>{B(),z()},[_]);const I=Y=>Y.toString().replace(/\B(?=(\d{3})+(?!\d))/g,","),D=Y=>{if(!Y)return"";const ye=Y.toString().replace(/\D/g,"");return ye.length===11?ye.replace(/(\d{3})(\d{4})(\d{4})/,"$1-$2-$3"):ye.length===10?ye.replace(/(\d{3})(\d{3})(\d{4})/,"$1-$2-$3"):Y},y=async()=>{try{const{data:Y,error:ye}=await ce.from("events").select("name").eq("status","active").order("created_at",{ascending:!1});if(ye)throw ye;A(Y||[])}catch(Y){console.error("   :",Y)}},z=async()=>{try{const{data:Y}=await ce.from("users").select("branch").not("branch","is",null).order("branch"),ye=[...new Set(Y?.map(et=>et.branch)||[])];M(ye);const{data:Fe}=await ce.from("users").select("name, referral_code").not("referral_code","is",null).order("name");let ke=ce.from("event_participants").select("referrer_code, event_name").not("referrer_code","is",null);_&&(ke=ke.eq("event_name",_));const{data:Ot}=await ke,Mt=new Set(Ot?.map(et=>et.referrer_code)||[]),Ge=Fe?.filter(et=>Mt.has(et.referral_code)).map(et=>({referrer_name:et.name,referrer_code:et.referral_code}))||[];H(Ge)}catch(Y){console.error("   :",Y)}},B=async()=>{try{console.log("   ..."),b(!0),console.log("    ...");let Y=ce.from("event_participants").select("child_gender, child_age, event_name, created_at, start_date, current_day, last_sent_date");if(a==="user"&&t?.referral_code)console.log(" [ ]   - :",t.referral_code),Y=Y.eq("referrer_code",t.referral_code);else if(a==="admin"&&t?.branch){console.log(" [/]   - :",t.branch);const{data:Ae}=await ce.from("users").select("referral_code").eq("branch",t.branch).not("referral_code","is",null),Ye=Ae?.map(Zt=>Zt.referral_code)||[];console.log("   :",Ye.length,""),Ye.length>0?Y=Y.in("referrer_code",Ye):Y=Y.eq("referrer_code","NONE")}else a==="system"&&console.log(" []   -  ");_&&(console.log("   :",_),Y=Y.eq("event_name",_));const{data:ye,error:Fe}=await Y;if(Fe)throw Fe;console.log("   :",ye?.length,"");const ke=new Date;ke.setDate(ke.getDate()-7);const Ot=ye?.length||0,Mt=ye?.filter(Ae=>new Date(Ae.created_at)>=ke).length||0,Ge=ye?.filter(Ae=>Ae.child_gender==="").length||0,et=ye?.filter(Ae=>Ae.child_gender==="").length||0;c({total:Ot,thisWeek:Mt,male:Ge,female:et}),console.log("   :",{totalCount:Ot,thisWeekCount:Mt,maleCount:Ge,femaleCount:et});const Ur={};ye?.forEach(Ae=>{const Ye=Ae.child_age||"";Ur[Ye]=(Ur[Ye]||0)+1});const hs=Object.entries(Ur).map(([Ae,Ye])=>({age:Ae,count:Ye})).sort((Ae,Ye)=>Ae.age===""?1:Ye.age===""?-1:parseInt(Ae.age)-parseInt(Ye.age));d(hs),console.log("  :",hs),console.log("     ...");let tt=ce.from("event_participants").select(`
          *,
          users:referrer_code (
            name,
            branch
          )
        `);if(a==="user"&&t?.referral_code)tt=tt.eq("referrer_code",t.referral_code);else if(a==="admin"&&t?.branch){const{data:Ae}=await ce.from("users").select("referral_code").eq("branch",t.branch).not("referral_code","is",null),Ye=Ae?.map(Zt=>Zt.referral_code)||[];Ye.length>0?tt=tt.in("referrer_code",Ye):tt=tt.eq("referrer_code","NONE")}if(_&&(tt=tt.eq("event_name",_)),E.startDate&&(tt=tt.gte("created_at",E.startDate)),E.endDate){const Ae=new Date(E.endDate);Ae.setHours(23,59,59,999),tt=tt.lte("created_at",Ae.toISOString())}tt=tt.order("created_at",{ascending:!1});const{data:fs,error:Ks}=await tt;if(Ks)throw Ks;if(console.log("   :",fs?.length,""),g(fs||[]),o){const Ae={};ye?.forEach(pt=>{pt.referrer_code&&(Ae[pt.referrer_code]||(Ae[pt.referrer_code]={code:pt.referrer_code,count:0,name:"",branch:""}),Ae[pt.referrer_code].count++)});const Ye=Object.keys(Ae);if(Ye.length>0){const{data:pt}=await ce.from("users").select("referral_code, name, branch").in("referral_code",Ye);pt?.forEach(It=>{Ae[It.referral_code]&&(Ae[It.referral_code].name=It.name,Ae[It.referral_code].branch=It.branch)})}const Zt=Object.values(Ae).sort((pt,It)=>It.count-pt.count).slice(0,10);if(u(Zt),console.log("  :",Zt),a==="system"){const pt={};fs?.forEach(Xt=>{const dr=Xt.users?.branch||"";pt[dr]=(pt[dr]||0)+1});const It=Object.entries(pt).map(([Xt,dr])=>({branch:Xt,count:dr})).sort((Xt,dr)=>dr.count-Xt.count).slice(0,10);p(It),console.log("  :",It)}}b(!1),console.log("   ")}catch(Y){console.error("   :",Y),b(!1)}},Q=(Y,ye)=>{O(Fe=>({...Fe,[Y]:ye}))},te=()=>{B()},re=()=>{O({branch:"",referrer:"",startDate:"",endDate:""}),setTimeout(()=>B(),100)},ve=()=>{const Y=["No.","","","","","","","","","",""],ye=x.map((Ge,et)=>[et+1,new Date(Ge.created_at).toLocaleString("ko-KR"),Ge.parent_name,D(Ge.phone),Ge.child_gender,`${Ge.child_age}`,Ge.users?.name||Ge.referrer_name||"-",Ge.referrer_code||"-",Ge.users?.branch||"-",Ge.current_day?`${Ge.current_day}`:"-",Ge.last_sent_date===new Date().toISOString().split("T")[0]?"":""]),Fe=[Y.join(","),...ye.map(Ge=>Ge.map(et=>`"${et}"`).join(","))].join(`
`),ke="\uFEFF",Ot=new Blob([ke+Fe],{type:"text/csv;charset=utf-8;"}),Mt=document.createElement("a");Mt.href=URL.createObjectURL(Ot),Mt.download=`__${new Date().toISOString().split("T")[0]}.csv`,Mt.click()},V=async Y=>{if(window.confirm("  ?"))try{const{error:ye}=await ce.from("event_participants").delete().eq("id",Y);if(ye)throw ye;alert("."),B()}catch(ye){console.error(" :",ye),alert(" .")}},pe=Y=>{ge(Y)},he=Y=>{Ee(parseInt(Y)),ge(1)},De=Math.ceil(x.length/xe),Ne=(J-1)*xe,de=Ne+xe,je=x.slice(Ne,de),ht=()=>{const Y=[];let Fe=Math.max(1,J-Math.floor(5)),ke=Math.min(De,Fe+10-1);ke-Fe+1<10&&(Fe=Math.max(1,ke-10+1));for(let Ot=Fe;Ot<=ke;Ot++)Y.push(Ot);return Y},_t=Y=>{if(Y.target.checked){const ye=new Date().toISOString().split("T")[0],Fe=je.filter(ke=>ke.last_sent_date!==ye);Te(Fe.map(ke=>ke.id))}else Te([])},Vt=Y=>{Te(ye=>ye.includes(Y)?ye.filter(Fe=>Fe!==Y):[...ye,Y])},_r=()=>{if(be.length===0){alert("  .");return}ue(!0)},Sr=async()=>{S(!0);try{const Y=x.filter(Fe=>be.includes(Fe.id)),ye=new Date().toISOString().split("T")[0];for(const Fe of Y){const{error:ke}=await ce.from("event_participants").update({current_day:(Fe.current_day||0)+1,last_sent_date:ye}).eq("id",Fe.id);if(ke)throw ke}alert(`${Y.length}  .`),ue(!1),Te([]),B()}catch(Y){console.error(" :",Y),alert(" .")}finally{S(!1)}},mt=()=>{const Y=new Date().toISOString().split("T")[0];return x.filter(ye=>be.includes(ye.id)&&ye.last_sent_date!==Y)};return T?n.jsx("div",{className:"min-h-screen flex items-center justify-center",children:n.jsx("div",{className:"text-xl",children:" ..."})}):n.jsx("div",{className:"min-h-screen",style:{backgroundColor:"#f5f5f5"},children:n.jsxs("div",{className:"max-w-7xl mx-auto p-6",children:[n.jsxs("div",{className:"mb-6 flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("button",{onClick:r,className:"px-4 py-2 bg-white border-2 rounded-lg hover:bg-gray-50 font-bold",style:{borderColor:"#249689",color:"#249689"},children:" "}),n.jsx("h1",{className:"text-3xl font-bold",style:{color:"#249689"},children:"   "})]}),n.jsxs("div",{className:"text-right",children:[n.jsx("div",{className:"text-sm text-gray-600",children:t?.name||""}),n.jsx("div",{className:"text-sm text-gray-600",children:t?.branch||""})]})]}),n.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx("label",{className:"text-lg font-bold",style:{color:"#249689"},children:" :"}),n.jsxs("select",{value:_,onChange:Y=>L(Y.target.value),className:"px-4 py-2 border-2 rounded-lg font-medium",style:{borderColor:"#249689",minWidth:"200px"},children:[n.jsx("option",{value:"",children:" "}),w.map(Y=>n.jsx("option",{value:Y.name,children:Y.name},Y.name))]})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsx("div",{className:"text-gray-600 mb-2",children:"  "}),n.jsxs("div",{className:"text-3xl font-bold",style:{color:"#249689"},children:[I(l.total),""]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsx("div",{className:"text-gray-600 mb-2",children:"  7"}),n.jsxs("div",{className:"text-3xl font-bold",style:{color:"#5B9BD5"},children:[I(l.thisWeek),""]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsx("div",{className:"text-gray-600 mb-2",children:" "}),n.jsxs("div",{className:"text-3xl font-bold",style:{color:"#70AD47"},children:[I(l.male),""]})]}),n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsx("div",{className:"text-gray-600 mb-2",children:" "}),n.jsxs("div",{className:"text-3xl font-bold",style:{color:"#FF6B9D"},children:[I(l.female),""]})]})]}),o&&n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#249689"},children:"   TOP 10"}),n.jsx("div",{className:"space-y-2",children:f.map((Y,ye)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"font-bold text-lg",style:{color:ye<3?"#FFD700":"#249689"},children:ye+1}),n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:Y.name||Y.code}),n.jsx("div",{className:"text-sm text-gray-600",children:Y.branch||"-"})]})]}),n.jsxs("div",{className:"text-xl font-bold",style:{color:"#249689"},children:[I(Y.count),""]})]},Y.code))})]}),a==="system"&&n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#249689"},children:"   TOP 10"}),n.jsx("div",{className:"space-y-2",children:m.map((Y,ye)=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx("span",{className:"font-bold text-lg",style:{color:ye<3?"#FFD700":"#249689"},children:ye+1}),n.jsx("div",{className:"font-medium",children:Y.branch})]}),n.jsxs("div",{className:"text-xl font-bold",style:{color:"#249689"},children:[I(Y.count),""]})]},Y.branch))})]}),a==="admin"&&n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#249689"},children:"  "}),n.jsx("div",{className:"space-y-2",children:h.map(Y=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{className:"font-medium",children:[Y.age,""]}),n.jsxs("div",{className:"text-xl font-bold",style:{color:"#249689"},children:[I(Y.count),""]})]},Y.age))})]})]}),!o&&n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[n.jsx("h3",{className:"text-xl font-bold mb-4",style:{color:"#249689"},children:"  "}),n.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:h.map(Y=>n.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg text-center",children:[n.jsxs("div",{className:"text-gray-600 mb-1",children:[Y.age,""]}),n.jsxs("div",{className:"text-2xl font-bold",style:{color:"#249689"},children:[I(Y.count),""]})]},Y.age))})]}),n.jsx("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:i?n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:""}),n.jsxs("select",{value:E.branch,onChange:Y=>Q("branch",Y.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[n.jsx("option",{value:"",children:" "}),F.map(Y=>n.jsx("option",{value:Y,children:Y},Y))]})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:""}),n.jsxs("select",{value:E.referrer,onChange:Y=>Q("referrer",Y.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[n.jsx("option",{value:"",children:" "}),U.map(Y=>n.jsxs("option",{value:Y.referrer_code,children:[Y.referrer_name," (",Y.referrer_code,")"]},Y.referrer_code))]})]})]}),n.jsxs("div",{className:"flex items-end gap-4",children:[n.jsxs("div",{style:{width:"160px"},children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:""}),n.jsx("input",{type:"date",value:E.startDate,onChange:Y=>Q("startDate",Y.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),n.jsxs("div",{style:{width:"160px"},children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:""}),n.jsx("input",{type:"date",value:E.endDate,onChange:Y=>Q("endDate",Y.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),n.jsxs("div",{className:"flex gap-2 ml-auto",children:[n.jsxs("button",{onClick:te,className:"px-6 py-2 text-white rounded-lg hover:opacity-90 font-bold whitespace-nowrap flex items-center gap-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ir,{size:18}),""]}),n.jsxs("button",{onClick:re,className:"py-2 border-2 rounded-lg hover:bg-gray-50 font-bold whitespace-nowrap flex items-center justify-center gap-2",style:{borderColor:"#249689",color:"#249689",borderRadius:"10px",fontSize:"15px",width:"110px"},children:[n.jsx(es,{size:18}),""]}),n.jsxs("button",{onClick:ve,className:"px-4 py-2 text-white rounded-lg hover:opacity-90 font-bold whitespace-nowrap flex items-center gap-2",style:{backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Rr,{size:18}),"(",I(x.length),")"]})]})]})]}):n.jsxs("div",{className:"flex items-end gap-4",children:[n.jsxs("div",{style:{width:"160px"},children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:""}),n.jsx("input",{type:"date",value:E.startDate,onChange:Y=>Q("startDate",Y.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),n.jsxs("div",{style:{width:"160px"},children:[n.jsx("label",{className:"block text-sm font-medium mb-1",children:""}),n.jsx("input",{type:"date",value:E.endDate,onChange:Y=>Q("endDate",Y.target.value),className:"w-full px-3 py-2 border rounded-lg"})]}),n.jsxs("div",{className:"flex gap-2 ml-auto",children:[n.jsxs("button",{onClick:re,className:"py-2 border-2 rounded-lg hover:bg-gray-50 font-bold whitespace-nowrap flex items-center justify-center gap-2",style:{borderColor:"#249689",color:"#249689",borderRadius:"10px",fontSize:"15px",width:"110px"},children:[n.jsx(es,{size:18}),""]}),n.jsxs("button",{onClick:ve,className:"px-4 py-2 text-white rounded-lg hover:opacity-90 font-bold whitespace-nowrap flex items-center gap-2",style:{backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Rr,{size:18}),"(",I(x.length),")"]})]})]})}),n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"text-xl font-bold",style:{color:"#249689"},children:"  "}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsxs("button",{onClick:_r,disabled:be.length===0,className:"px-4 py-2 text-white rounded-lg hover:opacity-90 font-bold whitespace-nowrap flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(pa,{size:18}),"  (",be.length,")"]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx("label",{className:"text-sm font-medium text-gray-700",children:""}),n.jsxs("select",{value:xe,onChange:Y=>he(Y.target.value),className:"px-3 py-2 border rounded-lg text-sm font-medium",style:{borderColor:"#249689"},children:[n.jsx("option",{value:"30",children:"30"}),n.jsx("option",{value:"50",children:"50"}),n.jsx("option",{value:"100",children:"100"})]})]}),n.jsxs("div",{className:"text-lg font-bold",style:{color:"#249689"},children:[": ",I(x.length),""]})]})]}),n.jsx("div",{className:"overflow-x-auto",children:n.jsxs("table",{className:"w-full",children:[n.jsx("thead",{children:n.jsxs("tr",{className:"border-b-2",style:{borderColor:"#249689"},children:[n.jsx("th",{className:"px-3 py-2 text-left",children:n.jsx("input",{type:"checkbox",onChange:_t,checked:be.length===je.filter(Y=>{const ye=new Date().toISOString().split("T")[0];return Y.last_sent_date!==ye}).length&&je.length>0})}),n.jsx("th",{className:"px-3 py-2 text-left",children:"No."}),n.jsx("th",{className:"px-3 py-2 text-left",children:""}),n.jsx("th",{className:"px-3 py-2 text-left",children:""}),n.jsx("th",{className:"px-3 py-2 text-left",children:""}),n.jsx("th",{className:"px-3 py-2 text-left",children:""}),n.jsx("th",{className:"px-3 py-2 text-left",children:""}),n.jsx("th",{className:"px-3 py-2 text-left",children:""}),n.jsx("th",{className:"px-3 py-2 text-left",children:""}),n.jsx("th",{className:"px-3 py-2 text-left",children:""}),n.jsx("th",{className:"px-3 py-2 text-left",children:""}),n.jsx("th",{className:"px-3 py-2 text-left",children:""}),a==="system"&&n.jsx("th",{className:"px-3 py-2 text-center",children:""})]})}),n.jsx("tbody",{children:je.map((Y,ye)=>{const Fe=new Date().toISOString().split("T")[0],ke=Y.last_sent_date===Fe;return n.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[n.jsx("td",{className:"px-3 py-3",children:n.jsx("input",{type:"checkbox",checked:be.includes(Y.id),onChange:()=>Vt(Y.id),disabled:ke})}),n.jsx("td",{className:"px-3 py-3 text-sm font-medium text-gray-600",children:Ne+ye+1}),n.jsx("td",{className:"px-3 py-3 text-sm",children:new Date(Y.created_at).toLocaleString("ko-KR")}),n.jsx("td",{className:"px-3 py-3",children:Y.parent_name}),n.jsx("td",{className:"px-3 py-3",children:D(Y.phone)}),n.jsx("td",{className:"px-3 py-3",children:Y.child_gender}),n.jsxs("td",{className:"px-3 py-3",children:[Y.child_age,""]}),n.jsx("td",{className:"px-3 py-3",children:Y.users?.name||Y.referrer_name||"-"}),n.jsx("td",{className:"px-3 py-3",children:Y.referrer_code||"-"}),n.jsx("td",{className:"px-3 py-3",children:Y.users?.branch||"-"}),n.jsx("td",{className:"px-3 py-3 font-medium",children:Y.current_day?`${Y.current_day}`:"-"}),n.jsx("td",{className:"px-3 py-3",children:ke?n.jsx("span",{className:"text-green-600 font-medium",children:" "}):n.jsx("span",{className:"text-gray-500",children:" "})}),a==="system"&&n.jsx("td",{className:"px-3 py-3 text-center",children:n.jsx("button",{onClick:()=>V(Y.id),className:"text-red-600 hover:text-red-800",children:""})})]},Y.id)})})]})}),x.length===0&&n.jsx("div",{className:"text-center py-8 text-gray-500",children:" "}),x.length>0&&De>1&&n.jsxs("div",{className:"flex items-center justify-center gap-2 mt-6",children:[n.jsx("button",{onClick:()=>pe(1),disabled:J===1,className:`p-2 rounded-lg transition-colors ${J===1?"text-gray-300 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:n.jsx(qc,{size:20})}),n.jsx("button",{onClick:()=>pe(J-1),disabled:J===1,className:`p-2 rounded-lg transition-colors ${J===1?"text-gray-300 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:n.jsx(Jc,{size:20})}),ht().map(Y=>n.jsx("button",{onClick:()=>pe(Y),className:`min-w-[40px] px-3 py-2 rounded-lg font-medium transition-colors ${J===Y?"text-white":"text-gray-700 hover:bg-gray-100"}`,style:J===Y?{backgroundColor:"#249689"}:{},children:Y},Y)),n.jsx("button",{onClick:()=>pe(J+1),disabled:J===De,className:`p-2 rounded-lg transition-colors ${J===De?"text-gray-300 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:n.jsx(Qc,{size:20})}),n.jsx("button",{onClick:()=>pe(De),disabled:J===De,className:`p-2 rounded-lg transition-colors ${J===De?"text-gray-300 cursor-not-allowed":"text-gray-700 hover:bg-gray-100"}`,children:n.jsx(Zc,{size:20})}),n.jsxs("span",{className:"ml-4 text-sm text-gray-600",children:[J," / ",De," "]})]})]}),le&&n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-2xl p-8 max-w-2xl w-full mx-4",children:[n.jsxs("div",{className:"flex items-center justify-between mb-6",children:[n.jsx("h2",{className:"text-2xl font-bold",style:{color:"#249689"},children:"   "}),n.jsx("button",{onClick:()=>ue(!1),className:"text-gray-400 hover:text-gray-600",children:n.jsx(Cs,{size:24})})]}),n.jsxs("div",{className:"mb-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4 p-4 bg-gray-50 rounded-lg",children:[n.jsx("span",{className:"text-lg font-medium",children:""}),n.jsx("span",{className:"text-lg font-bold",style:{color:"#249689"},children:new Date().toLocaleDateString("ko-KR")})]}),n.jsxs("div",{className:"flex items-center justify-between mb-4 p-4 bg-gray-50 rounded-lg",children:[n.jsx("span",{className:"text-lg font-medium",children:" "}),n.jsxs("span",{className:"text-lg font-bold",style:{color:"#249689"},children:[mt().length,""]})]})]}),n.jsxs("div",{className:"mb-6 max-h-96 overflow-y-auto",children:[n.jsx("h3",{className:"text-lg font-bold mb-3",children:" "}),n.jsx("div",{className:"space-y-2",children:mt().map(Y=>n.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[n.jsxs("div",{children:[n.jsx("div",{className:"font-medium",children:Y.parent_name}),n.jsx("div",{className:"text-sm text-gray-600",children:Y.email||D(Y.phone)})]}),n.jsxs("div",{className:"text-right",children:[n.jsxs("div",{className:"font-bold",style:{color:"#249689"},children:[(Y.current_day||0)+1,""]}),n.jsxs("div",{className:"text-sm text-gray-600",children:["(: ",Y.current_day||0,")"]})]})]},Y.id))})]}),n.jsxs("div",{className:"flex gap-4",children:[n.jsx("button",{onClick:()=>ue(!1),className:"flex-1 px-6 py-3 border-2 rounded-lg font-bold text-lg hover:bg-gray-50",style:{borderColor:"#249689",color:"#249689"},disabled:_e,children:""}),n.jsx("button",{onClick:Sr,className:"flex-1 px-6 py-3 text-white rounded-lg font-bold text-lg hover:opacity-90 flex items-center justify-center gap-2",style:{backgroundColor:"#249689"},disabled:_e,children:_e?n.jsx(n.Fragment,{children:" ..."}):n.jsxs(n.Fragment,{children:[n.jsx(pa,{size:20}),""]})})]})]})})]})})}function Lv({user:t,onNavigate:r,onLogout:e,onBack:s}){const a=t?.user_type==="";return n.jsx("div",{className:"min-h-screen bg-white",children:n.jsx("div",{className:"max-w-md mx-auto p-6",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-center gap-1.5 mb-8",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:" "})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-1.5 mb-8",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:" "}),n.jsx("input",{type:"text",value:t?.branch||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block mb-2 font-bold",style:{color:"#000000",fontSize:"15px"},children:" "}),n.jsx("input",{type:"text",value:t?.name||"",readOnly:!0,className:"w-full px-4 py-2 border border-gray-300 bg-gray-50",style:{borderRadius:"10px",color:"#000000",fontSize:"15px"}})]})]}),n.jsxs("div",{className:"space-y-4",children:[n.jsxs("button",{onClick:()=>{console.log(" Navigate to: adminEvent"),r("adminEvent")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ra,{size:20})," "]}),n.jsxs("button",{onClick:()=>{console.log(" Navigate to: AdminEventManager"),r("AdminEventManager")},className:"w-full py-4 text-white font-bold rounded-lg hover:opacity-90 transition-opacity flex items-center justify-center gap-2",style:{backgroundColor:"#5B9BD5",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(cn,{size:20}),"  "]}),n.jsxs("button",{onClick:()=>{console.log(" Navigate back"),s?s():r(a?"SystemAdminDashboard":"AdminDashboard")},className:"w-full py-4 font-bold rounded-lg hover:bg-gray-50 transition-colors flex items-center justify-center gap-1.5",style:{color:"#000000",border:"2px solid #A5AEE3",backgroundColor:"white",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ft,{size:20}),""]})]})]})})})}const Bv=({showBelow:t=300})=>{const[r,e]=P.useState(!1);P.useEffect(()=>{const a=()=>{window.pageYOffset>t?e(!0):e(!1)};return window.addEventListener("scroll",a),()=>window.removeEventListener("scroll",a)},[t]);const s=()=>{window.scrollTo({top:0,behavior:"smooth"})};return r?n.jsx("button",{onClick:s,className:"scroll-to-top","aria-label":"  ",style:{position:"fixed",bottom:"30px",right:"30px",width:"50px",height:"50px",borderRadius:"50%",background:"linear-gradient(135deg, #1e9a8a, #2cb5a3)",color:"white",border:"none",fontSize:"24px",cursor:"pointer",boxShadow:"0 4px 12px rgba(30, 154, 138, 0.3)",transition:"all 0.3s ease",zIndex:1e3,display:"flex",alignItems:"center",justifyContent:"center"},onMouseEnter:a=>{a.target.style.transform="translateY(-3px)",a.target.style.boxShadow="0 6px 16px rgba(30, 154, 138, 0.4)"},onMouseLeave:a=>{a.target.style.transform="translateY(0)",a.target.style.boxShadow="0 4px 12px rgba(30, 154, 138, 0.3)"},onMouseDown:a=>{a.target.style.transform="translateY(-1px)"},children:""}):null};function Mv({user:t,onBack:r}){const[e,s]=P.useState([]),[a,i]=P.useState(!0),[o,l]=P.useState("all"),[c,h]=P.useState(!1);P.useEffect(()=>{d()},[o]);const d=async()=>{try{i(!0);let f=ce.from("events").select("*").order("created_at",{ascending:!1});o!=="all"&&(f=f.eq("status",o));const{data:u,error:m}=await f;if(m)throw m;s(u||[])}catch(f){console.error("  :",f)}finally{i(!1)}};return n.jsxs("div",{className:"min-h-screen bg-gray-50",children:[n.jsxs("div",{className:"max-w-6xl mx-auto p-6",children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-8",children:[n.jsxs("button",{onClick:r,className:"flex items-center gap-1 font-bold hover:opacity-70 transition-opacity",style:{color:"#4A9B8E",fontSize:"16px"},children:[n.jsx(Ft,{size:20}),""]}),n.jsxs("div",{className:"flex items-center gap-1.5",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain",onError:f=>f.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"36px"},children:"  "})]}),n.jsx("div",{style:{width:"80px"}})]}),n.jsx("div",{className:"mb-6 p-3 rounded-lg",style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:"10px"},children:n.jsx("p",{className:"text-sm",style:{color:"#1e40af"},children:"    "})}),n.jsxs("div",{className:"flex items-center justify-between border-b border-gray-200",children:[n.jsx("div",{className:"flex gap-2",children:[{value:"all",label:""},{value:"active",label:""},{value:"scheduled",label:""},{value:"ended",label:""},{value:"inactive",label:""}].map(f=>n.jsx("button",{onClick:()=>l(f.value),className:`px-4 py-2 font-medium transition-colors ${o===f.value?"border-b-2":"text-gray-600 hover:text-gray-900"}`,style:o===f.value?{color:"#249689",borderColor:"#249689"}:{},children:f.label},f.value))}),n.jsxs("button",{onClick:()=>h(!0),className:"flex items-center gap-2 px-4 py-2 text-white rounded-lg hover:opacity-90 font-bold mb-2",style:{backgroundColor:"#249689",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Fn,{size:20}),""]})]})]}),a?n.jsx("div",{className:"flex justify-center items-center py-20",children:n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2",style:{borderColor:"#249689"}})}):e.length===0?n.jsxs("div",{className:"text-center py-20 bg-white rounded-lg shadow-sm border",children:[n.jsx(fn,{size:64,className:"mx-auto mb-4",style:{color:"#249689"}}),n.jsx("p",{className:"text-gray-600 mb-4",children:"  "}),n.jsx("button",{onClick:()=>h(!0),className:"px-6 py-2 text-white rounded-lg hover:opacity-90",style:{backgroundColor:"#249689",borderRadius:"10px"},children:"  "})]}):n.jsx("div",{className:"grid grid-cols-4 gap-4 max-h-[calc(100vh-300px)] overflow-y-auto pr-2",children:e.map(f=>n.jsx(zv,{event:f,onRefresh:d},f.id))})]}),c&&n.jsx(Uv,{onClose:()=>h(!1),onSuccess:()=>{h(!1),d()}})]})}function zv({event:t,onRefresh:r}){const[e,s]=P.useState(!1),a=async()=>{try{const c=t.status==="active"?"inactive":"active",{error:h}=await ce.from("events").update({status:c}).eq("id",t.id);if(h)throw h;r()}catch(c){console.error("  :",c)}},i=async()=>{if(confirm("   ?"))try{const{error:c}=await ce.from("events").delete().eq("id",t.id);if(c)throw c;r()}catch(c){console.error(" :",c)}},o=c=>{const h={active:{text:"",color:"bg-green-100 text-green-800"},inactive:{text:"",color:"bg-gray-100 text-gray-800"},scheduled:{text:"",color:"bg-blue-100 text-blue-800"},ended:{text:"",color:"bg-red-100 text-red-800"}},d=h[c]||h.inactive;return n.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-semibold ${d.color}`,children:d.text})},l=c=>c?new Date(c).toLocaleDateString("ko-KR"):"-";return n.jsxs(n.Fragment,{children:[n.jsxs("div",{className:"bg-white rounded-lg shadow-sm border overflow-hidden hover:shadow-md transition-shadow",children:[t.template_image_url?n.jsx("div",{className:"h-32 bg-gray-100 relative overflow-hidden",children:n.jsx("img",{src:t.template_image_url,alt:t.name,className:"w-full h-full object-contain",onError:c=>{c.target.style.display="none",c.target.parentElement.innerHTML='<div class="w-full h-full flex items-center justify-center text-gray-400"><span>   </span></div>'}})}):n.jsx("div",{className:"h-32 bg-gray-100 flex items-center justify-center",children:n.jsx("span",{className:"text-gray-400 text-xs",children:" "})}),n.jsxs("div",{className:"p-3",children:[n.jsxs("div",{className:"flex items-start justify-between mb-2",children:[n.jsx("h3",{className:"text-sm font-semibold text-gray-900 line-clamp-1",children:t.name}),o(t.status)]}),t.description&&n.jsx("p",{className:"text-xs text-gray-600 mb-2 line-clamp-1",children:t.description}),n.jsxs("div",{className:"text-xs text-gray-500 space-y-1 mb-3",children:[n.jsxs("div",{children:[": ",l(t.start_date)]}),n.jsxs("div",{children:[": ",l(t.end_date)]})]}),n.jsxs("div",{className:"flex gap-1",children:[n.jsxs("button",{onClick:a,className:"flex-1 flex items-center justify-center gap-1 px-2 py-1.5 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 text-xs",style:{borderRadius:"8px"},children:[t.status==="active"?n.jsx(e0,{size:14}):n.jsx(xo,{size:14}),n.jsx("span",{className:"hidden lg:inline",children:t.status==="active"?"":""})]}),n.jsx("button",{onClick:()=>s(!0),className:"px-2 py-1.5 rounded hover:opacity-80",style:{backgroundColor:"#249689",color:"white",borderRadius:"8px"},children:n.jsx(Ia,{size:14})}),n.jsx("button",{onClick:i,className:"px-2 py-1.5 bg-red-100 text-red-700 rounded hover:bg-red-200",style:{borderRadius:"8px"},children:n.jsx(yr,{size:14})})]})]})]}),e&&n.jsx($v,{event:t,onClose:()=>s(!1),onSuccess:()=>{s(!1),r()}})]})}function Nc({imageUrl:t,position:r,onPositionChange:e}){const[s,a]=P.useState(!1),[i,o]=P.useState(null),[l,c]=P.useState(null),h=P.useRef(null),d=P.useRef(null),[f,u]=P.useState(!1),m=()=>d.current?d.current.getBoundingClientRect():null,p=w=>{if(!d.current||!f)return;const A=m();if(!A||w.clientX<A.left||w.clientX>A.right||w.clientY<A.top||w.clientY>A.bottom)return;const _=(w.clientX-A.left)/A.width*100,L=(w.clientY-A.top)/A.height*100;console.log("  :",{clientX:w.clientX,clientY:w.clientY,imgLeft:A.left,imgTop:A.top,imgWidth:A.width,imgHeight:A.height,x:_,y:L}),o({x:_,y:L}),c({x:_,y:L}),a(!0)},x=w=>{if(!s||!d.current)return;const A=m();if(!A)return;const _=(w.clientX-A.left)/A.width*100,L=(w.clientY-A.top)/A.height*100,E=Math.max(0,Math.min(100,_)),O=Math.max(0,Math.min(100,L));c({x:E,y:O})},g=()=>{if(!s||!i||!l)return;const w=Math.min(i.x,l.x),A=Math.min(i.y,l.y),_=Math.abs(l.x-i.x),L=Math.abs(l.y-i.y);if(_>1&&L>1){const E={x:Math.max(0,Math.min(100,w)),y:Math.max(0,Math.min(100,A)),width:Math.min(100-w,_),height:Math.min(100-A,L)};e(E),console.log(" QR  :",E),console.log("  :",{left:`${w.toFixed(2)}%`,top:`${A.toFixed(2)}%`,right:`${(w+_).toFixed(2)}%`,bottom:`${(A+L).toFixed(2)}%`,width:`${_.toFixed(2)}%`,height:`${L.toFixed(2)}%`})}a(!1),o(null),c(null)},T=()=>{if(!s||!i||!l)return{};const w=Math.min(i.x,l.x),A=Math.min(i.y,l.y),_=Math.abs(l.x-i.x),L=Math.abs(l.y-i.y);return{left:`${w}%`,top:`${A}%`,width:`${_}%`,height:`${L}%`}},b=()=>!r||r.width===0?{}:{left:`${r.x}%`,top:`${r.y}%`,width:`${r.width}%`,height:`${r.height}%`};return n.jsxs("div",{ref:h,className:"relative w-full ",style:{minHeight:"350px"},onMouseDown:p,onMouseMove:x,onMouseUp:g,onMouseLeave:g,children:[n.jsx("img",{ref:d,src:t,alt:"Template",className:"w-full h-auto block cursor-crosshair",style:{maxHeight:"500px",objectFit:"contain"},draggable:"false",onDragStart:w=>w.preventDefault(),onLoad:()=>{u(!0),console.log("   :",t)},onError:w=>{console.error("   :",t),u(!1)}}),s&&i&&l&&n.jsx("div",{className:"absolute border-2 border-blue-500 bg-blue-200 bg-opacity-30 pointer-events-none",style:T()}),!s&&r&&r.width>0&&n.jsx("div",{className:"absolute border-4 border-green-500 bg-green-200 bg-opacity-40 pointer-events-none flex items-center justify-center",style:b(),children:n.jsx("span",{className:"text-xs font-bold text-green-700 bg-white px-2 py-1 rounded shadow-lg",children:"QR "})})]})}function Uv({onClose:t,onSuccess:r}){const[e,s]=P.useState({name:"",description:"",landing_url:"",template_image_url:"",qr_position:null,start_date:"",end_date:"",status:"active"}),[a,i]=P.useState(!1),[o,l]=P.useState(!1),[c,h]=P.useState(""),[d,f]=P.useState({type:"",message:""}),u=async x=>{const g=x.target.files[0];if(!g){console.log("   ");return}console.log("  :",g.name,g.size,"bytes");const T=URL.createObjectURL(g);h(T),f({type:"uploading",message:"  ..."}),console.log("  URL :",T);try{i(!0);const b=g.name.split(".").pop(),A=`event-templates/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${b}`}`;console.log("  :",A);const{data:_,error:L}=await ce.storage.from("event-images").upload(A,g);if(L){console.error(" Storage  :",L),f({type:"error",message:"  : "+L.message}),i(!1);return}console.log("  :",_),console.log("  :",A);const E="https://sgxnxbhbyvrmgrzhosyh.supabase.co";console.log(" Supabase URL:",E);const O=`${E}/storage/v1/object/public/event-images/${A}`;console.log("  Public URL:",O),s(F=>{const M={...F,template_image_url:O};return console.log(" FormData !"),console.log("    template_image_url:",M.template_image_url),M}),setTimeout(()=>{console.log(" previewUrl , template_image_url "),h("")},100),f({type:"success",message:"   !  QR  ."}),console.log("    !")}catch(b){console.error("   :",b),f({type:"error",message:"    : "+b.message})}finally{i(!1),console.log("   ")}},m=(x,g)=>{if(!x||!g)return"active";const T=new Date;T.setHours(0,0,0,0);const b=new Date(x);b.setHours(0,0,0,0);const w=new Date(g);return w.setHours(0,0,0,0),T>w?"ended":T<b?"scheduled":"active"},p=async x=>{if(x.preventDefault(),console.log("   !"),console.log("  formData:",e),!e.name){console.log("  :  "),f({type:"error",message:" ."});return}if(!e.landing_url){console.log("  :  URL "),f({type:"error",message:" URL ."});return}if(a){console.log("  :   "),f({type:"error",message:"   .  ."});return}if(console.log(" template_image_url :",e.template_image_url),!e.template_image_url||e.template_image_url===""){console.log("  : template_image_url "),console.log("   - previewUrl:",c),f({type:"error",message:"  ."});return}if(console.log(" qr_position :",e.qr_position),!e.qr_position||e.qr_position.width===0){console.log("  : QR  "),f({type:"error",message:"QR   .    QR  ."});return}try{l(!0),f({type:"uploading",message:"  ..."}),console.log("  :",e);const g=m(e.start_date,e.end_date),T={...e,status:g};console.log("  :",g);const{error:b}=await ce.from("events").insert([T]);if(b)throw console.error(" DB  :",b),b;console.log("   !"),f({type:"success",message:"   !"}),setTimeout(r,500)}catch(g){console.error("   :",g),f({type:"error",message:"   : "+g.message})}finally{l(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-50 p-4 overflow-y-auto",style:{paddingTop:"2rem"},children:n.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm relative",style:{borderRadius:"10px"},children:n.jsxs("div",{className:"p-5 max-h-[90vh] overflow-y-auto",children:[n.jsx("div",{className:"flex flex-col items-center justify-center mb-3",children:n.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain",onError:x=>x.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"28px"},children:" "})]})}),d.message&&n.jsx("div",{className:`mb-3 p-3 rounded-lg ${d.type==="error"?"bg-red-50 border-2 border-red-300":d.type==="success"?"bg-green-50 border-2 border-green-300":"bg-blue-50 border-2 border-blue-300"}`,style:{borderRadius:"10px"},children:n.jsx("p",{className:`text-sm font-medium ${d.type==="error"?"text-red-700":d.type==="success"?"text-green-700":"text-blue-700"}`,children:d.message})}),n.jsxs("form",{onSubmit:p,className:"space-y-2",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"text",value:e.name,onChange:x=>s(g=>({...g,name:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:":   ",style:{borderRadius:"10px"},required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),n.jsx("textarea",{value:e.description,onChange:x=>s(g=>({...g,description:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:"2",placeholder:"   ",style:{borderRadius:"10px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[" URL ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"url",value:e.landing_url,onChange:x=>s(g=>({...g,landing_url:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"https://example.com/event",style:{borderRadius:"10px"},required:!0})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),n.jsx("input",{type:"date",value:e.start_date,onChange:x=>s(g=>({...g,start_date:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:""}),n.jsx("input",{type:"date",value:e.end_date,onChange:x=>s(g=>({...g,end_date:x.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:["  ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"file",accept:"image/*",onChange:u,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"},disabled:a})]}),n.jsxs("div",{className:"p-3 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border-2 border-blue-300 shadow-md",style:{borderRadius:"10px"},children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2 text-center",children:" QR  "}),n.jsx("div",{className:"relative inline-block border-4 border-blue-400 rounded bg-white shadow-xl w-full",style:{borderRadius:"10px",minHeight:"400px"},children:a?n.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"400px"},children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-3"}),n.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"   ..."})]})}):c||e.template_image_url?n.jsx(Nc,{imageUrl:c||e.template_image_url,position:e.qr_position,onPositionChange:x=>s(g=>({...g,qr_position:x}))}):n.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"400px"},children:n.jsxs("div",{className:"text-center text-gray-400",children:[n.jsx("svg",{className:"w-16 h-16 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),n.jsx("p",{className:"text-sm",children:" "})]})})}),e.qr_position&&e.qr_position.width>0&&n.jsx("div",{className:"mt-2 p-2 bg-green-50 rounded border border-green-300",style:{borderRadius:"10px"},children:n.jsx("p",{className:"text-xs text-green-700 font-medium text-center",children:" QR  !"})})]}),n.jsxs("div",{className:"flex gap-3 pt-3",children:[n.jsx("button",{type:"button",onClick:t,className:"w-full py-3 flex items-center justify-center gap-2 bg-white text-gray-700 border-2 border-gray-300 rounded-lg hover:bg-gray-50 font-bold",style:{borderRadius:"10px",fontSize:"15px"},children:""}),n.jsxs("button",{type:"submit",disabled:o||a,className:"w-full py-3 flex items-center justify-center gap-2 text-white rounded-lg hover:opacity-90 disabled:opacity-50 font-bold",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Fn,{size:18}),o?" ...":""]})]})]})]})})})}function $v({event:t,onClose:r,onSuccess:e}){const[s,a]=P.useState({name:t.name||"",description:t.description||"",landing_url:t.landing_url||"",template_image_url:t.template_image_url||"",qr_position:t.qr_position||{x:0,y:0,width:0,height:0},status:t.status||"active",start_date:t.start_date||"",end_date:t.end_date||""}),[i,o]=P.useState(!1),[l,c]=P.useState(!1),[h,d]=P.useState(""),[f,u]=P.useState({type:"",message:""}),m=async g=>{const T=g.target.files[0];if(!T)return;const b=URL.createObjectURL(T);d(b),u({type:"uploading",message:"  ..."});try{o(!0);const w=T.name.split(".").pop(),_=`event-templates/${`${Date.now()}_${Math.random().toString(36).substring(7)}.${w}`}`,{data:L,error:E}=await ce.storage.from("event-images").upload(_,T);if(E)throw E;const F=`https://sgxnxbhbyvrmgrzhosyh.supabase.co/storage/v1/object/public/event-images/${_}`;a(M=>({...M,template_image_url:F})),setTimeout(()=>d(""),100),u({type:"success",message:"   !"})}catch(w){u({type:"error",message:"  : "+w.message})}finally{o(!1)}},p=(g,T)=>{if(!g||!T)return"active";const b=new Date;b.setHours(0,0,0,0);const w=new Date(g);w.setHours(0,0,0,0);const A=new Date(T);return A.setHours(0,0,0,0),b>A?"ended":b<w?"scheduled":"active"},x=async g=>{if(g.preventDefault(),!s.name||!s.landing_url){u({type:"error",message:"  ."});return}if(!s.template_image_url){u({type:"error",message:"  ."});return}if(!s.qr_position||s.qr_position.width===0){u({type:"error",message:"QR   ."});return}try{c(!0),u({type:"uploading",message:"  ..."});const T=p(s.start_date,s.end_date),b={...s,status:T};console.log("  :",T);const{error:w}=await ce.from("events").update(b).eq("id",t.id);if(w)throw w;u({type:"success",message:"   !"}),setTimeout(e,500)}catch(T){u({type:"error",message:"   : "+T.message})}finally{c(!1)}};return n.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-start justify-center z-50 p-4 overflow-y-auto",style:{paddingTop:"2rem"},children:n.jsx("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-sm relative",style:{borderRadius:"10px"},children:n.jsxs("div",{className:"p-4 max-h-[85vh] overflow-y-auto",children:[n.jsx("div",{className:"flex flex-col items-center justify-center mb-2.5",children:n.jsxs("div",{className:"flex items-center gap-1.5 mb-2",children:[n.jsx("img",{src:"/images/logo.png",alt:"LAS Logo",className:"w-10 h-10 object-contain",onError:g=>g.target.style.display="none"}),n.jsx("h2",{className:"font-bold",style:{color:"#249689",fontSize:"28px"},children:" "})]})}),f.message&&n.jsx("div",{className:`mb-3 p-3 rounded-lg ${f.type==="error"?"bg-red-50 border-2 border-red-300":f.type==="success"?"bg-green-50 border-2 border-green-300":"bg-blue-50 border-2 border-blue-300"}`,style:{borderRadius:"10px"},children:n.jsx("p",{className:`text-sm font-medium ${f.type==="error"?"text-red-700":f.type==="success"?"text-green-700":"text-blue-700"}`,children:f.message})}),n.jsxs("form",{onSubmit:x,className:"space-y-1.5",children:[n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:[" ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"text",value:s.name,onChange:g=>a(T=>({...T,name:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:":   ",style:{borderRadius:"10px"},required:!0})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:""}),n.jsx("textarea",{value:s.description,onChange:g=>a(T=>({...T,description:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",rows:"2",placeholder:"   ",style:{borderRadius:"10px"}})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:[" URL ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"url",value:s.landing_url,onChange:g=>a(T=>({...T,landing_url:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",placeholder:"https://example.com/event",style:{borderRadius:"10px"},required:!0})]}),n.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:""}),n.jsx("input",{type:"date",value:s.start_date,onChange:g=>a(T=>({...T,start_date:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]}),n.jsxs("div",{children:[n.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:""}),n.jsx("input",{type:"date",value:s.end_date,onChange:g=>a(T=>({...T,end_date:g.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"}})]})]}),n.jsxs("div",{children:[n.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-0.5",children:["  ",n.jsx("span",{style:{color:"red"},children:"*"})]}),n.jsx("input",{type:"file",accept:"image/*",onChange:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg",style:{borderRadius:"10px"},disabled:i})]}),n.jsxs("div",{className:"p-3 bg-gradient-to-br from-blue-50 to-cyan-50 rounded-lg border-2 border-blue-300 shadow-md",style:{borderRadius:"10px"},children:[n.jsx("label",{className:"block text-sm font-bold text-gray-700 mb-2 text-center",children:" QR  "}),n.jsx("div",{className:"relative inline-block border-4 border-blue-400 rounded bg-white shadow-xl w-full",style:{borderRadius:"10px",minHeight:"280px"},children:i?n.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"280px"},children:n.jsxs("div",{className:"text-center",children:[n.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-3"}),n.jsx("p",{className:"text-sm text-blue-700 font-medium",children:"   ..."})]})}):h||s.template_image_url?n.jsx(Nc,{imageUrl:h||s.template_image_url,position:s.qr_position,onPositionChange:g=>a(T=>({...T,qr_position:g}))}):n.jsx("div",{className:"flex items-center justify-center",style:{minHeight:"280px"},children:n.jsxs("div",{className:"text-center text-gray-400",children:[n.jsx("svg",{className:"w-16 h-16 mx-auto mb-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:n.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})}),n.jsx("p",{className:"text-sm",children:" "})]})})}),s.qr_position&&s.qr_position.width>0&&n.jsx("div",{className:"mt-2 p-2 bg-green-50 rounded border border-green-300",style:{borderRadius:"10px"},children:n.jsx("p",{className:"text-xs text-green-700 font-medium text-center",children:" QR  !"})})]}),n.jsxs("div",{className:"flex gap-3 pt-3",children:[n.jsx("button",{type:"button",onClick:r,className:"w-full py-3 flex items-center justify-center gap-2 bg-white text-gray-700 border-2 border-gray-300 rounded-lg hover:bg-gray-50 font-bold",style:{borderRadius:"10px",fontSize:"15px"},children:""}),n.jsxs("button",{type:"submit",disabled:l||i,className:"w-full py-3 flex items-center justify-center gap-2 text-white rounded-lg hover:opacity-90 disabled:opacity-50 font-bold",style:{backgroundColor:"#4A9B8E",borderRadius:"10px",fontSize:"15px"},children:[n.jsx(Ia,{size:18}),l?" ...":""]})]})]})]})})})}function Hv(){const[t,r]=P.useState(null),[e,s]=P.useState("/dashboard"),a=lo(),i=Lc();P.useEffect(()=>{console.log("Current User:",t),console.log("Current Path:",i.pathname),console.log("Previous Path:",e)},[t,i,e]);const o=f=>{console.log("Auto login:",f),r(f),f.user_type===""?a("/system-admin"):a("/dashboard")},l=async()=>{try{console.log("Logging out..."),await ce.auth.signOut(),r(null),a("/")}catch(f){console.error(" :",f),alert("   .")}},c=f=>{const u=typeof f=="string"?f.trim():f;console.log(""),console.log(" handleNavigate "),console.log("  :",`"${f}"`),console.log("  :",`"${u}"`),console.log("  :",typeof f);const m={hero:"/",login:"/login",signup:"/signup",mathletter:"/mathletter",event:"/event",Dashboard:"/dashboard",dashboard:"/dashboard",AdminDashboard:"/admin",admin:"/admin",AdminUsers:"/admin/users",AdminWorkDiary:"/admin/workdiary",AdminCustomers:"/admin/customers",AdminEventMenu:"/admin/event-menu",adminEvent:"/admin/event",AdminEventDashboard:"/admin/event",AdminEventManager:"/admin/event-manager",MyInfo:"/myinfo",MyQRCode:"/myqrcode",WorkDiary:"/workdiary",CustomerManagement:"/customers",ShippingList:"/shipping",PurchaseHistory:"/purchases",purchases:"/purchases",SystemAdminDashboard:"/system-admin","system-admin":"/system-admin",SystemAdminBranches:"/system-admin/branches",SystemAdminUsers:"/system-admin/users",SystemAdminCustomers:"/system-admin/customers",SystemAdminPurchases:"/system-admin/purchases",SystemAdminShipping:"/system-admin/shipping",MathLetterManager:"/system-admin/mathletter",Profile:"/profile"},p=m[u];if(console.log("  :",p),!p){console.error("    :",u),console.error("   :",Object.keys(m).join(", ")),console.error(" HeroPage(/) "),console.log(""),a("/");return}(u==="AdminEventDashboard"||u==="adminEvent")&&(s(i.pathname),console.log("   :",i.pathname)),console.log(" :",u,"",p),console.log(""),a(p)},h=f=>{console.log("Login:",f),r(f),f.user_type===""?a("/system-admin"):a("/dashboard")},d=f=>{console.log(""),console.log("App.jsx - handleSwitchMode "),console.log(" :",t?.loginMode),console.log(" :",f);const u={...t,loginMode:f};r(u),f===un.MANAGER?(console.log("MANAGER    /admin "),a("/admin")):f===un.EMPLOYEE&&(console.log("EMPLOYEE    /dashboard "),a("/dashboard")),console.log("")};return n.jsxs(n.Fragment,{children:[n.jsxs(Bc,{children:[n.jsx(Be,{path:"/",element:n.jsx(Id,{onNavigate:c,onAutoLogin:o})}),n.jsx(Be,{path:"/login",element:n.jsx(Pd,{onNavigate:c,onLogin:h})}),n.jsx(Be,{path:"/signup",element:n.jsx(Ld,{onNavigate:c})}),n.jsx(Be,{path:"/mathletter",element:n.jsx(Dv,{})}),n.jsx(Be,{path:"/event",element:n.jsx(Iv,{})}),n.jsx(Be,{path:"/dashboard",element:t?n.jsx(Bd,{user:t,onNavigate:c,onLogout:l,onSwitchMode:d}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin",element:t&&gs(t)?n.jsx(Md,{user:t,onNavigate:c,onLogout:l,onSwitchMode:d}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/users",element:t&&gs(t)?n.jsx(k1,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/workdiary",element:t&&gs(t)?n.jsx(A1,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/customers",element:t&&gs(t)?n.jsx(R1,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/event-menu",element:t&&t.user_type===""?n.jsx(Lv,{user:t,onNavigate:c,onLogout:l,onBack:()=>a("/system-admin")}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/event-manager",element:t&&t.user_type===""?n.jsx(Mv,{user:t,onBack:()=>a("/admin/event-menu")}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/admin/event",element:t?n.jsx(Pv,{user:t,onNavigate:c,onLogout:l,from:e,onBack:()=>{console.log(" AdminEventDashboard "),console.log("    :",e),e&&e!=="/admin/event"?(console.log("      :",e),a(e)):t.user_type===""?(console.log("    : /admin/event-menu"),a("/admin/event-menu")):gs(t)?(console.log("    : /admin"),a("/admin")):(console.log("     : /dashboard"),a("/dashboard"))}}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/myinfo",element:t?n.jsx(W1,{user:t,onBack:()=>a("/dashboard"),onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/myqrcode",element:t?n.jsx(Fv,{user:t,onBack:()=>a("/myinfo")}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/workdiary",element:t?n.jsx(D1,{user:t,onNavigate:c,onLogout:l}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/customers",element:t?n.jsx(O1,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/shipping",element:t?n.jsx(I1,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/purchases",element:t?n.jsx(P1,{user:t,onNavigate:c}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/system-admin",element:t&&t.user_type===""?n.jsx(L1,{user:t,onNavigate:c,onLogout:l}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"/system-admin/branches",element:t&&t.user_type===""?n.jsx(B1,{user:t,onNavigate:c}):n.jsx(We,{to:"/system-admin",replace:!0})}),n.jsx(Be,{path:"/system-admin/users",element:t&&t.user_type===""?n.jsx(z1,{user:t,onNavigate:c}):n.jsx(We,{to:"/system-admin",replace:!0})}),n.jsx(Be,{path:"/system-admin/customers",element:t&&t.user_type===""?n.jsx(U1,{user:t,onNavigate:c}):n.jsx(We,{to:"/system-admin",replace:!0})}),n.jsx(Be,{path:"/system-admin/purchases",element:t&&t.user_type===""?n.jsx($1,{user:t,onNavigate:c}):n.jsx(We,{to:"/system-admin",replace:!0})}),n.jsx(Be,{path:"/system-admin/shipping",element:t&&t.user_type===""?n.jsx(H1,{user:t,onNavigate:c}):n.jsx(We,{to:"/system-admin",replace:!0})}),n.jsx(Be,{path:"/system-admin/mathletter",element:t&&t.user_type===""?n.jsx(Ov,{user:t,onBack:()=>a("/system-admin")}):n.jsx(We,{to:"/system-admin",replace:!0})}),n.jsx(Be,{path:"/profile",element:t?n.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:n.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-8 max-w-md",children:[n.jsx("h2",{className:"text-2xl font-bold mb-4",style:{color:"#249689"},children:" "}),n.jsxs("div",{className:"mb-4 space-y-2",children:[n.jsxs("p",{className:"text-gray-600",children:[": ",t.name]}),n.jsxs("p",{className:"text-gray-600",children:[": ",t.email]}),n.jsxs("p",{className:"text-gray-600",children:[": ",t.branch]})]}),n.jsx("p",{className:"text-gray-500 text-sm mb-4",children:"   ."}),n.jsx("button",{onClick:()=>{t.user_type===""?a("/system-admin"):a("/dashboard")},className:"w-full py-2 text-white font-bold rounded-lg",style:{backgroundColor:"#249689"},children:" "})]})}):n.jsx(We,{to:"/login",replace:!0})}),n.jsx(Be,{path:"*",element:n.jsx(We,{to:"/",replace:!0})})]}),n.jsx(Bv,{})]})}function Wv(){return n.jsx(Pc,{children:n.jsx(Hv,{})})}ga.createRoot(document.getElementById("root")).render(n.jsx(Mc.StrictMode,{children:n.jsx(Wv,{})}));
